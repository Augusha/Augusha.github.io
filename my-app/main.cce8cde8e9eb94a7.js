(self.webpackChunkmy_app=self.webpackChunkmy_app||[]).push([[179],{309:(pm,mu,gu)=>{"use strict";function oi(e){return"function"==typeof e}function $h(e){const t=e(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const fm=$h(e=>function(t){e(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,l)=>`${l+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function p(e,n){if(e){const t=e.indexOf(n);0<=t&&e.splice(t,1)}}class je{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const u of t)u.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(oi(r))try{r()}catch(u){n=u instanceof fm?u.errors:[u]}const{_finalizers:l}=this;if(l){this._finalizers=null;for(const u of l)try{Jt(u)}catch(g){n=n??[],g instanceof fm?n=[...n,...g.errors]:n.push(g)}}if(n)throw new fm(n)}}add(n){var t;if(n&&n!==this)if(this.closed)Jt(n);else{if(n instanceof je){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(n)}}_hasParent(n){const{_parentage:t}=this;return t===n||Array.isArray(t)&&t.includes(n)}_addParent(n){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(n),t):t?[t,n]:n}_removeParent(n){const{_parentage:t}=this;t===n?this._parentage=null:Array.isArray(t)&&p(t,n)}remove(n){const{_finalizers:t}=this;t&&p(t,n),n instanceof je&&n._removeParent(this)}}je.EMPTY=(()=>{const e=new je;return e.closed=!0,e})();const Yo=je.EMPTY;function co(e){return e instanceof je||e&&"closed"in e&&oi(e.remove)&&oi(e.add)&&oi(e.unsubscribe)}function Jt(e){oi(e)?e():e.unsubscribe()}const Xt={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Ni={setTimeout(e,n,...t){const{delegate:r}=Ni;return r?.setTimeout?r.setTimeout(e,n,...t):setTimeout(e,n,...t)},clearTimeout(e){const{delegate:n}=Ni;return(n?.clearTimeout||clearTimeout)(e)},delegate:void 0};function Rr(e){Ni.setTimeout(()=>{const{onUnhandledError:n}=Xt;if(!n)throw e;n(e)})}function Mo(){}const Ts=eo("C",void 0,void 0);function eo(e,n,t){return{kind:e,value:n,error:t}}let uo=null;function Wr(e){if(Xt.useDeprecatedSynchronousErrorHandling){const n=!uo;if(n&&(uo={errorThrown:!1,error:null}),e(),n){const{errorThrown:t,error:r}=uo;if(uo=null,t)throw r}}else e()}class Ms extends je{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,co(n)&&n.add(this)):this.destination=_u}static create(n,t,r){return new Ra(n,t,r)}next(n){this.isStopped?uc(function gl(e){return eo("N",e,void 0)}(n),this):this._next(n)}error(n){this.isStopped?uc(function cc(e){return eo("E",void 0,e)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?uc(Ts,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Do=Function.prototype.bind;function lt(e,n){return Do.call(e,n)}class qh{constructor(n){this.partialObserver=n}next(n){const{partialObserver:t}=this;if(t.next)try{t.next(n)}catch(r){sn(r)}}error(n){const{partialObserver:t}=this;if(t.error)try{t.error(n)}catch(r){sn(r)}else sn(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(t){sn(t)}}}class Ra extends Ms{constructor(n,t,r){let l;if(super(),oi(n)||!n)l={next:n??void 0,error:t??void 0,complete:r??void 0};else{let u;this&&Xt.useDeprecatedNextContext?(u=Object.create(n),u.unsubscribe=()=>this.unsubscribe(),l={next:n.next&&lt(n.next,u),error:n.error&&lt(n.error,u),complete:n.complete&&lt(n.complete,u)}):l=n}this.destination=new qh(l)}}function sn(e){Xt.useDeprecatedSynchronousErrorHandling?function Pa(e){Xt.useDeprecatedSynchronousErrorHandling&&uo&&(uo.errorThrown=!0,uo.error=e)}(e):Rr(e)}function uc(e,n){const{onStoppedNotification:t}=Xt;t&&Ni.setTimeout(()=>t(e,n))}const _u={closed:!0,next:Mo,error:function qi(e){throw e},complete:Mo},Oa="function"==typeof Symbol&&Symbol.observable||"@@observable";function es(e){return e}function Fa(e){return 0===e.length?es:1===e.length?e[0]:function(t){return e.reduce((r,l)=>l(r),t)}}let fn=(()=>{class e{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new e;return r.source=this,r.operator=t,r}subscribe(t,r,l){const u=function Ii(e){return e&&e instanceof Ms||function ta(e){return e&&oi(e.next)&&oi(e.error)&&oi(e.complete)}(e)&&co(e)}(t)?t:new Ra(t,r,l);return Wr(()=>{const{operator:g,source:w}=this;u.add(g?g.call(u,w):w?this._subscribe(u):this._trySubscribe(u))}),u}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=zi(r))((l,u)=>{const g=new Ra({next:w=>{try{t(w)}catch(I){u(I),g.unsubscribe()}},error:u,complete:l});this.subscribe(g)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[Oa](){return this}pipe(...t){return Fa(t)(this)}toPromise(t){return new(t=zi(t))((r,l)=>{let u;this.subscribe(g=>u=g,g=>l(g),()=>r(u))})}}return e.create=n=>new e(n),e})();function zi(e){var n;return null!==(n=e??Xt.Promise)&&void 0!==n?n:Promise}const na=$h(e=>function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let rr=(()=>{class e extends fn{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new Ds(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new na}next(t){Wr(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){Wr(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){Wr(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:l,observers:u}=this;return r||l?Yo:(this.currentObservers=null,u.push(t),new je(()=>{this.currentObservers=null,p(u,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:l,isStopped:u}=this;r?t.error(l):u&&t.complete()}asObservable(){const t=new fn;return t.source=this,t}}return e.create=(n,t)=>new Ds(n,t),e})();class Ds extends rr{constructor(n,t){super(),this.destination=n,this.source=t}next(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,n)}error(n){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,n)}complete(){var n,t;null===(t=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===t||t.call(n)}_subscribe(n){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(n))&&void 0!==r?r:Yo}}function ts(e){return oi(e?.lift)}function pi(e){return n=>{if(ts(n))return n.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function ei(e,n,t,r,l){return new _l(e,n,t,r,l)}class _l extends Ms{constructor(n,t,r,l,u,g){super(n),this.onFinalize=u,this.shouldUnsubscribe=g,this._next=t?function(w){try{t(w)}catch(I){n.error(I)}}:super._next,this._error=l?function(w){try{l(w)}catch(I){n.error(I)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(w){n.error(w)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function ht(e,n){return pi((t,r)=>{let l=0;t.subscribe(ei(r,u=>{r.next(e.call(n,u,l++))}))})}function ko(e){return this instanceof ko?(this.v=e,this):new ko(e)}function Na(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=function to(e){var n="function"==typeof Symbol&&Symbol.iterator,t=n&&e[n],r=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(u){t[u]=e[u]&&function(g){return new Promise(function(w,I){!function l(u,g,w,I){Promise.resolve(I).then(function(S){u({value:S,done:w})},g)}(w,I,(g=e[u](g)).done,g.value)})}}}const de=e=>e&&"number"==typeof e.length&&"function"!=typeof e;function _e(e){return oi(e?.then)}function Ee(e){return oi(e[Oa])}function be(e){return Symbol.asyncIterator&&oi(e?.[Symbol.asyncIterator])}function ge(e){return new TypeError(`You provided ${null!==e&&"object"==typeof e?"an invalid object":`'${e}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const rt=function Pe(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function at(e){return oi(e?.[rt])}function tt(e){return function La(e,n,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var l,r=t.apply(e,n||[]),u=[];return l={},g("next"),g("throw"),g("return"),l[Symbol.asyncIterator]=function(){return this},l;function g(ne){r[ne]&&(l[ne]=function(se){return new Promise(function(he,Ie){u.push([ne,se,he,Ie])>1||w(ne,se)})})}function w(ne,se){try{!function I(ne){ne.value instanceof ko?Promise.resolve(ne.value.v).then(S,L):j(u[0][2],ne)}(r[ne](se))}catch(he){j(u[0][3],he)}}function S(ne){w("next",ne)}function L(ne){w("throw",ne)}function j(ne,se){ne(se),u.shift(),u.length&&w(u[0][0],u[0][1])}}(this,arguments,function*(){const t=e.getReader();try{for(;;){const{value:r,done:l}=yield ko(t.read());if(l)return yield ko(void 0);yield yield ko(r)}}finally{t.releaseLock()}})}function Ht(e){return oi(e?.getReader)}function Ot(e){if(e instanceof fn)return e;if(null!=e){if(Ee(e))return function qt(e){return new fn(n=>{const t=e[Oa]();if(oi(t.subscribe))return t.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(e);if(de(e))return function rn(e){return new fn(n=>{for(let t=0;t<e.length&&!n.closed;t++)n.next(e[t]);n.complete()})}(e);if(_e(e))return function mn(e){return new fn(n=>{e.then(t=>{n.closed||(n.next(t),n.complete())},t=>n.error(t)).then(null,Rr)})}(e);if(be(e))return Ai(e);if(at(e))return function si(e){return new fn(n=>{for(const t of e)if(n.next(t),n.closed)return;n.complete()})}(e);if(Ht(e))return function gr(e){return Ai(tt(e))}(e)}throw ge(e)}function Ai(e){return new fn(n=>{(function Oi(e,n){var t,r,l,u;return function oa(e,n,t,r){return new(t||(t=Promise))(function(u,g){function w(L){try{S(r.next(L))}catch(j){g(j)}}function I(L){try{S(r.throw(L))}catch(j){g(j)}}function S(L){L.done?u(L.value):function l(u){return u instanceof t?u:new t(function(g){g(u)})}(L.value).then(w,I)}S((r=r.apply(e,n||[])).next())})}(this,void 0,void 0,function*(){try{for(t=Na(e);!(r=yield t.next()).done;)if(n.next(r.value),n.closed)return}catch(g){l={error:g}}finally{try{r&&!r.done&&(u=t.return)&&(yield u.call(t))}finally{if(l)throw l.error}}n.complete()})})(e,n).catch(t=>n.error(t))})}function Wi(e,n,t,r=0,l=!1){const u=n.schedule(function(){t(),l?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(u),!l)return u}function Vn(e,n,t=1/0){return oi(n)?Vn((r,l)=>ht((u,g)=>n(r,u,l,g))(Ot(e(r,l))),t):("number"==typeof n&&(t=n),pi((r,l)=>function Zi(e,n,t,r,l,u,g,w){const I=[];let S=0,L=0,j=!1;const ne=()=>{j&&!I.length&&!S&&n.complete()},se=Ie=>S<r?he(Ie):I.push(Ie),he=Ie=>{u&&n.next(Ie),S++;let Ue=!1;Ot(t(Ie,L++)).subscribe(ei(n,$e=>{l?.($e),u?se($e):n.next($e)},()=>{Ue=!0},void 0,()=>{if(Ue)try{for(S--;I.length&&S<r;){const $e=I.shift();g?Wi(n,g,()=>he($e)):he($e)}ne()}catch($e){n.error($e)}}))};return e.subscribe(ei(n,se,()=>{j=!0,ne()})),()=>{w?.()}}(r,l,e,t)))}function Po(e=1/0){return Vn(es,e)}const ns=new fn(e=>e.complete());function za(e){return e[e.length-1]}function xu(e){return oi(za(e))?e.pop():void 0}function aa(e){return function Xh(e){return e&&oi(e.schedule)}(za(e))?e.pop():void 0}function rs(e,n=0){return pi((t,r)=>{t.subscribe(ei(r,l=>Wi(r,e,()=>r.next(l),n),()=>Wi(r,e,()=>r.complete(),n),l=>Wi(r,e,()=>r.error(l),n)))})}function bu(e,n=0){return pi((t,r)=>{r.add(e.schedule(()=>t.subscribe(r),n))})}function Fe(e,n){if(!e)throw new Error("Iterable cannot be null");return new fn(t=>{Wi(t,n,()=>{const r=e[Symbol.asyncIterator]();Wi(t,n,()=>{r.next().then(l=>{l.done?t.complete():t.next(l.value)})},0,!0)})})}function xn(e,n){return n?function Ti(e,n){if(null!=e){if(Ee(e))return function Kh(e,n){return Ot(e).pipe(bu(n),rs(n))}(e,n);if(de(e))return function Ss(e,n){return new fn(t=>{let r=0;return n.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}(e,n);if(_e(e))return function Va(e,n){return Ot(e).pipe(bu(n),rs(n))}(e,n);if(be(e))return Fe(e,n);if(at(e))return function mc(e,n){return new fn(t=>{let r;return Wi(t,n,()=>{r=e[rt](),Wi(t,n,()=>{let l,u;try{({value:l,done:u}=r.next())}catch(g){return void t.error(g)}u?t.complete():t.next(l)},0,!0)}),()=>oi(r?.return)&&r.return()})}(e,n);if(Ht(e))return function ks(e,n){return Fe(tt(e),n)}(e,n)}throw ge(e)}(e,n):Ot(e)}function gc(e,n,...t){if(!0===n)return void e();if(!1===n)return;const r=new Ra({next:()=>{r.unsubscribe(),e()}});return Ot(n(...t)).subscribe(r)}function Xn(e){for(let n in e)if(e[n]===Xn)return n;throw Error("Could not find renamed property on target object.")}function la(e,n){for(const t in n)n.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=n[t])}function et(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(et).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return`${e.overriddenName}`;if(e.name)return`${e.name}`;const n=e.toString();if(null==n)return""+n;const t=n.indexOf("\n");return-1===t?n:n.substring(0,t)}function an(e,n){return null==e||""===e?null===n?"":n:null==n||""===n?e:e+" "+n}const ln=Xn({__forward_ref__:Xn});function vn(e){return e.__forward_ref__=vn,e.toString=function(){return et(this())},e}function Pt(e){return Yt(e)?e():e}function Yt(e){return"function"==typeof e&&e.hasOwnProperty(ln)&&e.__forward_ref__===vn}function Or(e){return e&&!!e.\u0275providers}const os="https://g.co/ng/security#xss";class st extends Error{constructor(n,t){super(Zn(n,t)),this.code=n}}function Zn(e,n){return`NG0${Math.abs(e)}${n?": "+n.trim():""}`}function en(e){return"string"==typeof e?e:null==e?"":String(e)}function yc(e,n){throw new st(-201,!1)}function _r(e,n){null==e&&function Nn(e,n,t,r){throw new Error(`ASSERTION ERROR: ${e}`+(null==r?"":` [Expected=> ${t} ${r} ${n} <=Actual]`))}(n,e,null,"!=")}function Tt(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function fi(e){return{providers:e.providers||[],imports:e.imports||[]}}function Ua(e){return Tu(e,as)||Tu(e,El)}function Tu(e,n){return e.hasOwnProperty(n)?e[n]:null}function Mu(e){return e&&(e.hasOwnProperty(Oo)||e.hasOwnProperty(Ps))?e[Oo]:null}const as=Xn({\u0275prov:Xn}),Oo=Xn({\u0275inj:Xn}),El=Xn({ngInjectableDef:Xn}),Ps=Xn({ngInjectorDef:Xn});var Bt=(()=>((Bt=Bt||{})[Bt.Default=0]="Default",Bt[Bt.Host=1]="Host",Bt[Bt.Self=2]="Self",Bt[Bt.SkipSelf=4]="SkipSelf",Bt[Bt.Optional=8]="Optional",Bt))();let ua;function io(e){const n=ua;return ua=e,n}function bc(e,n,t){const r=Ua(e);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&Bt.Optional?null:void 0!==n?n:void yc(et(e))}const ti=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ja={},Du="__NG_DI_FLAG__",Cl="ngTempTokenPath",yp="ngTokenPath",Yh=/\n/gm,Il="\u0275",Ec="__source";let ls;function Zr(e){const n=ls;return ls=e,n}function Ha(e,n=Bt.Default){if(void 0===ls)throw new st(-203,!1);return null===ls?bc(e,void 0,n):ls.get(e,n&Bt.Optional?null:void 0,n)}function gt(e,n=Bt.Default){return(function xc(){return ua}()||Ha)(Pt(e),n)}function Wt(e,n=Bt.Default){return gt(e,Tl(n))}function Tl(e){return typeof e>"u"||"number"==typeof e?e:0|(e.optional&&8)|(e.host&&1)|(e.self&&2)|(e.skipSelf&&4)}function Cc(e){const n=[];for(let t=0;t<e.length;t++){const r=Pt(e[t]);if(Array.isArray(r)){if(0===r.length)throw new st(900,!1);let l,u=Bt.Default;for(let g=0;g<r.length;g++){const w=r[g],I=Su(w);"number"==typeof I?-1===I?l=w.token:u|=I:l=w}n.push(gt(l,u))}else n.push(gt(r))}return n}function ha(e,n){return e[Du]=n,e.prototype[Du]=n,e}function Su(e){return e[Du]}function ro(e){return{toString:e}.toString()}var Fo=(()=>((Fo=Fo||{})[Fo.OnPush=0]="OnPush",Fo[Fo.Default=1]="Default",Fo))(),mo=(()=>{return(e=mo||(mo={}))[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",mo;var e})();const cs={},wn=[],Ml=Xn({\u0275cmp:Xn}),nd=Xn({\u0275dir:Xn}),id=Xn({\u0275pipe:Xn}),vp=Xn({\u0275mod:Xn}),Lo=Xn({\u0275fac:Xn}),Ga=Xn({__NG_ELEMENT_ID__:Xn});let rd=0;function vr(e){return ro(()=>{const n=Pu(e),t={...n,decls:e.decls,vars:e.vars,template:e.template,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,onPush:e.changeDetection===Fo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&e.dependencies||null,getStandaloneInjector:null,data:e.data||{},encapsulation:e.encapsulation||mo.Emulated,id:"c"+rd++,styles:e.styles||wn,_:null,schemas:e.schemas||null,tView:null};xp(t);const r=e.dependencies;return t.directiveDefs=Sl(r,!1),t.pipeDefs=Sl(r,!0),t})}function Ap(e){return gn(e)||Ui(e)}function ym(e){return null!==e}function Vi(e){return ro(()=>({type:e.type,bootstrap:e.bootstrap||wn,declarations:e.declarations||wn,imports:e.imports||wn,exports:e.exports||wn,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null}))}function ku(e,n){if(null==e)return cs;const t={};for(const r in e)if(e.hasOwnProperty(r)){let l=e[r],u=l;Array.isArray(l)&&(u=l[1],l=l[0]),t[l]=r,n&&(n[l]=u)}return t}function Nt(e){return ro(()=>{const n=Pu(e);return xp(n),n})}function gn(e){return e[Ml]||null}function Ui(e){return e[nd]||null}function xr(e){return e[id]||null}function Qr(e,n){const t=e[vp]||null;if(!t&&!0===n)throw new Error(`Type ${et(e)} does not have '\u0275mod' property.`);return t}function Pu(e){const n={};return{type:e.type,providersResolver:null,factory:null,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:n,exportAs:e.exportAs||null,standalone:!0===e.standalone,selectors:e.selectors||wn,viewQuery:e.viewQuery||null,features:e.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ku(e.inputs,n),outputs:ku(e.outputs)}}function xp(e){e.features?.forEach(n=>n(e))}function Sl(e,n){if(!e)return null;const t=n?xr:Ap;return()=>("function"==typeof e?e():e).map(r=>t(r)).filter(ym)}const go=0,wt=1,hn=2,ui=3,Bo=4,Os=5,sr=6,us=7,bi=8,$a=9,Ic=10,tn=11,sd=12,Tc=13,bp=14,kl=15,br=16,Pl=17,Fs=18,Fr=19,Rl=20,ad=21,Fn=22,Xr=1,Ol=2,Mc=7,hs=8,No=9,Qi=10;function Zt(e){return Array.isArray(e)&&"object"==typeof e[Xr]}function Lr(e){return Array.isArray(e)&&!0===e[Xr]}function Ru(e){return 0!=(4&e.flags)}function da(e){return e.componentOffset>-1}function Ls(e){return 1==(1&e.flags)}function _o(e){return!!e.template}function Ou(e){return 0!=(256&e[hn])}function fa(e,n){return e.hasOwnProperty(Lo)?e[Lo]:null}class Vu{constructor(n,t,r){this.previousValue=n,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Hi(){return Uu}function Uu(e){return e.type.prototype.ngOnChanges&&(e.setInput=Ip),Am}function Am(){const e=ju(this),n=e?.current;if(n){const t=e.previous;if(t===cs)e.previous=n;else for(let r in n)t[r]=n[r];e.current=null,this.ngOnChanges(n)}}function Ip(e,n,t,r){const l=this.declaredInputs[t],u=ju(e)||function fd(e,n){return e[qa]=n}(e,{previous:cs,current:null}),g=u.current||(u.current={}),w=u.previous,I=w[l];g[l]=new Vu(I&&I.currentValue,n,w===cs),e[r]=n}Hi.ngInherit=!0;const qa="__ngSimpleChanges__";function ju(e){return e[qa]||null}const wr=function(e,n,t){};function Xi(e){for(;Array.isArray(e);)e=e[go];return e}function Pc(e,n){return Xi(n[e])}function Fi(e,n){return Xi(n[e.index])}function gd(e,n){return e.data[n]}function Br(e,n){const t=n[e];return Zt(t)?t:t[go]}function Rc(e){return 64==(64&e[hn])}function mi(e,n){return null==n?null:e[n]}function Dp(e){e[Fs]=0}function $u(e,n){e[Os]+=n;let t=e,r=e[ui];for(;null!==r&&(1===n&&1===t[Os]||-1===n&&0===t[Os]);)r[Os]+=n,t=r,r=r[ui]}const on={lFrame:$(null),bindingsEnabled:!0};function Uo(){return on.bindingsEnabled}function Ae(){return on.lFrame.lView}function In(){return on.lFrame.tView}function Tn(e){return on.lFrame.contextLView=e,e[bi]}function _n(e){return on.lFrame.contextLView=null,e}function gi(){let e=pt();for(;null!==e&&64===e.type;)e=e.parent;return e}function pt(){return on.lFrame.currentTNode}function ps(e,n){const t=on.lFrame;t.currentTNode=e,t.isParent=n}function Wu(){return on.lFrame.isParent}function Nr(){const e=on.lFrame;let n=e.bindingRootIndex;return-1===n&&(n=e.bindingRootIndex=e.tView.bindingStartIndex),n}function ma(){return on.lFrame.bindingIndex++}function Kr(e){const n=on.lFrame,t=n.bindingIndex;return n.bindingIndex=n.bindingIndex+e,t}function h(e,n){const t=on.lFrame;t.bindingIndex=t.bindingRootIndex=e,v(n)}function v(e){on.lFrame.currentDirectiveIndex=e}function T(){return on.lFrame.currentQueryIndex}function M(e){on.lFrame.currentQueryIndex=e}function k(e){const n=e[wt];return 2===n.type?n.declTNode:1===n.type?e[sr]:null}function F(e,n,t){if(t&Bt.SkipSelf){let l=n,u=e;for(;!(l=l.parent,null!==l||t&Bt.Host||(l=k(u),null===l||(u=u[kl],10&l.type))););if(null===l)return!1;n=l,e=u}const r=on.lFrame=z();return r.currentTNode=n,r.lView=e,!0}function O(e){const n=z(),t=e[wt];on.lFrame=n,n.currentTNode=t.firstChild,n.lView=e,n.tView=t,n.contextLView=e,n.bindingIndex=t.bindingStartIndex,n.inI18n=!1}function z(){const e=on.lFrame,n=null===e?null:e.child;return null===n?$(e):n}function $(e){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=n),n}function Q(){const e=on.lFrame;return on.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}const K=Q;function X(){const e=Q();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function W(){return on.lFrame.selectedIndex}function ie(e){on.lFrame.selectedIndex=e}function te(){const e=on.lFrame;return gd(e.tView,e.selectedIndex)}function Ze(e,n){for(let t=n.directiveStart,r=n.directiveEnd;t<r;t++){const u=e.data[t].type.prototype,{ngAfterContentInit:g,ngAfterContentChecked:w,ngAfterViewInit:I,ngAfterViewChecked:S,ngOnDestroy:L}=u;g&&(e.contentHooks??(e.contentHooks=[])).push(-t,g),w&&((e.contentHooks??(e.contentHooks=[])).push(t,w),(e.contentCheckHooks??(e.contentCheckHooks=[])).push(t,w)),I&&(e.viewHooks??(e.viewHooks=[])).push(-t,I),S&&((e.viewHooks??(e.viewHooks=[])).push(t,S),(e.viewCheckHooks??(e.viewCheckHooks=[])).push(t,S)),null!=L&&(e.destroyHooks??(e.destroyHooks=[])).push(t,L)}}function Ce(e,n,t){Qe(e,n,3,t)}function Be(e,n,t,r){(3&e[hn])===t&&Qe(e,n,t,r)}function Se(e,n){let t=e[hn];(3&t)===n&&(t&=2047,t+=1,e[hn]=t)}function Qe(e,n,t,r){const u=r??-1,g=n.length-1;let w=0;for(let I=void 0!==r?65535&e[Fs]:0;I<g;I++)if("number"==typeof n[I+1]){if(w=n[I],null!=r&&w>=r)break}else n[I]<0&&(e[Fs]+=65536),(w<u||-1==u)&&(Te(e,t,n,I),e[Fs]=(4294901760&e[Fs])+I+2),I++}function Te(e,n,t,r){const l=t[r]<0,u=t[r+1],w=e[l?-t[r]:t[r]];if(l){if(e[hn]>>11<e[Fs]>>16&&(3&e[hn])===n){e[hn]+=2048,wr(4,w,u);try{u.call(w)}finally{wr(5,w,u)}}}else{wr(4,w,u);try{u.call(w)}finally{wr(5,w,u)}}}const Le=-1;class Xe{constructor(n,t,r){this.factory=n,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function Et(e,n,t){let r=0;for(;r<t.length;){const l=t[r];if("number"==typeof l){if(0!==l)break;r++;const u=t[r++],g=t[r++],w=t[r++];e.setAttribute(n,g,w,u)}else{const u=l,g=t[++r];Un(u)?e.setProperty(n,u,g):e.setAttribute(n,u,g),r++}}return r}function Sn(e){return 3===e||4===e||6===e}function Un(e){return 64===e.charCodeAt(0)}function kn(e,n){if(null!==n&&0!==n.length)if(null===e||0===e.length)e=n.slice();else{let t=-1;for(let r=0;r<n.length;r++){const l=n[r];"number"==typeof l?t=l:0===t||jn(e,t,l,null,-1===t||2===t?n[++r]:null)}}return e}function jn(e,n,t,r,l){let u=0,g=e.length;if(-1===n)g=-1;else for(;u<e.length;){const w=e[u++];if("number"==typeof w){if(w===n){g=-1;break}if(w>n){g=u-1;break}}}for(;u<e.length;){const w=e[u];if("number"==typeof w)break;if(w===t){if(null===r)return void(null!==l&&(e[u+1]=l));if(r===e[u+1])return void(e[u+2]=l)}u++,null!==r&&u++,null!==l&&u++}-1!==g&&(e.splice(g,0,n),u=g+1),e.splice(u++,0,t),null!==r&&e.splice(u++,0,r),null!==l&&e.splice(u++,0,l)}function ar(e){return e!==Le}function Si(e){return 32767&e}function oo(e,n){let t=function yo(e){return e>>16}(e),r=n;for(;t>0;)r=r[kl],t--;return r}let Kn=!0;function Ln(e){const n=Kn;return Kn=e,n}const wi=255,Er=5;let ni=0;const _i={};function fs(e,n){const t=ms(e,n);if(-1!==t)return t;const r=n[wt];r.firstCreatePass&&(e.injectorIndex=n.length,Qa(r.data,e),Qa(n,null),Qa(r.blueprint,null));const l=gs(e,n),u=e.injectorIndex;if(ar(l)){const g=Si(l),w=oo(l,n),I=w[wt].data;for(let S=0;S<8;S++)n[u+S]=w[g+S]|I[g+S]}return n[u+8]=l,u}function Qa(e,n){e.push(0,0,0,0,0,0,0,0,n)}function ms(e,n){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===n[e.injectorIndex+8]?-1:e.injectorIndex}function gs(e,n){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;let t=0,r=null,l=n;for(;null!==l;){if(r=ry(l),null===r)return Le;if(t++,l=l[kl],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return Le}function Bs(e,n,t){!function Qu(e,n,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(Ga)&&(r=t[Ga]),null==r&&(r=t[Ga]=ni++);const l=r&wi;n.data[e+(l>>Er)]|=1<<l}(e,n,t)}function Nl(e,n,t){if(t&Bt.Optional||void 0!==e)return e;yc()}function Ku(e,n,t,r){if(t&Bt.Optional&&void 0===r&&(r=null),!(t&(Bt.Self|Bt.Host))){const l=e[$a],u=io(void 0);try{return l?l.get(n,r,t&Bt.Optional):bc(n,r,t&Bt.Optional)}finally{io(u)}}return Nl(r,0,t)}function wm(e,n,t,r=Bt.Default,l){if(null!==e){if(1024&n[hn]){const g=function y0(e,n,t,r,l){let u=e,g=n;for(;null!==u&&null!==g&&1024&g[hn]&&!(256&g[hn]);){const w=Em(u,g,t,r|Bt.Self,_i);if(w!==_i)return w;let I=u.parent;if(!I){const S=g[ad];if(S){const L=S.get(t,_i,r);if(L!==_i)return L}I=ry(g),g=g[kl]}u=I}return l}(e,n,t,r,_i);if(g!==_i)return g}const u=Em(e,n,t,r,_i);if(u!==_i)return u}return Ku(n,t,r,l)}function Em(e,n,t,r,l){const u=function iy(e){if("string"==typeof e)return e.charCodeAt(0)||0;const n=e.hasOwnProperty(Ga)?e[Ga]:void 0;return"number"==typeof n?n>=0?n&wi:Fp:n}(t);if("function"==typeof u){if(!F(n,e,r))return r&Bt.Host?Nl(l,0,r):Ku(n,t,r,l);try{const g=u(r);if(null!=g||r&Bt.Optional)return g;yc()}finally{K()}}else if("number"==typeof u){let g=null,w=ms(e,n),I=Le,S=r&Bt.Host?n[br][sr]:null;for((-1===w||r&Bt.SkipSelf)&&(I=-1===w?gs(e,n):n[w+8],I!==Le&&yd(r,!1)?(g=n[wt],w=Si(I),n=oo(I,n)):w=-1);-1!==w;){const L=n[wt];if(Op(u,w,L.data)){const j=_0(w,n,t,g,r,S);if(j!==_i)return j}I=n[w+8],I!==Le&&yd(r,n[wt].data[w+8]===S)&&Op(u,w,n)?(g=L,w=Si(I),n=oo(I,n)):w=-1}}return l}function _0(e,n,t,r,l,u){const g=n[wt],w=g.data[e+8],L=Ju(w,g,t,null==r?da(w)&&Kn:r!=g&&0!=(3&w.type),l&Bt.Host&&u===w);return null!==L?ga(n,g,L,w):_i}function Ju(e,n,t,r,l){const u=e.providerIndexes,g=n.data,w=1048575&u,I=e.directiveStart,L=u>>20,ne=l?w+L:e.directiveEnd;for(let se=r?w:w+L;se<ne;se++){const he=g[se];if(se<I&&t===he||se>=I&&he.type===t)return se}if(l){const se=g[I];if(se&&_o(se)&&se.type===t)return I}return null}function ga(e,n,t,r){let l=e[t];const u=n.data;if(function He(e){return e instanceof Xe}(l)){const g=l;g.resolving&&function _c(e,n){const t=n?`. Dependency path: ${n.join(" > ")} > ${e}`:"";throw new st(-200,`Circular dependency in DI detected for ${e}${t}`)}(function An(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():en(e)}(u[t]));const w=Ln(g.canSeeViewProviders);g.resolving=!0;const I=g.injectImpl?io(g.injectImpl):null;F(e,r,Bt.Default);try{l=e[t]=g.factory(void 0,u,e,r),n.firstCreatePass&&t>=r.directiveStart&&function Me(e,n,t){const{ngOnChanges:r,ngOnInit:l,ngDoCheck:u}=n.type.prototype;if(r){const g=Uu(n);(t.preOrderHooks??(t.preOrderHooks=[])).push(e,g),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(e,g)}l&&(t.preOrderHooks??(t.preOrderHooks=[])).push(0-e,l),u&&((t.preOrderHooks??(t.preOrderHooks=[])).push(e,u),(t.preOrderCheckHooks??(t.preOrderCheckHooks=[])).push(e,u))}(t,u[t],n)}finally{null!==I&&io(I),Ln(w),g.resolving=!1,K()}}return l}function Op(e,n,t){return!!(t[n+(e>>Er)]&1<<e)}function yd(e,n){return!(e&Bt.Self||e&Bt.Host&&n)}class vo{constructor(n,t){this._tNode=n,this._lView=t}get(n,t,r){return wm(this._tNode,this._lView,n,Tl(r),t)}}function Fp(){return new vo(gi(),Ae())}function Cr(e){return ro(()=>{const n=e.prototype.constructor,t=n[Lo]||Lp(n),r=Object.prototype;let l=Object.getPrototypeOf(e.prototype).constructor;for(;l&&l!==r;){const u=l[Lo]||Lp(l);if(u&&u!==t)return u;l=Object.getPrototypeOf(l)}return u=>new u})}function Lp(e){return Yt(e)?()=>{const n=Lp(Pt(e));return n&&n()}:fa(e)}function ry(e){const n=e[wt],t=n.type;return 2===t?n.declTNode:1===t?e[sr]:null}const _a="__parameters__";function Go(e,n,t){return ro(()=>{const r=function Ho(e){return function(...t){if(e){const r=e(...t);for(const l in r)this[l]=r[l]}}}(n);function l(...u){if(this instanceof l)return r.apply(this,u),this;const g=new l(...u);return w.annotation=g,w;function w(I,S,L){const j=I.hasOwnProperty(_a)?I[_a]:Object.defineProperty(I,_a,{value:[]})[_a];for(;j.length<=L;)j.push(null);return(j[L]=j[L]||[]).push(g),I}}return t&&(l.prototype=Object.create(t.prototype)),l.prototype.ngMetadataName=e,l.annotationCls=l,l})}class xt{constructor(n,t){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Tt({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function zr(e,n){e.forEach(t=>Array.isArray(t)?zr(t,n):n(t))}function Np(e,n,t){n>=e.length?e.push(t):e.splice(n,0,t)}function Aa(e,n){return n>=e.length-1?e.pop():e.splice(n,1)[0]}function Ao(e,n,t){let r=Vl(e,n);return r>=0?e[1|r]=t:(r=~r,function zp(e,n,t,r){let l=e.length;if(l==n)e.push(t,r);else if(1===l)e.push(r,e[0]),e[0]=t;else{for(l--,e.push(e[l-1],e[l]);l>n;)e[l]=e[l-2],l--;e[n]=t,e[n+1]=r}}(e,r,n,t)),r}function Cm(e,n){const t=Vl(e,n);if(t>=0)return e[1|t]}function Vl(e,n){return function eh(e,n,t){let r=0,l=e.length>>t;for(;l!==r;){const u=r+(l-r>>1),g=e[u<<t];if(n===g)return u<<t;g>n?l=u:r=u+1}return~(l<<t)}(e,n,1)}const lr=ha(Go("Optional"),8),ii=ha(Go("SkipSelf"),4);var cr=(()=>((cr=cr||{})[cr.Important=1]="Important",cr[cr.DashCase=2]="DashCase",cr))();const Uc=new Map;let Om=0;const qp="__ngContext__";function ki(e,n){Zt(n)?(e[qp]=n[Rl],function sh(e){Uc.set(e[Rl],e)}(n)):e[qp]=n}let Cd;function Zp(e,n){return Cd(e,n)}function Id(e){const n=e[ui];return Lr(n)?n[ui]:n}function Vm(e){return jl(e[Tc])}function js(e){return jl(e[Bo])}function jl(e){for(;null!==e&&!Lr(e);)e=e[Bo];return e}function el(e,n,t,r,l){if(null!=r){let u,g=!1;Lr(r)?u=r:Zt(r)&&(g=!0,r=r[go]);const w=Xi(r);0===e&&null!==t?null==l?Iy(n,t,w):jc(n,t,w,l||null,!0):1===e&&null!==t?jc(n,t,w,l||null,!0):2===e?function eg(e,n,t){const r=Kp(e,n);r&&function D0(e,n,t,r){e.removeChild(n,t,r)}(e,r,n,t)}(n,w,g):3===e&&n.destroyNode(w),null!=u&&function Gc(e,n,t,r,l){const u=t[Mc];u!==Xi(t)&&el(n,e,r,u,l);for(let w=Qi;w<t.length;w++){const I=t[w];Hc(I[wt],I,e,n,r,u)}}(n,e,u,t,l)}}function Um(e,n,t){return e.createElement(n,t)}function Gm(e,n){const t=e[No],r=t.indexOf(n),l=n[ui];512&n[hn]&&(n[hn]&=-513,$u(l,-1)),t.splice(r,1)}function tl(e,n){if(e.length<=Qi)return;const t=Qi+n,r=e[t];if(r){const l=r[Pl];null!==l&&l!==e&&Gm(l,r),n>0&&(e[t-1][Bo]=r[Bo]);const u=Aa(e,Qi+n);!function Ey(e,n){Hc(e,n,n[tn],2,null,null),n[go]=null,n[sr]=null}(r[wt],r);const g=u[Fr];null!==g&&g.detachView(u[wt]),r[ui]=null,r[Bo]=null,r[hn]&=-65}return r}function $m(e,n){if(!(128&n[hn])){const t=n[tn];t.destroyNode&&Hc(e,n,t,3,null,null),function M0(e){let n=e[Tc];if(!n)return qm(e[wt],e);for(;n;){let t=null;if(Zt(n))t=n[Tc];else{const r=n[Qi];r&&(t=r)}if(!t){for(;n&&!n[Bo]&&n!==e;)Zt(n)&&qm(n[wt],n),n=n[ui];null===n&&(n=e),Zt(n)&&qm(n[wt],n),t=n&&n[Bo]}n=t}}(n)}}function qm(e,n){if(!(128&n[hn])){n[hn]&=-65,n[hn]|=128,function Xp(e,n){let t;if(null!=e&&null!=(t=e.destroyHooks))for(let r=0;r<t.length;r+=2){const l=n[t[r]];if(!(l instanceof Xe)){const u=t[r+1];if(Array.isArray(u))for(let g=0;g<u.length;g+=2){const w=l[u[g]],I=u[g+1];wr(4,w,I);try{I.call(w)}finally{wr(5,w,I)}}else{wr(4,l,u);try{u.call(l)}finally{wr(5,l,u)}}}}}(e,n),function uh(e,n){const t=e.cleanup,r=n[us];let l=-1;if(null!==t)for(let u=0;u<t.length-1;u+=2)if("string"==typeof t[u]){const g=t[u+3];g>=0?r[l=g]():r[l=-g].unsubscribe(),u+=2}else{const g=r[l=t[u+1]];t[u].call(g)}if(null!==r){for(let u=l+1;u<r.length;u++)(0,r[u])();n[us]=null}}(e,n),1===n[wt].type&&n[tn].destroy();const t=n[Pl];if(null!==t&&Lr(n[ui])){t!==n[ui]&&Gm(t,n);const r=n[Fr];null!==r&&r.detachView(e)}!function Lm(e){Uc.delete(e[Rl])}(n)}}function Wm(e,n,t){return function Zm(e,n,t){let r=n;for(;null!==r&&40&r.type;)r=(n=r).parent;if(null===r)return t[go];{const{componentOffset:l}=r;if(l>-1){const{encapsulation:u}=e.data[r.directiveStart+l];if(u===mo.None||u===mo.Emulated)return null}return Fi(r,t)}}(e,n.parent,t)}function jc(e,n,t,r,l){e.insertBefore(n,t,r,l)}function Iy(e,n,t){e.appendChild(n,t)}function Qm(e,n,t,r,l){null!==r?jc(e,n,t,r,l):Iy(e,n,t)}function Kp(e,n){return e.parentNode(n)}let Td,tf,og,Sd,Jm=function Km(e,n,t){return 40&e.type?Fi(e,t):null};function Ur(e,n,t,r){const l=Wm(e,r,n),u=n[tn],w=function Xm(e,n,t){return Jm(e,n,t)}(r.parent||n[sr],r,n);if(null!=l)if(Array.isArray(t))for(let I=0;I<t.length;I++)Qm(u,l,t[I],w,!1);else Qm(u,l,t,w,!1);void 0!==Td&&Td(u,r,n,t,l)}function Jp(e,n){if(null!==n){const t=n.type;if(3&t)return Fi(n,e);if(4&t)return Ym(-1,e[n.index]);if(8&t){const r=n.child;if(null!==r)return Jp(e,r);{const l=e[n.index];return Lr(l)?Ym(-1,l):Xi(l)}}if(32&t)return Zp(n,e)()||Xi(e[n.index]);{const r=Yp(e,n);return null!==r?Array.isArray(r)?r[0]:Jp(Id(e[br]),r):Jp(e,n.next)}}return null}function Yp(e,n){return null!==n?e[br][sr].projection[n.projection]:null}function Ym(e,n){const t=Qi+e+1;if(t<n.length){const r=n[t],l=r[wt].firstChild;if(null!==l)return Jp(r,l)}return n[Mc]}function tg(e,n,t,r,l,u,g){for(;null!=t;){const w=r[t.index],I=t.type;if(g&&0===n&&(w&&ki(Xi(w),r),t.flags|=2),32!=(32&t.flags))if(8&I)tg(e,n,t.child,r,l,u,!1),el(n,e,l,w,u);else if(32&I){const S=Zp(t,r);let L;for(;L=S();)el(n,e,l,L,u);el(n,e,l,w,u)}else 16&I?ng(e,n,r,t,l,u):el(n,e,l,w,u);t=g?t.projectionNext:t.next}}function Hc(e,n,t,r,l,u){tg(t,r,e.firstChild,n,l,u,!1)}function ng(e,n,t,r,l,u){const g=t[br],I=g[sr].projection[r.projection];if(Array.isArray(I))for(let S=0;S<I.length;S++)el(n,e,l,I[S],u);else tg(e,n,I,g[ui],l,u,!0)}function Ty(e,n,t){""===t?e.removeAttribute(n,"class"):e.setAttribute(n,"class",t)}function My(e,n,t){const{mergedAttrs:r,classes:l,styles:u}=t;null!==r&&Et(e,n,r),null!==l&&Ty(e,n,l),null!==u&&function P0(e,n,t){e.setAttribute(n,"style",t)}(e,n,u)}function hh(e){return function ig(){if(void 0===tf&&(tf=null,ti.trustedTypes))try{tf=ti.trustedTypes.createPolicy("angular",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return tf}()?.createHTML(e)||e}function sg(e){return function ph(){if(void 0===Sd&&(Sd=null,ti.trustedTypes))try{Sd=ti.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:e=>e,createScript:e=>e,createScriptURL:e=>e})}catch{}return Sd}()?.createScriptURL(e)||e}class Hl{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${os})`}}class Pd extends Hl{getTypeName(){return"HTML"}}class ag extends Hl{getTypeName(){return"Style"}}class lg extends Hl{getTypeName(){return"Script"}}class cg extends Hl{getTypeName(){return"URL"}}class O0 extends Hl{getTypeName(){return"ResourceURL"}}function bo(e){return e instanceof Hl?e.changingThisBreaksApplicationSecurity:e}function wo(e,n){const t=function F0(e){return e instanceof Hl&&e.getTypeName()||null}(e);if(null!=t&&t!==n){if("ResourceURL"===t&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${t} (see ${os})`)}return t===n}class B0{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const t=(new window.DOMParser).parseFromString(hh(n),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(n):(t.removeChild(t.firstChild),t)}catch{return null}}}class N0{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const t=this.inertDocument.createElement("template");return t.innerHTML=hh(n),t}}const V0=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function rf(e){return(e=String(e)).match(V0)?e:"unsafe:"+e}function vs(e){const n={};for(const t of e.split(","))n[t]=!0;return n}function Rd(...e){const n={};for(const t of e)for(const r in t)t.hasOwnProperty(r)&&(n[r]=!0);return n}const pg=vs("area,br,col,hr,img,wbr"),$c=vs("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Sy=vs("rp,rt"),sf=Rd(pg,Rd($c,vs("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Rd(Sy,vs("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Rd(Sy,$c)),fg=vs("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),af=Rd(fg,vs("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),vs("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),lf=vs("script,style,template");class cf{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let t=n.firstChild,r=!0;for(;t;)if(t.nodeType===Node.ELEMENT_NODE?r=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,r&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);let l=this.checkClobberedElement(t,t.nextSibling);if(l){t=l;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}startElement(n){const t=n.nodeName.toLowerCase();if(!sf.hasOwnProperty(t))return this.sanitizedSomething=!0,!lf.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);const r=n.attributes;for(let l=0;l<r.length;l++){const u=r.item(l),g=u.name,w=g.toLowerCase();if(!af.hasOwnProperty(w)){this.sanitizedSomething=!0;continue}let I=u.value;fg[w]&&(I=rf(I)),this.buf.push(" ",g,'="',mh(I),'"')}return this.buf.push(">"),!0}endElement(n){const t=n.nodeName.toLowerCase();sf.hasOwnProperty(t)&&!pg.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}chars(n){this.buf.push(mh(n))}checkClobberedElement(n,t){if(t&&(n.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return t}}const j0=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,H0=/([^\#-~ |!])/g;function mh(e){return e.replace(/&/g,"&amp;").replace(j0,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(H0,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Gl;function mg(e,n){let t=null;try{Gl=Gl||function Dy(e){const n=new N0(e);return function z0(){try{return!!(new window.DOMParser).parseFromString(hh(""),"text/html")}catch{return!1}}()?new B0(n):n}(e);let r=n?String(n):"";t=Gl.getInertBodyElement(r);let l=5,u=r;do{if(0===l)throw new Error("Failed to sanitize html because the input is unstable");l--,r=u,u=t.innerHTML,t=Gl.getInertBodyElement(r)}while(r!==u);return hh((new cf).sanitizeChildren(qc(t)||t))}finally{if(t){const r=qc(t)||t;for(;r.firstChild;)r.removeChild(r.firstChild)}}}function qc(e){return"content"in e&&function ky(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var Qn=(()=>((Qn=Qn||{})[Qn.NONE=0]="NONE",Qn[Qn.HTML=1]="HTML",Qn[Qn.STYLE=2]="STYLE",Qn[Qn.SCRIPT=3]="SCRIPT",Qn[Qn.URL=4]="URL",Qn[Qn.RESOURCE_URL=5]="RESOURCE_URL",Qn))();function wa(e){const n=Ki();return n?n.sanitize(Qn.URL,e)||"":wo(e,"URL")?bo(e):rf(en(e))}function uf(e){const n=Ki();if(n)return sg(n.sanitize(Qn.RESOURCE_URL,e)||"");if(wo(e,"ResourceURL"))return sg(bo(e));throw new st(904,!1)}function Ki(){const e=Ae();return e&&e[sd]}const $l=new xt("ENVIRONMENT_INITIALIZER"),Wc=new xt("INJECTOR",-1),gh=new xt("INJECTOR_DEF_TYPES");class yg{get(n,t=ja){if(t===ja){const r=new Error(`NullInjectorError: No provider for ${et(n)}!`);throw r.name="NullInjectorError",r}return t}}function W0(...e){return{\u0275providers:By(0,e),\u0275fromNgModule:!0}}function By(e,...n){const t=[],r=new Set;let l;return zr(n,u=>{const g=u;vg(g,t,[],r)&&(l||(l=[]),l.push(g))}),void 0!==l&&Ny(l,t),t}function Ny(e,n){for(let t=0;t<e.length;t++){const{providers:l}=e[t];Ag(l,u=>{n.push(u)})}}function vg(e,n,t,r){if(!(e=Pt(e)))return!1;let l=null,u=Mu(e);const g=!u&&gn(e);if(u||g){if(g&&!g.standalone)return!1;l=e}else{const I=e.ngModule;if(u=Mu(I),!u)return!1;l=I}const w=r.has(l);if(g){if(w)return!1;if(r.add(l),g.dependencies){const I="function"==typeof g.dependencies?g.dependencies():g.dependencies;for(const S of I)vg(S,n,t,r)}}else{if(!u)return!1;{if(null!=u.imports&&!w){let S;r.add(l);try{zr(u.imports,L=>{vg(L,n,t,r)&&(S||(S=[]),S.push(L))})}finally{}void 0!==S&&Ny(S,n)}if(!w){const S=fa(l)||(()=>new l);n.push({provide:l,useFactory:S,deps:wn},{provide:gh,useValue:l,multi:!0},{provide:$l,useValue:()=>gt(l),multi:!0})}const I=u.providers;null==I||w||Ag(I,L=>{n.push(L)})}}return l!==e&&void 0!==e.providers}function Ag(e,n){for(let t of e)Or(t)&&(t=t.\u0275providers),Array.isArray(t)?Ag(t,n):n(t)}const hf=Xn({provide:String,useValue:Xn});function xg(e){return null!==e&&"object"==typeof e&&hf in e}function ql(e){return"function"==typeof e}const Eg=new xt("Set Injector scope."),df={},Q0={};let Cg;function Od(){return void 0===Cg&&(Cg=new yg),Cg}class Ea{}class Ji extends Ea{get destroyed(){return this._destroyed}constructor(n,t,r,l){super(),this.parent=t,this.source=r,this.scopes=l,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Tg(n,g=>this.processProvider(g)),this.records.set(Wc,_h(void 0,this)),l.has("environment")&&this.records.set(Ea,_h(void 0,this));const u=this.records.get(Eg);null!=u&&"string"==typeof u.value&&this.scopes.add(u.value),this.injectorDefTypes=new Set(this.get(gh.multi,wn,Bt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const t=Zr(this),r=io(void 0);try{return n()}finally{Zr(t),io(r)}}get(n,t=ja,r=Bt.Default){this.assertNotDestroyed(),r=Tl(r);const l=Zr(this),u=io(void 0);try{if(!(r&Bt.SkipSelf)){let w=this.records.get(n);if(void 0===w){const I=function K0(e){return"function"==typeof e||"object"==typeof e&&e instanceof xt}(n)&&Ua(n);w=I&&this.injectableDefInScope(I)?_h(Wo(n),df):null,this.records.set(n,w)}if(null!=w)return this.hydrate(n,w)}return(r&Bt.Self?Od():this.parent).get(n,t=r&Bt.Optional&&t===ja?null:t)}catch(g){if("NullInjectorError"===g.name){if((g[Cl]=g[Cl]||[]).unshift(et(n)),l)throw g;return function td(e,n,t,r){const l=e[Cl];throw n[Ec]&&l.unshift(n[Ec]),e.message=function bn(e,n,t,r=null){e=e&&"\n"===e.charAt(0)&&e.charAt(1)==Il?e.slice(2):e;let l=et(n);if(Array.isArray(n))l=n.map(et).join(" -> ");else if("object"==typeof n){let u=[];for(let g in n)if(n.hasOwnProperty(g)){let w=n[g];u.push(g+":"+("string"==typeof w?JSON.stringify(w):et(w)))}l=`{${u.join(", ")}}`}return`${t}${r?"("+r+")":""}[${l}]: ${e.replace(Yh,"\n  ")}`}("\n"+e.message,l,t,r),e[yp]=l,e[Cl]=null,e}(g,n,"R3InjectorError",this.source)}throw g}finally{io(u),Zr(l)}}resolveInjectorInitializers(){const n=Zr(this),t=io(void 0);try{const r=this.get($l.multi,wn,Bt.Self);for(const l of r)l()}finally{Zr(n),io(t)}}toString(){const n=[],t=this.records;for(const r of t.keys())n.push(et(r));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new st(205,!1)}processProvider(n){let t=ql(n=Pt(n))?n:Pt(n&&n.provide);const r=function pf(e){return xg(e)?_h(void 0,e.useValue):_h(Zc(e),df)}(n);if(ql(n)||!0!==n.multi)this.records.get(t);else{let l=this.records.get(t);l||(l=_h(void 0,df,!0),l.factory=()=>Cc(l.multi),this.records.set(t,l)),t=n,l.multi.push(n)}this.records.set(t,r)}hydrate(n,t){return t.value===df&&(t.value=Q0,t.value=t.factory()),"object"==typeof t.value&&t.value&&function Fd(e){return null!==e&&"object"==typeof e&&"function"==typeof e.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(n){if(!n.providedIn)return!1;const t=Pt(n.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}}function Wo(e){const n=Ua(e),t=null!==n?n.factory:fa(e);if(null!==t)return t;if(e instanceof xt)throw new st(204,!1);if(e instanceof Function)return function Ig(e){const n=e.length;if(n>0)throw function Xa(e,n){const t=[];for(let r=0;r<e;r++)t.push(n);return t}(n,"?"),new st(204,!1);const t=function wl(e){const n=e&&(e[as]||e[El]);return n?(function ss(e){if(e.hasOwnProperty("name"))return e.name;(""+e).match(/^function\s*([^\s(]+)/)}(e),n):null}(e);return null!==t?()=>t.factory(e):()=>new e}(e);throw new st(204,!1)}function Zc(e,n,t){let r;if(ql(e)){const l=Pt(e);return fa(l)||Wo(l)}if(xg(e))r=()=>Pt(e.useValue);else if(function wg(e){return!(!e||!e.useFactory)}(e))r=()=>e.useFactory(...Cc(e.deps||[]));else if(function bg(e){return!(!e||!e.useExisting)}(e))r=()=>gt(Pt(e.useExisting));else{const l=Pt(e&&(e.useClass||e.provide));if(!function X0(e){return!!e.deps}(e))return fa(l)||Wo(l);r=()=>new l(...Cc(e.deps))}return r}function _h(e,n,t=!1){return{factory:e,value:n,multi:t?[]:void 0}}function Tg(e,n){for(const t of e)Array.isArray(t)?Tg(t,n):t&&Or(t)?Tg(t.\u0275providers,n):n(t)}class zy{}class Mg{}class jy{resolveComponentFactory(n){throw function Vy(e){const n=Error(`No component factory found for ${et(e)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=e,n}(n)}}let yh=(()=>{class e{}return e.NULL=new jy,e})();function nl(){return Hs(gi(),Ae())}function Hs(e,n){return new jr(Fi(e,n))}let jr=(()=>{class e{constructor(t){this.nativeElement=t}}return e.__NG_ELEMENT_ID__=nl,e})();function J0(e){return e instanceof jr?e.nativeElement:e}class Hy{}let il=(()=>{class e{}return e.__NG_ELEMENT_ID__=()=>function Y0(){const e=Ae(),t=Br(gi().index,e);return(Zt(t)?t:e)[tn]}(),e})(),ex=(()=>{class e{}return e.\u0275prov=Tt({token:e,providedIn:"root",factory:()=>null}),e})();class Qc{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const tx=new Qc("15.2.7"),Dg={},Sg="ngOriginalError";function Wl(e){return e[Sg]}class rl{constructor(){this._console=console}handleError(n){const t=this._findOriginalError(n);this._console.error("ERROR",n),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(n){let t=n&&Wl(n);for(;t&&Wl(t);)t=Wl(t);return t||null}}function Ld(e){return e.ownerDocument.defaultView}function gf(e){return e.ownerDocument}function Gs(e){return e instanceof Function?e():e}function Bd(e,n,t){let r=e.length;for(;;){const l=e.indexOf(n,t);if(-1===l)return l;if(0===l||e.charCodeAt(l-1)<=32){const u=n.length;if(l+u===r||e.charCodeAt(l+u)<=32)return l}t=l+1}}const qy="ng-template";function Wy(e,n,t){let r=0,l=!0;for(;r<e.length;){let u=e[r++];if("string"==typeof u&&l){const g=e[r++];if(t&&"class"===u&&-1!==Bd(g.toLowerCase(),n,0))return!0}else{if(1===u){for(;r<e.length&&"string"==typeof(u=e[r++]);)if(u.toLowerCase()===n)return!0;return!1}"number"==typeof u&&(l=!1)}}return!1}function Rg(e){return 4===e.type&&e.value!==qy}function ox(e,n,t){return n===(4!==e.type||t?e.value:qy)}function Zy(e,n,t){let r=4;const l=e.attrs||[],u=function Qy(e){for(let n=0;n<e.length;n++)if(Sn(e[n]))return n;return e.length}(l);let g=!1;for(let w=0;w<n.length;w++){const I=n[w];if("number"!=typeof I){if(!g)if(4&r){if(r=2|1&r,""!==I&&!ox(e,I,t)||""===I&&1===n.length){if(As(r))return!1;g=!0}}else{const S=8&r?I:n[++w];if(8&r&&null!==e.attrs){if(!Wy(e.attrs,S,t)){if(As(r))return!1;g=!0}continue}const j=Og(8&r?"class":I,l,Rg(e),t);if(-1===j){if(As(r))return!1;g=!0;continue}if(""!==S){let ne;ne=j>u?"":l[j+1].toLowerCase();const se=8&r?ne:null;if(se&&-1!==Bd(se,S,0)||2&r&&S!==ne){if(As(r))return!1;g=!0}}}}else{if(!g&&!As(r)&&!As(I))return!1;if(g&&As(I))continue;g=!1,r=I|1&r}}return As(r)||g}function As(e){return 0==(1&e)}function Og(e,n,t,r){if(null===n)return-1;let l=0;if(r||!t){let u=!1;for(;l<n.length;){const g=n[l];if(g===e)return l;if(3===g||6===g)u=!0;else{if(1===g||2===g){let w=n[++l];for(;"string"==typeof w;)w=n[++l];continue}if(4===g)break;if(0===g){l+=4;continue}}l+=u?1:2}return-1}return function ol(e,n){let t=e.indexOf(4);if(t>-1)for(t++;t<e.length;){const r=e[t];if("number"==typeof r)return-1;if(r===n)return t;t++}return-1}(n,e)}function Fg(e,n,t=!1){for(let r=0;r<n.length;r++)if(Zy(e,n[r],t))return!0;return!1}function Lg(e,n){return e?":not("+n.trim()+")":n}function Ky(e){let n=e[0],t=1,r=2,l="",u=!1;for(;t<e.length;){let g=e[t];if("string"==typeof g)if(2&r){const w=e[++t];l+="["+g+(w.length>0?'="'+w+'"':"")+"]"}else 8&r?l+="."+g:4&r&&(l+=" "+g);else""!==l&&!As(g)&&(n+=Lg(u,l),l=""),r=g,u=u||!As(r);t++}return""!==l&&(n+=Lg(u,l)),n}const pn={};function ct(e){Bg(In(),Ae(),W()+e,!1)}function Bg(e,n,t,r){if(!r)if(3==(3&n[hn])){const u=e.preOrderCheckHooks;null!==u&&Ce(n,u,t)}else{const u=e.preOrderHooks;null!==u&&Be(n,u,0,t)}ie(t)}function Vg(e,n=null,t=null,r){const l=Nd(e,n,t,r);return l.resolveInjectorInitializers(),l}function Nd(e,n=null,t=null,r,l=new Set){const u=[t||wn,W0(e)];return r=r||("object"==typeof e?void 0:et(e)),new Ji(u,n||Od(),r||null,l)}let Eo=(()=>{class e{static create(t,r){if(Array.isArray(t))return Vg({name:""},r,t,"");{const l=t.name??"";return Vg({name:l},t.parent,t.providers,l)}}}return e.THROW_IF_NOT_FOUND=ja,e.NULL=new yg,e.\u0275prov=Tt({token:e,providedIn:"any",factory:()=>gt(Wc)}),e.__NG_ELEMENT_ID__=-1,e})();function qe(e,n=Bt.Default){const t=Ae();return null===t?gt(e,n):wm(gi(),t,Pt(e),n)}function av(e,n){const t=e.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const u=t[r+1];if(-1!==u){const g=e.data[u];M(t[r]),g.contentQueries(2,n[u],u)}}}function bf(e,n,t,r,l,u,g,w,I,S,L){const j=n.blueprint.slice();return j[go]=l,j[hn]=76|r,(null!==L||e&&1024&e[hn])&&(j[hn]|=1024),Dp(j),j[ui]=j[kl]=e,j[bi]=t,j[Ic]=g||e&&e[Ic],j[tn]=w||e&&e[tn],j[sd]=I||e&&e[sd]||null,j[$a]=S||e&&e[$a]||null,j[sr]=u,j[Rl]=function yy(){return Om++}(),j[ad]=L,j[br]=2==n.type?e[br]:j,j}function nu(e,n,t,r,l){let u=e.data[n];if(null===u)u=function qg(e,n,t,r,l){const u=pt(),g=Wu(),I=e.data[n]=function fx(e,n,t,r,l,u){return{type:t,index:r,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:l,attrs:u,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,g?u:u&&u.parent,t,n,r,l);return null===e.firstChild&&(e.firstChild=I),null!==u&&(g?null==u.child&&null!==I.parent&&(u.child=I):null===u.next&&(u.next=I,I.prev=u)),I}(e,n,t,r,l),function f(){return on.lFrame.inI18n}()&&(u.flags|=32);else if(64&u.type){u.type=t,u.value=r,u.attrs=l;const g=function Za(){const e=on.lFrame,n=e.currentTNode;return e.isParent?n:n.parent}();u.injectorIndex=null===g?-1:g.injectorIndex}return ps(u,!0),u}function wh(e,n,t,r){if(0===t)return-1;const l=n.length;for(let u=0;u<t;u++)n.push(r),e.blueprint.push(r),e.data.push(null);return l}function Wg(e,n,t){O(n);try{const r=e.viewQuery;null!==r&&Th(1,r,t);const l=e.template;null!==l&&uv(e,n,l,1,t),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&av(e,n),e.staticViewQueries&&Th(2,e.viewQuery,t);const u=e.components;null!==u&&function cv(e,n){for(let t=0;t<n.length;t++)vv(e,n[t])}(n,u)}catch(r){throw e.firstCreatePass&&(e.incompleteFirstPass=!0,e.firstCreatePass=!1),r}finally{n[hn]&=-5,X()}}function Ud(e,n,t,r){const l=n[hn];if(128!=(128&l)){O(n);try{Dp(n),function Zu(e){return on.lFrame.bindingIndex=e}(e.bindingStartIndex),null!==t&&uv(e,n,t,2,r);const g=3==(3&l);if(g){const S=e.preOrderCheckHooks;null!==S&&Ce(n,S,null)}else{const S=e.preOrderHooks;null!==S&&Be(n,S,0,null),Se(n,0)}if(function _v(e){for(let n=Vm(e);null!==n;n=js(n)){if(!n[Ol])continue;const t=n[No];for(let r=0;r<t.length;r++){const l=t[r];512&l[hn]||$u(l[ui],1),l[hn]|=512}}}(n),function gv(e){for(let n=Vm(e);null!==n;n=js(n))for(let t=Qi;t<n.length;t++){const r=n[t],l=r[wt];Rc(r)&&Ud(l,r,l.template,r[bi])}}(n),null!==e.contentQueries&&av(e,n),g){const S=e.contentCheckHooks;null!==S&&Ce(n,S)}else{const S=e.contentHooks;null!==S&&Be(n,S,1),Se(n,1)}!function xf(e,n){const t=e.hostBindingOpCodes;if(null!==t)try{for(let r=0;r<t.length;r++){const l=t[r];if(l<0)ie(~l);else{const u=l,g=t[++r],w=t[++r];h(g,u),w(2,n[u])}}}finally{ie(-1)}}(e,n);const w=e.components;null!==w&&function lv(e,n){for(let t=0;t<n.length;t++)yv(e,n[t])}(n,w);const I=e.viewQuery;if(null!==I&&Th(2,I,r),g){const S=e.viewCheckHooks;null!==S&&Ce(n,S)}else{const S=e.viewHooks;null!==S&&Be(n,S,2),Se(n,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),n[hn]&=-41,512&n[hn]&&(n[hn]&=-513,$u(n[ui],-1))}finally{X()}}}function uv(e,n,t,r,l){const u=W(),g=2&r;try{ie(-1),g&&n.length>Fn&&Bg(e,n,Fn,!1),wr(g?2:0,l),t(r,l)}finally{ie(u),wr(g?3:1,l)}}function Zg(e,n,t){if(Ru(n)){const l=n.directiveEnd;for(let u=n.directiveStart;u<l;u++){const g=e.data[u];g.contentQueries&&g.contentQueries(1,t[u],u)}}}function Eh(e,n,t){Uo()&&(function dv(e,n,t,r){const l=t.directiveStart,u=t.directiveEnd;da(t)&&function mv(e,n,t){const r=Fi(n,e),l=jd(t),u=e[Ic],g=Ws(e,bf(e,l,null,t.onPush?32:16,r,n,u,u.createRenderer(r,t),null,null,null));e[n.index]=g}(n,t,e.data[l+t.componentOffset]),e.firstCreatePass||fs(t,n),ki(r,n);const g=t.initialInputs;for(let w=l;w<u;w++){const I=e.data[w],S=ga(n,e,w,t);ki(S,n),null!==g&&e_(0,w-l,S,I,0,g),_o(I)&&(Br(t.index,n)[bi]=ga(n,e,w,t))}}(e,n,t,Fi(t,n)),64==(64&t.flags)&&pv(e,n,t))}function Ch(e,n,t=Fi){const r=n.localNames;if(null!==r){let l=n.index+1;for(let u=0;u<r.length;u+=2){const g=r[u+1],w=-1===g?t(n,e):e[g];e[l++]=w}}}function jd(e){const n=e.tView;return null===n||n.incompleteFirstPass?e.tView=Qg(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):n}function Qg(e,n,t,r,l,u,g,w,I,S){const L=Fn+r,j=L+l,ne=function Xg(e,n){const t=[];for(let r=0;r<n;r++)t.push(r<e?null:pn);return t}(L,j),se="function"==typeof S?S():S;return ne[wt]={type:e,blueprint:ne,template:t,queries:null,viewQuery:w,declTNode:n,data:ne.slice().fill(null,L),bindingStartIndex:L,expandoStartIndex:j,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof u?u():u,pipeRegistry:"function"==typeof g?g():g,firstChild:null,schemas:I,consts:se,incompleteFirstPass:!1}}function sl(e,n,t,r){const l=iu(n);null===t?l.push(r):(l.push(t),e.firstCreatePass&&Df(e).push(r,l.length-1))}function wf(e,n,t,r){for(let l in e)if(e.hasOwnProperty(l)){t=null===t?{}:t;const u=e[l];null===r?Jg(t,n,l,u):r.hasOwnProperty(l)&&Jg(t,n,r[l],u)}return t}function Jg(e,n,t,r){e.hasOwnProperty(t)?e[t].push(n,r):e[t]=[n,r]}function Qo(e,n,t,r,l,u,g,w){const I=Fi(n,t);let L,S=n.inputs;!w&&null!=S&&(L=S[r])?(Gd(e,t,L,r,l),da(n)&&function gx(e,n){const t=Br(n,e);16&t[hn]||(t[hn]|=32)}(t,n.index)):3&n.type&&(r=function mx(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(r),l=null!=g?g(l,n.value||"",r):l,u.setProperty(I,r,l))}function Yg(e,n,t,r){if(Uo()){const l=null===r?null:{"":-1},u=function bs(e,n){const t=e.directiveRegistry;let r=null,l=null;if(t)for(let u=0;u<t.length;u++){const g=t[u];if(Fg(n,g.selectors,!1))if(r||(r=[]),_o(g))if(null!==g.findHostDirectiveDefs){const w=[];l=l||new Map,g.findHostDirectiveDefs(g,w,l),r.unshift(...w,g),ws(e,n,w.length)}else r.unshift(g),ws(e,n,0);else l=l||new Map,g.findHostDirectiveDefs?.(g,r,l),r.push(g)}return null===r?null:[r,l]}(e,t);let g,w;null===u?g=w=null:[g,w]=u,null!==g&&Ih(e,n,t,g,l,w),l&&function Xl(e,n,t){if(n){const r=e.localNames=[];for(let l=0;l<n.length;l+=2){const u=t[n[l+1]];if(null==u)throw new st(-301,!1);r.push(n[l],u)}}}(t,r,l)}t.mergedAttrs=kn(t.mergedAttrs,t.attrs)}function Ih(e,n,t,r,l,u){for(let S=0;S<r.length;S++)Bs(fs(t,n),e,r[S].type);!function Kl(e,n,t){e.flags|=1,e.directiveStart=n,e.directiveEnd=n+t,e.providerIndexes=n}(t,e.data.length,r.length);for(let S=0;S<r.length;S++){const L=r[S];L.providersResolver&&L.providersResolver(L)}let g=!1,w=!1,I=wh(e,n,r.length,null);for(let S=0;S<r.length;S++){const L=r[S];t.mergedAttrs=kn(t.mergedAttrs,L.hostAttrs),Cf(e,t,n,I,L),Ca(I,L,l),null!==L.contentQueries&&(t.flags|=4),(null!==L.hostBindings||null!==L.hostAttrs||0!==L.hostVars)&&(t.flags|=64);const j=L.type.prototype;!g&&(j.ngOnChanges||j.ngOnInit||j.ngDoCheck)&&((e.preOrderHooks??(e.preOrderHooks=[])).push(t.index),g=!0),!w&&(j.ngOnChanges||j.ngDoCheck)&&((e.preOrderCheckHooks??(e.preOrderCheckHooks=[])).push(t.index),w=!0),I++}!function Ef(e,n,t){const l=n.directiveEnd,u=e.data,g=n.attrs,w=[];let I=null,S=null;for(let L=n.directiveStart;L<l;L++){const j=u[L],ne=t?t.get(j):null,he=ne?ne.outputs:null;I=wf(j.inputs,L,I,ne?ne.inputs:null),S=wf(j.outputs,L,S,he);const Ie=null===I||null===g||Rg(n)?null:Ax(I,L,g);w.push(Ie)}null!==I&&(I.hasOwnProperty("class")&&(n.flags|=8),I.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=w,n.inputs=I,n.outputs=S}(e,t,u)}function pv(e,n,t){const r=t.directiveStart,l=t.directiveEnd,u=t.index,g=function _(){return on.lFrame.currentDirectiveIndex}();try{ie(u);for(let w=r;w<l;w++){const I=e.data[w],S=n[w];v(w),(null!==I.hostBindings||0!==I.hostVars||null!==I.hostAttrs)&&fv(I,S)}}finally{ie(-1),v(g)}}function fv(e,n){null!==e.hostBindings&&e.hostBindings(1,n)}function ws(e,n,t){n.componentOffset=t,(e.components??(e.components=[])).push(n.index)}function Ca(e,n,t){if(t){if(n.exportAs)for(let r=0;r<n.exportAs.length;r++)t[n.exportAs[r]]=e;_o(n)&&(t[""]=e)}}function Cf(e,n,t,r,l){e.data[r]=l;const u=l.factory||(l.factory=fa(l.type)),g=new Xe(u,_o(l),qe);e.blueprint[r]=g,t[r]=g,function yx(e,n,t,r,l){const u=l.hostBindings;if(u){let g=e.hostBindingOpCodes;null===g&&(g=e.hostBindingOpCodes=[]);const w=~n.index;(function vx(e){let n=e.length;for(;n>0;){const t=e[--n];if("number"==typeof t&&t<0)return t}return 0})(g)!=w&&g.push(w),g.push(t,r,u)}}(e,n,r,wh(e,t,l.hostVars,pn),l)}function qs(e,n,t,r,l,u){const g=Fi(e,n);!function If(e,n,t,r,l,u,g){if(null==u)e.removeAttribute(n,l,t);else{const w=null==g?en(u):g(u,r||"",l);e.setAttribute(n,l,w,t)}}(n[tn],g,u,e.value,t,r,l)}function e_(e,n,t,r,l,u){const g=u[n];if(null!==g){const w=r.setInput;for(let I=0;I<g.length;){const S=g[I++],L=g[I++],j=g[I++];null!==w?r.setInput(t,j,S,L):t[L]=j}}}function Ax(e,n,t){let r=null,l=0;for(;l<t.length;){const u=t[l];if(0!==u)if(5!==u){if("number"==typeof u)break;if(e.hasOwnProperty(u)){null===r&&(r=[]);const g=e[u];for(let w=0;w<g.length;w+=2)if(g[w]===n){r.push(u,g[w+1],t[l+1]);break}}l+=2}else l+=2;else l+=4}return r}function t_(e,n,t,r){return[e,!0,!1,n,null,0,r,t,null,null]}function yv(e,n){const t=Br(n,e);if(Rc(t)){const r=t[wt];48&t[hn]?Ud(r,t,r.template,t[bi]):t[Os]>0&&Tf(t)}}function Tf(e){for(let r=Vm(e);null!==r;r=js(r))for(let l=Qi;l<r.length;l++){const u=r[l];if(Rc(u))if(512&u[hn]){const g=u[wt];Ud(g,u,g.template,u[bi])}else u[Os]>0&&Tf(u)}const t=e[wt].components;if(null!==t)for(let r=0;r<t.length;r++){const l=Br(t[r],e);Rc(l)&&l[Os]>0&&Tf(l)}}function vv(e,n){const t=Br(n,e),r=t[wt];(function Av(e,n){for(let t=n.length;t<e.blueprint.length;t++)n.push(e.blueprint[t])})(r,t),Wg(r,t,t[bi])}function Ws(e,n){return e[Tc]?e[bp][Bo]=n:e[Tc]=n,e[bp]=n,n}function Hd(e){for(;e;){e[hn]|=32;const n=Id(e);if(Ou(e)&&!n)return e;e=n}return null}function Mf(e,n,t,r=!0){const l=n[Ic];l.begin&&l.begin();try{Ud(e,n,e.template,t)}catch(g){throw r&&Zs(n,g),g}finally{l.end&&l.end()}}function Th(e,n,t){M(0),n(e,t)}function iu(e){return e[us]||(e[us]=[])}function Df(e){return e.cleanup||(e.cleanup=[])}function Zs(e,n){const t=e[$a],r=t?t.get(rl,null):null;r&&r.handleError(n)}function Gd(e,n,t,r,l){for(let u=0;u<t.length;){const g=t[u++],w=t[u++],I=n[g],S=e.data[g];null!==S.setInput?S.setInput(I,l,r,w):I[w]=l}}function Qs(e,n,t){const r=Pc(n,e);!function Qp(e,n,t){e.setValue(n,t)}(e[tn],r,t)}function Co(e,n,t){let r=t?e.styles:null,l=t?e.classes:null,u=0;if(null!==n)for(let g=0;g<n.length;g++){const w=n[g];"number"==typeof w?u=w:1==u?l=an(l,w):2==u&&(r=an(r,w+": "+n[++g]+";"))}t?e.styles=r:e.stylesWithoutHost=r,t?e.classes=l:e.classesWithoutHost=l}function Ia(e,n,t,r,l=!1){for(;null!==t;){const u=n[t.index];if(null!==u&&r.push(Xi(u)),Lr(u))for(let w=Qi;w<u.length;w++){const I=u[w],S=I[wt].firstChild;null!==S&&Ia(I[wt],I,S,r)}const g=t.type;if(8&g)Ia(e,n,t.child,r);else if(32&g){const w=Zp(t,n);let I;for(;I=w();)r.push(I)}else if(16&g){const w=Yp(n,t);if(Array.isArray(w))r.push(...w);else{const I=Id(n[br]);Ia(I[wt],I,w,r,!0)}}t=l?t.projectionNext:t.next}return r}class Mh{get rootNodes(){const n=this._lView,t=n[wt];return Ia(t,n,t.firstChild,[])}constructor(n,t){this._lView=n,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[bi]}set context(n){this._lView[bi]=n}get destroyed(){return 128==(128&this._lView[hn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[ui];if(Lr(n)){const t=n[hs],r=t?t.indexOf(this):-1;r>-1&&(tl(n,r),Aa(t,r))}this._attachedToViewContainer=!1}$m(this._lView[wt],this._lView)}onDestroy(n){sl(this._lView[wt],this._lView,null,n)}markForCheck(){Hd(this._cdRefInjectingView||this._lView)}detach(){this._lView[hn]&=-65}reattach(){this._lView[hn]|=64}detectChanges(){Mf(this._lView[wt],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new st(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function jm(e,n){Hc(e,n,n[tn],2,null,null)}(this._lView[wt],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new st(902,!1);this._appRef=n}}class xv extends Mh{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Mf(n[wt],n,n[bi],!1)}checkNoChanges(){}get context(){return null}}class Dh extends yh{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const t=gn(n);return new qd(t,this.ngModule)}}function $d(e){const n=[];for(let t in e)e.hasOwnProperty(t)&&n.push({propName:e[t],templateName:t});return n}class wv{constructor(n,t){this.injector=n,this.parentInjector=t}get(n,t,r){r=Tl(r);const l=this.injector.get(n,Dg,r);return l!==Dg||t===Dg?l:this.parentInjector.get(n,t,r)}}class qd extends Mg{get inputs(){return $d(this.componentDef.inputs)}get outputs(){return $d(this.componentDef.outputs)}constructor(n,t){super(),this.componentDef=n,this.ngModule=t,this.componentType=n.type,this.selector=function Jy(e){return e.map(Ky).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!t}create(n,t,r,l){let u=(l=l||this.ngModule)instanceof Ea?l:l?.injector;u&&null!==this.componentDef.getStandaloneInjector&&(u=this.componentDef.getStandaloneInjector(u)||u);const g=u?new wv(n,u):n,w=g.get(Hy,null);if(null===w)throw new st(407,!1);const I=g.get(ex,null),S=w.createRenderer(null,this.componentDef),L=this.componentDef.selectors[0][0]||"div",j=r?function Kg(e,n,t){return e.selectRootElement(n,t===mo.ShadowDom)}(S,r,this.componentDef.encapsulation):Um(S,L,function bv(e){const n=e.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(L)),ne=this.componentDef.onPush?288:272,se=Qg(0,null,null,1,0,null,null,null,null,null),he=bf(null,se,null,ne,null,null,w,S,I,g,null);let Ie,Ue;O(he);try{const $e=this.componentDef;let _t,Ke=null;$e.findHostDirectiveDefs?(_t=[],Ke=new Map,$e.findHostDirectiveDefs($e,_t,Ke),_t.push($e)):_t=[$e];const $t=function Cv(e,n){const t=e[wt],r=Fn;return e[r]=n,nu(t,r,2,"#host",null)}(he,j),vi=function bx(e,n,t,r,l,u,g,w){const I=l[wt];!function n_(e,n,t,r){for(const l of e)n.mergedAttrs=kn(n.mergedAttrs,l.hostAttrs);null!==n.mergedAttrs&&(Co(n,n.mergedAttrs,!0),null!==t&&My(r,t,n))}(r,e,n,g);const S=u.createRenderer(n,t),L=bf(l,jd(t),null,t.onPush?32:16,l[e.index],e,u,S,w||null,null,null);return I.firstCreatePass&&ws(I,e,r.length-1),Ws(l,L),l[e.index]=L}($t,j,$e,_t,he,w,S);Ue=gd(se,Fn),j&&function Tv(e,n,t,r){if(r)Et(e,t,["ng-version",tx.full]);else{const{attrs:l,classes:u}=function ax(e){const n=[],t=[];let r=1,l=2;for(;r<e.length;){let u=e[r];if("string"==typeof u)2===l?""!==u&&n.push(u,e[++r]):8===l&&t.push(u);else{if(!As(l))break;l=u}r++}return{attrs:n,classes:t}}(n.selectors[0]);l&&Et(e,t,l),u&&u.length>0&&Ty(e,t,u.join(" "))}}(S,$e,j,r),void 0!==t&&function Mv(e,n,t){const r=e.projection=[];for(let l=0;l<n.length;l++){const u=t[l];r.push(null!=u?Array.from(u):null)}}(Ue,this.ngContentSelectors,t),Ie=function Iv(e,n,t,r,l,u){const g=gi(),w=l[wt],I=Fi(g,l);Ih(w,l,g,t,null,r);for(let L=0;L<t.length;L++)ki(ga(l,w,g.directiveStart+L,g),l);pv(w,l,g),I&&ki(I,l);const S=ga(l,w,g.directiveStart+g.componentOffset,g);if(e[bi]=l[bi]=S,null!==u)for(const L of u)L(S,n);return Zg(w,g,e),S}(vi,$e,_t,Ke,he,[i_]),Wg(se,he,null)}finally{X()}return new Ev(this.componentType,Ie,Hs(Ue,he),he,Ue)}}class Ev extends zy{constructor(n,t,r,l,u){super(),this.location=r,this._rootLView=l,this._tNode=u,this.instance=t,this.hostView=this.changeDetectorRef=new xv(l),this.componentType=n}setInput(n,t){const r=this._tNode.inputs;let l;if(null!==r&&(l=r[n])){const u=this._rootLView;Gd(u[wt],u,l,n,t),Hd(Br(this._tNode.index,u))}}get injector(){return new vo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function i_(){const e=gi();Ze(Ae()[wt],e)}function Jn(e){let n=function kf(e){return Object.getPrototypeOf(e.prototype).constructor}(e.type),t=!0;const r=[e];for(;n;){let l;if(_o(e))l=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new st(903,!1);l=n.\u0275dir}if(l){if(t){r.push(l);const g=e;g.inputs=Zd(e.inputs),g.declaredInputs=Zd(e.declaredInputs),g.outputs=Zd(e.outputs);const w=l.hostBindings;w&&i(e,w);const I=l.viewQuery,S=l.contentQueries;if(I&&Dv(e,I),S&&o(e,S),la(e.inputs,l.inputs),la(e.declaredInputs,l.declaredInputs),la(e.outputs,l.outputs),_o(l)&&l.data.animation){const L=e.data;L.animation=(L.animation||[]).concat(l.data.animation)}}const u=l.features;if(u)for(let g=0;g<u.length;g++){const w=u[g];w&&w.ngInherit&&w(e),w===Jn&&(t=!1)}}n=Object.getPrototypeOf(n)}!function Wd(e){let n=0,t=null;for(let r=e.length-1;r>=0;r--){const l=e[r];l.hostVars=n+=l.hostVars,l.hostAttrs=kn(l.hostAttrs,t=kn(t,l.hostAttrs))}}(r)}function Zd(e){return e===cs?{}:e===wn?[]:e}function Dv(e,n){const t=e.viewQuery;e.viewQuery=t?(r,l)=>{n(r,l),t(r,l)}:n}function o(e,n){const t=e.contentQueries;e.contentQueries=t?(r,l,u)=>{n(r,l,u),t(r,l,u)}:n}function i(e,n){const t=e.hostBindings;e.hostBindings=t?(r,l)=>{n(r,l),t(r,l)}:n}function R(e){return!!U(e)&&(Array.isArray(e)||!(e instanceof Map)&&Symbol.iterator in e)}function U(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Y(e,n,t){return e[n]=t}function J(e,n,t){return!Object.is(e[n],t)&&(e[n]=t,!0)}function oe(e,n,t,r){const l=J(e,n,t);return J(e,n+1,r)||l}function xe(e,n,t,r){const l=Ae();return J(l,ma(),n)&&(In(),qs(te(),l,e,n,t,r)),xe}function Oe(e,n,t,r){return J(e,ma(),t)?n+en(t)+r:pn}function We(e,n,t,r,l,u){const w=oe(e,function jo(){return on.lFrame.bindingIndex}(),t,l);return Kr(2),w?n+en(t)+r+en(l)+u:pn}function At(e,n,t,r,l,u,g,w){const I=Ae(),S=In(),L=e+Fn,j=S.firstCreatePass?function Yn(e,n,t,r,l,u,g,w,I){const S=n.consts,L=nu(n,e,4,g||null,mi(S,w));Yg(n,t,L,mi(S,I)),Ze(n,L);const j=L.tView=Qg(2,L,r,l,u,n.directiveRegistry,n.pipeRegistry,null,n.schemas,S);return null!==n.queries&&(n.queries.template(n,L),j.queries=n.queries.embeddedTView(L)),L}(L,S,I,n,t,r,l,u,g):S.data[L];ps(j,!1);const ne=I[tn].createComment("");Ur(S,I,ne,j),ki(ne,I),Ws(I,I[L]=t_(ne,I,ne,j)),Ls(j)&&Eh(S,I,j),null!=g&&Ch(I,j,w)}function zn(e){return function Bl(e,n){return e[n]}(function Pp(){return on.lFrame.contextLView}(),Fn+e)}function ot(e,n,t){const r=Ae();return J(r,ma(),n)&&Qo(In(),te(),r,e,n,r[tn],t,!1),ot}function Hn(e,n,t,r,l){const g=l?"class":"style";Gd(e,t,n.inputs[g],g,r)}function ke(e,n,t,r){const l=Ae(),u=In(),g=Fn+e,w=l[tn],I=u.firstCreatePass?function $n(e,n,t,r,l,u){const g=n.consts,I=nu(n,e,2,r,mi(g,l));return Yg(n,t,I,mi(g,u)),null!==I.attrs&&Co(I,I.attrs,!1),null!==I.mergedAttrs&&Co(I,I.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,I),I}(g,u,l,n,t,r):u.data[g],S=l[g]=Um(w,n,function ye(){return on.lFrame.currentNamespace}()),L=Ls(I);return ps(I,!0),My(w,S,I),32!=(32&I.flags)&&Ur(u,l,S,I),0===function kp(){return on.lFrame.elementDepthCount}()&&ki(S,l),function xm(){on.lFrame.elementDepthCount++}(),L&&(Eh(u,l,I),Zg(u,I,l)),null!==r&&Ch(l,I),ke}function Ne(){let e=gi();Wu()?function Oc(){on.lFrame.isParent=!1}():(e=e.parent,ps(e,!1));const n=e;!function Vo(){on.lFrame.elementDepthCount--}();const t=In();return t.firstCreatePass&&(Ze(t,e),Ru(e)&&t.queries.elementEnd(e)),null!=n.classesWithoutHost&&function vt(e){return 0!=(8&e.flags)}(n)&&Hn(t,n,Ae(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function kt(e){return 0!=(16&e.flags)}(n)&&Hn(t,n,Ae(),n.stylesWithoutHost,!1),Ne}function Dt(e,n,t,r){return ke(e,n,t,r),Ne(),Dt}function Gt(){return Ae()}function li(e){return!!e&&"function"==typeof e.then}const Mr=function Wn(e){return!!e&&"function"==typeof e.subscribe};function ft(e,n,t,r){const l=Ae(),u=In(),g=gi();return function Hr(e,n,t,r,l,u,g){const w=Ls(r),S=e.firstCreatePass&&Df(e),L=n[bi],j=iu(n);let ne=!0;if(3&r.type||g){const Ie=Fi(r,n),Ue=g?g(Ie):Ie,$e=j.length,_t=g?$t=>g(Xi($t[r.index])):r.index;let Ke=null;if(!g&&w&&(Ke=function tr(e,n,t,r){const l=e.cleanup;if(null!=l)for(let u=0;u<l.length-1;u+=2){const g=l[u];if(g===t&&l[u+1]===r){const w=n[us],I=l[u+2];return w.length>I?w[I]:null}"string"==typeof g&&(u+=2)}return null}(e,n,l,r.index)),null!==Ke)(Ke.__ngLastListenerFn__||Ke).__ngNextListenerFn__=u,Ke.__ngLastListenerFn__=u,ne=!1;else{u=Es(r,n,L,u,!1);const $t=t.listen(Ue,l,u);j.push(u,$t),S&&S.push(l,_t,$e,$e+1)}}else u=Es(r,n,L,u,!1);const se=r.outputs;let he;if(ne&&null!==se&&(he=se[l])){const Ie=he.length;if(Ie)for(let Ue=0;Ue<Ie;Ue+=2){const vi=n[he[Ue]][he[Ue+1]].subscribe(u),mr=j.length;j.push(u,vi),S&&S.push(l,r.index,mr,-(mr+1))}}}(u,l,l[tn],g,e,n,r),ft}function Gi(e,n,t,r){try{return wr(6,n,t),!1!==t(r)}catch(l){return Zs(e,l),!1}finally{wr(7,n,t)}}function Es(e,n,t,r,l){return function u(g){if(g===Function)return r;Hd(e.componentOffset>-1?Br(e.index,n):n);let I=Gi(n,t,r,g),S=u.__ngNextListenerFn__;for(;S;)I=Gi(n,t,S,g)&&I,S=S.__ngNextListenerFn__;return l&&!1===I&&(g.preventDefault(),g.returnValue=!1),I}}function Ft(e=1){return function ee(e){return(on.lFrame.contextLView=function V(e,n){for(;e>0;)n=n[kl],e--;return n}(e,on.lFrame.contextLView))[bi]}(e)}function ru(e,n,t){return Pf(e,"",n,"",t),ru}function Pf(e,n,t,r,l){const u=Ae(),g=Oe(u,n,t,r);return g!==pn&&Qo(In(),te(),u,e,g,u[tn],l,!1),Pf}function Ks(e,n){return e<<17|n<<2}function Ta(e){return e>>17&32767}function Jr(e){return 2|e}function Js(e){return(131068&e)>>2}function Kd(e,n){return-131069&e|n<<2}function al(e){return 1|e}function A1(e,n,t,r,l){const u=e[t+1],g=null===n;let w=r?Ta(u):Js(u),I=!1;for(;0!==w&&(!1===I||g);){const L=e[w+1];kS(e[w],n)&&(I=!0,e[w+1]=r?al(L):Jr(L)),w=r?Ta(L):Js(L)}I&&(e[t+1]=r?Jr(u):al(u))}function kS(e,n){return null===e||null==n||(Array.isArray(e)?e[1]:e)===n||!(!Array.isArray(e)||"string"!=typeof n)&&Vl(e,n)>=0}function Nf(e,n,t){return ll(e,n,t,!1),Nf}function zf(e,n){return ll(e,n,null,!0),zf}function ll(e,n,t,r){const l=Ae(),u=In(),g=Kr(2);u.firstUpdatePass&&function M1(e,n,t,r){const l=e.data;if(null===l[t+1]){const u=l[W()],g=function T1(e,n){return n>=e.expandoStartIndex}(e,t);(function P1(e,n){return 0!=(e.flags&(n?8:16))})(u,r)&&null===n&&!g&&(n=!1),n=function VS(e,n,t,r){const l=function b(e){const n=on.lFrame.currentDirectiveIndex;return-1===n?null:e[n]}(e);let u=r?n.residualClasses:n.residualStyles;if(null===l)0===(r?n.classBindings:n.styleBindings)&&(t=s_(t=Ex(null,e,n,t,r),n.attrs,r),u=null);else{const g=n.directiveStylingLast;if(-1===g||e[g]!==l)if(t=Ex(l,e,n,t,r),null===u){let I=function US(e,n,t){const r=t?n.classBindings:n.styleBindings;if(0!==Js(r))return e[Ta(r)]}(e,n,r);void 0!==I&&Array.isArray(I)&&(I=Ex(null,e,n,I[1],r),I=s_(I,n.attrs,r),function jS(e,n,t,r){e[Ta(t?n.classBindings:n.styleBindings)]=r}(e,n,r,I))}else u=function HS(e,n,t){let r;const l=n.directiveEnd;for(let u=1+n.directiveStylingLast;u<l;u++)r=s_(r,e[u].hostAttrs,t);return s_(r,n.attrs,t)}(e,n,r)}return void 0!==u&&(r?n.residualClasses=u:n.residualStyles=u),t}(l,u,n,r),function DS(e,n,t,r,l,u){let g=u?n.classBindings:n.styleBindings,w=Ta(g),I=Js(g);e[r]=t;let L,S=!1;if(Array.isArray(t)?(L=t[1],(null===L||Vl(t,L)>0)&&(S=!0)):L=t,l)if(0!==I){const ne=Ta(e[w+1]);e[r+1]=Ks(ne,w),0!==ne&&(e[ne+1]=Kd(e[ne+1],r)),e[w+1]=function Io(e,n){return 131071&e|n<<17}(e[w+1],r)}else e[r+1]=Ks(w,0),0!==w&&(e[w+1]=Kd(e[w+1],r)),w=r;else e[r+1]=Ks(I,0),0===w?w=r:e[I+1]=Kd(e[I+1],r),I=r;S&&(e[r+1]=Jr(e[r+1])),A1(e,L,r,!0),A1(e,L,r,!1),function SS(e,n,t,r,l){const u=l?e.residualClasses:e.residualStyles;null!=u&&"string"==typeof n&&Vl(u,n)>=0&&(t[r+1]=al(t[r+1]))}(n,L,e,r,u),g=Ks(w,I),u?n.classBindings=g:n.styleBindings=g}(l,u,n,t,g,r)}}(u,e,g,r),n!==pn&&J(l,g,n)&&function S1(e,n,t,r,l,u,g,w){if(!(3&n.type))return;const I=e.data,S=I[w+1],L=function kv(e){return 1==(1&e)}(S)?k1(I,n,t,l,Js(S),g):void 0;Pv(L)||(Pv(u)||function wx(e){return 2==(2&e)}(S)&&(u=k1(I,null,t,l,w,g)),function Md(e,n,t,r,l){if(n)l?e.addClass(t,r):e.removeClass(t,r);else{let u=-1===r.indexOf("-")?void 0:cr.DashCase;null==l?e.removeStyle(t,r,u):("string"==typeof l&&l.endsWith("!important")&&(l=l.slice(0,-10),u|=cr.Important),e.setStyle(t,r,l,u))}}(r,g,Pc(W(),t),l,u))}(u,u.data[W()],l,l[tn],e,l[g+1]=function qS(e,n){return null==e||""===e||("string"==typeof n?e+=n:"object"==typeof e&&(e=et(bo(e)))),e}(n,t),r,g)}function Ex(e,n,t,r,l){let u=null;const g=t.directiveEnd;let w=t.directiveStylingLast;for(-1===w?w=t.directiveStart:w++;w<g&&(u=n[w],r=s_(r,u.hostAttrs,l),u!==e);)w++;return null!==e&&(t.directiveStylingLast=w),r}function s_(e,n,t){const r=t?1:2;let l=-1;if(null!==n)for(let u=0;u<n.length;u++){const g=n[u];"number"==typeof g?l=g:l===r&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),Ao(e,g,!!t||n[++u]))}return void 0===e?null:e}function k1(e,n,t,r,l,u){const g=null===n;let w;for(;l>0;){const I=e[l],S=Array.isArray(I),L=S?I[1]:I,j=null===L;let ne=t[l+1];ne===pn&&(ne=j?wn:void 0);let se=j?Cm(ne,r):L===r?ne:void 0;if(S&&!Pv(se)&&(se=Cm(I,r)),Pv(se)&&(w=se,g))return w;const he=e[l+1];l=g?Ta(he):Js(he)}if(null!==n){let I=u?n.residualClasses:n.residualStyles;null!=I&&(w=Cm(I,r))}return w}function Pv(e){return void 0!==e}function bt(e,n=""){const t=Ae(),r=In(),l=e+Fn,u=r.firstCreatePass?nu(r,l,1,n,null):r.data[l],g=t[l]=function ch(e,n){return e.createText(n)}(t[tn],n);Ur(r,t,g,u),ps(u,!1)}function ou(e){return Yr("",e,""),ou}function Yr(e,n,t){const r=Ae(),l=Oe(r,e,n,t);return l!==pn&&Qs(r,W(),l),Yr}function Rv(e,n,t,r,l){const u=Ae(),g=We(u,e,n,t,r,l);return g!==pn&&Qs(u,W(),g),Rv}const Uf="en-US";let Y1=Uf;function Tx(e,n,t,r,l){if(e=Pt(e),Array.isArray(e))for(let u=0;u<e.length;u++)Tx(e[u],n,t,r,l);else{const u=In(),g=Ae();let w=ql(e)?e:Pt(e.provide),I=Zc(e);const S=gi(),L=1048575&S.providerIndexes,j=S.directiveStart,ne=S.providerIndexes>>20;if(ql(e)||!e.multi){const se=new Xe(I,l,qe),he=Dx(w,n,l?L:L+ne,j);-1===he?(Bs(fs(S,g),u,w),Mx(u,e,n.length),n.push(w),S.directiveStart++,S.directiveEnd++,l&&(S.providerIndexes+=1048576),t.push(se),g.push(se)):(t[he]=se,g[he]=se)}else{const se=Dx(w,n,L+ne,j),he=Dx(w,n,L,L+ne),Ue=he>=0&&t[he];if(l&&!Ue||!l&&!(se>=0&&t[se])){Bs(fs(S,g),u,w);const $e=function uk(e,n,t,r,l){const u=new Xe(e,t,qe);return u.multi=[],u.index=n,u.componentProviders=0,EE(u,l,r&&!t),u}(l?ck:lk,t.length,l,r,I);!l&&Ue&&(t[he].providerFactory=$e),Mx(u,e,n.length,0),n.push(w),S.directiveStart++,S.directiveEnd++,l&&(S.providerIndexes+=1048576),t.push($e),g.push($e)}else Mx(u,e,se>-1?se:he,EE(t[l?he:se],I,!l&&r));!l&&r&&Ue&&t[he].componentProviders++}}}function Mx(e,n,t,r){const l=ql(n),u=function Z0(e){return!!e.useClass}(n);if(l||u){const I=(u?Pt(n.useClass):n).prototype.ngOnDestroy;if(I){const S=e.destroyHooks||(e.destroyHooks=[]);if(!l&&n.multi){const L=S.indexOf(t);-1===L?S.push(t,[r,I]):S[L+1].push(r,I)}else S.push(t,I)}}}function EE(e,n,t){return t&&e.componentProviders++,e.multi.push(n)-1}function Dx(e,n,t,r){for(let l=t;l<r;l++)if(n[l]===e)return l;return-1}function lk(e,n,t,r){return Sx(this.multi,[])}function ck(e,n,t,r){const l=this.multi;let u;if(this.providerFactory){const g=this.providerFactory.componentProviders,w=ga(t,t[wt],this.providerFactory.index,r);u=w.slice(0,g),Sx(l,u);for(let I=g;I<w.length;I++)u.push(w[I])}else u=[],Sx(l,u);return u}function Sx(e,n){for(let t=0;t<e.length;t++)n.push((0,e[t])());return n}function Bi(e,n=[]){return t=>{t.providersResolver=(r,l)=>function ak(e,n,t){const r=In();if(r.firstCreatePass){const l=_o(e);Tx(t,r.data,r.blueprint,l,!0),Tx(n,r.data,r.blueprint,l,!1)}}(r,l?l(e):e,n)}}class jf{}class CE{}class IE extends jf{constructor(n,t){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Dh(this);const r=Qr(n);this._bootstrapComponents=Gs(r.bootstrap),this._r3Injector=Nd(n,t,[{provide:jf,useValue:this},{provide:yh,useValue:this.componentFactoryResolver}],et(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class kx extends CE{constructor(n){super(),this.moduleType=n}create(n){return new IE(this.moduleType,n)}}class dk extends jf{constructor(n,t,r){super(),this.componentFactoryResolver=new Dh(this),this.instance=null;const l=new Ji([...n,{provide:jf,useValue:this},{provide:yh,useValue:this.componentFactoryResolver}],t||Od(),r,new Set(["environment"]));this.injector=l,l.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}function Nv(e,n,t=null){return new dk(e,n,t).injector}let pk=(()=>{class e{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t.id)){const r=By(0,t.type),l=r.length>0?Nv([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t.id,l)}return this.cachedInjectors.get(t.id)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}}return e.\u0275prov=Tt({token:e,providedIn:"environment",factory:()=>new e(gt(Ea))}),e})();function TE(e){e.getStandaloneInjector=n=>n.get(pk).getOrCreateStandaloneInjector(e)}function zv(e,n,t){const r=Nr()+e,l=Ae();return l[r]===pn?Y(l,r,t?n.call(t):n()):function ae(e,n){return e[n]}(l,r)}function Cs(e,n,t,r){return function OE(e,n,t,r,l,u){const g=n+t;return J(e,g,l)?Y(e,g+1,u?r.call(u,l):r(l)):d_(e,g+1)}(Ae(),Nr(),e,n,t,r)}function su(e,n,t,r,l){return function FE(e,n,t,r,l,u,g){const w=n+t;return oe(e,w,l,u)?Y(e,w+2,g?r.call(g,l,u):r(l,u)):d_(e,w+2)}(Ae(),Nr(),e,n,t,r,l)}function Vv(e,n,t,r,l,u){return function LE(e,n,t,r,l,u,g,w){const I=n+t;return function ue(e,n,t,r,l){const u=oe(e,n,t,r);return J(e,n+2,l)||u}(e,I,l,u,g)?Y(e,I+3,w?r.call(w,l,u,g):r(l,u,g)):d_(e,I+3)}(Ae(),Nr(),e,n,t,r,l,u)}function d_(e,n){const t=e[n];return t===pn?void 0:t}function Rx(e){return n=>{setTimeout(e,void 0,n)}}const ri=class Fk extends rr{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,t,r){let l=n,u=t||(()=>null),g=r;if(n&&"object"==typeof n){const I=n;l=I.next?.bind(I),u=I.error?.bind(I),g=I.complete?.bind(I)}this.__isAsync&&(u=Rx(u),l&&(l=Rx(l)),g&&(g=Rx(g)));const w=super.subscribe({next:l,error:u,complete:g});return n instanceof je&&n.add(w),w}};function Lk(){return this._results[Symbol.iterator]()}class Ox{get changes(){return this._changes||(this._changes=new ri)}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const t=Ox.prototype;t[Symbol.iterator]||(t[Symbol.iterator]=Lk)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,t){return this._results.reduce(n,t)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,t){const r=this;r.dirty=!1;const l=function $o(e){return e.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function oy(e,n,t){if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++){let l=e[r],u=n[r];if(t&&(l=t(l),u=t(u)),u!==l)return!1}return!0}(r._results,l,t))&&(r._results=l,r.length=l.length,r.last=l[this.length-1],r.first=l[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let au=(()=>{class e{}return e.__NG_ELEMENT_ID__=zk,e})();const Bk=au,Nk=class extends Bk{constructor(n,t,r){super(),this._declarationLView=n,this._declarationTContainer=t,this.elementRef=r}createEmbeddedView(n,t){const r=this._declarationTContainer.tView,l=bf(this._declarationLView,r,n,16,null,r.declTNode,null,null,null,null,t||null);l[Pl]=this._declarationLView[this._declarationTContainer.index];const g=this._declarationLView[Fr];return null!==g&&(l[Fr]=g.createEmbeddedView(r)),Wg(r,l,n),new Mh(l)}};function zk(){return Uv(gi(),Ae())}function Uv(e,n){return 4&e.type?new Nk(n,e,Hs(e,n)):null}let ul=(()=>{class e{}return e.__NG_ELEMENT_ID__=Vk,e})();function Vk(){return UE(gi(),Ae())}const Uk=ul,zE=class extends Uk{constructor(n,t,r){super(),this._lContainer=n,this._hostTNode=t,this._hostLView=r}get element(){return Hs(this._hostTNode,this._hostLView)}get injector(){return new vo(this._hostTNode,this._hostLView)}get parentInjector(){const n=gs(this._hostTNode,this._hostLView);if(ar(n)){const t=oo(n,this._hostLView),r=Si(n);return new vo(t[wt].data[r+8],t)}return new vo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const t=VE(this._lContainer);return null!==t&&t[n]||null}get length(){return this._lContainer.length-Qi}createEmbeddedView(n,t,r){let l,u;"number"==typeof r?l=r:null!=r&&(l=r.index,u=r.injector);const g=n.createEmbeddedView(t||{},u);return this.insert(g,l),g}createComponent(n,t,r,l,u){const g=n&&!function Ir(e){return"function"==typeof e}(n);let w;if(g)w=t;else{const j=t||{};w=j.index,r=j.injector,l=j.projectableNodes,u=j.environmentInjector||j.ngModuleRef}const I=g?n:new qd(gn(n)),S=r||this.parentInjector;if(!u&&null==I.ngModule){const ne=(g?S:this.parentInjector).get(Ea,null);ne&&(u=ne)}const L=I.create(S,l,void 0,u);return this.insert(L.hostView,w),L}insert(n,t){const r=n._lView,l=r[wt];if(function Mp(e){return Lr(e[ui])}(r)){const L=this.indexOf(n);if(-1!==L)this.detach(L);else{const j=r[ui],ne=new zE(j,j[sr],j[ui]);ne.detach(ne.indexOf(n))}}const u=this._adjustIndex(t),g=this._lContainer;!function Hm(e,n,t,r){const l=Qi+r,u=t.length;r>0&&(t[l-1][Bo]=n),r<u-Qi?(n[Bo]=t[l],Np(t,Qi+r,n)):(t.push(n),n[Bo]=null),n[ui]=t;const g=n[Pl];null!==g&&t!==g&&function Cy(e,n){const t=e[No];n[br]!==n[ui][ui][br]&&(e[Ol]=!0),null===t?e[No]=[n]:t.push(n)}(g,n);const w=n[Fr];null!==w&&w.insertView(e),n[hn]|=64}(l,r,g,u);const w=Ym(u,g),I=r[tn],S=Kp(I,g[Mc]);return null!==S&&function T0(e,n,t,r,l,u){r[go]=l,r[sr]=n,Hc(e,r,t,1,l,u)}(l,g[sr],I,r,S,w),n.attachToViewContainerRef(),Np(Fx(g),u,n),n}move(n,t){return this.insert(n,t)}indexOf(n){const t=VE(this._lContainer);return null!==t?t.indexOf(n):-1}remove(n){const t=this._adjustIndex(n,-1),r=tl(this._lContainer,t);r&&(Aa(Fx(this._lContainer),t),$m(r[wt],r))}detach(n){const t=this._adjustIndex(n,-1),r=tl(this._lContainer,t);return r&&null!=Aa(Fx(this._lContainer),t)?new Mh(r):null}_adjustIndex(n,t=0){return n??this.length+t}};function VE(e){return e[hs]}function Fx(e){return e[hs]||(e[hs]=[])}function UE(e,n){let t;const r=n[e.index];if(Lr(r))t=r;else{let l;if(8&e.type)l=Xi(r);else{const u=n[tn];l=u.createComment("");const g=Fi(e,n);jc(u,Kp(u,g),l,function k0(e,n){return e.nextSibling(n)}(u,g),!1)}n[e.index]=t=t_(r,n,l,e),Ws(n,t)}return new zE(t,e,n)}class Lx{constructor(n){this.queryList=n,this.matches=null}clone(){return new Lx(this.queryList)}setDirty(){this.queryList.setDirty()}}class Bx{constructor(n=[]){this.queries=n}createEmbeddedView(n){const t=n.queries;if(null!==t){const r=null!==n.contentQueries?n.contentQueries[0]:t.length,l=[];for(let u=0;u<r;u++){const g=t.getByIndex(u);l.push(this.queries[g.indexInDeclarationView].clone())}return new Bx(l)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let t=0;t<this.queries.length;t++)null!==WE(n,t).matches&&this.queries[t].setDirty()}}class jE{constructor(n,t,r=null){this.predicate=n,this.flags=t,this.read=r}}class Nx{constructor(n=[]){this.queries=n}elementStart(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].elementStart(n,t)}elementEnd(n){for(let t=0;t<this.queries.length;t++)this.queries[t].elementEnd(n)}embeddedTView(n){let t=null;for(let r=0;r<this.length;r++){const l=null!==t?t.length:0,u=this.getByIndex(r).embeddedTView(n,l);u&&(u.indexInDeclarationView=r,null!==t?t.push(u):t=[u])}return null!==t?new Nx(t):null}template(n,t){for(let r=0;r<this.queries.length;r++)this.queries[r].template(n,t)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class zx{constructor(n,t=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=t}elementStart(n,t){this.isApplyingToNode(t)&&this.matchTNode(n,t)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,t){this.elementStart(n,t)}embeddedTView(n,t){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,t),new zx(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const t=this._declarationNodeIndex;let r=n.parent;for(;null!==r&&8&r.type&&r.index!==t;)r=r.parent;return t===(null!==r?r.index:-1)}return this._appliesToNextNode}matchTNode(n,t){const r=this.metadata.predicate;if(Array.isArray(r))for(let l=0;l<r.length;l++){const u=r[l];this.matchTNodeWithReadOption(n,t,jk(t,u)),this.matchTNodeWithReadOption(n,t,Ju(t,n,u,!1,!1))}else r===au?4&t.type&&this.matchTNodeWithReadOption(n,t,-1):this.matchTNodeWithReadOption(n,t,Ju(t,n,r,!1,!1))}matchTNodeWithReadOption(n,t,r){if(null!==r){const l=this.metadata.read;if(null!==l)if(l===jr||l===ul||l===au&&4&t.type)this.addMatch(t.index,-2);else{const u=Ju(t,n,l,!1,!1);null!==u&&this.addMatch(t.index,u)}else this.addMatch(t.index,r)}}addMatch(n,t){null===this.matches?this.matches=[n,t]:this.matches.push(n,t)}}function jk(e,n){const t=e.localNames;if(null!==t)for(let r=0;r<t.length;r+=2)if(t[r]===n)return t[r+1];return null}function Gk(e,n,t,r){return-1===t?function Hk(e,n){return 11&e.type?Hs(e,n):4&e.type?Uv(e,n):null}(n,e):-2===t?function $k(e,n,t){return t===jr?Hs(n,e):t===au?Uv(n,e):t===ul?UE(n,e):void 0}(e,n,r):ga(e,e[wt],t,n)}function HE(e,n,t,r){const l=n[Fr].queries[r];if(null===l.matches){const u=e.data,g=t.matches,w=[];for(let I=0;I<g.length;I+=2){const S=g[I];w.push(S<0?null:Gk(n,u[S],g[I+1],t.metadata.read))}l.matches=w}return l.matches}function Vx(e,n,t,r){const l=e.queries.getByIndex(t),u=l.matches;if(null!==u){const g=HE(e,n,l,t);for(let w=0;w<u.length;w+=2){const I=u[w];if(I>0)r.push(g[w/2]);else{const S=u[w+1],L=n[-I];for(let j=Qi;j<L.length;j++){const ne=L[j];ne[Pl]===ne[ui]&&Vx(ne[wt],ne,S,r)}if(null!==L[No]){const j=L[No];for(let ne=0;ne<j.length;ne++){const se=j[ne];Vx(se[wt],se,S,r)}}}}}return r}function Sh(e){const n=Ae(),t=In(),r=T();M(r+1);const l=WE(t,r);if(e.dirty&&function _d(e){return 4==(4&e[hn])}(n)===(2==(2&l.metadata.flags))){if(null===l.matches)e.reset([]);else{const u=l.crossesNgTemplate?Vx(t,n,r,[]):HE(t,n,l,r);e.reset(u,J0),e.notifyOnChanges()}return!0}return!1}function Yd(e,n,t){const r=In();r.firstCreatePass&&(function qE(e,n,t){null===e.queries&&(e.queries=new Nx),e.queries.track(new zx(n,t))}(r,new jE(e,n,t),-1),2==(2&n)&&(r.staticViewQueries=!0)),function $E(e,n,t){const r=new Ox(4==(4&t));sl(e,n,r,r.destroy),null===n[Fr]&&(n[Fr]=new Bx),n[Fr].queries.push(new Lx(r))}(r,Ae(),n)}function kh(){return function qk(e,n){return e[Fr].queries[n].queryList}(Ae(),T())}function WE(e,n){return e.queries.getByIndex(n)}function Hv(...e){}const Gv=new xt("Application Initializer");let $v=(()=>{class e{constructor(t){this.appInits=t,this.resolve=Hv,this.reject=Hv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,l)=>{this.resolve=r,this.reject=l})}runInitializers(){if(this.initialized)return;const t=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let l=0;l<this.appInits.length;l++){const u=this.appInits[l]();if(li(u))t.push(u);else if(Mr(u)){const g=new Promise((w,I)=>{u.subscribe({complete:w,error:I})});t.push(g)}}Promise.all(t).then(()=>{r()}).catch(l=>{this.reject(l)}),0===t.length&&r(),this.initialized=!0}}return e.\u0275fac=function(t){return new(t||e)(gt(Gv,8))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const m_=new xt("AppId",{providedIn:"root",factory:function hC(){return`${qx()}${qx()}${qx()}`}});function qx(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const dC=new xt("Platform Initializer"),g_=new xt("Platform ID",{providedIn:"platform",factory:()=>"unknown"});let fP=(()=>{class e{log(t){console.log(t)}warn(t){console.warn(t)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const tc=new xt("LocaleId",{providedIn:"root",factory:()=>Wt(tc,Bt.Optional|Bt.SkipSelf)||function mP(){return typeof $localize<"u"&&$localize.locale||Uf}()});class _P{constructor(n,t){this.ngModuleFactory=n,this.componentFactories=t}}let pC=(()=>{class e{compileModuleSync(t){return new kx(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),u=Gs(Qr(t).declarations).reduce((g,w)=>{const I=gn(w);return I&&g.push(new qd(I)),g},[]);return new _P(r,u)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const AP=(()=>Promise.resolve(0))();function Wx(e){typeof Zone>"u"?AP.then(()=>{e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}class ir{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ri(!1),this.onMicrotaskEmpty=new ri(!1),this.onStable=new ri(!1),this.onError=new ri(!1),typeof Zone>"u")throw new st(908,!1);Zone.assertZonePatched();const l=this;l._nesting=0,l._outer=l._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(l._inner=l._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(l._inner=l._inner.fork(Zone.longStackTraceZoneSpec)),l.shouldCoalesceEventChangeDetection=!r&&t,l.shouldCoalesceRunChangeDetection=r,l.lastRequestAnimationFrameId=-1,l.nativeRequestAnimationFrame=function xP(){let e=ti.requestAnimationFrame,n=ti.cancelAnimationFrame;if(typeof Zone<"u"&&e&&n){const t=e[Zone.__symbol__("OriginalDelegate")];t&&(e=t);const r=n[Zone.__symbol__("OriginalDelegate")];r&&(n=r)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function EP(e){const n=()=>{!function wP(e){e.isCheckStableRunning||-1!==e.lastRequestAnimationFrameId||(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call(ti,()=>{e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{e.lastRequestAnimationFrameId=-1,Qx(e),e.isCheckStableRunning=!0,Zx(e),e.isCheckStableRunning=!1},void 0,()=>{},()=>{})),e.fakeTopEventTask.invoke()}),Qx(e))}(e)};e._inner=e._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,l,u,g,w)=>{try{return gC(e),t.invokeTask(l,u,g,w)}finally{(e.shouldCoalesceEventChangeDetection&&"eventTask"===u.type||e.shouldCoalesceRunChangeDetection)&&n(),_C(e)}},onInvoke:(t,r,l,u,g,w,I)=>{try{return gC(e),t.invoke(l,u,g,w,I)}finally{e.shouldCoalesceRunChangeDetection&&n(),_C(e)}},onHasTask:(t,r,l,u)=>{t.hasTask(l,u),r===l&&("microTask"==u.change?(e._hasPendingMicrotasks=u.microTask,Qx(e),Zx(e)):"macroTask"==u.change&&(e.hasPendingMacrotasks=u.macroTask))},onHandleError:(t,r,l,u)=>(t.handleError(l,u),e.runOutsideAngular(()=>e.onError.emit(u)),!1)})}(l)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ir.isInAngularZone())throw new st(909,!1)}static assertNotInAngularZone(){if(ir.isInAngularZone())throw new st(909,!1)}run(n,t,r){return this._inner.run(n,t,r)}runTask(n,t,r,l){const u=this._inner,g=u.scheduleEventTask("NgZoneEvent: "+l,n,bP,Hv,Hv);try{return u.runTask(g,t,r)}finally{u.cancelTask(g)}}runGuarded(n,t,r){return this._inner.runGuarded(n,t,r)}runOutsideAngular(n){return this._outer.run(n)}}const bP={};function Zx(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(()=>e.onStable.emit(null))}finally{e.isStable=!0}}}function Qx(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function gC(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function _C(e){e._nesting--,Zx(e)}class CP{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ri,this.onMicrotaskEmpty=new ri,this.onStable=new ri,this.onError=new ri}run(n,t,r){return n.apply(t,r)}runGuarded(n,t,r){return n.apply(t,r)}runOutsideAngular(n){return n()}runTask(n,t,r,l){return n.apply(t,r)}}const yC=new xt(""),qv=new xt("");let Jx,Xx=(()=>{class e{constructor(t,r,l){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Jx||(function IP(e){Jx=e}(l),l.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ir.assertNotInAngularZone(),Wx(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Wx(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,l){let u=-1;r&&r>0&&(u=setTimeout(()=>{this._callbacks=this._callbacks.filter(g=>g.timeoutId!==u),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:u,updateCb:l})}whenStable(t,r,l){if(l&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,l),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,l){return[]}}return e.\u0275fac=function(t){return new(t||e)(gt(ir),gt(Kx),gt(qv))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})(),Kx=(()=>{class e{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Jx?.findTestabilityInTree(this,t,r)??null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();const lu=!1;let Ph=null;const vC=new xt("AllowMultipleToken"),Yx=new xt("PlatformDestroyListeners"),AC=new xt("appBootstrapListener");class xC{constructor(n,t){this.name=n,this.token=t}}function wC(e,n,t=[]){const r=`Platform: ${n}`,l=new xt(r);return(u=[])=>{let g=eb();if(!g||g.injector.get(vC,!1)){const w=[...t,...u,{provide:l,useValue:!0}];e?e(w):function DP(e){if(Ph&&!Ph.get(vC,!1))throw new st(400,!1);Ph=e;const n=e.get(CC);(function bC(e){const n=e.get(dC,null);n&&n.forEach(t=>t())})(e)}(function EC(e=[],n){return Eo.create({name:n,providers:[{provide:Eg,useValue:"platform"},{provide:Yx,useValue:new Set([()=>Ph=null])},...e]})}(w,r))}return function kP(e){const n=eb();if(!n)throw new st(401,!1);return n}()}}function eb(){return Ph?.get(CC)??null}let CC=(()=>{class e{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const l=function TC(e,n){let t;return t="noop"===e?new CP:("zone.js"===e?void 0:e)||new ir(n),t}(r?.ngZone,function IC(e){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!e||!e.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!e||!e.ngZoneRunCoalescing)||!1}}(r)),u=[{provide:ir,useValue:l}];return l.run(()=>{const g=Eo.create({providers:u,parent:this.injector,name:t.moduleType.name}),w=t.create(g),I=w.injector.get(rl,null);if(!I)throw new st(402,!1);return l.runOutsideAngular(()=>{const S=l.onError.subscribe({next:L=>{I.handleError(L)}});w.onDestroy(()=>{Zv(this._modules,w),S.unsubscribe()})}),function MC(e,n,t){try{const r=t();return li(r)?r.catch(l=>{throw n.runOutsideAngular(()=>e.handleError(l)),l}):r}catch(r){throw n.runOutsideAngular(()=>e.handleError(r)),r}}(I,l,()=>{const S=w.injector.get($v);return S.runInitializers(),S.donePromise.then(()=>(function eE(e){_r(e,"Expected localeId to be defined"),"string"==typeof e&&(Y1=e.toLowerCase().replace(/_/g,"-"))}(w.injector.get(tc,Uf)||Uf),this._moduleDoBootstrap(w),w))})})}bootstrapModule(t,r=[]){const l=DC({},r);return function TP(e,n,t){const r=new kx(t);return Promise.resolve(r)}(0,0,t).then(u=>this.bootstrapModuleFactory(u,l))}_moduleDoBootstrap(t){const r=t.injector.get(Wv);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(l=>r.bootstrap(l));else{if(!t.instance.ngDoBootstrap)throw new st(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new st(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(Yx,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return e.\u0275fac=function(t){return new(t||e)(gt(Eo))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"platform"}),e})();function DC(e,n){return Array.isArray(n)?n.reduce(DC,e):{...e,...n}}let Wv=(()=>{class e{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(t,r,l){this._zone=t,this._injector=r,this._exceptionHandler=l,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const u=new fn(w=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{w.next(this._stable),w.complete()})}),g=new fn(w=>{let I;this._zone.runOutsideAngular(()=>{I=this._zone.onStable.subscribe(()=>{ir.assertNotInAngularZone(),Wx(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,w.next(!0))})})});const S=this._zone.onUnstable.subscribe(()=>{ir.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{w.next(!1)}))});return()=>{I.unsubscribe(),S.unsubscribe()}});this.isStable=function pp(...e){const n=aa(e),t=function is(e,n){return"number"==typeof za(e)?e.pop():n}(e,1/0),r=e;return r.length?1===r.length?Ot(r[0]):Po(t)(xn(r,n)):ns}(u,g.pipe(function Ro(e={}){const{connector:n=(()=>new rr),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:l=!0}=e;return u=>{let g,w,I,S=0,L=!1,j=!1;const ne=()=>{w?.unsubscribe(),w=void 0},se=()=>{ne(),g=I=void 0,L=j=!1},he=()=>{const Ie=g;se(),Ie?.unsubscribe()};return pi((Ie,Ue)=>{S++,!j&&!L&&ne();const $e=I=I??n();Ue.add(()=>{S--,0===S&&!j&&!L&&(w=gc(he,l))}),$e.subscribe(Ue),!g&&S>0&&(g=new Ra({next:_t=>$e.next(_t),error:_t=>{j=!0,ne(),w=gc(se,t,_t),$e.error(_t)},complete:()=>{L=!0,ne(),w=gc(se,r),$e.complete()}}),Ot(Ie).subscribe(g))})(u)}}()))}bootstrap(t,r){const l=t instanceof Mg;if(!this._injector.get($v).done){!l&&function Rs(e){const n=gn(e)||Ui(e)||xr(e);return null!==n&&n.standalone}(t);throw new st(405,lu)}let g;g=l?t:this._injector.get(yh).resolveComponentFactory(t),this.componentTypes.push(g.componentType);const w=function MP(e){return e.isBoundToModule}(g)?void 0:this._injector.get(jf),S=g.create(Eo.NULL,[],r||g.selector,w),L=S.location.nativeElement,j=S.injector.get(yC,null);return j?.registerApplication(L),S.onDestroy(()=>{this.detachView(S.hostView),Zv(this.components,S),j?.unregisterApplication(L)}),this._loadComponent(S),S}tick(){if(this._runningTick)throw new st(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(t))}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;Zv(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(AC,[]);r.push(...this._bootstrapListeners),r.forEach(l=>l(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>Zv(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new st(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return e.\u0275fac=function(t){return new(t||e)(gt(ir),gt(Ea),gt(rl))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function Zv(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}let $f=(()=>{class e{}return e.__NG_ELEMENT_ID__=RP,e})();function RP(e){return function OP(e,n,t){if(da(e)&&!t){const r=Br(e.index,n);return new Mh(r,r)}return 47&e.type?new Mh(n[br],n):null}(gi(),Ae(),16==(16&e))}class OC{constructor(){}supports(n){return R(n)}create(n){return new VP(n)}}const zP=(e,n)=>n;class VP{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||zP}forEachItem(n){let t;for(t=this._itHead;null!==t;t=t._next)n(t)}forEachOperation(n){let t=this._itHead,r=this._removalsHead,l=0,u=null;for(;t||r;){const g=!r||t&&t.currentIndex<LC(r,l,u)?t:r,w=LC(g,l,u),I=g.currentIndex;if(g===r)l--,r=r._nextRemoved;else if(t=t._next,null==g.previousIndex)l++;else{u||(u=[]);const S=w-l,L=I-l;if(S!=L){for(let ne=0;ne<S;ne++){const se=ne<u.length?u[ne]:u[ne]=0,he=se+ne;L<=he&&he<S&&(u[ne]=se+1)}u[g.previousIndex]=L-S}}w!==I&&n(g,w,I)}}forEachPreviousItem(n){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachMovedItem(n){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}forEachIdentityChange(n){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)n(t)}diff(n){if(null==n&&(n=[]),!R(n))throw new st(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let l,u,g,t=this._itHead,r=!1;if(Array.isArray(n)){this.length=n.length;for(let w=0;w<this.length;w++)u=n[w],g=this._trackByFn(w,u),null!==t&&Object.is(t.trackById,g)?(r&&(t=this._verifyReinsertion(t,u,g,w)),Object.is(t.item,u)||this._addIdentityChange(t,u)):(t=this._mismatch(t,u,g,w),r=!0),t=t._next}else l=0,function N(e,n){if(Array.isArray(e))for(let t=0;t<e.length;t++)n(e[t]);else{const t=e[Symbol.iterator]();let r;for(;!(r=t.next()).done;)n(r.value)}}(n,w=>{g=this._trackByFn(l,w),null!==t&&Object.is(t.trackById,g)?(r&&(t=this._verifyReinsertion(t,w,g,l)),Object.is(t.item,w)||this._addIdentityChange(t,w)):(t=this._mismatch(t,w,g,l),r=!0),t=t._next,l++}),this.length=l;return this._truncate(t),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,t,r,l){let u;return null===n?u=this._itTail:(u=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._reinsertAfter(n,u,l)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(r,l))?(Object.is(n.item,t)||this._addIdentityChange(n,t),this._moveAfter(n,u,l)):n=this._addAfter(new UP(t,r),u,l),n}_verifyReinsertion(n,t,r,l){let u=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==u?n=this._reinsertAfter(u,n._prev,l):n.currentIndex!=l&&(n.currentIndex=l,this._addToMoves(n,l)),n}_truncate(n){for(;null!==n;){const t=n._next;this._addToRemovals(this._unlink(n)),n=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const l=n._prevRemoved,u=n._nextRemoved;return null===l?this._removalsHead=u:l._nextRemoved=u,null===u?this._removalsTail=l:u._prevRemoved=l,this._insertAfter(n,t,r),this._addToMoves(n,r),n}_moveAfter(n,t,r){return this._unlink(n),this._insertAfter(n,t,r),this._addToMoves(n,r),n}_addAfter(n,t,r){return this._insertAfter(n,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,t,r){const l=null===t?this._itHead:t._next;return n._next=l,n._prev=t,null===l?this._itTail=n:l._prev=n,null===t?this._itHead=n:t._next=n,null===this._linkedRecords&&(this._linkedRecords=new FC),this._linkedRecords.put(n),n.currentIndex=r,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const t=n._prev,r=n._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,n}_addToMoves(n,t){return n.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new FC),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,t){return n.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class UP{constructor(n,t){this.item=n,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class jP{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,n))return r;return null}remove(n){const t=n._prevDup,r=n._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class FC{constructor(){this.map=new Map}put(n){const t=n.trackById;let r=this.map.get(t);r||(r=new jP,this.map.set(t,r)),r.add(n)}get(n,t){const l=this.map.get(n);return l?l.get(n,t):null}remove(n){const t=n.trackById;return this.map.get(t).remove(n)&&this.map.delete(t),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function LC(e,n,t){const r=e.previousIndex;if(null===r)return r;let l=0;return t&&r<t.length&&(l=t[r]),r+n+l}class BC{constructor(){}supports(n){return n instanceof Map||U(n)}create(){return new HP}}class HP{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let t;for(t=this._mapHead;null!==t;t=t._next)n(t)}forEachPreviousItem(n){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)n(t)}forEachChangedItem(n){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)n(t)}forEachAddedItem(n){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)n(t)}forEachRemovedItem(n){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)n(t)}diff(n){if(n){if(!(n instanceof Map||U(n)))throw new st(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(n,(r,l)=>{if(t&&t.key===l)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const u=this._getOrCreateRecordForKey(l,r);t=this._insertBeforeOrAppend(t,u)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,t){if(n){const r=n._prev;return t._next=n,t._prev=r,n._prev=t,r&&(r._next=t),n===this._mapHead&&(this._mapHead=t),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(n,t){if(this._records.has(n)){const l=this._records.get(n);this._maybeAddToChanges(l,t);const u=l._prev,g=l._next;return u&&(u._next=g),g&&(g._prev=u),l._next=null,l._prev=null,l}const r=new GP(n);return this._records.set(n,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,t){Object.is(t,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=t,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,t){n instanceof Map?n.forEach(t):Object.keys(n).forEach(r=>t(n[r],r))}}class GP{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function NC(){return new Kv([new OC])}let Kv=(()=>{class e{constructor(t){this.factories=t}static create(t,r){if(null!=r){const l=r.factories.slice();t=t.concat(l)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||NC()),deps:[[e,new ii,new lr]]}}find(t){const r=this.factories.find(l=>l.supports(t));if(null!=r)return r;throw new st(901,!1)}}return e.\u0275prov=Tt({token:e,providedIn:"root",factory:NC}),e})();function zC(){return new __([new BC])}let __=(()=>{class e{constructor(t){this.factories=t}static create(t,r){if(r){const l=r.factories.slice();t=t.concat(l)}return new e(t)}static extend(t){return{provide:e,useFactory:r=>e.create(t,r||zC()),deps:[[e,new ii,new lr]]}}find(t){const r=this.factories.find(l=>l.supports(t));if(r)return r;throw new st(901,!1)}}return e.\u0275prov=Tt({token:e,providedIn:"root",factory:zC}),e})();const WP=wC(null,"core",[]);let ZP=(()=>{class e{constructor(t){}}return e.\u0275fac=function(t){return new(t||e)(gt(Wv))},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({}),e})();function qf(e){return"boolean"==typeof e?e:null!=e&&"false"!==e}let ob=null;function cu(){return ob}class KP{}const Ri=new xt("DocumentToken");let sb=(()=>{class e{historyGo(t){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return function JP(){return gt(VC)}()},providedIn:"platform"}),e})();const YP=new xt("Location Initialized");let VC=(()=>{class e extends sb{constructor(t){super(),this._doc=t,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return cu().getBaseHref(this._doc)}onPopState(t){const r=cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=cu().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,l){UC()?this._history.pushState(t,r,l):this._location.hash=l}replaceState(t,r,l){UC()?this._history.replaceState(t,r,l):this._location.hash=l}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:function(){return function eR(){return new VC(gt(Ri))}()},providedIn:"platform"}),e})();function UC(){return!!window.history.pushState}function ab(e,n){if(0==e.length)return n;if(0==n.length)return e;let t=0;return e.endsWith("/")&&t++,n.startsWith("/")&&t++,2==t?e+n.substring(1):1==t?e+n:e+"/"+n}function jC(e){const n=e.match(/#|\?|$/),t=n&&n.index||e.length;return e.slice(0,t-("/"===e[t-1]?1:0))+e.slice(t)}function uu(e){return e&&"?"!==e[0]?"?"+e:e}let tp=(()=>{class e{historyGo(t){throw new Error("Not implemented")}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return Wt(GC)},providedIn:"root"}),e})();const HC=new xt("appBaseHref");let GC=(()=>{class e extends tp{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??Wt(Ri).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return ab(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+uu(this._platformLocation.search),l=this._platformLocation.hash;return l&&t?`${r}${l}`:r}pushState(t,r,l,u){const g=this.prepareExternalUrl(l+uu(u));this._platformLocation.pushState(t,r,g)}replaceState(t,r,l,u){const g=this.prepareExternalUrl(l+uu(u));this._platformLocation.replaceState(t,r,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return e.\u0275fac=function(t){return new(t||e)(gt(sb),gt(HC,8))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),tR=(()=>{class e extends tp{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=ab(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,l,u){let g=this.prepareExternalUrl(l+uu(u));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.pushState(t,r,g)}replaceState(t,r,l,u){let g=this.prepareExternalUrl(l+uu(u));0==g.length&&(g=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,g)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}}return e.\u0275fac=function(t){return new(t||e)(gt(sb),gt(HC,8))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})(),lb=(()=>{class e{constructor(t){this._subject=new ri,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function rR(e){if(new RegExp("^(https?:)?//").test(e)){const[,t]=e.split(/\/\/[^\/]+/);return t}return e}(jC($C(r))),this._locationStrategy.onPopState(l=>{this._subject.emit({url:this.path(!0),pop:!0,state:l.state,type:l.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+uu(r))}normalize(t){return e.stripTrailingSlash(function iR(e,n){if(!e||!n.startsWith(e))return n;const t=n.substring(e.length);return""===t||["/",";","?","#"].includes(t[0])?t:n}(this._basePath,$C(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",l=null){this._locationStrategy.pushState(l,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+uu(r)),l)}replaceState(t,r="",l=null){this._locationStrategy.replaceState(l,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+uu(r)),l)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(l=>l(t,r))}subscribe(t,r,l){return this._subject.subscribe({next:t,error:r,complete:l})}}return e.normalizeQueryParams=uu,e.joinWithSlash=ab,e.stripTrailingSlash=jC,e.\u0275fac=function(t){return new(t||e)(gt(tp))},e.\u0275prov=Tt({token:e,factory:function(){return function nR(){return new lb(gt(tp))}()},providedIn:"root"}),e})();function $C(e){return e.replace(/\/index.html$/,"")}function eI(e,n){n=encodeURIComponent(n);for(const t of e.split(";")){const r=t.indexOf("="),[l,u]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(l.trim()===n)return decodeURIComponent(u)}return null}const yb=/\s+/,tI=[];let np=(()=>{class e{constructor(t,r,l,u){this._iterableDiffers=t,this._keyValueDiffers=r,this._ngEl=l,this._renderer=u,this.initialClasses=tI,this.stateMap=new Map}set klass(t){this.initialClasses=null!=t?t.trim().split(yb):tI}set ngClass(t){this.rawClass="string"==typeof t?t.trim().split(yb):t}ngDoCheck(){for(const r of this.initialClasses)this._updateState(r,!0);const t=this.rawClass;if(Array.isArray(t)||t instanceof Set)for(const r of t)this._updateState(r,!0);else if(null!=t)for(const r of Object.keys(t))this._updateState(r,Boolean(t[r]));this._applyStateDiff()}_updateState(t,r){const l=this.stateMap.get(t);void 0!==l?(l.enabled!==r&&(l.changed=!0,l.enabled=r),l.touched=!0):this.stateMap.set(t,{enabled:r,changed:!0,touched:!0})}_applyStateDiff(){for(const t of this.stateMap){const r=t[0],l=t[1];l.changed?(this._toggleClass(r,l.enabled),l.changed=!1):l.touched||(l.enabled&&this._toggleClass(r,!1),this.stateMap.delete(r)),l.touched=!1}}_toggleClass(t,r){(t=t.trim()).length>0&&t.split(yb).forEach(l=>{r?this._renderer.addClass(this._ngEl.nativeElement,l):this._renderer.removeClass(this._ngEl.nativeElement,l)})}}return e.\u0275fac=function(t){return new(t||e)(qe(Kv),qe(__),qe(jr),qe(il))},e.\u0275dir=Nt({type:e,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),e})();class jR{constructor(n,t,r,l){this.$implicit=n,this.ngForOf=t,this.index=r,this.count=l}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let A_=(()=>{class e{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,l){this._viewContainer=t,this._template=r,this._differs=l,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((l,u,g)=>{if(null==l.previousIndex)r.createEmbeddedView(this._template,new jR(l.item,this._ngForOf,-1,-1),null===g?void 0:g);else if(null==g)r.remove(null===u?void 0:u);else if(null!==u){const w=r.get(u);r.move(w,g),rI(w,l)}});for(let l=0,u=r.length;l<u;l++){const w=r.get(l).context;w.index=l,w.count=u,w.ngForOf=this._ngForOf}t.forEachIdentityChange(l=>{rI(r.get(l.currentIndex),l)})}static ngTemplateContextGuard(t,r){return!0}}return e.\u0275fac=function(t){return new(t||e)(qe(ul),qe(au),qe(Kv))},e.\u0275dir=Nt({type:e,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),e})();function rI(e,n){e.context.$implicit=n.item}let ip=(()=>{class e{constructor(t,r){this._viewContainer=t,this._context=new GR,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){oI("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){oI("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}}return e.\u0275fac=function(t){return new(t||e)(qe(ul),qe(au))},e.\u0275dir=Nt({type:e,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),e})();class GR{constructor(){this.$implicit=null,this.ngIf=null}}function oI(e,n){if(n&&!n.createEmbeddedView)throw new Error(`${e} must be a TemplateRef, but received '${et(n)}'.`)}let xb=(()=>{class e{constructor(t,r,l){this._ngEl=t,this._differs=r,this._renderer=l,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,r){const[l,u]=t.split("."),g=-1===l.indexOf("-")?void 0:cr.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,l,u?`${r}${u}`:r,g):this._renderer.removeStyle(this._ngEl.nativeElement,l,g)}_applyChanges(t){t.forEachRemovedItem(r=>this._setStyle(r.key,null)),t.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),t.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}}return e.\u0275fac=function(t){return new(t||e)(qe(jr),qe(__),qe(il))},e.\u0275dir=Nt({type:e,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),e})(),lI=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({}),e})();const cI="browser";function Eb(e){return e===cI}let vO=(()=>{class e{}return e.\u0275prov=Tt({token:e,providedIn:"root",factory:()=>new AO(gt(Ri),window)}),e})();class AO{constructor(n,t){this.document=n,this.window=t,this.offset=()=>[0,0]}setOffset(n){this.offset=Array.isArray(n)?()=>n:n}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(n){this.supportsScrolling()&&this.window.scrollTo(n[0],n[1])}scrollToAnchor(n){if(!this.supportsScrolling())return;const t=function xO(e,n){const t=e.getElementById(n)||e.getElementsByName(n)[0];if(t)return t;if("function"==typeof e.createTreeWalker&&e.body&&(e.body.createShadowRoot||e.body.attachShadow)){const r=e.createTreeWalker(e.body,NodeFilter.SHOW_ELEMENT);let l=r.currentNode;for(;l;){const u=l.shadowRoot;if(u){const g=u.getElementById(n)||u.querySelector(`[name="${n}"]`);if(g)return g}l=r.nextNode()}}return null}(this.document,n);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(n){if(this.supportScrollRestoration()){const t=this.window.history;t&&t.scrollRestoration&&(t.scrollRestoration=n)}}scrollToElement(n){const t=n.getBoundingClientRect(),r=t.left+this.window.pageXOffset,l=t.top+this.window.pageYOffset,u=this.offset();this.window.scrollTo(r-u[0],l-u[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const n=uI(this.window.history)||uI(Object.getPrototypeOf(this.window.history));return!(!n||!n.writable&&!n.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function uI(e){return Object.getOwnPropertyDescriptor(e,"scrollRestoration")}class hI{}class ZO extends KP{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class Tb extends ZO{static makeCurrent(){!function XP(e){ob||(ob=e)}(new Tb)}onAndCancel(n,t,r){return n.addEventListener(t,r,!1),()=>{n.removeEventListener(t,r,!1)}}dispatchEvent(n,t){n.dispatchEvent(t)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,t){return(t=t||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,t){return"window"===t?window:"document"===t?n:"body"===t?n.body:null}getBaseHref(n){const t=function QO(){return b_=b_||document.querySelector("base"),b_?b_.getAttribute("href"):null}();return null==t?null:function XO(e){cA=cA||document.createElement("a"),cA.setAttribute("href",e);const n=cA.pathname;return"/"===n.charAt(0)?n:`/${n}`}(t)}resetBaseElement(){b_=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return eI(document.cookie,n)}}let cA,b_=null;const gI=new xt("TRANSITION_ID"),JO=[{provide:Gv,useFactory:function KO(e,n,t){return()=>{t.get($v).donePromise.then(()=>{const r=cu(),l=n.querySelectorAll(`style[ng-transition="${e}"]`);for(let u=0;u<l.length;u++)r.remove(l[u])})}},deps:[gI,Ri,Eo],multi:!0}];let eF=(()=>{class e{build(){return new XMLHttpRequest}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const uA=new xt("EventManagerPlugins");let hA=(()=>{class e{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(l=>{l.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,l){return this._findPluginFor(r).addEventListener(t,r,l)}addGlobalEventListener(t,r,l){return this._findPluginFor(r).addGlobalEventListener(t,r,l)}getZone(){return this._zone}_findPluginFor(t){const r=this._eventNameToPlugin.get(t);if(r)return r;const l=this._plugins;for(let u=0;u<l.length;u++){const g=l[u];if(g.supports(t))return this._eventNameToPlugin.set(t,g),g}throw new Error(`No event manager plugin found for event ${t}`)}}return e.\u0275fac=function(t){return new(t||e)(gt(uA),gt(ir))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();class _I{constructor(n){this._doc=n}addGlobalEventListener(n,t,r){const l=cu().getGlobalEventTarget(this._doc,n);if(!l)throw new Error(`Unsupported event target ${l} for event ${t}`);return this.addEventListener(l,t,r)}}let yI=(()=>{class e{constructor(){this.usageCount=new Map}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)0===this.changeUsageCount(r,-1)&&this.onStyleRemoved(r)}onStyleRemoved(t){}onStyleAdded(t){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(t,r){const l=this.usageCount;let u=l.get(t)??0;return u+=r,u>0?l.set(t,u):l.delete(t),u}ngOnDestroy(){for(const t of this.getAllStyles())this.onStyleRemoved(t);this.usageCount.clear()}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})(),w_=(()=>{class e extends yI{constructor(t){super(),this.doc=t,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.forEach(u=>u.remove()),r.delete(t)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}addStyleToHost(t,r){const l=this.doc.createElement("style");l.textContent=r,t.appendChild(l);const u=this.styleRef.get(r);u?u.push(l):this.styleRef.set(r,[l])}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const Mb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Db=/%COMP%/g,xI=new xt("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function bI(e,n){return n.flat(100).map(t=>t.replace(Db,e))}function wI(e){return n=>{if("__ngUnwrap__"===n)return e;!1===e(n)&&(n.preventDefault(),n.returnValue=!1)}}let Sb=(()=>{class e{constructor(t,r,l,u){this.eventManager=t,this.sharedStylesHost=r,this.appId=l,this.removeStylesOnCompDestory=u,this.rendererByCompId=new Map,this.defaultRenderer=new kb(t)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;const l=this.getOrCreateRenderer(t,r);return l instanceof II?l.applyToHost(t):l instanceof Pb&&l.applyStyles(),l}getOrCreateRenderer(t,r){const l=this.rendererByCompId;let u=l.get(r.id);if(!u){const g=this.eventManager,w=this.sharedStylesHost,I=this.removeStylesOnCompDestory;switch(r.encapsulation){case mo.Emulated:u=new II(g,w,r,this.appId,I);break;case mo.ShadowDom:return new aF(g,w,t,r);default:u=new Pb(g,w,r,I)}u.onDestroy=()=>l.delete(r.id),l.set(r.id,u)}return u}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return e.\u0275fac=function(t){return new(t||e)(gt(hA),gt(w_),gt(m_),gt(xI))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();class kb{constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,t){return t?document.createElementNS(Mb[t]||t,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,t){(CI(n)?n.content:n).appendChild(t)}insertBefore(n,t,r){n&&(CI(n)?n.content:n).insertBefore(t,r)}removeChild(n,t){n&&n.removeChild(t)}selectRootElement(n,t){let r="string"==typeof n?document.querySelector(n):n;if(!r)throw new Error(`The selector "${n}" did not match any elements`);return t||(r.textContent=""),r}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,t,r,l){if(l){t=l+":"+t;const u=Mb[l];u?n.setAttributeNS(u,t,r):n.setAttribute(t,r)}else n.setAttribute(t,r)}removeAttribute(n,t,r){if(r){const l=Mb[r];l?n.removeAttributeNS(l,t):n.removeAttribute(`${r}:${t}`)}else n.removeAttribute(t)}addClass(n,t){n.classList.add(t)}removeClass(n,t){n.classList.remove(t)}setStyle(n,t,r,l){l&(cr.DashCase|cr.Important)?n.style.setProperty(t,r,l&cr.Important?"important":""):n.style[t]=r}removeStyle(n,t,r){r&cr.DashCase?n.style.removeProperty(t):n.style[t]=""}setProperty(n,t,r){n[t]=r}setValue(n,t){n.nodeValue=t}listen(n,t,r){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,t,wI(r)):this.eventManager.addEventListener(n,t,wI(r))}}function CI(e){return"TEMPLATE"===e.tagName&&void 0!==e.content}class aF extends kb{constructor(n,t,r,l){super(n),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=bI(l.id,l.styles);for(const g of u){const w=document.createElement("style");w.textContent=g,this.shadowRoot.appendChild(w)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,t){return super.appendChild(this.nodeOrShadowRoot(n),t)}insertBefore(n,t,r){return super.insertBefore(this.nodeOrShadowRoot(n),t,r)}removeChild(n,t){return super.removeChild(this.nodeOrShadowRoot(n),t)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Pb extends kb{constructor(n,t,r,l,u=r.id){super(n),this.sharedStylesHost=t,this.removeStylesOnCompDestory=l,this.rendererUsageCount=0,this.styles=bI(u,r.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class II extends Pb{constructor(n,t,r,l,u){const g=l+"-"+r.id;super(n,t,r,u,g),this.contentAttr=function rF(e){return"_ngcontent-%COMP%".replace(Db,e)}(g),this.hostAttr=function oF(e){return"_nghost-%COMP%".replace(Db,e)}(g)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,t){const r=super.createElement(n,t);return super.setAttribute(r,this.contentAttr,""),r}}let lF=(()=>{class e extends _I{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,l){return t.addEventListener(r,l,!1),()=>this.removeEventListener(t,r,l)}removeEventListener(t,r,l){return t.removeEventListener(r,l)}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const TI=["alt","control","meta","shift"],cF={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},uF={alt:e=>e.altKey,control:e=>e.ctrlKey,meta:e=>e.metaKey,shift:e=>e.shiftKey};let hF=(()=>{class e extends _I{constructor(t){super(t)}supports(t){return null!=e.parseEventName(t)}addEventListener(t,r,l){const u=e.parseEventName(r),g=e.eventCallback(u.fullKey,l,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>cu().onAndCancel(t,u.domEventName,g))}static parseEventName(t){const r=t.toLowerCase().split("."),l=r.shift();if(0===r.length||"keydown"!==l&&"keyup"!==l)return null;const u=e._normalizeKey(r.pop());let g="",w=r.indexOf("code");if(w>-1&&(r.splice(w,1),g="code."),TI.forEach(S=>{const L=r.indexOf(S);L>-1&&(r.splice(L,1),g+=S+".")}),g+=u,0!=r.length||0===u.length)return null;const I={};return I.domEventName=l,I.fullKey=g,I}static matchEventFullKeyCode(t,r){let l=cF[t.key]||t.key,u="";return r.indexOf("code.")>-1&&(l=t.code,u="code."),!(null==l||!l)&&(l=l.toLowerCase()," "===l?l="space":"."===l&&(l="dot"),TI.forEach(g=>{g!==l&&(0,uF[g])(t)&&(u+=g+".")}),u+=l,u===r)}static eventCallback(t,r,l){return u=>{e.matchEventFullKeyCode(u,t)&&l.runGuarded(()=>r(u))}}static _normalizeKey(t){return"esc"===t?"escape":t}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const DI=[{provide:g_,useValue:cI},{provide:dC,useValue:function dF(){Tb.makeCurrent()},multi:!0},{provide:Ri,useFactory:function fF(){return function Pi(e){og=e}(document),document},deps:[]}],mF=wC(WP,"browser",DI),SI=new xt(""),kI=[{provide:qv,useClass:class YO{addToWindow(n){ti.getAngularTestability=(r,l=!0)=>{const u=n.findTestabilityInTree(r,l);if(null==u)throw new Error("Could not find testability for element.");return u},ti.getAllAngularTestabilities=()=>n.getAllTestabilities(),ti.getAllAngularRootElements=()=>n.getAllRootElements(),ti.frameworkStabilizers||(ti.frameworkStabilizers=[]),ti.frameworkStabilizers.push(r=>{const l=ti.getAllAngularTestabilities();let u=l.length,g=!1;const w=function(I){g=g||I,u--,0==u&&r(g)};l.forEach(function(I){I.whenStable(w)})})}findTestabilityInTree(n,t,r){return null==t?null:n.getTestability(t)??(r?cu().isShadowRoot(t)?this.findTestabilityInTree(n,t.host,!0):this.findTestabilityInTree(n,t.parentElement,!0):null)}},deps:[]},{provide:yC,useClass:Xx,deps:[ir,Kx,qv]},{provide:Xx,useClass:Xx,deps:[ir,Kx,qv]}],PI=[{provide:Eg,useValue:"root"},{provide:rl,useFactory:function pF(){return new rl},deps:[]},{provide:uA,useClass:lF,multi:!0,deps:[Ri,ir,g_]},{provide:uA,useClass:hF,multi:!0,deps:[Ri]},{provide:Sb,useClass:Sb,deps:[hA,w_,m_,xI]},{provide:Hy,useExisting:Sb},{provide:yI,useExisting:w_},{provide:w_,useClass:w_,deps:[Ri]},{provide:hA,useClass:hA,deps:[uA,ir]},{provide:hI,useClass:eF,deps:[]},[]];let gF=(()=>{class e{constructor(t){}static withServerTransition(t){return{ngModule:e,providers:[{provide:m_,useValue:t.appId},{provide:gI,useExisting:m_},JO]}}}return e.\u0275fac=function(t){return new(t||e)(gt(SI,12))},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({providers:[...PI,...kI],imports:[lI,ZP]}),e})(),RI=(()=>{class e{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:function(t){let r=null;return r=t?new t:function yF(){return new RI(gt(Ri))}(),r},providedIn:"root"}),e})();typeof window<"u"&&window;let E_=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(t){let r=null;return r=t?new(t||e):gt(LI),r},providedIn:"root"}),e})(),LI=(()=>{class e extends E_{constructor(t){super(),this._doc=t}sanitize(t,r){if(null==r)return null;switch(t){case Qn.NONE:return r;case Qn.HTML:return wo(r,"HTML")?bo(r):mg(this._doc,String(r)).toString();case Qn.STYLE:return wo(r,"Style")?bo(r):r;case Qn.SCRIPT:if(wo(r,"Script"))return bo(r);throw new Error("unsafe value used in a script context");case Qn.URL:return wo(r,"URL")?bo(r):rf(String(r));case Qn.RESOURCE_URL:if(wo(r,"ResourceURL"))return bo(r);throw new Error(`unsafe value used in a resource URL context (see ${os})`);default:throw new Error(`Unexpected SecurityContext ${t} (see ${os})`)}}bypassSecurityTrustHtml(t){return function ug(e){return new Pd(e)}(t)}bypassSecurityTrustStyle(t){return function L0(e){return new ag(e)}(t)}bypassSecurityTrustScript(t){return function hg(e){return new lg(e)}(t)}bypassSecurityTrustUrl(t){return function dg(e){return new cg(e)}(t)}bypassSecurityTrustResourceUrl(t){return function nf(e){return new O0(e)}(t)}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri))},e.\u0275prov=Tt({token:e,factory:function(t){let r=null;return r=t?new t:function wF(e){return new LI(e.get(Ri))}(gt(Eo)),r},providedIn:"root"}),e})();function Lt(...e){return xn(e,aa(e))}class fl extends rr{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const t=super._subscribe(n);return!t.closed&&n.next(this._value),t}getValue(){const{hasError:n,thrownError:t,_value:r}=this;if(n)throw t;return this._throwIfClosed(),r}next(n){super.next(this._value=n)}}const dA=$h(e=>function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}),{isArray:EF}=Array,{getPrototypeOf:CF,prototype:IF,keys:TF}=Object;function BI(e){if(1===e.length){const n=e[0];if(EF(n))return{args:n,keys:null};if(function MF(e){return e&&"object"==typeof e&&CF(e)===IF}(n)){const t=TF(n);return{args:t.map(r=>n[r]),keys:t}}}return{args:e,keys:null}}const{isArray:DF}=Array;function NI(e){return ht(n=>function SF(e,n){return DF(n)?e(...n):e(n)}(e,n))}function zI(e,n){return e.reduce((t,r,l)=>(t[r]=n[l],t),{})}function Fb(...e){const n=aa(e),t=xu(e),{args:r,keys:l}=BI(e);if(0===r.length)return xn([],n);const u=new fn(function kF(e,n,t=es){return r=>{VI(n,()=>{const{length:l}=e,u=new Array(l);let g=l,w=l;for(let I=0;I<l;I++)VI(n,()=>{const S=xn(e[I],n);let L=!1;S.subscribe(ei(r,j=>{u[I]=j,L||(L=!0,w--),w||r.next(t(u.slice()))},()=>{--g||r.complete()}))},r)},r)}}(r,n,l?g=>zI(l,g):es));return t?u.pipe(NI(t)):u}function VI(e,n,t){e?Wi(t,e,n):n()}function pA(...e){return function PF(){return Po(1)}()(xn(e,aa(e)))}function UI(e){return new fn(n=>{Ot(e()).subscribe(n)})}function Wf(e,n){const t=oi(e)?e:()=>e,r=l=>l.error(t());return new fn(n?l=>n.schedule(r,0,l):r)}function Lb(){return pi((e,n)=>{let t=null;e._refCount++;const r=ei(n,void 0,void 0,void 0,()=>{if(!e||e._refCount<=0||0<--e._refCount)return void(t=null);const l=e._connection,u=t;t=null,l&&(!u||l===u)&&l.unsubscribe(),n.unsubscribe()});e.subscribe(r),r.closed||(t=e.connect())})}class jI extends fn{constructor(n,t){super(),this.source=n,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,ts(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new je;const t=this.getSubject();n.add(this.source.subscribe(ei(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),n.closed&&(this._connection=null,n=je.EMPTY)}return n}refCount(){return Lb()(this)}}function ml(e,n){return pi((t,r)=>{let l=null,u=0,g=!1;const w=()=>g&&!l&&r.complete();t.subscribe(ei(r,I=>{l?.unsubscribe();let S=0;const L=u++;Ot(e(I,L)).subscribe(l=ei(r,j=>r.next(n?n(I,j,L,S++):j),()=>{l=null,w()}))},()=>{g=!0,w()}))})}function rp(e){return e<=0?()=>ns:pi((n,t)=>{let r=0;n.subscribe(ei(t,l=>{++r<=e&&(t.next(l),e<=r&&t.complete())}))})}function HI(...e){const n=aa(e);return pi((t,r)=>{(n?pA(e,t,n):pA(e,t)).subscribe(r)})}function nc(e,n){return pi((t,r)=>{let l=0;t.subscribe(ei(r,u=>e.call(n,u,l++)&&r.next(u)))})}function fA(e){return pi((n,t)=>{let r=!1;n.subscribe(ei(t,l=>{r=!0,t.next(l)},()=>{r||t.next(e),t.complete()}))})}function GI(e=RF){return pi((n,t)=>{let r=!1;n.subscribe(ei(t,l=>{r=!0,t.next(l)},()=>r?t.complete():t.error(e())))})}function RF(){return new dA}function Oh(e,n){const t=arguments.length>=2;return r=>r.pipe(e?nc((l,u)=>e(l,u,r)):es,rp(1),t?fA(n):GI(()=>new dA))}function Fh(e,n){return oi(n)?Vn(e,n,1):Vn(e,1)}function kr(e,n,t){const r=oi(e)||n||t?{next:e,error:n,complete:t}:e;return r?pi((l,u)=>{var g;null===(g=r.subscribe)||void 0===g||g.call(r);let w=!0;l.subscribe(ei(u,I=>{var S;null===(S=r.next)||void 0===S||S.call(r,I),u.next(I)},()=>{var I;w=!1,null===(I=r.complete)||void 0===I||I.call(r),u.complete()},I=>{var S;w=!1,null===(S=r.error)||void 0===S||S.call(r,I),u.error(I)},()=>{var I,S;w&&(null===(I=r.unsubscribe)||void 0===I||I.call(r)),null===(S=r.finalize)||void 0===S||S.call(r)}))}):es}function ic(e){return pi((n,t)=>{let u,r=null,l=!1;r=n.subscribe(ei(t,void 0,void 0,g=>{u=Ot(e(g,ic(e)(n))),r?(r.unsubscribe(),r=null,u.subscribe(t)):l=!0})),l&&(r.unsubscribe(),r=null,u.subscribe(t))})}function $I(e,n){return pi(function OF(e,n,t,r,l){return(u,g)=>{let w=t,I=n,S=0;u.subscribe(ei(g,L=>{const j=S++;I=w?e(I,L,j):(w=!0,L),r&&g.next(I)},l&&(()=>{w&&g.next(I),g.complete()})))}}(e,n,arguments.length>=2,!0))}function Bb(e){return e<=0?()=>ns:pi((n,t)=>{let r=[];n.subscribe(ei(t,l=>{r.push(l),e<r.length&&r.shift()},()=>{for(const l of r)t.next(l);t.complete()},void 0,()=>{r=null}))})}function qI(e,n){const t=arguments.length>=2;return r=>r.pipe(e?nc((l,u)=>e(l,u,r)):es,Bb(1),t?fA(n):GI(()=>new dA))}function mA(e){return pi((n,t)=>{try{n.subscribe(t)}finally{t.add(e)}})}const yn="primary",C_=Symbol("RouteTitle");class BF{constructor(n){this.params=n||{}}has(n){return Object.prototype.hasOwnProperty.call(this.params,n)}get(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t[0]:t}return null}getAll(n){if(this.has(n)){const t=this.params[n];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function Zf(e){return new BF(e)}function NF(e,n,t){const r=t.path.split("/");if(r.length>e.length||"full"===t.pathMatch&&(n.hasChildren()||r.length<e.length))return null;const l={};for(let u=0;u<r.length;u++){const g=r[u],w=e[u];if(g.startsWith(":"))l[g.substring(1)]=w;else if(g!==w.path)return null}return{consumed:e.slice(0,r.length),posParams:l}}function rc(e,n){const t=e?Object.keys(e):void 0,r=n?Object.keys(n):void 0;if(!t||!r||t.length!=r.length)return!1;let l;for(let u=0;u<t.length;u++)if(l=t[u],!WI(e[l],n[l]))return!1;return!0}function WI(e,n){if(Array.isArray(e)&&Array.isArray(n)){if(e.length!==n.length)return!1;const t=[...e].sort(),r=[...n].sort();return t.every((l,u)=>r[u]===l)}return e===n}function ZI(e){return Array.prototype.concat.apply([],e)}function QI(e){return e.length>0?e[e.length-1]:null}function lo(e,n){for(const t in e)e.hasOwnProperty(t)&&n(e[t],t)}function Lh(e){return Mr(e)?e:li(e)?xn(Promise.resolve(e)):Lt(e)}const gA=!1,VF={exact:function JI(e,n,t){if(!op(e.segments,n.segments)||!_A(e.segments,n.segments,t)||e.numberOfChildren!==n.numberOfChildren)return!1;for(const r in n.children)if(!e.children[r]||!JI(e.children[r],n.children[r],t))return!1;return!0},subset:YI},XI={exact:function UF(e,n){return rc(e,n)},subset:function jF(e,n){return Object.keys(n).length<=Object.keys(e).length&&Object.keys(n).every(t=>WI(e[t],n[t]))},ignored:()=>!0};function KI(e,n,t){return VF[t.paths](e.root,n.root,t.matrixParams)&&XI[t.queryParams](e.queryParams,n.queryParams)&&!("exact"===t.fragment&&e.fragment!==n.fragment)}function YI(e,n,t){return eT(e,n,n.segments,t)}function eT(e,n,t,r){if(e.segments.length>t.length){const l=e.segments.slice(0,t.length);return!(!op(l,t)||n.hasChildren()||!_A(l,t,r))}if(e.segments.length===t.length){if(!op(e.segments,t)||!_A(e.segments,t,r))return!1;for(const l in n.children)if(!e.children[l]||!YI(e.children[l],n.children[l],r))return!1;return!0}{const l=t.slice(0,e.segments.length),u=t.slice(e.segments.length);return!!(op(e.segments,l)&&_A(e.segments,l,r)&&e.children[yn])&&eT(e.children[yn],n,u,r)}}function _A(e,n,t){return n.every((r,l)=>XI[t](e[l].parameters,r.parameters))}class Bh{constructor(n=new Mn([],{}),t={},r=null){this.root=n,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Zf(this.queryParams)),this._queryParamMap}toString(){return $F.serialize(this)}}class Mn{constructor(n,t){this.segments=n,this.children=t,this.parent=null,lo(t,(r,l)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return yA(this)}}class I_{constructor(n,t){this.path=n,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=Zf(this.parameters)),this._parameterMap}toString(){return iT(this)}}function op(e,n){return e.length===n.length&&e.every((t,r)=>t.path===n[r].path)}let T_=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return new Nb},providedIn:"root"}),e})();class Nb{parse(n){const t=new eL(n);return new Bh(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(n){const t=`/${M_(n.root,!0)}`,r=function ZF(e){const n=Object.keys(e).map(t=>{const r=e[t];return Array.isArray(r)?r.map(l=>`${vA(t)}=${vA(l)}`).join("&"):`${vA(t)}=${vA(r)}`}).filter(t=>!!t);return n.length?`?${n.join("&")}`:""}(n.queryParams);return`${t}${r}${"string"==typeof n.fragment?`#${function qF(e){return encodeURI(e)}(n.fragment)}`:""}`}}const $F=new Nb;function yA(e){return e.segments.map(n=>iT(n)).join("/")}function M_(e,n){if(!e.hasChildren())return yA(e);if(n){const t=e.children[yn]?M_(e.children[yn],!1):"",r=[];return lo(e.children,(l,u)=>{u!==yn&&r.push(`${u}:${M_(l,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function GF(e,n){let t=[];return lo(e.children,(r,l)=>{l===yn&&(t=t.concat(n(r,l)))}),lo(e.children,(r,l)=>{l!==yn&&(t=t.concat(n(r,l)))}),t}(e,(r,l)=>l===yn?[M_(e.children[yn],!1)]:[`${l}:${M_(r,!1)}`]);return 1===Object.keys(e.children).length&&null!=e.children[yn]?`${yA(e)}/${t[0]}`:`${yA(e)}/(${t.join("//")})`}}function tT(e){return encodeURIComponent(e).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function vA(e){return tT(e).replace(/%3B/gi,";")}function zb(e){return tT(e).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function AA(e){return decodeURIComponent(e)}function nT(e){return AA(e.replace(/\+/g,"%20"))}function iT(e){return`${zb(e.path)}${function WF(e){return Object.keys(e).map(n=>`;${zb(n)}=${zb(e[n])}`).join("")}(e.parameters)}`}const QF=/^[^\/()?;=#]+/;function xA(e){const n=e.match(QF);return n?n[0]:""}const XF=/^[^=?&#]+/,JF=/^[^&#]+/;class eL{constructor(n){this.url=n,this.remaining=n}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Mn([],{}):new Mn([],this.parseChildren())}parseQueryParams(){const n={};if(this.consumeOptional("?"))do{this.parseQueryParam(n)}while(this.consumeOptional("&"));return n}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const n=[];for(this.peekStartsWith("(")||n.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),n.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(n.length>0||Object.keys(t).length>0)&&(r[yn]=new Mn(n,t)),r}parseSegment(){const n=xA(this.remaining);if(""===n&&this.peekStartsWith(";"))throw new st(4009,gA);return this.capture(n),new I_(AA(n),this.parseMatrixParams())}parseMatrixParams(){const n={};for(;this.consumeOptional(";");)this.parseParam(n);return n}parseParam(n){const t=xA(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const l=xA(this.remaining);l&&(r=l,this.capture(r))}n[AA(t)]=AA(r)}parseQueryParam(n){const t=function KF(e){const n=e.match(XF);return n?n[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const g=function YF(e){const n=e.match(JF);return n?n[0]:""}(this.remaining);g&&(r=g,this.capture(r))}const l=nT(t),u=nT(r);if(n.hasOwnProperty(l)){let g=n[l];Array.isArray(g)||(g=[g],n[l]=g),g.push(u)}else n[l]=u}parseParens(n){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=xA(this.remaining),l=this.remaining[r.length];if("/"!==l&&")"!==l&&";"!==l)throw new st(4010,gA);let u;r.indexOf(":")>-1?(u=r.slice(0,r.indexOf(":")),this.capture(u),this.capture(":")):n&&(u=yn);const g=this.parseChildren();t[u]=1===Object.keys(g).length?g[yn]:new Mn([],g),this.consumeOptional("//")}return t}peekStartsWith(n){return this.remaining.startsWith(n)}consumeOptional(n){return!!this.peekStartsWith(n)&&(this.remaining=this.remaining.substring(n.length),!0)}capture(n){if(!this.consumeOptional(n))throw new st(4011,gA)}}function Vb(e){return e.segments.length>0?new Mn([],{[yn]:e}):e}function bA(e){const n={};for(const r of Object.keys(e.children)){const u=bA(e.children[r]);(u.segments.length>0||u.hasChildren())&&(n[r]=u)}return function tL(e){if(1===e.numberOfChildren&&e.children[yn]){const n=e.children[yn];return new Mn(e.segments.concat(n.segments),n.children)}return e}(new Mn(e.segments,n))}function sp(e){return e instanceof Bh}const Ub=!1;function nL(e,n,t,r,l){if(0===t.length)return Qf(n.root,n.root,n.root,r,l);const u=function lT(e){if("string"==typeof e[0]&&1===e.length&&"/"===e[0])return new aT(!0,0,e);let n=0,t=!1;const r=e.reduce((l,u,g)=>{if("object"==typeof u&&null!=u){if(u.outlets){const w={};return lo(u.outlets,(I,S)=>{w[S]="string"==typeof I?I.split("/"):I}),[...l,{outlets:w}]}if(u.segmentPath)return[...l,u.segmentPath]}return"string"!=typeof u?[...l,u]:0===g?(u.split("/").forEach((w,I)=>{0==I&&"."===w||(0==I&&""===w?t=!0:".."===w?n++:""!=w&&l.push(w))}),l):[...l,u]},[]);return new aT(t,n,r)}(t);return u.toRoot()?Qf(n.root,n.root,new Mn([],{}),r,l):function g(I){const S=function rL(e,n,t,r){if(e.isAbsolute)return new Xf(n.root,!0,0);if(-1===r)return new Xf(t,t===n.root,0);return function cT(e,n,t){let r=e,l=n,u=t;for(;u>l;){if(u-=l,r=r.parent,!r)throw new st(4005,Ub&&"Invalid number of '../'");l=r.segments.length}return new Xf(r,!1,l-u)}(t,r+(D_(e.commands[0])?0:1),e.numberOfDoubleDots)}(u,n,e.snapshot?._urlSegment,I),L=S.processChildren?Kf(S.segmentGroup,S.index,u.commands):jb(S.segmentGroup,S.index,u.commands);return Qf(n.root,S.segmentGroup,L,r,l)}(e.snapshot?._lastPathIndex)}function D_(e){return"object"==typeof e&&null!=e&&!e.outlets&&!e.segmentPath}function S_(e){return"object"==typeof e&&null!=e&&e.outlets}function Qf(e,n,t,r,l){let g,u={};r&&lo(r,(I,S)=>{u[S]=Array.isArray(I)?I.map(L=>`${L}`):`${I}`}),g=e===n?t:sT(e,n,t);const w=Vb(bA(g));return new Bh(w,u,l)}function sT(e,n,t){const r={};return lo(e.children,(l,u)=>{r[u]=l===n?t:sT(l,n,t)}),new Mn(e.segments,r)}class aT{constructor(n,t,r){if(this.isAbsolute=n,this.numberOfDoubleDots=t,this.commands=r,n&&r.length>0&&D_(r[0]))throw new st(4003,Ub&&"Root segment cannot have matrix parameters");const l=r.find(S_);if(l&&l!==QI(r))throw new st(4004,Ub&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Xf{constructor(n,t,r){this.segmentGroup=n,this.processChildren=t,this.index=r}}function jb(e,n,t){if(e||(e=new Mn([],{})),0===e.segments.length&&e.hasChildren())return Kf(e,n,t);const r=function sL(e,n,t){let r=0,l=n;const u={match:!1,pathIndex:0,commandIndex:0};for(;l<e.segments.length;){if(r>=t.length)return u;const g=e.segments[l],w=t[r];if(S_(w))break;const I=`${w}`,S=r<t.length-1?t[r+1]:null;if(l>0&&void 0===I)break;if(I&&S&&"object"==typeof S&&void 0===S.outlets){if(!hT(I,S,g))return u;r+=2}else{if(!hT(I,{},g))return u;r++}l++}return{match:!0,pathIndex:l,commandIndex:r}}(e,n,t),l=t.slice(r.commandIndex);if(r.match&&r.pathIndex<e.segments.length){const u=new Mn(e.segments.slice(0,r.pathIndex),{});return u.children[yn]=new Mn(e.segments.slice(r.pathIndex),e.children),Kf(u,0,l)}return r.match&&0===l.length?new Mn(e.segments,{}):r.match&&!e.hasChildren()?Hb(e,n,t):r.match?Kf(e,0,l):Hb(e,n,t)}function Kf(e,n,t){if(0===t.length)return new Mn(e.segments,{});{const r=function oL(e){return S_(e[0])?e[0].outlets:{[yn]:e}}(t),l={};if(!r[yn]&&e.children[yn]&&1===e.numberOfChildren&&0===e.children[yn].segments.length){const u=Kf(e.children[yn],n,t);return new Mn(e.segments,u.children)}return lo(r,(u,g)=>{"string"==typeof u&&(u=[u]),null!==u&&(l[g]=jb(e.children[g],n,u))}),lo(e.children,(u,g)=>{void 0===r[g]&&(l[g]=u)}),new Mn(e.segments,l)}}function Hb(e,n,t){const r=e.segments.slice(0,n);let l=0;for(;l<t.length;){const u=t[l];if(S_(u)){const I=aL(u.outlets);return new Mn(r,I)}if(0===l&&D_(t[0])){r.push(new I_(e.segments[n].path,uT(t[0]))),l++;continue}const g=S_(u)?u.outlets[yn]:`${u}`,w=l<t.length-1?t[l+1]:null;g&&w&&D_(w)?(r.push(new I_(g,uT(w))),l+=2):(r.push(new I_(g,{})),l++)}return new Mn(r,{})}function aL(e){const n={};return lo(e,(t,r)=>{"string"==typeof t&&(t=[t]),null!==t&&(n[r]=Hb(new Mn([],{}),0,t))}),n}function uT(e){const n={};return lo(e,(t,r)=>n[r]=`${t}`),n}function hT(e,n,t){return e==t.path&&rc(n,t.parameters)}const k_="imperative";class oc{constructor(n,t){this.id=n,this.url=t}}class Gb extends oc{constructor(n,t,r="imperative",l=null){super(n,t),this.type=0,this.navigationTrigger=r,this.restoredState=l}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class ap extends oc{constructor(n,t,r){super(n,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class wA extends oc{constructor(n,t,r,l){super(n,t),this.reason=r,this.code=l,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class EA extends oc{constructor(n,t,r,l){super(n,t),this.reason=r,this.code=l,this.type=16}}class $b extends oc{constructor(n,t,r,l){super(n,t),this.error=r,this.target=l,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class lL extends oc{constructor(n,t,r,l){super(n,t),this.urlAfterRedirects=r,this.state=l,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class cL extends oc{constructor(n,t,r,l){super(n,t),this.urlAfterRedirects=r,this.state=l,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class uL extends oc{constructor(n,t,r,l,u){super(n,t),this.urlAfterRedirects=r,this.state=l,this.shouldActivate=u,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class hL extends oc{constructor(n,t,r,l){super(n,t),this.urlAfterRedirects=r,this.state=l,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class dL extends oc{constructor(n,t,r,l){super(n,t),this.urlAfterRedirects=r,this.state=l,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class pL{constructor(n){this.route=n,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class fL{constructor(n){this.route=n,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class mL{constructor(n){this.snapshot=n,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class gL{constructor(n){this.snapshot=n,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _L{constructor(n){this.snapshot=n,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yL{constructor(n){this.snapshot=n,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dT{constructor(n,t,r){this.routerEvent=n,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let xL=(()=>{class e{createUrlTree(t,r,l,u,g,w){return nL(t||r.root,l,u,g,w)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})(),wL=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(n){return xL.\u0275fac(n)},providedIn:"root"}),e})();class pT{constructor(n){this._root=n}get root(){return this._root.value}parent(n){const t=this.pathFromRoot(n);return t.length>1?t[t.length-2]:null}children(n){const t=qb(n,this._root);return t?t.children.map(r=>r.value):[]}firstChild(n){const t=qb(n,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(n){const t=Wb(n,this._root);return t.length<2?[]:t[t.length-2].children.map(l=>l.value).filter(l=>l!==n)}pathFromRoot(n){return Wb(n,this._root).map(t=>t.value)}}function qb(e,n){if(e===n.value)return n;for(const t of n.children){const r=qb(e,t);if(r)return r}return null}function Wb(e,n){if(e===n.value)return[n];for(const t of n.children){const r=Wb(e,t);if(r.length)return r.unshift(n),r}return[]}class du{constructor(n,t){this.value=n,this.children=t}toString(){return`TreeNode(${this.value})`}}function Jf(e){const n={};return e&&e.children.forEach(t=>n[t.value.outlet]=t),n}class fT extends pT{constructor(n,t){super(n),this.snapshot=t,Zb(this,n)}toString(){return this.snapshot.toString()}}function mT(e,n){const t=function EL(e,n){const g=new CA([],{},{},"",{},yn,n,null,e.root,-1,{});return new _T("",new du(g,[]))}(e,n),r=new fl([new I_("",{})]),l=new fl({}),u=new fl({}),g=new fl({}),w=new fl(""),I=new Nh(r,l,g,w,u,yn,n,t.root);return I.snapshot=t.root,new fT(new du(I,[]),t)}class Nh{constructor(n,t,r,l,u,g,w,I){this.url=n,this.params=t,this.queryParams=r,this.fragment=l,this.data=u,this.outlet=g,this.component=w,this.title=this.data?.pipe(ht(S=>S[C_]))??Lt(void 0),this._futureSnapshot=I}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(ht(n=>Zf(n)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(ht(n=>Zf(n)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function gT(e,n="emptyOnly"){const t=e.pathFromRoot;let r=0;if("always"!==n)for(r=t.length-1;r>=1;){const l=t[r],u=t[r-1];if(l.routeConfig&&""===l.routeConfig.path)r--;else{if(u.component)break;r--}}return function CL(e){return e.reduce((n,t)=>({params:{...n.params,...t.params},data:{...n.data,...t.data},resolve:{...t.data,...n.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class CA{get title(){return this.data?.[C_]}constructor(n,t,r,l,u,g,w,I,S,L,j){this.url=n,this.params=t,this.queryParams=r,this.fragment=l,this.data=u,this.outlet=g,this.component=w,this.routeConfig=I,this._urlSegment=S,this._lastPathIndex=L,this._resolve=j}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=Zf(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=Zf(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class _T extends pT{constructor(n,t){super(t),this.url=n,Zb(this,t)}toString(){return yT(this._root)}}function Zb(e,n){n.value._routerState=e,n.children.forEach(t=>Zb(e,t))}function yT(e){const n=e.children.length>0?` { ${e.children.map(yT).join(", ")} } `:"";return`${e.value}${n}`}function Qb(e){if(e.snapshot){const n=e.snapshot,t=e._futureSnapshot;e.snapshot=t,rc(n.queryParams,t.queryParams)||e.queryParams.next(t.queryParams),n.fragment!==t.fragment&&e.fragment.next(t.fragment),rc(n.params,t.params)||e.params.next(t.params),function zF(e,n){if(e.length!==n.length)return!1;for(let t=0;t<e.length;++t)if(!rc(e[t],n[t]))return!1;return!0}(n.url,t.url)||e.url.next(t.url),rc(n.data,t.data)||e.data.next(t.data)}else e.snapshot=e._futureSnapshot,e.data.next(e._futureSnapshot.data)}function Xb(e,n){const t=rc(e.params,n.params)&&function HF(e,n){return op(e,n)&&e.every((t,r)=>rc(t.parameters,n[r].parameters))}(e.url,n.url);return t&&!(!e.parent!=!n.parent)&&(!e.parent||Xb(e.parent,n.parent))}function P_(e,n,t){if(t&&e.shouldReuseRoute(n.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=n.value;const l=function TL(e,n,t){return n.children.map(r=>{for(const l of t.children)if(e.shouldReuseRoute(r.value,l.value.snapshot))return P_(e,r,l);return P_(e,r)})}(e,n,t);return new du(r,l)}{if(e.shouldAttach(n.value)){const u=e.retrieve(n.value);if(null!==u){const g=u.route;return g.value._futureSnapshot=n.value,g.children=n.children.map(w=>P_(e,w)),g}}const r=function ML(e){return new Nh(new fl(e.url),new fl(e.params),new fl(e.queryParams),new fl(e.fragment),new fl(e.data),e.outlet,e.component,e)}(n.value),l=n.children.map(u=>P_(e,u));return new du(r,l)}}const Kb="ngNavigationCancelingError";function vT(e,n){const{redirectTo:t,navigationBehaviorOptions:r}=sp(n)?{redirectTo:n,navigationBehaviorOptions:void 0}:n,l=AT(!1,0,n);return l.url=t,l.navigationBehaviorOptions=r,l}function AT(e,n,t){const r=new Error("NavigationCancelingError: "+(e||""));return r[Kb]=!0,r.cancellationCode=n,t&&(r.url=t),r}function xT(e){return bT(e)&&sp(e.url)}function bT(e){return e&&e[Kb]}class DL{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new R_,this.attachRef=null}}let R_=(()=>{class e{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const l=this.getOrCreateContext(t);l.outlet=r,this.contexts.set(t,l)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new DL,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const IA=!1;let Jb=(()=>{class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=yn,this.activateEvents=new ri,this.deactivateEvents=new ri,this.attachEvents=new ri,this.detachEvents=new ri,this.parentContexts=Wt(R_),this.location=Wt(ul),this.changeDetector=Wt($f),this.environmentInjector=Wt(Ea)}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:l}=t.name;if(r)return;this.isTrackedInParentContexts(l)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(l)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new st(4012,IA);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new st(4012,IA);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new st(4012,IA);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new st(4013,IA);this._activatedRoute=t;const l=this.location,g=t.snapshot.component,w=this.parentContexts.getOrCreateContext(this.name).children,I=new SL(t,w,l.injector);if(r&&function kL(e){return!!e.resolveComponentFactory}(r)){const S=r.resolveComponentFactory(g);this.activated=l.createComponent(S,l.length,I)}else this.activated=l.createComponent(g,{index:l.length,injector:I,environmentInjector:r??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Nt({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Hi]}),e})();class SL{constructor(n,t,r){this.route=n,this.childContexts=t,this.parent=r}get(n,t){return n===Nh?this.route:n===R_?this.childContexts:this.parent.get(n,t)}}let Yb=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vr({type:e,selectors:[["ng-component"]],standalone:!0,features:[TE],decls:1,vars:0,template:function(t,r){1&t&&Dt(0,"router-outlet")},dependencies:[Jb],encapsulation:2}),e})();function wT(e,n){return e.providers&&!e._injector&&(e._injector=Nv(e.providers,n,`Route: ${e.path}`)),e._injector??n}function tw(e){const n=e.children&&e.children.map(tw),t=n?{...e,children:n}:{...e};return!t.component&&!t.loadComponent&&(n||t.loadChildren)&&t.outlet&&t.outlet!==yn&&(t.component=Yb),t}function Sa(e){return e.outlet||yn}function ET(e,n){const t=e.filter(r=>Sa(r)===n);return t.push(...e.filter(r=>Sa(r)!==n)),t}function O_(e){if(!e)return null;if(e.routeConfig?._injector)return e.routeConfig._injector;for(let n=e.parent;n;n=n.parent){const t=n.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class LL{constructor(n,t,r,l){this.routeReuseStrategy=n,this.futureState=t,this.currState=r,this.forwardEvent=l}activate(n){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,n),Qb(this.futureState.root),this.activateChildRoutes(t,r,n)}deactivateChildRoutes(n,t,r){const l=Jf(t);n.children.forEach(u=>{const g=u.value.outlet;this.deactivateRoutes(u,l[g],r),delete l[g]}),lo(l,(u,g)=>{this.deactivateRouteAndItsChildren(u,r)})}deactivateRoutes(n,t,r){const l=n.value,u=t?t.value:null;if(l===u)if(l.component){const g=r.getContext(l.outlet);g&&this.deactivateChildRoutes(n,t,g.children)}else this.deactivateChildRoutes(n,t,r);else u&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(n,t){n.value.component&&this.routeReuseStrategy.shouldDetach(n.value.snapshot)?this.detachAndStoreRouteSubtree(n,t):this.deactivateRouteAndOutlet(n,t)}detachAndStoreRouteSubtree(n,t){const r=t.getContext(n.value.outlet),l=r&&n.value.component?r.children:t,u=Jf(n);for(const g of Object.keys(u))this.deactivateRouteAndItsChildren(u[g],l);if(r&&r.outlet){const g=r.outlet.detach(),w=r.children.onOutletDeactivated();this.routeReuseStrategy.store(n.value.snapshot,{componentRef:g,route:n,contexts:w})}}deactivateRouteAndOutlet(n,t){const r=t.getContext(n.value.outlet),l=r&&n.value.component?r.children:t,u=Jf(n);for(const g of Object.keys(u))this.deactivateRouteAndItsChildren(u[g],l);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(n,t,r){const l=Jf(t);n.children.forEach(u=>{this.activateRoutes(u,l[u.value.outlet],r),this.forwardEvent(new yL(u.value.snapshot))}),n.children.length&&this.forwardEvent(new gL(n.value.snapshot))}activateRoutes(n,t,r){const l=n.value,u=t?t.value:null;if(Qb(l),l===u)if(l.component){const g=r.getOrCreateContext(l.outlet);this.activateChildRoutes(n,t,g.children)}else this.activateChildRoutes(n,t,r);else if(l.component){const g=r.getOrCreateContext(l.outlet);if(this.routeReuseStrategy.shouldAttach(l.snapshot)){const w=this.routeReuseStrategy.retrieve(l.snapshot);this.routeReuseStrategy.store(l.snapshot,null),g.children.onOutletReAttached(w.contexts),g.attachRef=w.componentRef,g.route=w.route.value,g.outlet&&g.outlet.attach(w.componentRef,w.route.value),Qb(w.route.value),this.activateChildRoutes(n,null,g.children)}else{const w=O_(l.snapshot),I=w?.get(yh)??null;g.attachRef=null,g.route=l,g.resolver=I,g.injector=w,g.outlet&&g.outlet.activateWith(l,g.injector),this.activateChildRoutes(n,null,g.children)}}else this.activateChildRoutes(n,null,r)}}class CT{constructor(n){this.path=n,this.route=this.path[this.path.length-1]}}class TA{constructor(n,t){this.component=n,this.route=t}}function BL(e,n,t){const r=e._root;return F_(r,n?n._root:null,t,[r.value])}function Yf(e,n){const t=Symbol(),r=n.get(e,t);return r===t?"function"!=typeof e||function _m(e){return null!==Ua(e)}(e)?n.get(e):e:r}function F_(e,n,t,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=Jf(n);return e.children.forEach(g=>{(function zL(e,n,t,r,l={canDeactivateChecks:[],canActivateChecks:[]}){const u=e.value,g=n?n.value:null,w=t?t.getContext(e.value.outlet):null;if(g&&u.routeConfig===g.routeConfig){const I=function VL(e,n,t){if("function"==typeof t)return t(e,n);switch(t){case"pathParamsChange":return!op(e.url,n.url);case"pathParamsOrQueryParamsChange":return!op(e.url,n.url)||!rc(e.queryParams,n.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Xb(e,n)||!rc(e.queryParams,n.queryParams);default:return!Xb(e,n)}}(g,u,u.routeConfig.runGuardsAndResolvers);I?l.canActivateChecks.push(new CT(r)):(u.data=g.data,u._resolvedData=g._resolvedData),F_(e,n,u.component?w?w.children:null:t,r,l),I&&w&&w.outlet&&w.outlet.isActivated&&l.canDeactivateChecks.push(new TA(w.outlet.component,g))}else g&&L_(n,w,l),l.canActivateChecks.push(new CT(r)),F_(e,null,u.component?w?w.children:null:t,r,l)})(g,u[g.value.outlet],t,r.concat([g.value]),l),delete u[g.value.outlet]}),lo(u,(g,w)=>L_(g,t.getContext(w),l)),l}function L_(e,n,t){const r=Jf(e),l=e.value;lo(r,(u,g)=>{L_(u,l.component?n?n.children.getContext(g):null:n,t)}),t.canDeactivateChecks.push(new TA(l.component&&n&&n.outlet&&n.outlet.isActivated?n.outlet.component:null,l))}function B_(e){return"function"==typeof e}function nw(e){return e instanceof dA||"EmptyError"===e?.name}const MA=Symbol("INITIAL_VALUE");function em(){return ml(e=>Fb(e.map(n=>n.pipe(rp(1),HI(MA)))).pipe(ht(n=>{for(const t of n)if(!0!==t){if(t===MA)return MA;if(!1===t||t instanceof Bh)return t}return!0}),nc(n=>n!==MA),rp(1)))}function IT(e){return function un(...e){return Fa(e)}(kr(n=>{if(sp(n))throw vT(0,n)}),ht(n=>!0===n))}const iw={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function TT(e,n,t,r,l){const u=rw(e,n,t);return u.matched?function iB(e,n,t,r){const l=n.canMatch;return l&&0!==l.length?Lt(l.map(g=>{const w=Yf(g,e);return Lh(function qL(e){return e&&B_(e.canMatch)}(w)?w.canMatch(n,t):e.runInContext(()=>w(n,t)))})).pipe(em(),IT()):Lt(!0)}(r=wT(n,r),n,t).pipe(ht(g=>!0===g?u:{...iw})):Lt(u)}function rw(e,n,t){if(""===n.path)return"full"===n.pathMatch&&(e.hasChildren()||t.length>0)?{...iw}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const l=(n.matcher||NF)(t,e,n);if(!l)return{...iw};const u={};lo(l.posParams,(w,I)=>{u[I]=w.path});const g=l.consumed.length>0?{...u,...l.consumed[l.consumed.length-1].parameters}:u;return{matched:!0,consumedSegments:l.consumed,remainingSegments:t.slice(l.consumed.length),parameters:g,positionalParamSegments:l.posParams??{}}}function DA(e,n,t,r){if(t.length>0&&function sB(e,n,t){return t.some(r=>SA(e,n,r)&&Sa(r)!==yn)}(e,t,r)){const u=new Mn(n,function oB(e,n,t,r){const l={};l[yn]=r,r._sourceSegment=e,r._segmentIndexShift=n.length;for(const u of t)if(""===u.path&&Sa(u)!==yn){const g=new Mn([],{});g._sourceSegment=e,g._segmentIndexShift=n.length,l[Sa(u)]=g}return l}(e,n,r,new Mn(t,e.children)));return u._sourceSegment=e,u._segmentIndexShift=n.length,{segmentGroup:u,slicedSegments:[]}}if(0===t.length&&function aB(e,n,t){return t.some(r=>SA(e,n,r))}(e,t,r)){const u=new Mn(e.segments,function rB(e,n,t,r,l){const u={};for(const g of r)if(SA(e,t,g)&&!l[Sa(g)]){const w=new Mn([],{});w._sourceSegment=e,w._segmentIndexShift=n.length,u[Sa(g)]=w}return{...l,...u}}(e,n,t,r,e.children));return u._sourceSegment=e,u._segmentIndexShift=n.length,{segmentGroup:u,slicedSegments:t}}const l=new Mn(e.segments,e.children);return l._sourceSegment=e,l._segmentIndexShift=n.length,{segmentGroup:l,slicedSegments:t}}function SA(e,n,t){return(!(e.hasChildren()||n.length>0)||"full"!==t.pathMatch)&&""===t.path}function MT(e,n,t,r){return!!(Sa(e)===r||r!==yn&&SA(n,t,e))&&("**"===e.path||rw(n,e,t).matched)}function DT(e,n,t){return 0===n.length&&!e.children[t]}const kA=!1;class PA{constructor(n){this.segmentGroup=n||null}}class ST{constructor(n){this.urlTree=n}}function N_(e){return Wf(new PA(e))}function kT(e){return Wf(new ST(e))}class hB{constructor(n,t,r,l,u){this.injector=n,this.configLoader=t,this.urlSerializer=r,this.urlTree=l,this.config=u,this.allowRedirects=!0}apply(){const n=DA(this.urlTree.root,[],[],this.config).segmentGroup,t=new Mn(n.segments,n.children);return this.expandSegmentGroup(this.injector,this.config,t,yn).pipe(ht(u=>this.createUrlTree(bA(u),this.urlTree.queryParams,this.urlTree.fragment))).pipe(ic(u=>{if(u instanceof ST)return this.allowRedirects=!1,this.match(u.urlTree);throw u instanceof PA?this.noMatchError(u):u}))}match(n){return this.expandSegmentGroup(this.injector,this.config,n.root,yn).pipe(ht(l=>this.createUrlTree(bA(l),n.queryParams,n.fragment))).pipe(ic(l=>{throw l instanceof PA?this.noMatchError(l):l}))}noMatchError(n){return new st(4002,kA)}createUrlTree(n,t,r){const l=Vb(n);return new Bh(l,t,r)}expandSegmentGroup(n,t,r,l){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(n,t,r).pipe(ht(u=>new Mn([],u))):this.expandSegment(n,r,t,r.segments,l,!0)}expandChildren(n,t,r){const l=[];for(const u of Object.keys(r.children))"primary"===u?l.unshift(u):l.push(u);return xn(l).pipe(Fh(u=>{const g=r.children[u],w=ET(t,u);return this.expandSegmentGroup(n,w,g,u).pipe(ht(I=>({segment:I,outlet:u})))}),$I((u,g)=>(u[g.outlet]=g.segment,u),{}),qI())}expandSegment(n,t,r,l,u,g){return xn(r).pipe(Fh(w=>this.expandSegmentAgainstRoute(n,t,r,w,l,u,g).pipe(ic(S=>{if(S instanceof PA)return Lt(null);throw S}))),Oh(w=>!!w),ic((w,I)=>{if(nw(w))return DT(t,l,u)?Lt(new Mn([],{})):N_(t);throw w}))}expandSegmentAgainstRoute(n,t,r,l,u,g,w){return MT(l,t,u,g)?void 0===l.redirectTo?this.matchSegmentAgainstRoute(n,t,l,u,g):w&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(n,t,r,l,u,g):N_(t):N_(t)}expandSegmentAgainstRouteUsingRedirect(n,t,r,l,u,g){return"**"===l.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(n,r,l,g):this.expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,l,u,g)}expandWildCardWithParamsAgainstRouteUsingRedirect(n,t,r,l){const u=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?kT(u):this.lineralizeSegments(r,u).pipe(Vn(g=>{const w=new Mn(g,{});return this.expandSegment(n,w,t,g,l,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(n,t,r,l,u,g){const{matched:w,consumedSegments:I,remainingSegments:S,positionalParamSegments:L}=rw(t,l,u);if(!w)return N_(t);const j=this.applyRedirectCommands(I,l.redirectTo,L);return l.redirectTo.startsWith("/")?kT(j):this.lineralizeSegments(l,j).pipe(Vn(ne=>this.expandSegment(n,t,r,ne.concat(S),g,!1)))}matchSegmentAgainstRoute(n,t,r,l,u){return"**"===r.path?(n=wT(r,n),r.loadChildren?(r._loadedRoutes?Lt({routes:r._loadedRoutes,injector:r._loadedInjector}):this.configLoader.loadChildren(n,r)).pipe(ht(w=>(r._loadedRoutes=w.routes,r._loadedInjector=w.injector,new Mn(l,{})))):Lt(new Mn(l,{}))):TT(t,r,l,n).pipe(ml(({matched:g,consumedSegments:w,remainingSegments:I})=>g?this.getChildConfig(n=r._injector??n,r,l).pipe(Vn(L=>{const j=L.injector??n,ne=L.routes,{segmentGroup:se,slicedSegments:he}=DA(t,w,I,ne),Ie=new Mn(se.segments,se.children);if(0===he.length&&Ie.hasChildren())return this.expandChildren(j,ne,Ie).pipe(ht(Ke=>new Mn(w,Ke)));if(0===ne.length&&0===he.length)return Lt(new Mn(w,{}));const Ue=Sa(r)===u;return this.expandSegment(j,Ie,ne,he,Ue?yn:u,!0).pipe(ht(_t=>new Mn(w.concat(_t.segments),_t.children)))})):N_(t)))}getChildConfig(n,t,r){return t.children?Lt({routes:t.children,injector:n}):t.loadChildren?void 0!==t._loadedRoutes?Lt({routes:t._loadedRoutes,injector:t._loadedInjector}):function nB(e,n,t,r){const l=n.canLoad;return void 0===l||0===l.length?Lt(!0):Lt(l.map(g=>{const w=Yf(g,e);return Lh(function jL(e){return e&&B_(e.canLoad)}(w)?w.canLoad(n,t):e.runInContext(()=>w(n,t)))})).pipe(em(),IT())}(n,t,r).pipe(Vn(l=>l?this.configLoader.loadChildren(n,t).pipe(kr(u=>{t._loadedRoutes=u.routes,t._loadedInjector=u.injector})):function cB(e){return Wf(AT(kA,3))}())):Lt({routes:[],injector:n})}lineralizeSegments(n,t){let r=[],l=t.root;for(;;){if(r=r.concat(l.segments),0===l.numberOfChildren)return Lt(r);if(l.numberOfChildren>1||!l.children[yn])return n.redirectTo,Wf(new st(4e3,kA));l=l.children[yn]}}applyRedirectCommands(n,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),n,r)}applyRedirectCreateUrlTree(n,t,r,l){const u=this.createSegmentGroup(n,t.root,r,l);return new Bh(u,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(n,t){const r={};return lo(n,(l,u)=>{if("string"==typeof l&&l.startsWith(":")){const w=l.substring(1);r[u]=t[w]}else r[u]=l}),r}createSegmentGroup(n,t,r,l){const u=this.createSegments(n,t.segments,r,l);let g={};return lo(t.children,(w,I)=>{g[I]=this.createSegmentGroup(n,w,r,l)}),new Mn(u,g)}createSegments(n,t,r,l){return t.map(u=>u.path.startsWith(":")?this.findPosParam(n,u,l):this.findOrReturn(u,r))}findPosParam(n,t,r){const l=r[t.path.substring(1)];if(!l)throw new st(4001,kA);return l}findOrReturn(n,t){let r=0;for(const l of t){if(l.path===n.path)return t.splice(r),l;r++}return n}}class pB{}class gB{constructor(n,t,r,l,u,g,w){this.injector=n,this.rootComponentType=t,this.config=r,this.urlTree=l,this.url=u,this.paramsInheritanceStrategy=g,this.urlSerializer=w}recognize(){const n=DA(this.urlTree.root,[],[],this.config.filter(t=>void 0===t.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,n,yn).pipe(ht(t=>{if(null===t)return null;const r=new CA([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},yn,this.rootComponentType,null,this.urlTree.root,-1,{}),l=new du(r,t),u=new _T(this.url,l);return this.inheritParamsAndData(u._root),u}))}inheritParamsAndData(n){const t=n.value,r=gT(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),n.children.forEach(l=>this.inheritParamsAndData(l))}processSegmentGroup(n,t,r,l){return 0===r.segments.length&&r.hasChildren()?this.processChildren(n,t,r):this.processSegment(n,t,r,r.segments,l)}processChildren(n,t,r){return xn(Object.keys(r.children)).pipe(Fh(l=>{const u=r.children[l],g=ET(t,l);return this.processSegmentGroup(n,g,u,l)}),$I((l,u)=>l&&u?(l.push(...u),l):null),function FF(e,n=!1){return pi((t,r)=>{let l=0;t.subscribe(ei(r,u=>{const g=e(u,l++);(g||n)&&r.next(u),!g&&r.complete()}))})}(l=>null!==l),fA(null),qI(),ht(l=>{if(null===l)return null;const u=RT(l);return function _B(e){e.sort((n,t)=>n.value.outlet===yn?-1:t.value.outlet===yn?1:n.value.outlet.localeCompare(t.value.outlet))}(u),u}))}processSegment(n,t,r,l,u){return xn(t).pipe(Fh(g=>this.processSegmentAgainstRoute(g._injector??n,g,r,l,u)),Oh(g=>!!g),ic(g=>{if(nw(g))return DT(r,l,u)?Lt([]):Lt(null);throw g}))}processSegmentAgainstRoute(n,t,r,l,u){if(t.redirectTo||!MT(t,r,l,u))return Lt(null);let g;if("**"===t.path){const w=l.length>0?QI(l).parameters:{},I=FT(r)+l.length;g=Lt({snapshot:new CA(l,w,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,LT(t),Sa(t),t.component??t._loadedComponent??null,t,OT(r),I,BT(t)),consumedSegments:[],remainingSegments:[]})}else g=TT(r,t,l,n).pipe(ht(({matched:w,consumedSegments:I,remainingSegments:S,parameters:L})=>{if(!w)return null;const j=FT(r)+I.length;return{snapshot:new CA(I,L,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,LT(t),Sa(t),t.component??t._loadedComponent??null,t,OT(r),j,BT(t)),consumedSegments:I,remainingSegments:S}}));return g.pipe(ml(w=>{if(null===w)return Lt(null);const{snapshot:I,consumedSegments:S,remainingSegments:L}=w;n=t._injector??n;const j=t._loadedInjector??n,ne=function yB(e){return e.children?e.children:e.loadChildren?e._loadedRoutes:[]}(t),{segmentGroup:se,slicedSegments:he}=DA(r,S,L,ne.filter(Ue=>void 0===Ue.redirectTo));if(0===he.length&&se.hasChildren())return this.processChildren(j,ne,se).pipe(ht(Ue=>null===Ue?null:[new du(I,Ue)]));if(0===ne.length&&0===he.length)return Lt([new du(I,[])]);const Ie=Sa(t)===u;return this.processSegment(j,ne,se,he,Ie?yn:u).pipe(ht(Ue=>null===Ue?null:[new du(I,Ue)]))}))}}function vB(e){const n=e.value.routeConfig;return n&&""===n.path&&void 0===n.redirectTo}function RT(e){const n=[],t=new Set;for(const r of e){if(!vB(r)){n.push(r);continue}const l=n.find(u=>r.value.routeConfig===u.value.routeConfig);void 0!==l?(l.children.push(...r.children),t.add(l)):n.push(r)}for(const r of t){const l=RT(r.children);n.push(new du(r.value,l))}return n.filter(r=>!t.has(r))}function OT(e){let n=e;for(;n._sourceSegment;)n=n._sourceSegment;return n}function FT(e){let n=e,t=n._segmentIndexShift??0;for(;n._sourceSegment;)n=n._sourceSegment,t+=n._segmentIndexShift??0;return t-1}function LT(e){return e.data||{}}function BT(e){return e.resolve||{}}function NT(e){return"string"==typeof e.title||null===e.title}function ow(e){return ml(n=>{const t=e(n);return t?xn(t).pipe(ht(()=>n)):Lt(n)})}const tm=new xt("ROUTES");let sw=(()=>{class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=Wt(pC)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return Lt(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Lh(t.loadComponent()).pipe(ht(VT),kr(u=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=u}),mA(()=>{this.componentLoaders.delete(t)})),l=new jI(r,()=>new rr).pipe(Lb());return this.componentLoaders.set(t,l),l}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return Lt({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const u=this.loadModuleFactoryOrRoutes(r.loadChildren).pipe(ht(w=>{this.onLoadEndListener&&this.onLoadEndListener(r);let I,S,L=!1;Array.isArray(w)?S=w:(I=w.create(t).injector,S=ZI(I.get(tm,[],Bt.Self|Bt.Optional)));return{routes:S.map(tw),injector:I}}),mA(()=>{this.childrenLoaders.delete(r)})),g=new jI(u,()=>new rr).pipe(Lb());return this.childrenLoaders.set(r,g),g}loadModuleFactoryOrRoutes(t){return Lh(t()).pipe(ht(VT),Vn(r=>r instanceof CE||Array.isArray(r)?Lt(r):xn(this.compiler.compileModuleAsync(r))))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function VT(e){return function TB(e){return e&&"object"==typeof e&&"default"in e}(e)?e.default:e}let OA=(()=>{class e{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new rr,this.configLoader=Wt(sw),this.environmentInjector=Wt(Ea),this.urlSerializer=Wt(T_),this.rootContexts=Wt(R_),this.navigationId=0,this.afterPreactivation=()=>Lt(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=l=>this.events.next(new fL(l)),this.configLoader.onLoadStartListener=l=>this.events.next(new pL(l))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t){return this.transitions=new fl({id:0,targetPageId:0,currentUrlTree:t.currentUrlTree,currentRawUrl:t.currentUrlTree,extractedUrl:t.urlHandlingStrategy.extract(t.currentUrlTree),urlAfterRedirects:t.urlHandlingStrategy.extract(t.currentUrlTree),rawUrl:t.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:k_,restoredState:null,currentSnapshot:t.routerState.snapshot,targetSnapshot:null,currentRouterState:t.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(nc(r=>0!==r.id),ht(r=>({...r,extractedUrl:t.urlHandlingStrategy.extract(r.rawUrl)})),ml(r=>{let l=!1,u=!1;return Lt(r).pipe(kr(g=>{this.currentNavigation={id:g.id,initialUrl:g.rawUrl,extractedUrl:g.extractedUrl,trigger:g.source,extras:g.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ml(g=>{const w=t.browserUrlTree.toString(),I=!t.navigated||g.extractedUrl.toString()!==w||w!==t.currentUrlTree.toString();if(!I&&"reload"!==(g.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const L="";return this.events.next(new EA(g.id,t.serializeUrl(r.rawUrl),L,0)),t.rawUrlTree=g.rawUrl,g.resolve(null),ns}if(t.urlHandlingStrategy.shouldProcessUrl(g.rawUrl))return UT(g.source)&&(t.browserUrlTree=g.extractedUrl),Lt(g).pipe(ml(L=>{const j=this.transitions?.getValue();return this.events.next(new Gb(L.id,this.urlSerializer.serialize(L.extractedUrl),L.source,L.restoredState)),j!==this.transitions?.getValue()?ns:Promise.resolve(L)}),function dB(e,n,t,r){return ml(l=>function uB(e,n,t,r,l){return new hB(e,n,t,r,l).apply()}(e,n,t,l.extractedUrl,r).pipe(ht(u=>({...l,urlAfterRedirects:u}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,t.config),kr(L=>{this.currentNavigation={...this.currentNavigation,finalUrl:L.urlAfterRedirects},r.urlAfterRedirects=L.urlAfterRedirects}),function xB(e,n,t,r,l){return Vn(u=>function mB(e,n,t,r,l,u,g="emptyOnly"){return new gB(e,n,t,r,l,g,u).recognize().pipe(ml(w=>null===w?function fB(e){return new fn(n=>n.error(e))}(new pB):Lt(w)))}(e,n,t,u.urlAfterRedirects,r.serialize(u.urlAfterRedirects),r,l).pipe(ht(g=>({...u,targetSnapshot:g}))))}(this.environmentInjector,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),kr(L=>{if(r.targetSnapshot=L.targetSnapshot,"eager"===t.urlUpdateStrategy){if(!L.extras.skipLocationChange){const ne=t.urlHandlingStrategy.merge(L.urlAfterRedirects,L.rawUrl);t.setBrowserUrl(ne,L)}t.browserUrlTree=L.urlAfterRedirects}const j=new lL(L.id,this.urlSerializer.serialize(L.extractedUrl),this.urlSerializer.serialize(L.urlAfterRedirects),L.targetSnapshot);this.events.next(j)}));if(I&&t.urlHandlingStrategy.shouldProcessUrl(t.rawUrlTree)){const{id:L,extractedUrl:j,source:ne,restoredState:se,extras:he}=g,Ie=new Gb(L,this.urlSerializer.serialize(j),ne,se);this.events.next(Ie);const Ue=mT(j,this.rootComponentType).snapshot;return Lt(r={...g,targetSnapshot:Ue,urlAfterRedirects:j,extras:{...he,skipLocationChange:!1,replaceUrl:!1}})}{const L="";return this.events.next(new EA(g.id,t.serializeUrl(r.extractedUrl),L,1)),t.rawUrlTree=g.rawUrl,g.resolve(null),ns}}),kr(g=>{const w=new cL(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot);this.events.next(w)}),ht(g=>r={...g,guards:BL(g.targetSnapshot,g.currentSnapshot,this.rootContexts)}),function ZL(e,n){return Vn(t=>{const{targetSnapshot:r,currentSnapshot:l,guards:{canActivateChecks:u,canDeactivateChecks:g}}=t;return 0===g.length&&0===u.length?Lt({...t,guardsResult:!0}):function QL(e,n,t,r){return xn(e).pipe(Vn(l=>function tB(e,n,t,r,l){const u=n&&n.routeConfig?n.routeConfig.canDeactivate:null;return u&&0!==u.length?Lt(u.map(w=>{const I=O_(n)??l,S=Yf(w,I);return Lh(function $L(e){return e&&B_(e.canDeactivate)}(S)?S.canDeactivate(e,n,t,r):I.runInContext(()=>S(e,n,t,r))).pipe(Oh())})).pipe(em()):Lt(!0)}(l.component,l.route,t,n,r)),Oh(l=>!0!==l,!0))}(g,r,l,e).pipe(Vn(w=>w&&function UL(e){return"boolean"==typeof e}(w)?function XL(e,n,t,r){return xn(n).pipe(Fh(l=>pA(function JL(e,n){return null!==e&&n&&n(new mL(e)),Lt(!0)}(l.route.parent,r),function KL(e,n){return null!==e&&n&&n(new _L(e)),Lt(!0)}(l.route,r),function eB(e,n,t){const r=n[n.length-1],u=n.slice(0,n.length-1).reverse().map(g=>function NL(e){const n=e.routeConfig?e.routeConfig.canActivateChild:null;return n&&0!==n.length?{node:e,guards:n}:null}(g)).filter(g=>null!==g).map(g=>UI(()=>Lt(g.guards.map(I=>{const S=O_(g.node)??t,L=Yf(I,S);return Lh(function GL(e){return e&&B_(e.canActivateChild)}(L)?L.canActivateChild(r,e):S.runInContext(()=>L(r,e))).pipe(Oh())})).pipe(em())));return Lt(u).pipe(em())}(e,l.path,t),function YL(e,n,t){const r=n.routeConfig?n.routeConfig.canActivate:null;if(!r||0===r.length)return Lt(!0);const l=r.map(u=>UI(()=>{const g=O_(n)??t,w=Yf(u,g);return Lh(function HL(e){return e&&B_(e.canActivate)}(w)?w.canActivate(n,e):g.runInContext(()=>w(n,e))).pipe(Oh())}));return Lt(l).pipe(em())}(e,l.route,t))),Oh(l=>!0!==l,!0))}(r,u,e,n):Lt(w)),ht(w=>({...t,guardsResult:w})))})}(this.environmentInjector,g=>this.events.next(g)),kr(g=>{if(r.guardsResult=g.guardsResult,sp(g.guardsResult))throw vT(0,g.guardsResult);const w=new uL(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(g.urlAfterRedirects),g.targetSnapshot,!!g.guardsResult);this.events.next(w)}),nc(g=>!!g.guardsResult||(t.restoreHistory(g),this.cancelNavigationTransition(g,"",3),!1)),ow(g=>{if(g.guards.canActivateChecks.length)return Lt(g).pipe(kr(w=>{const I=new hL(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(I)}),ml(w=>{let I=!1;return Lt(w).pipe(function bB(e,n){return Vn(t=>{const{targetSnapshot:r,guards:{canActivateChecks:l}}=t;if(!l.length)return Lt(t);let u=0;return xn(l).pipe(Fh(g=>function wB(e,n,t,r){const l=e.routeConfig,u=e._resolve;return void 0!==l?.title&&!NT(l)&&(u[C_]=l.title),function EB(e,n,t,r){const l=function CB(e){return[...Object.keys(e),...Object.getOwnPropertySymbols(e)]}(e);if(0===l.length)return Lt({});const u={};return xn(l).pipe(Vn(g=>function IB(e,n,t,r){const l=O_(n)??r,u=Yf(e,l);return Lh(u.resolve?u.resolve(n,t):l.runInContext(()=>u(n,t)))}(e[g],n,t,r).pipe(Oh(),kr(w=>{u[g]=w}))),Bb(1),function LF(e){return ht(()=>e)}(u),ic(g=>nw(g)?ns:Wf(g)))}(u,e,n,r).pipe(ht(g=>(e._resolvedData=g,e.data=gT(e,t).resolve,l&&NT(l)&&(e.data[C_]=l.title),null)))}(g.route,r,e,n)),kr(()=>u++),Bb(1),Vn(g=>u===l.length?Lt(t):ns))})}(t.paramsInheritanceStrategy,this.environmentInjector),kr({next:()=>I=!0,complete:()=>{I||(t.restoreHistory(w),this.cancelNavigationTransition(w,"",2))}}))}),kr(w=>{const I=new dL(w.id,this.urlSerializer.serialize(w.extractedUrl),this.urlSerializer.serialize(w.urlAfterRedirects),w.targetSnapshot);this.events.next(I)}))}),ow(g=>{const w=I=>{const S=[];I.routeConfig?.loadComponent&&!I.routeConfig._loadedComponent&&S.push(this.configLoader.loadComponent(I.routeConfig).pipe(kr(L=>{I.component=L}),ht(()=>{})));for(const L of I.children)S.push(...w(L));return S};return Fb(w(g.targetSnapshot.root)).pipe(fA(),rp(1))}),ow(()=>this.afterPreactivation()),ht(g=>{const w=function IL(e,n,t){const r=P_(e,n._root,t?t._root:void 0);return new fT(r,n)}(t.routeReuseStrategy,g.targetSnapshot,g.currentRouterState);return r={...g,targetRouterState:w}}),kr(g=>{t.currentUrlTree=g.urlAfterRedirects,t.rawUrlTree=t.urlHandlingStrategy.merge(g.urlAfterRedirects,g.rawUrl),t.routerState=g.targetRouterState,"deferred"===t.urlUpdateStrategy&&(g.extras.skipLocationChange||t.setBrowserUrl(t.rawUrlTree,g),t.browserUrlTree=g.urlAfterRedirects)}),((e,n,t)=>ht(r=>(new LL(n,r.targetRouterState,r.currentRouterState,t).activate(e),r)))(this.rootContexts,t.routeReuseStrategy,g=>this.events.next(g)),rp(1),kr({next:g=>{l=!0,this.lastSuccessfulNavigation=this.currentNavigation,t.navigated=!0,this.events.next(new ap(g.id,this.urlSerializer.serialize(g.extractedUrl),this.urlSerializer.serialize(t.currentUrlTree))),t.titleStrategy?.updateTitle(g.targetRouterState.snapshot),g.resolve(!0)},complete:()=>{l=!0}}),mA(()=>{l||u||this.cancelNavigationTransition(r,"",1),this.currentNavigation?.id===r.id&&(this.currentNavigation=null)}),ic(g=>{if(u=!0,bT(g)){xT(g)||(t.navigated=!0,t.restoreHistory(r,!0));const w=new wA(r.id,this.urlSerializer.serialize(r.extractedUrl),g.message,g.cancellationCode);if(this.events.next(w),xT(g)){const I=t.urlHandlingStrategy.merge(g.url,t.rawUrlTree),S={skipLocationChange:r.extras.skipLocationChange,replaceUrl:"eager"===t.urlUpdateStrategy||UT(r.source)};t.scheduleNavigation(I,k_,null,S,{resolve:r.resolve,reject:r.reject,promise:r.promise})}else r.resolve(!1)}else{t.restoreHistory(r,!0);const w=new $b(r.id,this.urlSerializer.serialize(r.extractedUrl),g,r.targetSnapshot??void 0);this.events.next(w);try{r.resolve(t.errorHandler(g))}catch(I){r.reject(I)}}return ns}))}))}cancelNavigationTransition(t,r,l){const u=new wA(t.id,this.urlSerializer.serialize(t.extractedUrl),r,l);this.events.next(u),t.resolve(!1)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function UT(e){return e!==k_}let jT=(()=>{class e{buildTitle(t){let r,l=t.root;for(;void 0!==l;)r=this.getResolvedTitleForRoute(l)??r,l=l.children.find(u=>u.outlet===yn);return r}getResolvedTitleForRoute(t){return t.data[C_]}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return Wt(MB)},providedIn:"root"}),e})(),MB=(()=>{class e extends jT{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}}return e.\u0275fac=function(t){return new(t||e)(gt(RI))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),DB=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return Wt(kB)},providedIn:"root"}),e})();class SB{shouldDetach(n){return!1}store(n,t){}shouldAttach(n){return!1}retrieve(n){return null}shouldReuseRoute(n,t){return n.routeConfig===t.routeConfig}}let kB=(()=>{class e extends SB{}return e.\u0275fac=function(){let n;return function(r){return(n||(n=Cr(e)))(r||e)}}(),e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const FA=new xt("",{providedIn:"root",factory:()=>({})});let RB=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:function(){return Wt(OB)},providedIn:"root"}),e})(),OB=(()=>{class e{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function FB(e){throw e}function LB(e,n,t){return n.parse("/")}const BB={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},NB={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ys=(()=>{class e{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=Wt(fP),this.isNgZoneEnabled=!1,this.options=Wt(FA,{optional:!0})||{},this.errorHandler=this.options.errorHandler||FB,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||LB,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=Wt(RB),this.routeReuseStrategy=Wt(DB),this.urlCreationStrategy=Wt(wL),this.titleStrategy=Wt(jT),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ZI(Wt(tm,{optional:!0})??[]),this.navigationTransitions=Wt(OA),this.urlSerializer=Wt(T_),this.location=Wt(lb),this.isNgZoneEnabled=Wt(ir)instanceof ir&&ir.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Bh,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=mT(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=t.targetPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)})}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),k_,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,l){const u={replaceUrl:!0},g=l?.navigationId?l:null;if(l){const I={...l};delete I.navigationId,delete I.\u0275routerPageId,0!==Object.keys(I).length&&(u.state=I)}const w=this.parseUrl(t);this.scheduleNavigation(w,r,g,u)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(t){this.config=t.map(tw),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(t,r={}){const{relativeTo:l,queryParams:u,fragment:g,queryParamsHandling:w,preserveFragment:I}=r,S=I?this.currentUrlTree.fragment:g;let L=null;switch(w){case"merge":L={...this.currentUrlTree.queryParams,...u};break;case"preserve":L=this.currentUrlTree.queryParams;break;default:L=u||null}return null!==L&&(L=this.removeEmptyProps(L)),this.urlCreationStrategy.createUrlTree(l,this.routerState,this.currentUrlTree,t,L,S??null)}navigateByUrl(t,r={skipLocationChange:!1}){const l=sp(t)?t:this.parseUrl(t),u=this.urlHandlingStrategy.merge(l,this.rawUrlTree);return this.scheduleNavigation(u,k_,null,r)}navigate(t,r={skipLocationChange:!1}){return function zB(e){for(let n=0;n<e.length;n++){const t=e[n];if(null==t)throw new st(4008,false)}}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(l){r=this.malformedUriErrorHandler(l,this.urlSerializer,t)}return r}isActive(t,r){let l;if(l=!0===r?{...BB}:!1===r?{...NB}:r,sp(t))return KI(this.currentUrlTree,t,l);const u=this.parseUrl(t);return KI(this.currentUrlTree,u,l)}removeEmptyProps(t){return Object.keys(t).reduce((r,l)=>{const u=t[l];return null!=u&&(r[l]=u),r},{})}scheduleNavigation(t,r,l,u,g){if(this.disposed)return Promise.resolve(!1);let w,I,S,L;return g?(w=g.resolve,I=g.reject,S=g.promise):S=new Promise((j,ne)=>{w=j,I=ne}),L="computed"===this.canceledNavigationResolution?l&&l.\u0275routerPageId?l.\u0275routerPageId:u.replaceUrl||u.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:L,source:r,restoredState:l,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:t,extras:u,resolve:w,reject:I,promise:S,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),S.catch(j=>Promise.reject(j))}setBrowserUrl(t,r){const l=this.urlSerializer.serialize(t),u={...r.extras.state,...this.generateNgRouterState(r.id,r.targetPageId)};this.location.isCurrentPathEqualTo(l)||r.extras.replaceUrl?this.location.replaceState(l,"",u):this.location.go(l,"",u)}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const l=this.currentPageId-t.targetPageId;"popstate"!==t.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===l?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===l&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(l)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),LA=(()=>{class e{constructor(t,r,l,u,g,w){this.router=t,this.route=r,this.tabIndexAttribute=l,this.renderer=u,this.el=g,this.locationStrategy=w,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new rr;const I=g.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===I||"area"===I,this.isAnchorElement?this.subscription=t.events.subscribe(S=>{S instanceof ap&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(t){this._preserveFragment=qf(t)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(t){this._skipLocationChange=qf(t)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(t){this._replaceUrl=qf(t)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,l,u,g){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||l||u||g||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function gg(e,n,t){return function $0(e,n){return"src"===n&&("embed"===e||"frame"===e||"iframe"===e||"media"===e||"script"===e)||"href"===n&&("base"===e||"link"===e)?uf:wa}(n,t)(e)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const l=this.renderer,u=this.el.nativeElement;null!==r?l.setAttribute(u,t,r):l.removeAttribute(u,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return e.\u0275fac=function(t){return new(t||e)(qe(Ys),qe(Nh),function Bp(e){return function Xu(e,n){if("class"===n)return e.classes;if("style"===n)return e.styles;const t=e.attrs;if(t){const r=t.length;let l=0;for(;l<r;){const u=t[l];if(Sn(u))break;if(0===u)l+=2;else if("number"==typeof u)for(l++;l<r&&"string"==typeof t[l];)l++;else{if(u===n)return t[l+1];l+=2}}}return null}(gi(),e)}("tabindex"),qe(il),qe(jr),qe(tp))},e.\u0275dir=Nt({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(t,r){1&t&&ft("click",function(u){return r.onClick(u.button,u.ctrlKey,u.shiftKey,u.altKey,u.metaKey)}),2&t&&xe("target",r.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[Hi]}),e})();class HT{}let jB=(()=>{class e{constructor(t,r,l,u,g){this.router=t,this.injector=l,this.preloadingStrategy=u,this.loader=g}setUpPreloading(){this.subscription=this.router.events.pipe(nc(t=>t instanceof ap),Fh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const l=[];for(const u of r){u.providers&&!u._injector&&(u._injector=Nv(u.providers,t,`Route: ${u.path}`));const g=u._injector??t,w=u._loadedInjector??g;(u.loadChildren&&!u._loadedRoutes&&void 0===u.canLoad||u.loadComponent&&!u._loadedComponent)&&l.push(this.preloadConfig(g,u)),(u.children||u._loadedRoutes)&&l.push(this.processRoutes(w,u.children??u._loadedRoutes))}return xn(l).pipe(Po())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let l;l=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):Lt(null);const u=l.pipe(Vn(g=>null===g?Lt(void 0):(r._loadedRoutes=g.routes,r._loadedInjector=g.injector,this.processRoutes(g.injector??t,g.routes))));return r.loadComponent&&!r._loadedComponent?xn([u,this.loader.loadComponent(r)]).pipe(Po()):u})}}return e.\u0275fac=function(t){return new(t||e)(gt(Ys),gt(pC),gt(Ea),gt(HT),gt(sw))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const lw=new xt("");let GT=(()=>{class e{constructor(t,r,l,u,g={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=l,this.zone=u,this.options=g,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},g.scrollPositionRestoration=g.scrollPositionRestoration||"disabled",g.anchorScrolling=g.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof Gb?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof ap&&(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof dT&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new dT(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return e.\u0275fac=function(t){!function tu(){throw new Error("invalid")}()},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();var ea=(()=>((ea=ea||{})[ea.COMPLETE=0]="COMPLETE",ea[ea.FAILED=1]="FAILED",ea[ea.REDIRECTING=2]="REDIRECTING",ea))();const nm=!1;function zh(e,n){return{\u0275kind:e,\u0275providers:n}}const cw=new xt("",{providedIn:"root",factory:()=>!1});function qT(){const e=Wt(Eo);return n=>{const t=e.get(Wv);if(n!==t.components[0])return;const r=e.get(Ys),l=e.get(WT);1===e.get(uw)&&r.initialNavigation(),e.get(ZT,null,Bt.Optional)?.setUpPreloading(),e.get(lw,null,Bt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),l.closed||(l.next(),l.complete(),l.unsubscribe())}}const WT=new xt(nm?"bootstrap done indicator":"",{factory:()=>new rr}),uw=new xt(nm?"initial navigation":"",{providedIn:"root",factory:()=>1});function WB(){let e=[];return e=nm?[{provide:$l,multi:!0,useFactory:()=>{const n=Wt(Ys);return()=>n.events.subscribe(t=>{console.group?.(`Router Event: ${t.constructor.name}`),console.log(function vL(e){if(!("type"in e))return`Unknown Router Event: ${e.constructor.name}`;switch(e.type){case 14:return`ActivationEnd(path: '${e.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${e.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${e.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${e.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}', state: ${e.state}, shouldActivate: ${e.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}', state: ${e.state})`;case 2:return`NavigationCancel(id: ${e.id}, url: '${e.url}')`;case 16:return`NavigationSkipped(id: ${e.id}, url: '${e.url}')`;case 1:return`NavigationEnd(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${e.id}, url: '${e.url}', error: ${e.error})`;case 0:return`NavigationStart(id: ${e.id}, url: '${e.url}')`;case 6:return`ResolveEnd(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}', state: ${e.state})`;case 5:return`ResolveStart(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}', state: ${e.state})`;case 10:return`RouteConfigLoadEnd(path: ${e.route.path})`;case 9:return`RouteConfigLoadStart(path: ${e.route.path})`;case 4:return`RoutesRecognized(id: ${e.id}, url: '${e.url}', urlAfterRedirects: '${e.urlAfterRedirects}', state: ${e.state})`;case 15:return`Scroll(anchor: '${e.anchor}', position: '${e.position?`${e.position[0]}, ${e.position[1]}`:null}')`}}(t)),console.log(t),console.groupEnd?.()})}}]:[],zh(1,e)}const ZT=new xt(nm?"router preloader":"");function ZB(e){return zh(0,[{provide:ZT,useExisting:jB},{provide:HT,useExisting:e}])}const z_=!1,QT=new xt(z_?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),QB=[lb,{provide:T_,useClass:Nb},Ys,R_,{provide:Nh,useFactory:function $T(e){return e.routerState.root},deps:[Ys]},sw,z_?{provide:cw,useValue:!0}:[]];function XB(){return new xC("Router",Ys)}let XT=(()=>{class e{constructor(t){}static forRoot(t,r){return{ngModule:e,providers:[QB,z_&&r?.enableTracing?WB().\u0275providers:[],{provide:tm,multi:!0,useValue:t},{provide:QT,useFactory:eN,deps:[[Ys,new lr,new ii]]},{provide:FA,useValue:r||{}},r?.useHash?{provide:tp,useClass:tR}:{provide:tp,useClass:GC},{provide:lw,useFactory:()=>{const e=Wt(vO),n=Wt(ir),t=Wt(FA),r=Wt(OA),l=Wt(T_);return t.scrollOffset&&e.setOffset(t.scrollOffset),new GT(l,r,e,n,t)}},r?.preloadingStrategy?ZB(r.preloadingStrategy).\u0275providers:[],{provide:xC,multi:!0,useFactory:XB},r?.initialNavigation?tN(r):[],[{provide:KT,useFactory:qT},{provide:AC,multi:!0,useExisting:KT}]]}}static forChild(t){return{ngModule:e,providers:[{provide:tm,multi:!0,useValue:t}]}}}return e.\u0275fac=function(t){return new(t||e)(gt(QT,8))},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[Yb]}),e})();function eN(e){if(z_&&e)throw new st(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function tN(e){return["disabled"===e.initialNavigation?zh(3,[{provide:Gv,multi:!0,useFactory:()=>{const n=Wt(Ys);return()=>{n.setUpLocationChangeListener()}}},{provide:uw,useValue:2}]).\u0275providers:[],"enabledBlocking"===e.initialNavigation?zh(2,[{provide:uw,useValue:0},{provide:Gv,multi:!0,deps:[Eo],useFactory:n=>{const t=n.get(YP,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const l=n.get(Ys),u=n.get(WT);(function HB(e,n){e.events.pipe(nc(t=>t instanceof ap||t instanceof wA||t instanceof $b||t instanceof EA),ht(t=>t instanceof ap||t instanceof EA?ea.COMPLETE:t instanceof wA&&(0===t.code||1===t.code)?ea.REDIRECTING:ea.FAILED),nc(t=>t!==ea.REDIRECTING),rp(1)).subscribe(()=>{n()})})(l,()=>{r(!0)}),n.get(OA).afterPreactivation=()=>(r(!0),u.closed?Lt(void 0):u),l.initialNavigation()}))}}]).\u0275providers:[]]}const KT=new xt(z_?"Router Initializer":""),iN=JSON.parse('[{"capital":"Tirana","country":"Albania","favourite":false,"visited":false,"planned":false,"url":"https://cebraarchitecture.dk/cebra-architecture/wp-content/uploads/2022/10/15-mount-tirana.jpg","description":"Tirana is the capital and largest city of Albania. It is located in the center of the country, on the Ishm River. Tirana has a population of over 410,000 people. The city was founded in the 17th century by the Ottoman Turks. It became the capital of Albania in 1920.Tirana is a modern city with a mix of old and new architecture. The city center is home to many government buildings, museums, and theaters. There are also many parks and green spaces in Tirana. The city is a popular tourist destination, with many historical and cultural attractions.","images":["https://cdn.britannica.com/36/195936-050-7CF4E835/Tirana-Albania.jpg","https://theholisticbackpacker.com/wp-content/uploads/2022/08/MG_1858.jpg","https://sp-ao.shortpixel.ai/client/to_webp,q_lossless,ret_img,w_1080,h_720/https://drivemefoody.com/wp-content/uploads/albania-tirana-sunset-view-sky-tower-1080x720.jpg","https://travellingbalkans.com/wp-content/uploads/2019/09/DJI_0853-HDR-1150x862.jpg"]},{"capital":"Andorra la Vella","country":"Andorra","favourite":false,"visited":false,"planned":false,"url":"https://images.lucasfox.com/location/4x3_1600w/050EB433EF.jpg","description":"Andorra la Vella is the capital of Andorra, a small country located in the Pyrenees Mountains between France and Spain. It is the highest capital city in Europe, at an elevation of 1,023 meters (3,356 feet).Andorra la Vella is a small city, with a population of just over 22,000 people. The city is home to the Andorran government, as well as a number of shops, restaurants, and hotels.","images":["https://mediaim.expedia.com/destination/2/40fb4f1cc18151717167e3b334236a09.jpg","https://d19tiqumqauva7.cloudfront.net/var/andorra/storage/images/www.andorra.ad/multimedia/galeria/cultura/itineraris-culturals/itinerari-cultural-andorra-la-vella/1906x960_itinerari-cultural-andorra-la-vella/24104076-1-cat-ES/1906x960_itinerari-cultural-andorra-la-vella.jpg","https://www.collinsdictionary.com/images/full/andorralavella_317791925_1000.jpg","https://www.worldatlas.com/r/w1200/upload/97/4b/c8/shutterstock-64114618.jpg"]},{"capital":"Vienna","country":"Austria","favourite":false,"visited":false,"planned":false,"url":"https://www.travelandleisure.com/thmb/zFpjulihpXjpUV7gKNHzydvJANA=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/vienna-austria-VIENNATG0621-ecb0ee926c2d49c4bce610db594f7405.jpg","description":"Vienna is the capital of Austria and the largest city in the country. It is located in the east of Austria, on the Danube River. Vienna has a population of over 1.9 million people. The city is a major center for culture, education, and politics in Austria. Vienna is a beautiful city with a rich history. The city center is home to many historical landmarks, including the Hofburg Palace, the Sch\xf6nbrunn Palace, and the St. Stephen\'s Cathedral. Vienna is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://i2-prod.manchestereveningnews.co.uk/incoming/article16169571.ece/ALTERNATES/s1200c/0_Vienna-central.jpg","https://d3vonci41uckcv.cloudfront.net/old-images/original/3762e33f-6ff4-4d13-a254-96d3b68fee4c.austria-vienna-danube.jpg","https://www.kkhotels.com/wp-content/uploads/2018/12/2020-02-12-13_52_04-Vienna-Sunset.jpg-IrfanView-Selection_-94-0-800-x-630-1.270.png","https://www.travelanddestinations.com/wp-content/uploads/2016/04/Vienna-Austria-Best-things-to-do.jpg"]},{"capital":"Minsk","country":"Belarus","favourite":false,"visited":false,"planned":false,"url":"https://www.intrepidtravel.com/adventures/wp-content/uploads/2019/06/shutterstock_1282471396.jpg","description":"\\nMinsk is the capital and largest city of Belarus. It is located on the Svisloch River, in the central part of the country. Minsk has a population of over 2 million people. The city was founded in the 11th century and has been the capital of Belarus since 1919. Minsk is a modern city with a mix of old and new architecture. The city center is home to many government buildings, museums, and theaters. There are also many parks and green spaces in Minsk. The city is a popular tourist destination, with many historical and cultural attractions.","images":["https://thumbs.dreamstime.com/b/panorama-paysage-urbain-de-minsk-belarus-%C3%A9t%C3%A9-64569970.jpg","https://www.reisepassnummer.de/assets/images/2018/05/06/minsk/minsk-2677096_1920_klein.jpg","https://belarus24.by/upload/medialibrary/1ff/1ffdf19f8814695789d4b9e5f752d561.jpg","https://vetliva.com/upload/resize_cache/iblock/10c/1170_640_23ee4b948f86b68649480f85209bcab9f/10c2348146dd2cf572624e5635662c93.jpg"]},{"capital":"Brussels","country":"Belgium","favourite":false,"visited":false,"planned":false,"url":"https://www.visit.brussels/en/visitors/_jcr_content/root/container/content_1226746056_c/multicolumn/teaser_2005755142.coreimg.jpeg/1675354196799/grand-place-4212-%C2%A9-visit.brussels---jean-michel-byl.jpeg","description":"\\nBrussels is the capital of Belgium and of the Brussels-Capital Region. It is a major European center of finance, diplomacy, and culture, with headquarters of many of the world\'s biggest international organizations, including NATO and the European Union. Brussels is a beautiful city with a rich history. The city center is home to many historical landmarks, including the Grand Place, the Manneken Pis, and the Atomium. Brussels is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://c0.wallpaperflare.com/preview/396/1004/936/belgium-bruxelles-atomium.jpg","https://c0.wallpaperflare.com/preview/705/114/463/grand-place-brussels-belgium-travel.jpg","https://c0.wallpaperflare.com/preview/907/665/188/belgium-brussels-parc-du-cinquantenaire-europe.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/2/26/Grand-Place%2C_Brussels_-_panorama%2C_June_2018.jpg/1024px-Grand-Place%2C_Brussels_-_panorama%2C_June_2018.jpg"]},{"capital":"Sarajevo","country":"Bosnia and Herzegovina","favourite":false,"visited":false,"planned":false,"url":"https://www.flydubai.com/en/media/Sarajevo_710x473_tcm8-5999.jpg","description":"\\nSarajevo is the capital and largest city of Bosnia and Herzegovina. It is located in the heart of the country, at the confluence of the Miljacka and Bosna rivers. Sarajevo has a population of over 275,000 people. Sarajevo is a beautiful city with a mix of old and new architecture. The city center is home to many historical landmarks, including the Gazi Husrev-bey Mosque, the Vije\u0107nica (City Hall), and the Latin Bridge. Sarajevo is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://e0.pxfuel.com/wallpapers/431/272/desktop-wallpaper-stari-grad-old-town-sarajevo-bosnia-and-herzegovina.jpg","https://w0.peakpx.com/wallpaper/145/898/HD-wallpaper-gazi-husrev-beg-s-mosque-sarajevo-bosnia-bosnia-mosque-bascarsija-sarajevo-classic-ottoman.jpg","https://c1.wallpaperflare.com/preview/560/490/360/bosnia-and-herzegovina-bosnia-sarajevo-miljacka.jpg","https://c0.wallpaperflare.com/preview/55/401/192/bosnia-and-herzegovina-sarajevo-vrelo-bosne.jpg"]},{"capital":"Sofia","country":"Bulgaria","favourite":false,"visited":false,"planned":false,"url":"https://tourscanner.com/blog/wp-content/uploads/2022/07/things-to-do-in-Sofia.jpg","description":"Sofia is the capital of Bulgaria and the largest city in the country. It is located in the western part of Bulgaria, at the foot of Vitosha Mountain. Sofia has a population of over 1.2 million people. Sofia is a beautiful city with a mix of old and new architecture. The city center is home to many historical landmarks, including the Alexander Nevsky Cathedral, the Boyana Church, and the National Historical Museum. Sofia is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://c4.wallpaperflare.com/wallpaper/499/728/926/alexander-nevsky-cathedral-sofia-bulgaria-wallpaper-preview.jpg","https://c0.wallpaperflare.com/preview/884/117/291/sofia-bulgaria-crowd-mountain.jpg","https://c1.wallpaperflare.com/preview/335/230/440/bulgaria-national-assembly-sofia-parliament.jpg","https://c0.wallpaperflare.com/preview/970/196/870/sofia-bulgaria-architecture-cathedral.jpg"]},{"capital":"Zagreb","country":"Croatia","favourite":false,"visited":false,"planned":false,"url":"https://static.nationalgeographic.co.uk/files/styles/image_3200/public/zagrebgettyimages-1144074611hr.jpg?w=1900&h=1267","description":"Zagreb is the capital and largest city of Croatia. It is located in the northwest of the country, at the confluence of the Sava and Krka rivers. Zagreb has a population of over 800,000 people. Zagreb is a beautiful city with a mix of old and new architecture. The city center is home to many historical landmarks, including the Zagreb Cathedral, the Lotr\u0161\u010dak Tower, and the Stone Gate. Zagreb is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://c1.wallpaperflare.com/preview/115/346/484/zagreb-cathedral-europe-croatia.jpg","https://c1.wallpaperflare.com/preview/866/699/781/zagreb-jarun-park-bright-sunny.jpg","https://c0.wallpaperflare.com/preview/625/570/420/croatia-zagreb-ban-josip-jela%C4%8Di%C4%87-square.jpg","https://c1.wallpaperflare.com/preview/128/677/163/ban-jela%C4%8Di%C4%87-building-croatia-photo.jpg"]},{"capital":"Nicosia","country":"Cyprus","favourite":false,"visited":false,"planned":false,"url":"https://www.collinsdictionary.com/images/full/nicosia_280198175_1000.jpg","description":"Nicosia (Greek: \u039b\u03b5\u03c5\u03ba\u03c9\u03c3\u03af\u03b1, Lefkosia; Turkish: Lefko\u015fa) is the capital and largest city of Cyprus. It is located in the centre of the Mesaoria Plain, on the banks of the Pedieos River. Nicosia is the seat of the government of the Republic of Cyprus, as well as the seat of the Turkish Cypriot community\'s self-declared capital, North Nicosia. Nicosia is also a modern city with a vibrant economy. The city is home to many businesses, banks, and universities. Nicosia is a popular tourist destination, with something to offer everyone. Whether you\'re interested in history, culture, or nightlife, you\'re sure to find something to enjoy in Nicosia.","images":["https://c1.wallpaperflare.com/preview/190/232/905/cyprus-nicosia-square-sculpture-city-building.jpg","https://w0.peakpx.com/wallpaper/714/928/HD-wallpaper-selimiye-mosque-city-of-edirne.jpg","https://w0.peakpx.com/wallpaper/356/150/HD-wallpaper-kykkos-monastery-in-cyprus-christianity-europe-cyprus-monastery.jpg","https://e1.pxfuel.com/desktop-wallpaper/827/318/desktop-wallpaper-of-cyprus-nicosia-nicosia.jpg"]},{"capital":"Prague","country":"Czech Republic","favourite":false,"visited":false,"planned":false,"url":"https://static.independent.co.uk/s3fs-public/thumbnails/image/2018/06/20/09/prague-overview.jpg","description":"Prague, the capital of the Czech Republic, is a beautiful city with a rich history. It is located on the Vltava River in the central part of the country. Prague has a population of over 1.2 million people. Prague is a beautiful city with a mix of old and new architecture. The city center is home to many historical landmarks, including the Charles Bridge, the Prague Castle, and the Old Town Square. Prague is also home to many museums, art galleries, and theaters. The city is a popular tourist destination, with something to offer everyone.","images":["https://c4.wallpaperflare.com/wallpaper/902/457/184/prague-charles-bridge-czech-republic-river-vltava-evening-lights-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/49/957/162/architecture-building-evening-lights-wallpaper-preview.jpg","https://w0.peakpx.com/wallpaper/335/817/HD-wallpaper-dancing-house-in-prague-building-city-dance-prague.jpg","https://media.tacdn.com/media/attractions-splice-spp-674x446/0b/e1/1b/2c.jpg"]},{"capital":"Copenhagen","country":"Denmark","favourite":false,"visited":false,"planned":false,"url":"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/28/74/c2/dc/caption.jpg?w=700&h=500&s=1","description":"Copenhagen is the capital of Denmark and one of the most popular tourist destinations in Europe. The city is known for its beautiful architecture, its vibrant nightlife, and its many green spaces. Copenhagen is home to a number of world-famous landmarks, including the Amalienborg Palace, the Rosenborg Castle, and the Round Tower. The city also has a number of museums, including the National Museum of Denmark, the Royal Danish Academy of Fine Arts, and the Copenhagen Museum. In addition to its cultural attractions, Copenhagen is also a great place to enjoy the outdoors. The city has a number of parks and gardens, including the Rosenborg Castle Gardens, the Amalienborg Palace Gardens, and the Copenhagen Botanical Garden. Copenhagen is also home to a number of beaches, including the Langelinie Beach and the Islands Brygge Beach.","images":["https://www.travelandleisure.com/thmb/G5hwSYQUTvgGQISOXymFUYYr-Iw=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/copenhagen-dk-COPENHAGENTG0721-4a481cb6025b43d1a781b1571b144f46.jpg","https://a.cdn-hotels.com/gdcs/production28/d1675/f55e58c8-c184-4198-a75d-4b146892de4c.jpg","https://www.visitcopenhagen.com/sites/visitcopenhagen.com/files/2023-02/Bike%20city%20-%20photo%20credits%20VisitCopenhagen%2028.jpg","https://www.staysure.co.uk/wp-content/uploads/2015/07/copenhagen_skyline.jpg"]},{"capital":"Tallinn","country":"Estonia","favourite":false,"visited":false,"planned":false,"url":"https://static.visitestonia.com/images/3560295/1600_900_false_false_82b4d1c3132c5a4824361d0abbf38603.jpg","description":"Tallinn is the capital of Estonia and is located on the coast of the Gulf of Finland. It is a beautiful city with a rich history dating back to the 13th century. Tallinn is a popular tourist destination and is known for its well-preserved medieval Old Town. Tallinn is a great place to visit for a weekend getaway or a longer vacation. With its rich history, culture, and nightlife, there\'s something for everyone in Tallinn.","images":["https://lp-cms-production.imgix.net/features/2015/12/tallinn-old-town-1500-cs.jpg","https://file.visittallinn.ee/w1u4r7/detail-tallinnchristmasmarkett2020kaupokalda3.jpg","https://c4.wallpaperflare.com/wallpaper/472/513/107/tallinn-estonia-old-town-road-houses-wallpaper-preview.jpg","https://w0.peakpx.com/wallpaper/473/100/HD-wallpaper-tallinn-town-hall-raekoja-plats-town-hall-square-evening-square-tallinn-cityscape-estonia.jpg"]},{"capital":"T\xf3rshavn","country":"Faroe Islands","favourite":false,"visited":false,"planned":false,"url":"https://upload.wikimedia.org/wikipedia/commons/1/18/Vestaravag_torshavn%2C_faroe_islands%2C_feb_2005.jpg","description":"Torshavn is a small city with a population of around 17,000 people. It is located on the Streymoy Island, the largest of the Faroe Islands. Torshavn is a popular tourist destination, known for its beautiful scenery, charming old town, and vibrant cultural scene. Torshavn is a great place to visit for a weekend getaway or a longer vacation. With its beautiful scenery, charming old town, and vibrant cultural scene, there\'s something for everyone in Torshavn.","images":["https://www.iwanderlista.com/wp-content/uploads/2022/03/Torshavn-6.jpg","https://cdn.britannica.com/88/141188-050-E9E53A17/Torshavn-Faroe-Islands-Den.jpg","https://handluggageonly.co.uk/wp-content/uploads/2016/07/13305200_10154232920874784_2219183897590260675_o.jpg","https://questo.imgix.net/misc/5abd05ec-6874-4e73-bf71-e2b4b17d2a7f.jpeg"]},{"capital":"Helsinki","country":"Finland","favourite":false,"visited":false,"planned":false,"url":"https://a.cdn-hotels.com/gdcs/production0/d1589/6d9eed40-c31d-11e8-9739-0242ac110006.jpg","description":"Helsinki is the capital of Finland and the most populous city in the Nordic countries. It is located on a peninsula in the Gulf of Finland, with a population of over 600,000 people. Helsinki is a modern city with a rich history, dating back to the 16th century. The city is home to many historical landmarks, including the Senate Square, the Helsinki Cathedral, and the Uspenski Cathedral. Helsinki is also a popular tourist destination, known for its beautiful scenery, vibrant cultural scene, and excellent public transportation system.","images":["https://c1.wallpaperflare.com/preview/382/764/980/helsinki-cathedral-cathedral-church-helsinki-finland-architecture.jpg","https://c1.wallpaperflare.com/preview/146/591/743/suomenlinna-viapori-kustaanmiekka-island.jpg","https://c0.wallpaperflare.com/preview/521/839/733/finland-helsinki-uspenski-cathedral-russian-church.jpg","https://c4.wallpaperflare.com/wallpaper/871/289/283/finland-fortress-helsinki-island-suomenlinna-hd-wallpaper-preview.jpg"]},{"capital":"Paris","country":"France","favourite":false,"visited":false,"planned":false,"url":"https://travellersworldwide.com/wp-content/uploads/2022/12/Shutterstock_2045606852.jpg","description":"Paris is the capital of France and one of the most popular tourist destinations in the world. The city is located on the Seine River in the north-central part of France. Paris has a population of over 2.2 million people and is the most populous city in France. Paris is a city with a rich history dating back to the Roman era. The city has been home to many important events in history, including the French Revolution and the World Wars. Paris is also a city of art and culture, and is home to many famous landmarks, including the Eiffel Tower, the Louvre Museum, and the Notre Dame Cathedral.","images":["https://c4.wallpaperflare.com/wallpaper/930/781/157/eiffel-tower-paris-hd-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/54/118/440/louvre-paris-france-pyramid-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/851/252/967/paris-france-notre-dame-de-paris-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/572/901/228/the-sky-france-paris-the-evening-wallpaper-preview.jpg"]},{"capital":"Berlin","country":"Germany","favourite":false,"visited":false,"planned":false,"url":"https://media.timeout.com/images/105303515/750/422/image.jpg","description":"Berlin is the capital and largest city of Germany. It is located in northeastern Germany, on the River Spree. Berlin is a major center for culture, politics, media, and science. The city has a population of over 3.5 million people.\\n\\nBerlin is a city with a rich history. The city was founded in the 13th century and has been the capital of Germany since 1871. Berlin was heavily damaged during World War II, but it was rebuilt and has since become a thriving metropolis.\\n\\nBerlin is a city of contrasts. The city is home to many historical landmarks, such as the Brandenburg Gate and the Reichstag, but it is also home to a vibrant and diverse cultural scene. Berlin is a city that is constantly changing and evolving, and it is a great place to visit for a weekend getaway or a longer vacation.","images":["https://c4.wallpaperflare.com/wallpaper/492/1012/59/monuments-brandenburg-gate-berlin-germany-wallpaper-preview.jpg","https://c0.wallpaperflare.com/preview/512/220/946/berlin-reichstag-building-germany.jpg","https://e0.pxfuel.com/wallpapers/866/265/desktop-wallpaper-berlin-wall-berlin-street.jpg","https://c4.wallpaperflare.com/wallpaper/958/325/226/berlin-museum-island-wallpaper-preview.jpg"]},{"capital":"Gibraltar","country":"Gibraltar","favourite":false,"visited":false,"planned":false,"url":"https://cdn.britannica.com/61/191561-050-1507BA4F/Gibraltar.jpg","description":"Gibraltar is a British overseas territory located on the southern tip of the Iberian Peninsula. It is bordered to the north by Spain and has an area of 6.7 square kilometers. Gibraltar is a popular tourist destination, known for its beautiful scenery, its strategic location on the Strait of Gibraltar, and its history as a British outpost.\\n\\nThe Rock of Gibraltar is the most prominent feature of the territory. It is a limestone massif that rises to a height of 426 meters above sea level. The Rock is home to a variety of plant and animal life, including Barbary apes, which are the only wild monkeys in Europe.","images":["https://theplanetd.com/images/Rock-of-Gibraltar.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/b/b5/Catalan_Bay_Gibraltar.jpg/1024px-Catalan_Bay_Gibraltar.jpg","https://cdn.britannica.com/61/191561-050-1507BA4F/Gibraltar.jpg","https://ichef.bbci.co.uk/news/976/mcs/media/images/73969000/jpg/_73969578_gibraltar_peninsular_g.jpg"]},{"capital":"Athens","country":"Greece","favourite":false,"visited":false,"planned":false,"url":"https://cdn.britannica.com/66/102266-050-FBDEFCA1/acropolis-city-state-Greece-Athens.jpg","description":"Athens is the capital of Greece and is one of the oldest cities in Europe. It is located on the Attica peninsula, and has a population of over 3.7 million people. Athens is a major center for culture, politics, and education. It is home to the National Archaeological Museum, which houses a collection of artifacts from ancient Greece, and the University of Athens, which is the oldest university in Greece. Athens is also a popular tourist destination. The city is home to many historical landmarks, including the Acropolis, the Parthenon, and the Temple of Olympian Zeus. The Acropolis is a hilltop citadel that was once the center of ancient Athens. The Parthenon is a temple that was built on the Acropolis in the 5th century BC. The Temple of Olympian Zeus was a temple that was built in the 2nd century AD.","images":["https://c4.wallpaperflare.com/wallpaper/732/34/491/greece-athens-acropolis-parthenon-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/836/388/907/europe-parthenon-greece-athen-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/607/836/982/ancient-history-tourism-ruins-temple-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/257/14/559/architecture-old-building-lights-evening-wallpaper-preview.jpg"]},{"capital":"St Peter Port","country":"Guernsey","favourite":false,"visited":false,"planned":false,"url":"https://www.pocruises.com/content/dam/po/inventory-assets/ports/GCI/GCI.jpg.1591372901030.image.750.563.low.jpg","description":"St Peter Port is the capital of Guernsey, a British Crown dependency in the English Channel. It is a small, charming town with a population of around 20,000 people. St Peter Port is located on the east coast of Guernsey and is the island\'s main port. The town has a long and rich history. It was founded by the Normans in the 11th century and has been the capital of Guernsey since the 13th century. St Peter Port was heavily damaged during World War II, but it has been rebuilt and is now a thriving town. St Peter Port is a popular tourist destination. The town has a beautiful harbor, a historic old town, and a variety of shops, restaurants, and cafes. St Peter Port is also a popular destination for walkers and cyclists.","images":["https://c1.wallpaperflare.com/preview/275/677/80/castle-island-castle-cornet-drone.jpg","https://c4.wallpaperflare.com/wallpaper/173/772/919/castles-castle-cornet-architecture-bailiwick-of-guernsey-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/273/418/521/colors-of-dawn-in-guernsey-channel-isls-wallpaper-preview.jpg","https://c0.wallpaperflare.com/preview/703/699/820/guernsey-torteval-drone-pleinmont.jpg"]},{"capital":"Budapest","country":"Hungary","favourite":false,"visited":false,"planned":false,"url":"https://www.tripsavvy.com/thmb/YZCXPivyMUxMidbeyv7VLEizlEE=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/the-hungarian-parliament-on-the-danube-river-at-sunset-in-budapest--hungary-945207010-23afbc9012d54bc4bb7c8a1f8c90075b.jpg","description":"\\nBudapest is the capital of Hungary and is one of the most beautiful cities in Europe. It is located on the banks of the Danube River and is divided into two parts: Buda and Pest. Buda is the older part of the city and is home to many historical landmarks, including the Buda Castle, the Matthias Church, and the Fisherman\'s Bastion. Pest is the newer part of the city and is home to many cultural attractions, including the Hungarian Parliament Building, the Great Market Hall, and the House of Terror.","images":["https://c1.wallpaperflare.com/preview/788/723/600/buda-castle-buda-castle-at-night-budapest-hungary.jpg","https://c1.wallpaperflare.com/preview/919/653/201/budapest-hungary-bastion-fisherman-s.jpg","https://c4.wallpaperflare.com/wallpaper/786/863/822/chain-bridge-budapest-hungary-europe-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/128/698/536/the-sky-the-city-lights-construction-the-evening-hd-wallpaper-preview.jpg"]},{"capital":"Reykjav\xedk","country":"Iceland","favourite":false,"visited":false,"planned":false,"url":"https://cdn.britannica.com/71/73371-050-9DFAEC1E/Reykjavik-Iceland.jpg","description":"Reykjavik is the northernmost capital city in the world. It is located on the southwestern coast of Iceland, on a peninsula that juts into Faxa Bay. The city has a population of around 120,000 people, making it the largest city in Iceland. Reykjavik is a young city, founded in 874 AD by Ing\xf3lfur Arnarson. The city grew slowly for many years, but it began to grow rapidly in the 20th century. Today, Reykjavik is a major center for business, culture, and tourism.","images":["https://e0.pxfuel.com/wallpapers/695/604/desktop-wallpaper-magnificent-hallgrimskirkja-church-reykjavik-iceland-statue-modern.jpg","https://c1.wallpaperflare.com/preview/971/362/540/iceland-harpa-concert-hall-reykjavik-architecture-building.jpg","https://c1.wallpaperflare.com/preview/731/853/104/iceland-sun-voyager-reykjavik-monument.jpg","https://cdn.britannica.com/71/73371-050-9DFAEC1E/Reykjavik-Iceland.jpg"]},{"capital":"Dublin","country":"Ireland","favourite":false,"visited":false,"planned":false,"url":"https://upload.wikimedia.org/wikipedia/commons/4/42/Samuel_Beckett_Bridge_At_Sunset_Dublin_Ireland_%2897037639%29_%28cropped%29.jpeg","description":"Dublin is the capital and largest city of Ireland. It is located on the east coast of Ireland, at the mouth of the River Liffey. The city has a population of 1,348,300 (2016) and is the center of the Dublin metropolitan area, which has a population of 1,906,228 (2016). Dublin is a vibrant and cosmopolitan city with something to offer everyone. The city has a thriving arts scene, with theaters, museums, and galleries. Dublin is also home to many festivals, including the Dublin Film Festival, the Dublin Theatre Festival, and the Dublin City Marathon.","images":["https://c4.wallpaperflare.com/wallpaper/557/474/428/library-books-trinity-college-library-dublin-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/291/749/265/ha-penny-bridge-and-river-liffey-at-night-dublin-ireland-wallpaper-preview.jpg","https://c1.wallpaperflare.com/preview/724/161/76/dublin-st-patrick-st-patrick-s-cathedral-cathedral-irish-architecture.jpg","https://tetu.com/wp-content/uploads/2016/04/irlande12-1024x768.jpg"]},{"capital":"Douglas","country":"Isle of Man","favourite":false,"visited":false,"planned":false,"url":"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/10/50/fb/04/the-steam-packet.jpg?w=600&h=400&s=1","description":"Douglas is the capital and largest town of the Isle of Man, a self-governing British Crown dependency in the Irish Sea. It is located on the east coast of the island, at the mouth of the River Douglas. Douglas is a popular tourist destination, with a mild climate and a variety of attractions, including the Isle of Man Steam Railway, the Manx Museum, and the Villa Marina Theatre. The town is also home to a number of festivals and events, including the Isle of Man TT Races and the Manx Grand Prix.","images":["https://www.placenorthwest.co.uk/wp-content/uploads/Douglas-generic-c-John-Hall-for-Culture-Vannin-CC-BY-SA-2.0-bit.ly-SLASH-3MAAIEH-650x460.jpg","https://c.files.bbci.co.uk/10AD/production/_107096240_horsetram20192.jpg","https://qtxasset.com/quartz/qcloud1/media/image/luxurytraveladvisor/1522955978/DouglasIsleofManPanmauleiStockGettyImagesPlusGettyImages.jpg/DouglasIsleofManPanmauleiStockGettyImagesPlusGettyImages.jpg?VersionId=bLKAfz_fMgvQFT07HSWacf.xBN.LVnBt","https://media.istockphoto.com/id/1065171108/photo/panorama-of-douglas-on-the-isle-of-man.jpg?s=612x612&w=0&k=20&c=NURXguKbrET0TTLIEbs2se66M-Kuy1wb_iFgRPy0m2o="]},{"capital":"Rome","country":"Italy","favourite":false,"visited":false,"planned":false,"url":"https://lp-cms-production.imgix.net/2021-03/500pxRF_77415821.jpg?auto=format&w=1440&h=810&fit=crop&q=75","description":"Rome is the capital of Italy and one of the most popular tourist destinations in the world. The city is home to a wealth of historical and cultural attractions, including the Colosseum, the Roman Forum, and the Vatican City. Rome was founded in the 8th century BC by the Romans, who made it the capital of their empire. The city reached its peak in the 1st century AD, when it was the largest and most powerful city in the world. Rome continued to be an important center of culture and learning throughout the Middle Ages and Renaissance.","images":["https://c4.wallpaperflare.com/wallpaper/265/778/338/colosseum-amphitheatre-ancient-colosseum-amphitheatre-wallpaper-preview.jpg","https://c1.wallpaperflare.com/preview/259/924/891/italy-rome-trevi-fountain-sculpture.jpg","https://c4.wallpaperflare.com/wallpaper/648/386/575/building-home-area-rome-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/45/849/224/pantheon-rome-italy-wallpaper-preview.jpg"]},{"capital":"Saint Helier","country":"Jersey","favourite":false,"visited":false,"planned":false,"url":"https://www.seabourn.com/content/dam/sbn65/inventory-assets/ports/em/sh2/port-st-helier-jersey.jpg","description":"Saint Helier is the capital of Jersey, a self-governing British Crown dependency in the English Channel. The town is located on the south coast of Jersey, on the eastern end of St Aubin\'s Bay. It is the most populated parish of Jersey, with a population of over 35,000. Saint Helier is a thriving commercial center, with a wide variety of shops, restaurants, and bars. The town is also home to a number of historical and cultural attractions, including the Elizabeth Castle, the Jersey Museum & Art Gallery, and the Royal Square. Saint Helier is a popular tourist destination, with a mild climate and a beautiful setting. The town is also a popular destination for business travelers, with a number of hotels and conference facilities.","images":["https://c4.wallpaperflare.com/wallpaper/226/115/694/nature-landscape-beach-sea-wallpaper-preview.jpg","https://www.britain-magazine.com/wp-content/uploads/JerseyCastle.jpg","https://cdn.britannica.com/84/126384-050-3671F8F9/Hermitage-Saint-Helier-LIslet-Jersey-Channel-Islands.jpg","https://previews.123rf.com/images/ambeon/ambeon2103/ambeon210300009/165231986-saint-helier-capital-city-panorama-with-port-and-marina-in-the-foreground-bailiwick-of-jersey.jpg"]},{"capital":"Pristina","country":"Kosovo","favourite":false,"visited":false,"planned":false,"url":"https://i.pinimg.com/originals/15/50/e1/1550e1defd089b0e1b6b0028d52d6399.jpg","description":"Pristina is the capital and largest city of Kosovo. It is located in the north-eastern part of the country, close to the Goljak mountains. The city has a population of over 200,000 people, and is the center of government, business, and culture in Kosovo. Pristina has a long and rich history. The city was founded in the 11th century, and has been ruled by a number of different empires, including the Ottomans, the Austrians, and the Serbians. Pristina was heavily damaged during the Kosovo War in the 1990s, but has since been rebuilt. Today, Pristina is a modern city with a mix of old and new architecture. The city is home to a number of universities, museums, and cultural institutions. Pristina is also a popular tourist destination, with a number of historical and cultural attractions, including the Grand Mosque, the Mother Teresa Cathedral, and the Pristina Fortress.","images":["https://cdn.getyourguide.com/img/location/5a1d57c05dcf5.jpeg/75.jpg","https://wander-lush.org/wp-content/uploads/2019/05/Emily-Lush-Prishtina-Kosovo-37.jpg","https://www.ncronline.org/files/webRNS-KOSOVO2-09052017.jpg","https://solohappy.com/wp-content/uploads/2022/12/Best-places-to-visit-in-Pristina-Kosovo-1200x640.jpg"]},{"capital":"Riga","country":"Latvia","favourite":false,"visited":false,"planned":false,"url":"https://upload.wikimedia.org/wikipedia/commons/thumb/a/a9/Vistas_desde_la_iglesia_de_San_Pedro%2C_Riga%2C_Letonia%2C_2012-08-07%2C_DD_04_%28cropped%29.JPG/1200px-Vistas_desde_la_iglesia_de_San_Pedro%2C_Riga%2C_Letonia%2C_2012-08-07%2C_DD_04_%28cropped%29.JPG","description":"Riga is the capital of Latvia, located on the Baltic Sea. It is the largest city in the Baltic states with a population of over 600,000 people. Riga has a long and rich history, dating back to the 13th century. The city has been ruled by a number of different empires, including the Germans, the Swedes, and the Russians. Riga was heavily damaged during World War II, but has since been rebuilt. Riga is a beautiful city with a lot to offer visitors. The city is home to a number of historical and cultural attractions, including the Riga Cathedral, the House of the Black Heads, and the Central Market. Riga is also a popular tourist destination for its vibrant nightlife and its many restaurants and bars.","images":["https://c4.wallpaperflare.com/wallpaper/442/996/899/town-lights-architecture-church-wallpaper-preview.jpg","https://cdn.britannica.com/78/115478-050-71EB889C/Old-Town-Latvia-Riga-Daugava-River.jpg","https://www.spectator.co.uk/wp-content/uploads/2022/09/iStock-615926196.jpg","https://cdn.getyourguide.com/img/location/538cab118c1d7.jpeg/75.jpg"]},{"capital":"Vaduz","country":"Liechtenstein","favourite":false,"visited":false,"planned":false,"url":"https://upload.wikimedia.org/wikipedia/commons/e/e3/Vaduz.jpg","description":"Vaduz is the capital and largest city of Liechtenstein, a small German-speaking alpine country located between Switzerland and Austria. It is situated on the Rhine River, at the foot of the Alps. The city has a population of around 5,000 people. Vaduz is a charming city with a medieval feel. The main street, St\xe4dtle, is lined with shops, restaurants, and cafes. The city is also home to a number of historical buildings, including Vaduz Castle, the seat of the Liechtenstein government.","images":["https://c4.wallpaperflare.com/wallpaper/237/22/441/two-white-and-gray-kitten-beside-wooden-surface-cats-cats-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/875/550/429/snow-mountains-landscape-nature-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/530/538/361/towns-vaduz-liechtenstein-wallpaper-preview.jpg","https://upload.wikimedia.org/wikipedia/commons/e/e3/Vaduz.jpg"]},{"capital":"Vilnius","country":"Lithuania","favourite":false,"visited":false,"planned":false,"url":"https://www.roadaffair.com/wp-content/uploads/2020/03/aerial-view-hot-air-balloon-vilnius-lithuania-shutterstock_1288741006.jpg","description":"Vilnius is the capital of Lithuania, a country located in Eastern Europe. It is the largest city in Lithuania, with a population of over 500,000 people. Vilnius is a beautiful city with a rich history and culture. It is home to many historical and cultural landmarks, including the Vilnius Cathedral, the Gediminas Castle Tower, and the Hill of Three Crosses. Vilnius is also a popular tourist destination, with many things to see and do.","images":["https://c1.wallpaperflare.com/preview/708/842/390/lithuania-vilnius-cathedral.jpg","https://c1.wallpaperflare.com/preview/497/55/820/lithuania-vilnius-churches-cathedral.jpg","https://c1.wallpaperflare.com/preview/513/992/856/lithuania-vilnius-st-catherine-s-church-historically-mirroring-cathedral.jpg","https://c1.wallpaperflare.com/preview/798/9/297/vilnius-lithuania-europe-city.jpg"]},{"capital":"Luxembourg","country":"Luxembourg","favourite":false,"visited":false,"planned":false,"url":"https://static.euronews.com/articles/stories/05/66/80/50/1440x810_cmsv2_82112269-e4ca-5196-bb34-92241777d094-5668050.jpg","description":"Luxembourg is a small country in Western Europe, bordered by Belgium to the west and north, France to the south, and Germany to the east. The capital and largest city of Luxembourg is Luxembourg City. The country has a population of about 640,000 people. Luxembourg is a constitutional monarchy, with Grand Duke Henri as the head of state. The current prime minister is Xavier Bettel. The official languages of Luxembourg are Luxembourgish, French, and German.","images":["https://c1.wallpaperflare.com/preview/632/826/542/luxembourg-ville-haute-city-architecture.jpg","https://c1.wallpaperflare.com/preview/17/341/229/luxembourg-city-landscape-cityscape.jpg","https://c1.wallpaperflare.com/preview/553/221/159/architecture-building-castle-photos.jpg","https://cdn.britannica.com/08/178008-050-93B5F493/Alzette-River-city-Luxembourg.jpg"]},{"capital":"Skopje","country":"Macedonia","favourite":false,"visited":false,"planned":false,"url":"https://www.staysure.co.uk/wp-content/uploads/2016/09/Alexander-the-Great-Monument-in-Skopje.jpg","description":"Skopje is the capital and largest city of North Macedonia. It is located in the central part of the country, on the banks of the Vardar River. The city has a population of about 546,000 people. Today, Skopje is a modern city with a mix of old and new architecture. The city is home to a number of historical and cultural landmarks, including the Old Bazaar, the Kale Fortress, and the Mother Teresa Memorial House. Skopje is also a popular tourist destination, known for its vibrant nightlife and its delicious food.","images":["https://explore.mk/wp-content/uploads/2020/02/shutterstock_173849720.jpg","https://explore.mk/wp-content/uploads/2020/02/shutterstock_142027141aaa.png","https://www.golivegotravel.nl/wp-content/uploads/2018/12/Statues-Skopje.jpeg","https://freesofiatour.com/wp-content/uploads/2020/01/how-to-get-to-skopje-e1579877405853.jpg"]},{"capital":"Valletta","country":"Malta","favourite":false,"visited":false,"planned":false,"url":"https://a.cdn-hotels.com/gdcs/production38/d1036/f7b5ecf3-139d-4c55-b89f-a79f655e2224.jpg","description":"Valletta is the capital of Malta, a small island nation in the Mediterranean Sea. It is a walled city that was founded in the 16th century by the Knights of St. John, a Roman Catholic military order. Valletta is known for its Baroque architecture, its many museums and palaces, and its stunning views of the Mediterranean Sea. Valletta was named a UNESCO World Heritage Site in 1980. It is the smallest capital city in the European Union, with a population of just over 5,000 people.","images":["https://e1.pxfuel.com/desktop-wallpaper/666/906/desktop-wallpaper-valletta-capital-of-malta-grand-harbour-old-valletta.jpg","https://image.geo.de/30128698/t/jk/v4/w1440/r0/-/valetta-f-105026194-jpg--73015-.jpg","https://www.weseektravel.com/wp-content/uploads/2022/11/things-to-do-in-valletta-malta-1.jpg","https://www.travellingking.com/wp-content/uploads/2022/10/Valletta-Aerial-view-of-Valletta-city-capital-of-Malta-country.-.jpg"]},{"capital":"Chi\u015fin\u0103u","country":"Moldova","favourite":false,"visited":false,"planned":false,"url":"https://t3.ftcdn.net/jpg/02/31/19/22/360_F_231192271_RypDJREDSkBdnBbp1rvLN8qBu5awRubi.jpg","description":"Chisinau, also known as Kishinev, is the capital of Moldova. It is located in the central part of the country, on the B\xe2c River. The city has a population of over 600,000 people.\\n\\nChisinau is a relatively young city, founded in 1752. The city was originally named Kishinev, after the name of a nearby village. In 1812, Kishinev was annexed by the Russian Empire and renamed Chisinau.\\n\\nChisinau is a major cultural and economic center in Moldova. The city is home to a number of universities, museums, and theaters. Chisinau is also a major industrial center, with a number of factories producing wine, food, and textiles.","images":["https://static.independent.co.uk/2021/09/24/16/iStock-1066138896.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/5/52/Arch_of_Triumph%2C_Chisinau%2C_Republic_of_Moldova_%2851160304626_cropped%29.jpg/1200px-Arch_of_Triumph%2C_Chisinau%2C_Republic_of_Moldova_%2851160304626_cropped%29.jpg","https://d1bvpoagx8hqbg.cloudfront.net/originals/experience-chisinau-moldova-alexandra-20a84e1dbde81963ff3323a47fe83978.jpg","https://img.ev.mu/images/attractions/7282/960x640/753308.jpg"]},{"capital":"Monaco","country":"Monaco","favourite":false,"visited":false,"planned":false,"url":"https://static.euronews.com/articles/stories/06/17/95/94/1440x810_cmsv2_2f761865-3d02-59bc-9c7f-06158b32b00d-6179594.jpg","description":"Monaco, officially the Principality of Monaco, is a sovereign city-state and microstate on the French Riviera a few kilometres west of the Italian region of Liguria, in Western Europe, on the Mediterranean Sea. It is bordered by France to the north, east and west. Monaco is the second smallest country in the world, after Vatican City. It is also the most densely populated country in the world, with a population of over 38,000 people living in an area of just 0.78 square miles.","images":["https://e1.pxfuel.com/desktop-wallpaper/242/882/desktop-wallpaper-the-monte-carlo-casino-monte-carlo-monaco-widescreen-monaco.jpg","https://c4.wallpaperflare.com/wallpaper/194/592/15/cities-monaco-cruise-ship-museum-wallpaper-preview.jpg","https://img.bekiaviajes.com/articulos/portada/79000/79686.jpg","https://hips.hearstapps.com/hmg-prod/images/ferraris-monegasque-driver-charles-leclerc-drives-during-news-photo-1650649175.jpg"]},{"capital":"Podgorica","country":"Montenegro","favourite":false,"visited":false,"planned":false,"url":"https://waytomonte.com/img/slider/8/1/7055/60f4ee3a5707e0c918a90da0dabf8a10_thumb.jpg","description":"Podgorica is the capital and largest city of Montenegro. It is located in the central part of the country, on the banks of the Mora\u010da River. The city has a population of about 198,000 people. Podgorica is a young city, with its current form dating back to the 19th century. However, the city has a long and rich history, dating back to the 7th century BC. Podgorica was once the capital of the Kingdom of Duklja, and it was also an important center of the Roman Empire and the Ottoman Empire.","images":["https://c1.wallpaperflare.com/preview/87/646/512/podgorica-montenegro-city-capital.jpg","https://cdn.britannica.com/43/145343-050-5042276C/Podgorica-Monte.jpg","https://thumbs.dreamstime.com/b/podgorica-panoramic-view-capital-largest-city-montenegro-residential-commercial-part-podgori-sunny-winter-day-172944566.jpg","https://www.bhfieldschool.org/uploaded/gallery/BH%20Field%20School%20Towns%20-%20Podgorica.1-6961.JPG"]},{"capital":"Amsterdam","country":"Netherlands","favourite":false,"visited":false,"planned":false,"url":"https://media.timeout.com/images/105504583/750/422/image.jpg","description":"Amsterdam is the capital of the Netherlands, located in the province of North Holland. It is the most populous city in the Netherlands, with a population of over 870,000 people. Amsterdam is a popular tourist destination, known for its canals, museums, and vibrant nightlife. The city is built on a series of canals, which are used for transportation and recreation. The canals are lined with beautiful 17th-century houses, which give the city a unique charm. Amsterdam is home to a number of museums, including the Rijksmuseum, the Van Gogh Museum, and the Anne Frank House. The Rijksmuseum houses a collection of Dutch art, including works by Rembrandt and Vermeer. The Van Gogh Museum houses a collection of Van Gogh\'s paintings, including \\"The Starry Night\\" and \\"Sunflowers.\\" The Anne Frank House is a museum dedicated to the life of Anne Frank, a Jewish girl who hid from the Nazis during World War II.","images":["https://static.independent.co.uk/2021/10/08/17/iStock-516188849.jpg","https://a.cdn-hotels.com/gdcs/production82/d1440/1c5a8da3-35c4-48ce-a6a8-bbedc5fd013e.jpg","https://a.cdn-hotels.com/gdcs/production92/d539/dde53919-277b-4cdc-90fc-dfae0846b282.jpg","https://cdn-ffeol.nitrocdn.com/XvtpqXVmEaOeVBUbzBMDShrhLDOERTbY/assets/static/optimized/rev-a667f81/wp-content/uploads/2021/02/Prettiest-Amsterdam-streets.jpg"]},{"capital":"Oslo","country":"Norway","favourite":false,"visited":false,"planned":false,"url":"https://a.cdn-hotels.com/gdcs/production106/d1597/5303351b-a7d2-4775-994a-348002ea13d2.jpg","description":"Oslo is the capital and most populous city of Norway. It is located in southeastern Norway, on the Oslofjord. The city has a population of about 672,000 people. Oslo is a modern city with a mix of old and new architecture. The city is home to a number of historical and cultural landmarks, including the Akershus Fortress, the Royal Palace, and the Oslo Opera House. Oslo is also a popular tourist destination, known for its vibrant nightlife and its delicious food.","images":["https://c1.wallpaperflare.com/preview/662/779/806/city-urban-bridge-sunset.jpg","https://c1.wallpaperflare.com/preview/19/136/953/oslo-opera-house-norway-opera.jpg","https://c1.wallpaperflare.com/preview/539/76/845/akershus-fortress-at-night-norway.jpg","https://c1.wallpaperflare.com/preview/707/1009/149/oslo-castle-norway-royal-castle.jpg"]},{"capital":"Warsaw","country":"Poland","favourite":false,"visited":false,"planned":false,"url":"https://s.inyourpocket.com/img/text/poland/warsaw/warsaw-city-centre_drone-in-warsaw-2.jpg","description":"Warsaw is the capital and largest city of Poland. It is located on the Vistula River in east-central Poland, and its population is officially estimated at 1.765 million as of 2017. Warsaw is the most populous city in Poland and the 9th most populous city in the European Union. Warsaw is a popular tourist destination, known for its historical and cultural landmarks, including the Old Town, the Royal Castle, and the Palace of Culture and Science. Warsaw is also home to a number of museums and art galleries, including the National Museum, the Warsaw Uprising Museum, and the Copernicus Science Centre.","images":["https://e0.pxfuel.com/wallpapers/952/644/desktop-wallpaper-palace-of-culture-and-science-warsaw-poland-%E2%9D%A4-ultra-culture.jpg","https://c4.wallpaperflare.com/wallpaper/599/175/739/dusk-eu-europe-poland-wallpaper-preview.jpg","https://c0.wallpaperflare.com/preview/359/442/555/poland-warsaw-%C5%82azienki-park-park.jpg","https://dag08uxs564ub.cloudfront.net/images/warsaw-the-old-town.max-1280x768.jpg"]},{"capital":"Lisbon","country":"Portugal","favourite":false,"visited":false,"planned":false,"url":"https://www.back-packer.org/wp-content/uploads/best-things-to-do-in-lisbon-portugal-title.jpg","description":"\\nLisbon is the capital and largest city of Portugal, with a population of approximately 505,000 within its administrative limits. It is located on the western coast of the Iberian Peninsula, on the Tagus River estuary. Lisbon is a beautiful city with a lot to offer visitors. The city is home to a number of historical and cultural landmarks, including the S\xe3o Jorge Castle, the Bel\xe9m Tower, and the Jer\xf3nimos Monastery. Lisbon is also home to a number of museums, art galleries, and theaters.","images":["https://c1.wallpaperflare.com/preview/1012/802/545/jeronimos-monastery-monastery-church-religion-lisbon-portugal.jpg","https://c1.wallpaperflare.com/preview/689/804/980/lisbon-portugal-castle-of-sao-jorge-castle.jpg","https://c4.wallpaperflare.com/wallpaper/306/557/199/castle-belem-tower-lisbon-portugal-wallpaper-preview.jpg","https://c4.wallpaperflare.com/wallpaper/681/364/897/rossio-square-lisbon-portugal-wallpaper-preview.jpg"]},{"capital":"Bucharest","country":"Romania","favourite":false,"visited":false,"planned":false,"url":"https://img.traveltriangle.com/blog/wp-content/uploads/2019/01/Cover-for-Summer-In-Bucharest.jpg","description":"Bucharest is the capital and largest city of Romania. It is located in the south of the country, on the banks of the D\xe2mbovi\u021ba River. The city has a population of over 1.9 million people. Bucharest is a city with a long and rich history. It was founded in the 14th century and was the capital of the Principality of Wallachia from 1459 to 1861. In 1861, Bucharest became the capital of the United Principalities of Romania.","images":["https://romaniatourstore.com/wp-content/uploads/2016/09/Triumphant-Arch-Bucharest-2.jpg","https://romaniatourstore.com/wp-content/uploads/2015/10/The-Palace-of-Parliament.jpg","https://romaniatourstore.com/wp-content/uploads/2014/03/shutterstock_493813045.jpg","https://media.tacdn.com/media/attractions-splice-spp-674x446/07/16/cc/43.jpg"]},{"capital":"San Marino","country":"San Marino","favourite":false,"visited":false,"planned":false,"url":"https://www.solosophie.com/wp-content/uploads/2023/04/san-marino-guide_1381614365.jpeg","description":"San Marino is a small country located in the central part of Italy. It is completely surrounded by Italy and has an area of only 61 square kilometers. The capital of San Marino is also called San Marino. San Marino is the fifth smallest country in the world and the third smallest country in Europe. It has a population of about 33,000 people. The official language of San Marino is Italian. San Marino is a microstate, which means that it is a sovereign state that is very small in size. It is the oldest surviving republic in the world, having been founded in 301 AD.","images":["https://cdn.britannica.com/02/141002-050-7B946D16/one-fortresses-Guaita-city-San-Marino.jpg","https://www.beerandcroissants.com/wp-content/uploads/2017/12/city-of-san-marino.jpg","https://s27363.pcdn.co/wp-content/uploads/2017/10/San-Marino-in-Rain.jpg.optimal.jpg","https://cdn.britannica.com/54/142954-050-C5675BFB/Borgo-Maggiore-San-Marino.jpg"]},{"capital":"Belgrade","country":"Serbia","favourite":false,"visited":false,"planned":false,"url":"https://deih43ym53wif.cloudfront.net/sava-river-belgrade-serbia-shutterstock_695817301_6e9c75d6d4.jpeg","description":"Belgrade is the capital and largest city of Serbia. It is located at the confluence of the Sava and Danube rivers, in the central part of the country. The city has a population of over 1.2 million people. Belgrade is a beautiful and vibrant city with a lot to offer visitors. The city is home to a number of historical and cultural landmarks, including the Belgrade Fortress, the National Assembly of Serbia, and the Temple of Saint Sava. Belgrade is also home to a number of museums, art galleries, and theaters.","images":["https://lp-cms-production.imgix.net/features/2017/09/Belgrade-Knez-Mihailova-street-af958c3aa30c.jpg","https://cdn.britannica.com/57/96057-050-BD18B6F6/Boats-Danube-River-Belgrade-Serbia.jpg","https://efs-belgrade2022.org/wp-content/uploads/2022/09/Knez.png","https://www.nationsonline.org/gallery/Serbia/Aerial-view-of-Belgrade.jpg"]},{"capital":"Bratislava","country":"Slovakia","favourite":false,"visited":false,"planned":false,"url":"https://sacr3-files.s3-eu-west-1.amazonaws.com/_processed_/csm_Bratislavsky%2520hrad_94d492b936.jpg","description":"\\nBratislava is the capital of Slovakia and the country\'s largest city. It is located at the confluence of the Danube and Morava rivers, on the western edge of the Carpathian Mountains. The city has a population of about 430,000 people. Bratislava is a beautiful and vibrant city with a lot to offer visitors. The city is home to a number of historical and cultural landmarks, including the Bratislava Castle, the Old Town, and the Primatial Palace. Bratislava is also home to a number of museums, art galleries, and theaters.","images":["https://33traveltips.com/wp-content/uploads/Facts-about-Bratislava.jpg","https://d2bgjx2gb489de.cloudfront.net/gbb-blogs/wp-content/uploads/2020/07/01093015/Bratislava.jpg","https://www.gastrotravelogue.com/wp-content/uploads/2017/09/Old-Town.jpg","https://www.novo-monde.com/app/uploads/2022/10/musee-histoire-1024x768.jpg"]},{"capital":"Ljubljana","country":"Slovenia","favourite":false,"visited":false,"planned":false,"url":"https://cdn.britannica.com/79/124479-050-DD359499/Ljubljana-Slovenia.jpg","description":"Ljubljana is the capital and largest city of Slovenia. It is located in the central part of the country, on the banks of the Ljubljanica River. The city has a population of about 293,000 people. Ljubljana is a beautiful and vibrant city with a lot to offer visitors. The city is home to a number of historical and cultural landmarks, including the Ljubljana Castle, the Triple Bridge, and the Pre\u0161eren Square. Ljubljana is also home to a number of museums, art galleries, and theaters.","images":["https://cdn.britannica.com/79/124479-050-DD359499/Ljubljana-Slovenia.jpg","https://cdn.britannica.com/68/93068-050-E7C71026/Ljubljana-Ljubljanica-River-Slovenia.jpg","https://www.iwanderlista.com/wp-content/uploads/2019/08/Ljubljana-18.jpg","https://esacroatia.com/app/uploads/2012/06/Ljubljanabynight-1024x721.jpg"]},{"capital":"Madrid","country":"Spain","favourite":false,"visited":false,"planned":false,"url":"https://dynamic-media-cdn.tripadvisor.com/media/photo-o/28/6a/f5/4c/caption.jpg?w=500&h=300&s=1","description":"Madrid is a city of contrasts. It is a modern city with a rich history. It is a city of culture and nightlife. It is a city of art and architecture. It is a city of parks and gardens. It is a city of people from all over the world. Madrid is a city that has something to offer everyone. Whether you are interested in history, culture, art, food, or nightlife, you are sure to find something to enjoy in Madrid.","images":["https://upload.wikimedia.org/wikipedia/commons/thumb/9/92/Gran_V%C3%ADa_%28Madrid%29_1.jpg/1200px-Gran_V%C3%ADa_%28Madrid%29_1.jpg","https://deih43ym53wif.cloudfront.net/cibeles-fountain-madrid-spain-shutterstock_556870582_cf4a306a5b.jpeg","https://a.cdn-hotels.com/gdcs/production196/d170/348659c0-9beb-11e8-a1b5-0242ac110053.jpg","https://media.gq-magazine.co.uk/photos/5d1396399fa60179288385ed/4:3/w_1704,h_1278,c_limit/Madrid-02-GQ-17May17_b.jpg"]},{"capital":"Longyearbyen","country":"Svalbard and Jan Mayen","favourite":false,"visited":false,"planned":false,"url":"https://ychef.files.bbci.co.uk/live/624x351/p04qw8tg.jpg","description":"Longyearbyen is the world\'s northernmost settlement with a population greater than 1,000 and the largest inhabited area of Svalbard, Norway. It stretches along the foot of the left bank of the Longyear Valley and on the shore of Adventfjorden, the short estuary leading into Isfjorden on the west coast of Spitsbergen, the island\'s broadest inlet. As of 2002 Longyearbyen Community Council became an official Norwegian municipality.","images":["https://www.meganstarr.com/wp-content/uploads/2020/02/What-to-know-before-visiting-Svalbard-tips-for-Spitsbergen-and-beyond-4.jpg","https://previews.123rf.com/images/aleksandrlutcenko/aleksandrlutcenko1602/aleksandrlutcenko160200114/53971447-a-city-details-of-longyearbyen-the-most-northern-settlement-in-the-world-spitsbergen-svalbard.jpg","https://upload.wikimedia.org/wikipedia/commons/thumb/5/5c/Longyearbyen-as-of-2022.jpg/1200px-Longyearbyen-as-of-2022.jpg","https://upload.wikimedia.org/wikipedia/commons/1/1c/Longyearbyen4.jpg"]},{"capital":"Stockholm","country":"Sweden","favourite":false,"visited":false,"planned":false,"url":"https://i2-prod.mirror.co.uk/incoming/article6088198.ece/ALTERNATES/s1200b/Riddarholmen-Old-Town-in-Stockholm.jpg","description":"Stockholm is the capital of Sweden and the most populous city in the Nordic countries. It is built on 14 islands in central Sweden on the Baltic Sea coast, an ideal location for trade. The city has a population of about 975,000 people, and its metropolitan area is home to over 2.3 million people. Stockholm is a beautiful and historic city with a lot to offer visitors. The city is home to a number of historical and cultural landmarks, including the Royal Palace, the Gamla Stan (Old Town), and the Vasa Museum. Stockholm is also home to a number of museums, art galleries, and theaters.","images":["https://s3-eu-north-1.amazonaws.com/py3.visitsweden.com/images/Trygg_Sthlm_Heli_2_352_High-res-CMSTemplate_g.width-1650.jpg","https://i2-prod.mirror.co.uk/incoming/article6088198.ece/ALTERNATES/s1200b/Riddarholmen-Old-Town-in-Stockholm.jpg","https://www.meganstarr.com/wp-content/uploads/2023/02/Best-things-to-do-in-Stockholm_2090319031.jpg","https://www.stockholmfreetour.com/wp-content/uploads/2017/01/The-Royale-Palace.jpg"]},{"capital":"Berne","country":"Switzerland","favourite":false,"visited":false,"planned":false,"url":"https://media.istockphoto.com/id/475439326/photo/bern.jpg?s=612x612&w=0&k=20&c=CMhqdUyCazMsEiDq9SdNIZDUCZQj_ODadTYmwRV-emk=","description":"Berne (Swiss German: B\xe4rn, pronounced [\u02c8b\u025b\u02d0rn]) is the de facto capital of Switzerland and the capital of the canton of Bern. It is located in the west-central part of Switzerland, on the Aare River in the foothills of the Alps. The city has a population of about 133,000 people (as of 2022), and its metropolitan area is home to over 660,000 people. Bern was founded in the 12th century by the Dukes of Z\xe4hringen. The city grew rapidly in the 13th and 14th centuries, and became a major center of trade and commerce. In 1353, Bern joined the Swiss Confederacy, and became its capital in 1848.","images":["https://www.alibabuy.com/photos/library/1500/13008.jpg","https://www.chateauberne.com/wp-content/uploads/2021/10/2-A-drone-hotel-@droneyourproperty-1000x700.png","https://www.swisscaution.ch/wp-content/uploads/Berne-1100x733-2.jpeg","https://c1.wallpaperflare.com/preview/925/12/916/swiss-berne-the-old-town.jpg"]},{"capital":"Kyiv","country":"Ukraine","favourite":false,"visited":false,"planned":false,"url":"https://cdnp.flypgs.com/files/Sehirler-long-tail/Kyiv/kyiv-bag_ms_zl_k-anit.jpg","description":"Kyiv is the capital and most populous city of Ukraine. It is in north-central Ukraine along the Dnieper River. As of 1 January 2022, its population was 2,952,301, making Kyiv the seventh-most populous city in Europe. Kyiv is an important industrial, scientific, educational, and cultural center in Eastern Europe. It is home to many high-tech industries, higher education institutions, and historical landmarks. The city has an extensive system of public transport and infrastructure, including the Kyiv Metro. Kyiv is a very old city, with a history dating back to the 9th century. It was founded by the Slavic people and was the capital of the first Slavic state, Kievan Rus. Kyiv was a major center of trade and culture in the Middle Ages and was home to many important religious and cultural institutions. The city was also a major center of the Cossack movement in the 17th and 18th centuries.","images":["https://gdb.rferl.org/fc06b200-8659-4f79-8184-874ceb34616e_w1080_r0_s.jpg","https://upload.wikimedia.org/wikipedia/uk/a/a8/Kiev_Independence_Square_cropped.jpg","https://c4.wallpaperflare.com/wallpaper/252/246/522/golden-gate-kiev-ukraine-zoloti-vorota-wallpaper-preview.jpg","https://static.dw.com/image/62926482_605.jpeg"]},{"capital":"London","country":"United Kingdom","favourite":false,"visited":false,"planned":false,"url":"https://planetofhotels.com/guide/sites/default/files/styles/node__blog_post__bp_banner/public/live_banner/London-1.jpg","description":"London is the capital of England and the United Kingdom. It is the most populous city in the United Kingdom, with a metropolitan area of over 13 million inhabitants. London is a global city, with strengths in finance, banking, commerce, entertainment, the arts, fashion, research, technology, education, and tourism. London has been a major settlement for two millennia. Its core, the ancient City of London, largely retains its square-mile medieval boundaries. Today, the City of London is a major financial, commercial and cultural centre, with an independent economy. The bulk of London\'s more than 2.9 million residents live in the surrounding metropolitan area, which extends beyond Greater London.","images":["https://cdn.britannica.com/38/242638-050-D96EB78F/Buckingham-Palace-Victoria-Memorial-Tulips-London-England.jpg","https://c4.wallpaperflare.com/wallpaper/246/582/347/evening-europe-tower-bridge-london-wallpaper-preview.jpg","https://c1.wallpaperflare.com/preview/53/944/1005/big-ben-clock-lights-reflection.jpg","https://e0.pxfuel.com/wallpapers/622/355/desktop-wallpaper-london-eye-ferris-wheel-awesome-aesthetic-london.jpg"]},{"capital":"Vatican","country":"Vatican","favourite":false,"visited":false,"planned":false,"url":"https://mamalovesrome.com/wp-content/uploads/2021/05/Vatican-City-St-Peter-basilica-DP.jpg","description":"The Vatican City is a walled enclave within the city of Rome. It is the smallest internationally recognized independent state in the world by both area and population, having an area of approximately 49 hectares (121 acres) and a population of just over 800 people. Vatican City is the seat of the Roman Catholic Church, the world\'s largest Christian church. The Pope is the head of state of the Vatican City and the supreme leader of the Catholic Church. The Vatican City was established in 1929 with the signing of the Lateran Treaty between the Holy See and Italy. The treaty ended the Roman Question, a dispute between the papacy and Italy that had lasted for over half a century. The Vatican City is a sovereign state and is not part of Italy. It has its own flag, currency, and postal service.","images":["https://cdn.britannica.com/38/242638-050-D96EB78F/Buckingham-Palace-Victoria-Memorial-Tulips-London-England.jpg","https://cdn.britannica.com/96/175196-050-EA0EF9D1/St-Peters-Basilica-Vatican-City.jpg","https://media.tacdn.com/media/attractions-splice-spp-674x446/0f/ba/c1/d8.jpg","https://assets.editorial.aetnd.com/uploads/2023/03/vatican-city-GettyImages-1097352500.jpg"]}]');class BA{}class hw{}class pu{constructor(n){this.normalizedNames=new Map,this.lazyUpdate=null,n?this.lazyInit="string"==typeof n?()=>{this.headers=new Map,n.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const l=t.slice(0,r),u=l.toLowerCase(),g=t.slice(r+1).trim();this.maybeSetNormalizedName(l,u),this.headers.has(u)?this.headers.get(u).push(g):this.headers.set(u,[g])}})}:()=>{this.headers=new Map,Object.keys(n).forEach(t=>{let r=n[t];const l=t.toLowerCase();"string"==typeof r&&(r=[r]),r.length>0&&(this.headers.set(l,r),this.maybeSetNormalizedName(t,l))})}:this.headers=new Map}has(n){return this.init(),this.headers.has(n.toLowerCase())}get(n){this.init();const t=this.headers.get(n.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(n){return this.init(),this.headers.get(n.toLowerCase())||null}append(n,t){return this.clone({name:n,value:t,op:"a"})}set(n,t){return this.clone({name:n,value:t,op:"s"})}delete(n,t){return this.clone({name:n,value:t,op:"d"})}maybeSetNormalizedName(n,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,n)}init(){this.lazyInit&&(this.lazyInit instanceof pu?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(n=>this.applyUpdate(n)),this.lazyUpdate=null))}copyFrom(n){n.init(),Array.from(n.headers.keys()).forEach(t=>{this.headers.set(t,n.headers.get(t)),this.normalizedNames.set(t,n.normalizedNames.get(t))})}clone(n){const t=new pu;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof pu?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([n]),t}applyUpdate(n){const t=n.name.toLowerCase();switch(n.op){case"a":case"s":let r=n.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(n.name,t);const l=("a"===n.op?this.headers.get(t):void 0)||[];l.push(...r),this.headers.set(t,l);break;case"d":const u=n.value;if(u){let g=this.headers.get(t);if(!g)return;g=g.filter(w=>-1===u.indexOf(w)),0===g.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,g)}else this.headers.delete(t),this.normalizedNames.delete(t)}}forEach(n){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>n(this.normalizedNames.get(t),this.headers.get(t)))}}class rN{encodeKey(n){return JT(n)}encodeValue(n){return JT(n)}decodeKey(n){return decodeURIComponent(n)}decodeValue(n){return decodeURIComponent(n)}}const sN=/%(\d[a-f0-9])/gi,aN={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function JT(e){return encodeURIComponent(e).replace(sN,(n,t)=>aN[t]??n)}function NA(e){return`${e}`}class Vh{constructor(n={}){if(this.updates=null,this.cloneFrom=null,this.encoder=n.encoder||new rN,n.fromString){if(n.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function oN(e,n){const t=new Map;return e.length>0&&e.replace(/^\?/,"").split("&").forEach(l=>{const u=l.indexOf("="),[g,w]=-1==u?[n.decodeKey(l),""]:[n.decodeKey(l.slice(0,u)),n.decodeValue(l.slice(u+1))],I=t.get(g)||[];I.push(w),t.set(g,I)}),t}(n.fromString,this.encoder)}else n.fromObject?(this.map=new Map,Object.keys(n.fromObject).forEach(t=>{const r=n.fromObject[t],l=Array.isArray(r)?r.map(NA):[NA(r)];this.map.set(t,l)})):this.map=null}has(n){return this.init(),this.map.has(n)}get(n){this.init();const t=this.map.get(n);return t?t[0]:null}getAll(n){return this.init(),this.map.get(n)||null}keys(){return this.init(),Array.from(this.map.keys())}append(n,t){return this.clone({param:n,value:t,op:"a"})}appendAll(n){const t=[];return Object.keys(n).forEach(r=>{const l=n[r];Array.isArray(l)?l.forEach(u=>{t.push({param:r,value:u,op:"a"})}):t.push({param:r,value:l,op:"a"})}),this.clone(t)}set(n,t){return this.clone({param:n,value:t,op:"s"})}delete(n,t){return this.clone({param:n,value:t,op:"d"})}toString(){return this.init(),this.keys().map(n=>{const t=this.encoder.encodeKey(n);return this.map.get(n).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(n=>""!==n).join("&")}clone(n){const t=new Vh({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(n),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(n=>this.map.set(n,this.cloneFrom.map.get(n))),this.updates.forEach(n=>{switch(n.op){case"a":case"s":const t=("a"===n.op?this.map.get(n.param):void 0)||[];t.push(NA(n.value)),this.map.set(n.param,t);break;case"d":if(void 0===n.value){this.map.delete(n.param);break}{let r=this.map.get(n.param)||[];const l=r.indexOf(NA(n.value));-1!==l&&r.splice(l,1),r.length>0?this.map.set(n.param,r):this.map.delete(n.param)}}}),this.cloneFrom=this.updates=null)}}class lN{constructor(){this.map=new Map}set(n,t){return this.map.set(n,t),this}get(n){return this.map.has(n)||this.map.set(n,n.defaultValue()),this.map.get(n)}delete(n){return this.map.delete(n),this}has(n){return this.map.has(n)}keys(){return this.map.keys()}}function YT(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer}function eM(e){return typeof Blob<"u"&&e instanceof Blob}function tM(e){return typeof FormData<"u"&&e instanceof FormData}class V_{constructor(n,t,r,l){let u;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=n.toUpperCase(),function cN(e){switch(e){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||l?(this.body=void 0!==r?r:null,u=l):u=r,u&&(this.reportProgress=!!u.reportProgress,this.withCredentials=!!u.withCredentials,u.responseType&&(this.responseType=u.responseType),u.headers&&(this.headers=u.headers),u.context&&(this.context=u.context),u.params&&(this.params=u.params)),this.headers||(this.headers=new pu),this.context||(this.context=new lN),this.params){const g=this.params.toString();if(0===g.length)this.urlWithParams=t;else{const w=t.indexOf("?");this.urlWithParams=t+(-1===w?"?":w<t.length-1?"&":"")+g}}else this.params=new Vh,this.urlWithParams=t}serializeBody(){return null===this.body?null:YT(this.body)||eM(this.body)||tM(this.body)||function uN(e){return typeof URLSearchParams<"u"&&e instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Vh?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||tM(this.body)?null:eM(this.body)?this.body.type||null:YT(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Vh?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(n={}){const t=n.method||this.method,r=n.url||this.url,l=n.responseType||this.responseType,u=void 0!==n.body?n.body:this.body,g=void 0!==n.withCredentials?n.withCredentials:this.withCredentials,w=void 0!==n.reportProgress?n.reportProgress:this.reportProgress;let I=n.headers||this.headers,S=n.params||this.params;const L=n.context??this.context;return void 0!==n.setHeaders&&(I=Object.keys(n.setHeaders).reduce((j,ne)=>j.set(ne,n.setHeaders[ne]),I)),n.setParams&&(S=Object.keys(n.setParams).reduce((j,ne)=>j.set(ne,n.setParams[ne]),S)),new V_(t,r,u,{params:S,headers:I,context:L,reportProgress:w,responseType:l,withCredentials:g})}}var Pr=(()=>((Pr=Pr||{})[Pr.Sent=0]="Sent",Pr[Pr.UploadProgress=1]="UploadProgress",Pr[Pr.ResponseHeader=2]="ResponseHeader",Pr[Pr.DownloadProgress=3]="DownloadProgress",Pr[Pr.Response=4]="Response",Pr[Pr.User=5]="User",Pr))();class dw{constructor(n,t=200,r="OK"){this.headers=n.headers||new pu,this.status=void 0!==n.status?n.status:t,this.statusText=n.statusText||r,this.url=n.url||null,this.ok=this.status>=200&&this.status<300}}class pw extends dw{constructor(n={}){super(n),this.type=Pr.ResponseHeader}clone(n={}){return new pw({headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class zA extends dw{constructor(n={}){super(n),this.type=Pr.Response,this.body=void 0!==n.body?n.body:null}clone(n={}){return new zA({body:void 0!==n.body?n.body:this.body,headers:n.headers||this.headers,status:void 0!==n.status?n.status:this.status,statusText:n.statusText||this.statusText,url:n.url||this.url||void 0})}}class nM extends dw{constructor(n){super(n,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${n.url||"(unknown url)"}`:`Http failure response for ${n.url||"(unknown url)"}: ${n.status} ${n.statusText}`,this.error=n.error||null}}function fw(e,n){return{body:n,headers:e.headers,context:e.context,observe:e.observe,params:e.params,reportProgress:e.reportProgress,responseType:e.responseType,withCredentials:e.withCredentials}}let im=(()=>{class e{constructor(t){this.handler=t}request(t,r,l={}){let u;if(t instanceof V_)u=t;else{let I,S;I=l.headers instanceof pu?l.headers:new pu(l.headers),l.params&&(S=l.params instanceof Vh?l.params:new Vh({fromObject:l.params})),u=new V_(t,r,void 0!==l.body?l.body:null,{headers:I,context:l.context,params:S,reportProgress:l.reportProgress,responseType:l.responseType||"json",withCredentials:l.withCredentials})}const g=Lt(u).pipe(Fh(I=>this.handler.handle(I)));if(t instanceof V_||"events"===l.observe)return g;const w=g.pipe(nc(I=>I instanceof zA));switch(l.observe||"body"){case"body":switch(u.responseType){case"arraybuffer":return w.pipe(ht(I=>{if(null!==I.body&&!(I.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return I.body}));case"blob":return w.pipe(ht(I=>{if(null!==I.body&&!(I.body instanceof Blob))throw new Error("Response is not a Blob.");return I.body}));case"text":return w.pipe(ht(I=>{if(null!==I.body&&"string"!=typeof I.body)throw new Error("Response is not a string.");return I.body}));default:return w.pipe(ht(I=>I.body))}case"response":return w;default:throw new Error(`Unreachable: unhandled observe type ${l.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new Vh).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,l={}){return this.request("PATCH",t,fw(l,r))}post(t,r,l={}){return this.request("POST",t,fw(l,r))}put(t,r,l={}){return this.request("PUT",t,fw(l,r))}}return e.\u0275fac=function(t){return new(t||e)(gt(BA))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();function iM(e,n){return n(e)}function hN(e,n){return(t,r)=>n.intercept(t,{handle:l=>e(l,r)})}const pN=new xt("HTTP_INTERCEPTORS"),U_=new xt("HTTP_INTERCEPTOR_FNS");function fN(){let e=null;return(n,t)=>(null===e&&(e=(Wt(pN,{optional:!0})??[]).reduceRight(hN,iM)),e(n,t))}let rM=(()=>{class e extends BA{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null}handle(t){if(null===this.chain){const r=Array.from(new Set(this.injector.get(U_)));this.chain=r.reduceRight((l,u)=>function dN(e,n,t){return(r,l)=>t.runInContext(()=>n(r,u=>e(u,l)))}(l,u,this.injector),iM)}return this.chain(t,r=>this.backend.handle(r))}}return e.\u0275fac=function(t){return new(t||e)(gt(hw),gt(Ea))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const yN=/^\)\]\}',?\n/;let sM=(()=>{class e{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new fn(r=>{const l=this.xhrFactory.build();if(l.open(t.method,t.urlWithParams),t.withCredentials&&(l.withCredentials=!0),t.headers.forEach((se,he)=>l.setRequestHeader(se,he.join(","))),t.headers.has("Accept")||l.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const se=t.detectContentTypeHeader();null!==se&&l.setRequestHeader("Content-Type",se)}if(t.responseType){const se=t.responseType.toLowerCase();l.responseType="json"!==se?se:"text"}const u=t.serializeBody();let g=null;const w=()=>{if(null!==g)return g;const se=l.statusText||"OK",he=new pu(l.getAllResponseHeaders()),Ie=function vN(e){return"responseURL"in e&&e.responseURL?e.responseURL:/^X-Request-URL:/m.test(e.getAllResponseHeaders())?e.getResponseHeader("X-Request-URL"):null}(l)||t.url;return g=new pw({headers:he,status:l.status,statusText:se,url:Ie}),g},I=()=>{let{headers:se,status:he,statusText:Ie,url:Ue}=w(),$e=null;204!==he&&($e=typeof l.response>"u"?l.responseText:l.response),0===he&&(he=$e?200:0);let _t=he>=200&&he<300;if("json"===t.responseType&&"string"==typeof $e){const Ke=$e;$e=$e.replace(yN,"");try{$e=""!==$e?JSON.parse($e):null}catch($t){$e=Ke,_t&&(_t=!1,$e={error:$t,text:$e})}}_t?(r.next(new zA({body:$e,headers:se,status:he,statusText:Ie,url:Ue||void 0})),r.complete()):r.error(new nM({error:$e,headers:se,status:he,statusText:Ie,url:Ue||void 0}))},S=se=>{const{url:he}=w(),Ie=new nM({error:se,status:l.status||0,statusText:l.statusText||"Unknown Error",url:he||void 0});r.error(Ie)};let L=!1;const j=se=>{L||(r.next(w()),L=!0);let he={type:Pr.DownloadProgress,loaded:se.loaded};se.lengthComputable&&(he.total=se.total),"text"===t.responseType&&l.responseText&&(he.partialText=l.responseText),r.next(he)},ne=se=>{let he={type:Pr.UploadProgress,loaded:se.loaded};se.lengthComputable&&(he.total=se.total),r.next(he)};return l.addEventListener("load",I),l.addEventListener("error",S),l.addEventListener("timeout",S),l.addEventListener("abort",S),t.reportProgress&&(l.addEventListener("progress",j),null!==u&&l.upload&&l.upload.addEventListener("progress",ne)),l.send(u),r.next({type:Pr.Sent}),()=>{l.removeEventListener("error",S),l.removeEventListener("abort",S),l.removeEventListener("load",I),l.removeEventListener("timeout",S),t.reportProgress&&(l.removeEventListener("progress",j),null!==u&&l.upload&&l.upload.removeEventListener("progress",ne)),l.readyState!==l.DONE&&l.abort()}})}}return e.\u0275fac=function(t){return new(t||e)(gt(hI))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const mw=new xt("XSRF_ENABLED"),aM=new xt("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),lM=new xt("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class cM{}let bN=(()=>{class e{constructor(t,r,l){this.doc=t,this.platform=r,this.cookieName=l,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=eI(t,this.cookieName),this.lastCookieString=t),this.lastToken}}return e.\u0275fac=function(t){return new(t||e)(gt(Ri),gt(g_),gt(aM))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();function wN(e,n){const t=e.url.toLowerCase();if(!Wt(mw)||"GET"===e.method||"HEAD"===e.method||t.startsWith("http://")||t.startsWith("https://"))return n(e);const r=Wt(cM).getToken(),l=Wt(lM);return null!=r&&!e.headers.has(l)&&(e=e.clone({headers:e.headers.set(l,r)})),n(e)}var fr=(()=>((fr=fr||{})[fr.Interceptors=0]="Interceptors",fr[fr.LegacyInterceptors=1]="LegacyInterceptors",fr[fr.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",fr[fr.NoXsrfProtection=3]="NoXsrfProtection",fr[fr.JsonpSupport=4]="JsonpSupport",fr[fr.RequestsMadeViaParent=5]="RequestsMadeViaParent",fr))();function rm(e,n){return{\u0275kind:e,\u0275providers:n}}function EN(...e){const n=[im,sM,rM,{provide:BA,useExisting:rM},{provide:hw,useExisting:sM},{provide:U_,useValue:wN,multi:!0},{provide:mw,useValue:!0},{provide:cM,useClass:bN}];for(const t of e)n.push(...t.\u0275providers);return function Ly(e){return{\u0275providers:e}}(n)}const uM=new xt("LEGACY_INTERCEPTOR_FN");let IN=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({providers:[EN(rm(fr.LegacyInterceptors,[{provide:uM,useFactory:fN},{provide:U_,useExisting:uM,multi:!0}]))]}),e})(),VA=(()=>{class e{constructor(t){this.http=t,this.API_KEY="e5cdd4eb059c0c34a3f8a7e01fd6758e",this.API_URL="https://api.openweathermap.org/data/2.5/",this.API_URL_GEO="https://api.openweathermap.org/geo/1.0/"}getWeather(t){return this.http.get(`${this.API_URL}weather?q=${t.toLowerCase()}&units=metric&appid=${this.API_KEY}`).pipe(ht(r=>({temp:r.main.temp,icon:`https://openweathermap.org/img/wn/${r.weather[0].icon}@2x.png`})),ic(r=>Lt({temp:-1e4,message:r.error.message})))}getGeo(t){const r=`${this.API_URL_GEO}direct?q=${t.toLowerCase()}&limit=5&appid=${this.API_KEY}`;return this.http.get(r).pipe(ht(l=>{const u=l[0];return{lat:u.lat,lon:u.lon}}))}getWeatherForecast(t){const r=`${this.API_URL}forecast?q=${t.toLowerCase()}&units=metric&appid=${this.API_KEY}`;return this.http.get(r).pipe(ht(l=>{const u=[];for(let g=0;g<l.list.length;g+=8)u.push({date:l.list[g].dt_txt,temperature:l.list[g].main.temp,description:l.list[g].weather[0].description,pressure:l.list[g].main.pressure,wind:l.list[g].wind.speed,humidity:l.list[g].main.humidity,feelsLike:l.list[g].main.feels_like,icon:`https://openweathermap.org/img/wn/${l.list[g].weather[0].icon}@2x.png`});return u}))}}return e.\u0275fac=function(t){return new(t||e)(gt(im))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),j_=(()=>{class e{constructor(t,r){this.weatherService=t,this.http=r,this.capitals=iN,this.min=1e3,this.max=-1e3,this.temperature=-1,this.dialogValue=!1,this.searchValueSubject=new rr,this.capitalIdSubject=new rr}ngOnInit(){for(let t=0;t<this.capitals.length;t++)this.capitals[t].id=t}getMinValue(){this.min=this.capitals[0].temperature;for(let t=0;t<this.capitals.length;t++)this.min>this.capitals[t].temperature&&(this.min=this.capitals[t].temperature);return this.min}getMaxValue(){this.max=this.capitals[0].temperature;for(let t=0;t<this.capitals.length;t++)this.max<this.capitals[t].temperature&&(this.max=this.capitals[t].temperature);return this.max}updateCapitals(t){this.capitals=t}dialog(){this.dialogValue=!this.dialogValue,console.log(this.dialogValue)}}return e.\u0275fac=function(t){return new(t||e)(gt(VA),gt(im))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function TN(e,n){1&e&&Dt(0,"app-add-capital")}const gw=function(e,n){return{"fav-active":e,"filled-star":n}},MN=function(e){return["/capitals",e]};function DN(e,n){if(1&e){const t=Gt();ke(0,"div",37)(1,"div",38)(2,"div",39)(3,"button",40),ft("click",function(){const u=Tn(t).$implicit;return _n(Ft().onclickFavourite(u))}),ke(4,"div",41),Dt(5,"i",42),Ne()(),ke(6,"button",43),ft("click",function(){const u=Tn(t).$implicit;return _n(Ft().onclickPlanned(u))}),ke(7,"div",41),Dt(8,"i",42),Ne()(),ke(9,"button",44),ft("click",function(){const u=Tn(t).$implicit;return _n(Ft().onclickVisited(u))}),ke(10,"div",41),Dt(11,"i",42),Ne()()(),ke(12,"div",45),Dt(13,"div",46)(14,"img",47),Ne(),ke(15,"div",48)(16,"div",49)(17,"h2",50),bt(18),Ne(),Dt(19,"img",51),Ne(),ke(20,"h4",52),bt(21),Ne(),ke(22,"h6",53),bt(23),Ne()(),ke(24,"div",54)(25,"button",55),ft("click",function(){const u=Tn(t).$implicit;return _n(Ft().deleteCapital(u.id))}),ke(26,"div",41),Dt(27,"i",56),Ne()(),ke(28,"div",57)(29,"button",58),ft("click",function(){return Tn(t),_n(Ft().scrollTop())}),bt(30,"Show more"),Ne()()()()()}if(2&e){const t=n.$implicit,r=Ft();ct(1),Nf("background",r.getCapitalColor(t.temperature)),ct(2),ot("ngClass",su(16,gw,t.favourite,t.favourite)),ct(2),ot("ngClass",t.favourite?"bi-star-fill":"bi-star"),ct(1),ot("ngClass",su(19,gw,t.planned,t.planned)),ct(2),ot("ngClass",t.planned?"bi-calendar-check":"bi-calendar"),ct(1),ot("ngClass",su(22,gw,t.visited,t.visited)),ct(2),ot("ngClass",t.visited?"bi-eye-fill":"bi-eye"),ct(2),Nf("background",r.getCapitalColorTransition()),ct(1),ru("src",t.url,wa),ct(4),Yr("",t.temperature,"\xb0C"),ct(1),ru("src",t.icon,wa),ct(2),ou(t.capital),ct(2),ou(t.country),ct(6),ot("routerLink",Cs(25,MN,t.id))}}let _w=(()=>{class e{constructor(t,r){this.helper=t,this.weatherService=r,this.originalCapitals=[],this.capitals=[],this.searchValue="",this.sortOrder="temp",this.showParameter="null",this.capitalColor="",this.dialogValue=!1}ngOnInit(){this.originalCapitals=[...this.helper.capitals];const t=localStorage.getItem("capitals");this.capitals=t?JSON.parse(t):[...this.originalCapitals],this.helper.capitalIdSubject.next(-1),this.helper.searchValueSubject.subscribe(r=>{this.searchValue=r});for(let r=0;r<this.capitals.length;r++)this.capitals[r].id=r;console.log(this.capitals[5].id),this.helper.updateCapitals(this.capitals),this.helper.getMaxValue(),this.helper.getMinValue()}updateWeatherData(){for(let t=0;t<this.capitals.length;t++)this.weatherService.getWeather(this.capitals[t].capital).subscribe(r=>{this.capitals[t].temperature=Math.round(10*r.temp)/10,this.capitals[t].icon=r.icon})}get filteredCapitals(){let t=this.capitals.filter(r=>r.capital.toLowerCase().includes(this.searchValue.toLowerCase()));return"capital"===this.sortOrder?t=t.sort((r,l)=>r.capital.localeCompare(l.capital)):"-capital"===this.sortOrder?t=t.sort((r,l)=>l.capital.localeCompare(r.capital)):"temp"===this.sortOrder?t=t.sort((r,l)=>l.temperature-r.temperature):"-temp"===this.sortOrder?t=t.sort((r,l)=>r.temperature-l.temperature):"country"===this.sortOrder?t=t.sort((r,l)=>r.country.localeCompare(l.country)):"-country"===this.sortOrder&&(t=t.sort((r,l)=>l.country.localeCompare(r.country))),"visited"==this.showParameter?t=t.filter(r=>r.visited):"planned"==this.showParameter?t=t.filter(r=>r.planned):"favourite"==this.showParameter&&(t=t.filter(r=>r.favourite)),t}onChangeFilter(t){this.showParameter=t}onChangeSort(t){console.log(this.sortOrder),this.sortOrder=t}getCapitalColor(t){const r=(t+this.helper.min)/(this.helper.max+this.helper.min);let l,u,g;if(r<.5)l=205+Math.round(100*r),u=230+Math.round(100*r),g=255;else{const w=(t+this.helper.min)/(this.helper.max+this.helper.min);l=255,u=Math.round(150/w),g=Math.round(150/w)}return this.capitalColor=`rgba(${l},${u},${g},1)`,this.capitalColor}getCapitalColorTransition(){return`linear-gradient(rgba(255,255,255,0)50%, ${this.capitalColor})`}onclickFavourite(t){t.favourite=!t.favourite}onclickVisited(t){t.visited=!t.visited}onclickPlanned(t){t.planned=!t.planned}deleteCapital(t){for(let r=0;r<this.helper.capitals.length;r++)this.helper.capitals[r].id==t&&this.helper.capitals.splice(r,1);this.capitals=[...this.helper.capitals],this.helper.getMaxValue(),this.helper.getMinValue()}restoreCapital(){this.capitals=[...this.originalCapitals],this.updateWeatherData(),this.helper.updateCapitals(this.capitals),this.helper.getMaxValue(),this.helper.getMinValue()}scrollTop(){document.getElementById("home").scrollIntoView({behavior:"auto",block:"start",inline:"nearest"})}ngOnDestroy(){localStorage.setItem("capitals",JSON.stringify(this.capitals))}unloadHandler(){localStorage.setItem("capitals",JSON.stringify(this.capitals))}onAdd(){this.helper.dialog()}}return e.\u0275fac=function(t){return new(t||e)(qe(j_),qe(VA))},e.\u0275cmp=vr({type:e,selectors:[["app-test"]],hostBindings:function(t,r){1&t&&ft("beforeunload",function(u){return r.unloadHandler(u)},0,Ld)},decls:54,vars:2,consts:[["id","home"],[4,"ngIf"],["id","capitals"],[1,"container","main-container","px-0","my-5"],[1,"row","restore-container","w-100","mx-auto","py-3","px-4","px-lg-5"],[1,"col-6","col-sm-4","col-lg-4","px-1"],[1,"row"],[1,"col-4","col-sm-4","col-md-3","col-lg-4","col-xl-3","px-0"],[1,"my-auto","text-top"],[1,"col-8","col-sm-8","col-md-7","col-lg-6","col-xl-5","my-auto"],[1,"select-filter","w-100",3,"change"],["filter",""],["value","null"],["value","visited"],["value","planned"],["value","favourite"],[1,"col-6","col-sm-4","col-lg-4","col-xl-4","px-1"],[1,"row","h-100"],[1,"col-4","col-sm-4","col-md-3","col-lg-4","col-xl-3","px-1","my-auto"],[1,"col-8","col-sm-8","col-md-7","col-lg-6","col-xl-5","px-2","my-auto"],["sort",""],["value","temp"],["value","-temp"],["value","capital"],["value","-capital"],["value","country"],["value","-country"],[1,"col-sm-4","col-lg-4","col-xl-4","px-1","my-auto"],[1,"row","flex-row-reverse","mt-2","mt-sm-0"],[1,"col-8","col-sm-7","col-xl-5","px-2","px-sm-0","px-md-2","my-auto"],["type","button",1,"btn","btn-success","btn-restore",3,"click"],[1,"col-4","col-sm-4","px-2","my-auto"],["type","button",1,"btn","btn-top","btn-add","py-0",3,"click"],[1,"btn-add-text-big"],[1,"btn-add-text-small"],[1,"row","cards","mx-0","cards-container"],["class","col-12 col-sm-12 col-md-6 col-lg-4 col-xl-3 px-2",4,"ngFor","ngForOf"],[1,"col-12","col-sm-12","col-md-6","col-lg-4","col-xl-3","px-2"],[1,"card","mx-auto","mb-4","position-relative"],[1,"row","flex-row-reverse","row-buttons"],[1,"text-body","favourite",3,"ngClass","click"],[1,"icon"],[1,"bi",3,"ngClass"],[1,"text-body","planned",3,"ngClass","click"],[1,"text-body","visited",3,"ngClass","click"],[1,"img-container","position-relative","top-0","start-0"],[1,"img-transition","position-absolute"],["alt","Card image cap",1,"card-img-top",3,"src"],[1,"card-body"],[1,"title-container"],[1,"card-title","text-body","my-auto","h-25"],[1,"my-auto","weather-icon",3,"src"],[1,"card-text","mt-3"],[1,"card-text"],[1,"card-body","p-0","py-2","px-3"],[1,"del","text-danger","position-absolute","bottom-0","end-0","py-1","px-1","bg-transparent",3,"click"],[1,"bi","bi-trash3"],[1,"btn-container","w-100","mb-1"],[1,"btn","btn-more","py-0","px-0",3,"routerLink","click"]],template:function(t,r){if(1&t){const l=Gt();Dt(0,"app-hello",0),At(1,TN,1,0,"app-add-capital",1),ke(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"p",8),bt(9,"Filter:"),Ne()(),ke(10,"div",9)(11,"select",10,11),ft("change",function(){Tn(l);const g=zn(12);return _n(r.onChangeFilter(g.value))}),ke(13,"option",12),bt(14,"None"),Ne(),ke(15,"option",13),bt(16,"Visited"),Ne(),ke(17,"option",14),bt(18,"Planned"),Ne(),ke(19,"option",15),bt(20,"Favourite"),Ne()()()()(),ke(21,"div",16)(22,"div",17)(23,"div",18)(24,"p",8),bt(25,"Sort:"),Ne()(),ke(26,"div",19)(27,"select",10,20),ft("change",function(){Tn(l);const g=zn(28);return _n(r.onChangeSort(g.value))}),ke(29,"option",21),bt(30,"Temp High"),Ne(),ke(31,"option",22),bt(32,"Temp Low"),Ne(),ke(33,"option",23),bt(34,"Capital A-z"),Ne(),ke(35,"option",24),bt(36,"Capital z-A"),Ne(),ke(37,"option",25),bt(38,"Country A-z"),Ne(),ke(39,"option",26),bt(40,"Country z-A"),Ne()()()()(),ke(41,"div",27)(42,"div",28)(43,"div",29)(44,"button",30),ft("click",function(){return r.restoreCapital()}),bt(45,"Restore"),Ne()(),ke(46,"div",31)(47,"button",32),ft("click",function(){return r.onAdd()}),ke(48,"span",33),bt(49,"+"),Ne(),ke(50,"span",34),bt(51,"Add"),Ne()()()()()(),ke(52,"div",35),At(53,DN,31,27,"div",36),Ne()()()}2&t&&(ct(1),ot("ngIf",r.helper.dialogValue),ct(52),ot("ngForOf",r.filteredCapitals))},styles:["#capitals[_ngcontent-%COMP%]{padding-top:90px}.main-container[_ngcontent-%COMP%]{margin-top:0!important;margin-bottom:0!important;overflow:hidden;width:100%;background-color:#fff6;border-radius:1rem;border:rgb(255,255,255) 3px solid;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);box-shadow:#63636333 0 1px 5px}.img-container[_ngcontent-%COMP%]{height:180px}.restore-container[_ngcontent-%COMP%]{background-color:#fff6;border-bottom:white 3px solid}.text-top[_ngcontent-%COMP%]{vertical-align:bottom;padding:15px;font-weight:500}.btn-top[_ngcontent-%COMP%]{width:100%;background-color:#fafafa;border-radius:1rem;padding:5px;font-size:.9rem;font-weight:500;color:#333;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.btn-top[_ngcontent-%COMP%]:hover{border:#333333 1px solid}.btn-restore[_ngcontent-%COMP%]{width:100%;border-radius:2rem;font-weight:500}.btn-add[_ngcontent-%COMP%]{border-radius:2rem;font-size:1.5rem;width:40px;float:right;height:40px;background:#e4c3ff;border:3px solid transparent!important;box-sizing:border-box;position:relative}.btn-add[_ngcontent-%COMP%]:hover{border:3px solid white!important}.cards-container[_ngcontent-%COMP%]{padding:25px}.cards[_ngcontent-%COMP%]{overflow:hidden}.card[_ngcontent-%COMP%]{overflow:hidden;border:rgb(255,255,255) 3px solid}.card-weather[_ngcontent-%COMP%]{width:90%!important;box-shadow:#63636333 0 1px 5px;overflow:hidden;background-color:#fafafa;border:3px white solid}.card-img-top[_ngcontent-%COMP%]{height:180px}.card-body[_ngcontent-%COMP%]{z-index:2}.img-transition[_ngcontent-%COMP%]{background:linear-gradient(rgba(255,255,255,0) 50%,rgb(255,255,255));height:100%;width:100%;z-index:1;margin-bottom:-2px}.card-title[_ngcontent-%COMP%]{font-weight:600;font-size:3rem}.title-container[_ngcontent-%COMP%]{margin-top:-77px;display:flex}.weather-icon[_ngcontent-%COMP%]{width:70px;height:70px;filter:drop-shadow(2px 3px 2px rgba(0,0,0,.3))}a[_ngcontent-%COMP%]{text-decoration:none}.row-buttons[_ngcontent-%COMP%]{overflow:hidden;position:absolute;top:-1px;right:12px;z-index:4;background-color:#fffc;border-bottom-left-radius:.5rem;border-left:3px white solid;border-bottom:3px white solid}.favourite[_ngcontent-%COMP%], .visited[_ngcontent-%COMP%], .planned[_ngcontent-%COMP%]{width:45px;padding:0;background:transparent}.del[_ngcontent-%COMP%], .favourite[_ngcontent-%COMP%], .visited[_ngcontent-%COMP%], .planned[_ngcontent-%COMP%]{border:none}.icon[_ngcontent-%COMP%]{height:48px;width:48px;font-size:2rem;text-align:center}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:color .1s}.bi-calendar-check[_ngcontent-%COMP%], .bi-calendar[_ngcontent-%COMP%]:hover{color:#23c26b}.bi-eye-fill[_ngcontent-%COMP%], .bi-eye[_ngcontent-%COMP%]:hover{color:#1e90ff}.bi-star[_ngcontent-%COMP%]{color:#333;margin-top:0;padding-top:0}.bi-star-fill[_ngcontent-%COMP%], .bi-star[_ngcontent-%COMP%]:hover{color:#fdda18}.bi-trash3[_ngcontent-%COMP%]{color:#24292e;transition:.1s}.bi-trash3[_ngcontent-%COMP%]:hover{color:red}.s-field[_ngcontent-%COMP%]{background-color:#fff;height:100%;padding-top:10px;padding-bottom:10px}.form-inline[_ngcontent-%COMP%]{width:90%}.btn-more[_ngcontent-%COMP%]{height:40px;padding:.375rem 10px!important;border-radius:2rem;border:transparent 3px solid;font-weight:500;box-sizing:inherit;background-color:#9696961a}.btn-more[_ngcontent-%COMP%]:hover, .btn-success[_ngcontent-%COMP%]:hover{border:white 3px solid}.add-capital[_ngcontent-%COMP%]{position:fixed;top:0;left:0}.select-filter[_ngcontent-%COMP%]{background-color:#fafafa;border:none;border-radius:1rem;padding:7px 20px 7px 7px;font-size:.9rem;font-weight:500;color:#333;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;cursor:pointer}.select-filter[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.7)}.options[_ngcontent-%COMP%]{margin-top:5px;cursor:pointer}.btn-add-text-small[_ngcontent-%COMP%], .btn-add-text-big[_ngcontent-%COMP%]{font-size:1rem;position:absolute;top:6px;left:0;right:0;width:100%}.btn-add-text-big[_ngcontent-%COMP%]{top:-5px;font-size:1.7rem}.bi-arrow-down[_ngcontent-%COMP%]{width:20px;height:20px}@media (max-width: 992px){#capitals[_ngcontent-%COMP%]{padding-top:60px}}@media (min-width: 576px){.btn-add-text-small[_ngcontent-%COMP%]{display:none}}@media (min-width: 768px){.btn-add-text-big[_ngcontent-%COMP%]{display:none}.btn-add-text-small[_ngcontent-%COMP%]{display:inline;top:6px}.btn-add[_ngcontent-%COMP%]{width:100%}}@media (max-width: 576px){.btn-top[_ngcontent-%COMP%], .btn-success[_ngcontent-%COMP%], .btn-add[_ngcontent-%COMP%], .btn-restore[_ngcontent-%COMP%]{margin-top:5px}.main-container[_ngcontent-%COMP%]{width:98%}.btn-add[_ngcontent-%COMP%]{width:100%;padding-top:0}.btn-add-text-big[_ngcontent-%COMP%]{display:none}}"]}),e})();var hM=gu(898);let pM=(()=>{class e{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=l=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}}return e.\u0275fac=function(t){return new(t||e)(qe(il),qe(jr))},e.\u0275dir=Nt({type:e}),e})(),lp=(()=>{class e extends pM{}return e.\u0275fac=function(){let n;return function(r){return(n||(n=Cr(e)))(r||e)}}(),e.\u0275dir=Nt({type:e,features:[Jn]}),e})();const sc=new xt("NgValueAccessor"),kN={provide:sc,useExisting:vn(()=>cp),multi:!0},RN=new xt("CompositionEventMode");let cp=(()=>{class e extends pM{constructor(t,r,l){super(t,r),this._compositionMode=l,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function PN(){const e=cu()?cu().getUserAgent():"";return/android (\d+)/.test(e.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}}return e.\u0275fac=function(t){return new(t||e)(qe(il),qe(jr),qe(RN,8))},e.\u0275dir=Nt({type:e,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(t,r){1&t&&ft("input",function(u){return r._handleInput(u.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(u){return r._compositionEnd(u.target.value)})},features:[Bi([kN]),Jn]}),e})();const ON=!1,To=new xt("NgValidators"),jh=new xt("NgAsyncValidators");function EM(e){return null!=e}function CM(e){const n=li(e)?xn(e):e;if(ON&&!Mr(n)){let t="Expected async validator to return Promise or Observable.";throw"object"==typeof e&&(t+=" Are you using a synchronous validator where an async validator is expected?"),new st(-1101,t)}return n}function IM(e){let n={};return e.forEach(t=>{n=null!=t?{...n,...t}:n}),0===Object.keys(n).length?null:n}function TM(e,n){return n.map(t=>t(e))}function MM(e){return e.map(n=>function LN(e){return!e.validate}(n)?n:t=>n.validate(t))}function yw(e){return null!=e?function DM(e){if(!e)return null;const n=e.filter(EM);return 0==n.length?null:function(t){return IM(TM(t,n))}}(MM(e)):null}function SM(e){if(!e)return null;const n=e.filter(EM);return 0==n.length?null:function(t){return function dM(...e){const n=xu(e),{args:t,keys:r}=BI(e),l=new fn(u=>{const{length:g}=t;if(!g)return void u.complete();const w=new Array(g);let I=g,S=g;for(let L=0;L<g;L++){let j=!1;Ot(t[L]).subscribe(ei(u,ne=>{j||(j=!0,S--),w[L]=ne},()=>I--,void 0,()=>{(!I||!j)&&(S||u.next(r?zI(r,w):w),u.complete())}))}});return n?l.pipe(NI(n)):l}(TM(t,n).map(CM)).pipe(ht(IM))}}function vw(e){return null!=e?SM(MM(e)):null}function kM(e,n){return null===e?[n]:Array.isArray(e)?[...e,n]:[e,n]}function Aw(e){return e?Array.isArray(e)?e:[e]:[]}function jA(e,n){return Array.isArray(e)?e.includes(n):e===n}function OM(e,n){const t=Aw(n);return Aw(e).forEach(l=>{jA(t,l)||t.push(l)}),t}function FM(e,n){return Aw(n).filter(t=>!jA(e,t))}class LM{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=yw(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=vw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,t){return!!this.control&&this.control.hasError(n,t)}getError(n,t){return this.control?this.control.getError(n,t):null}}class Jo extends LM{get formDirective(){return null}get path(){return null}}class Hh extends LM{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class BM{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let H_=(()=>{class e extends BM{constructor(t){super(t)}}return e.\u0275fac=function(t){return new(t||e)(qe(Hh,2))},e.\u0275dir=Nt({type:e,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(t,r){2&t&&zf("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[Jn]}),e})(),xw=(()=>{class e extends BM{constructor(t){super(t)}}return e.\u0275fac=function(t){return new(t||e)(qe(Jo,10))},e.\u0275dir=Nt({type:e,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(t,r){2&t&&zf("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[Jn]}),e})();function NM(e,n){return e?`with name: '${n}'`:`at index: ${n}`}const Ew=!1,G_="VALID",GA="INVALID",om="PENDING",$_="DISABLED";function Cw(e){return($A(e)?e.validators:e)||null}function Iw(e,n){return($A(n)?n.asyncValidators:e)||null}function $A(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}class UM{constructor(n,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===G_}get invalid(){return this.status===GA}get pending(){return this.status==om}get disabled(){return this.status===$_}get enabled(){return this.status!==$_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators(OM(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(OM(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(FM(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(FM(n,this._rawAsyncValidators))}hasValidator(n){return jA(this._rawValidators,n)}hasAsyncValidator(n){return jA(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=om,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=$_,this.errors=null,this._forEachChild(r=>{r.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(n={}){const t=this._parentMarkedDirty(n.onlySelf);this.status=G_,this._forEachChild(r=>{r.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===G_||this.status===om)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?$_:G_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=om,this._hasOwnPendingAsyncValidator=!0;const t=CM(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,t={}){this.errors=n,this._updateControlsErrors(!1!==t.emitEvent)}get(n){let t=n;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,l)=>r&&r._find(l),this)}getError(n,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[n]:null}hasError(n,t){return!!this.getError(n,t)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new ri,this.statusChanges=new ri}_calculateStatus(){return this._allControlsDisabled()?$_:this.errors?GA:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(om)?om:this._anyControlsHaveStatus(GA)?GA:G_}_anyControlsHaveStatus(n){return this._anyControls(t=>t.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){$A(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function HN(e){return Array.isArray(e)?yw(e):e||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function GN(e){return Array.isArray(e)?vw(e):e||null}(this._rawAsyncValidators)}}class Tw extends UM{constructor(n,t,r){super(Cw(t),Iw(r,t)),this.controls=n,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,t){return this.controls[n]?this.controls[n]:(this.controls[n]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(n,t,r={}){this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(n,t={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(n,t,r={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],t&&this.registerControl(n,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,t={}){(function VM(e,n,t){e._forEachChild((r,l)=>{if(void 0===t[l])throw new st(1002,Ew?function jN(e,n){return`Must supply a value for form control ${NM(e,n)}`}(n,l):"")})})(this,!0,n),Object.keys(n).forEach(r=>{(function zM(e,n,t){const r=e.controls;if(!(n?Object.keys(r):r).length)throw new st(1e3,Ew?function VN(e){return`\n    There are no form controls registered with this ${e?"group":"array"} yet. If you're using ngModel,\n    you may want to check next tick (e.g. use setTimeout).\n  `}(n):"");if(!r[t])throw new st(1001,Ew?function UN(e,n){return`Cannot find form control ${NM(e,n)}`}(n,t):"")})(this,!0,r),this.controls[r].setValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(n,t={}){null!=n&&(Object.keys(n).forEach(r=>{const l=this.controls[r];l&&l.patchValue(n[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(n={},t={}){this._forEachChild((r,l)=>{r.reset(n[l],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(n,t,r)=>(n[r]=t.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&n(r,t)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&n(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,l)=>((r.enabled||this.disabled)&&(t[l]=r.value),t))}_reduceChildren(n,t){let r=n;return this._forEachChild((l,u)=>{r=t(r,l,u)}),r}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const sm=new xt("CallSetDisabledState",{providedIn:"root",factory:()=>qA}),qA="always";function q_(e,n,t=qA){Mw(e,n),n.valueAccessor.writeValue(e.value),(e.disabled||"always"===t)&&n.valueAccessor.setDisabledState?.(e.disabled),function WN(e,n){n.valueAccessor.registerOnChange(t=>{e._pendingValue=t,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&jM(e,n)})}(e,n),function QN(e,n){const t=(r,l)=>{n.valueAccessor.writeValue(r),l&&n.viewToModelUpdate(r)};e.registerOnChange(t),n._registerOnDestroy(()=>{e._unregisterOnChange(t)})}(e,n),function ZN(e,n){n.valueAccessor.registerOnTouched(()=>{e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&jM(e,n),"submit"!==e.updateOn&&e.markAsTouched()})}(e,n),function qN(e,n){if(n.valueAccessor.setDisabledState){const t=r=>{n.valueAccessor.setDisabledState(r)};e.registerOnDisabledChange(t),n._registerOnDestroy(()=>{e._unregisterOnDisabledChange(t)})}}(e,n)}function QA(e,n){e.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(n)})}function Mw(e,n){const t=function PM(e){return e._rawValidators}(e);null!==n.validator?e.setValidators(kM(t,n.validator)):"function"==typeof t&&e.setValidators([t]);const r=function RM(e){return e._rawAsyncValidators}(e);null!==n.asyncValidator?e.setAsyncValidators(kM(r,n.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]);const l=()=>e.updateValueAndValidity();QA(n._rawValidators,l),QA(n._rawAsyncValidators,l)}function jM(e,n){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}const ez={provide:Jo,useExisting:vn(()=>Z_)},W_=(()=>Promise.resolve())();let Z_=(()=>{class e extends Jo{constructor(t,r,l){super(),this.callSetDisabledState=l,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ri,this.form=new Tw({},yw(t),vw(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){W_.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),q_(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){W_.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){W_.then(()=>{const r=this._findContainer(t.path),l=new Tw({});(function HM(e,n){Mw(e,n)})(l,t),r.registerControl(t.name,l),l.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){W_.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){W_.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function GM(e,n){e._syncPendingControls(),n.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}}return e.\u0275fac=function(t){return new(t||e)(qe(To,10),qe(jh,10),qe(sm,8))},e.\u0275dir=Nt({type:e,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(t,r){1&t&&ft("submit",function(u){return r.onSubmit(u)})("reset",function(){return r.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Bi([ez]),Jn]}),e})();function $M(e,n){const t=e.indexOf(n);t>-1&&e.splice(t,1)}function qM(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}const WM=class extends UM{constructor(n=null,t,r){super(Cw(t),Iw(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),$A(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=qM(n)?n.value:n)}setValue(n,t={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(n,t={}){this.setValue(n,t)}reset(n=this.defaultValue,t={}){this._applyFormState(n),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){$M(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){$M(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){qM(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},iz={provide:Hh,useExisting:vn(()=>am)},XM=(()=>Promise.resolve())();let am=(()=>{class e extends Hh{constructor(t,r,l,u,g,w){super(),this._changeDetectorRef=g,this.callSetDisabledState=w,this.control=new WM,this._registered=!1,this.update=new ri,this._parent=t,this._setValidators(r),this._setAsyncValidators(l),this.valueAccessor=function kw(e,n){if(!n)return null;let t,r,l;return Array.isArray(n),n.forEach(u=>{u.constructor===cp?t=u:function JN(e){return Object.getPrototypeOf(e.constructor)===lp}(u)?r=u:l=u}),l||r||t||null}(0,u)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function Sw(e,n){if(!e.hasOwnProperty("model"))return!1;const t=e.model;return!!t.isFirstChange()||!Object.is(n,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){q_(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){XM.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,l=0!==r&&qf(r);XM.then(()=>{l&&!this.control.disabled?this.control.disable():!l&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function WA(e,n){return[...n.path,e]}(t,this._parent):[t]}}return e.\u0275fac=function(t){return new(t||e)(qe(Jo,9),qe(To,10),qe(jh,10),qe(sc,10),qe($f,8),qe(sm,8))},e.\u0275dir=Nt({type:e,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Bi([iz]),Jn,Hi]}),e})(),Pw=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275dir=Nt({type:e,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),e})(),JM=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({}),e})();const pz={provide:sc,useExisting:vn(()=>Lw),multi:!0};function oD(e,n){return null==e?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${e}: ${n}`.slice(0,50))}let Lw=(()=>{class e extends lp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){this.value=t;const l=oD(this._getOptionId(t),t);this.setProperty("value",l)}registerOnChange(t){this.onChange=r=>{this.value=this._getOptionValue(r),t(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r),t))return r;return null}_getOptionValue(t){const r=function fz(e){return e.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r):t}}return e.\u0275fac=function(){let n;return function(r){return(n||(n=Cr(e)))(r||e)}}(),e.\u0275dir=Nt({type:e,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(t,r){1&t&&ft("change",function(u){return r.onChange(u.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bi([pz]),Jn]}),e})(),sD=(()=>{class e{constructor(t,r,l){this._element=t,this._renderer=r,this._select=l,this._select&&(this.id=this._select._registerOption())}set ngValue(t){null!=this._select&&(this._select._optionMap.set(this.id,t),this._setElementValue(oD(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._setElementValue(t),this._select&&this._select.writeValue(this._select.value)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(qe(jr),qe(il),qe(Lw,9))},e.\u0275dir=Nt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})();const mz={provide:sc,useExisting:vn(()=>Bw),multi:!0};function aD(e,n){return null==e?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${e}: ${n}`.slice(0,50))}let Bw=(()=>{class e extends lp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(t){this._compareWith=t}writeValue(t){let r;if(this.value=t,Array.isArray(t)){const l=t.map(u=>this._getOptionId(u));r=(u,g)=>{u._setSelected(l.indexOf(g.toString())>-1)}}else r=(l,u)=>{l._setSelected(!1)};this._optionMap.forEach(r)}registerOnChange(t){this.onChange=r=>{const l=[],u=r.selectedOptions;if(void 0!==u){const g=u;for(let w=0;w<g.length;w++){const S=this._getOptionValue(g[w].value);l.push(S)}}else{const g=r.options;for(let w=0;w<g.length;w++){const I=g[w];if(I.selected){const S=this._getOptionValue(I.value);l.push(S)}}}this.value=l,t(l)}}_registerOption(t){const r=(this._idCounter++).toString();return this._optionMap.set(r,t),r}_getOptionId(t){for(const r of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(r)._value,t))return r;return null}_getOptionValue(t){const r=function gz(e){return e.split(":")[0]}(t);return this._optionMap.has(r)?this._optionMap.get(r)._value:t}}return e.\u0275fac=function(){let n;return function(r){return(n||(n=Cr(e)))(r||e)}}(),e.\u0275dir=Nt({type:e,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(t,r){1&t&&ft("change",function(u){return r.onChange(u.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[Bi([mz]),Jn]}),e})(),lD=(()=>{class e{constructor(t,r,l){this._element=t,this._renderer=r,this._select=l,this._select&&(this.id=this._select._registerOption(this))}set ngValue(t){null!=this._select&&(this._value=t,this._setElementValue(aD(this.id,t)),this._select.writeValue(this._select.value))}set value(t){this._select?(this._value=t,this._setElementValue(aD(this.id,t)),this._select.writeValue(this._select.value)):this._setElementValue(t)}_setElementValue(t){this._renderer.setProperty(this._element.nativeElement,"value",t)}_setSelected(t){this._renderer.setProperty(this._element.nativeElement,"selected",t)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return e.\u0275fac=function(t){return new(t||e)(qe(jr),qe(il),qe(Bw,9))},e.\u0275dir=Nt({type:e,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),e})(),Cz=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[JM]}),e})(),Tz=(()=>{class e{static withConfig(t){return{ngModule:e,providers:[{provide:sm,useValue:t.callSetDisabledState??qA}]}}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[Cz]}),e})();const yD=function(e){return{ratio:e}};function Mz(e,n){if(1&e){const t=Gt();ke(0,"img",7),ft("load",function(){return Tn(t),_n(Ft(2).imageLoading=!1)}),Ne()}if(2&e){const t=Ft(2);ot("ngClass",Cs(5,yD,t.ratio))("src",t.fileUrl,wa)("alt",t.alt)("title",t.title),xe("loading",1==t.lazy?"lazy":null)}}function Dz(e,n){if(1&e&&Dt(0,"iframe",8),2&e){const t=Ft(2);ot("src",t.fileUrl,uf),xe("loading",1==t.lazy?"lazy":null)}}function Sz(e,n){if(1&e){const t=Gt();ke(0,"video",9),ft("click",function(l){return Tn(t),_n(Ft(2).videoClickHandler(l))}),Dt(1,"source",10),bt(2," Your browser does not support the video tag. "),Ne()}if(2&e){const t=Ft(2);ot("id","video_"+t.imageIndex)("ngClass",Cs(5,yD,t.ratio))("autoplay",t.videoAutoPlay),xe("controls",t.showVideoControls?t.showVideoControls:null),ct(1),ot("src",t.fileUrl,wa)}}function kz(e,n){1&e&&(ke(0,"div",11),bt(1,"Invalid file format"),Ne()),2&e&&ot("dir",Ft(2).direction)}function Pz(e,n){1&e&&Dt(0,"span",12)}const Rz=function(e){return{"ng-fullimage-loading":e}};function Oz(e,n){if(1&e&&(ke(0,"div",1),At(1,Mz,1,7,"img",2),At(2,Dz,1,2,"iframe",3),At(3,Sz,3,7,"video",4),At(4,kz,2,1,"div",5),At(5,Pz,1,0,"span",6),Ne()),2&e){const t=Ft();ot("ngClass",Cs(6,Rz,t.imageLoading)),ct(1),ot("ngIf",t.type===t.IMAGE&&t.fileUrl),ct(1),ot("ngIf",t.type===t.YOUTUBE&&t.fileUrl),ct(1),ot("ngIf",t.type===t.VIDEO),ct(1),ot("ngIf",!t.fileUrl),ct(1),ot("ngIf",t.type===t.YOUTUBE||t.type===t.VIDEO||t.isVideo)}}const Fz=["lightboxDiv"],Lz=["lightboxImageDiv"];function Bz(e,n){1&e&&(ke(0,"div",13),Dt(1,"div",14),Ne())}const Nz=function(e){return{width:e}};function zz(e,n){if(1&e){const t=Gt();ke(0,"div",15,16),ft("touchstart",function(l){return Tn(t),_n(Ft(2).swipeLightboxImg(l,"start"))})("touchend",function(l){return Tn(t),_n(Ft(2).swipeLightboxImg(l,"end"))}),ke(2,"div",17),ft("click",function(){return Tn(t),_n(Ft(2).closeLightbox())}),Ne(),Dt(3,"custom-img",18),Ne()}if(2&e){const t=n.$implicit,r=n.index,l=Ft(2);ot("ngStyle",Cs(13,Nz,l.popupWidth+"px")),xe("id","ng-lightbox-image-"+r),ct(3),ot("imageUrl",(null==t?null:t.image)||(null==t?null:t.video))("isVideo",!!(null!=t&&t.posterImage||null!=t&&t.video))("currentImageIndex",l.currentImageIndex)("imageIndex",r)("speed",l.speed)("videoAutoPlay",l.videoAutoPlay&&r==l.currentImageIndex)("showVideoControls",l.showVideoControls?1:0)("alt",(null==t?null:t.alt)||(null==t?null:t.title)||"")("title",(null==t?null:t.title)||(null==t?null:t.alt)||"")("showVideo",!0)("direction",l.direction)}}const KA=function(e){return{disable:e}};function Vz(e,n){if(1&e){const t=Gt();ke(0,"a",19),ft("click",function(){return Tn(t),_n(Ft(2).prevImageLightbox())}),bt(1,"\u2039"),Ne()}if(2&e){const t=Ft(2);ot("ngClass",Cs(1,KA,t.lightboxPrevDisable))}}function Uz(e,n){if(1&e){const t=Gt();ke(0,"a",20),ft("click",function(){return Tn(t),_n(Ft(2).nextImageLightbox())}),bt(1,"\u203a"),Ne()}if(2&e){const t=Ft(2);ot("ngClass",Cs(1,KA,t.lightboxNextDisable))}}function jz(e,n){if(1&e&&(ke(0,"div",21),bt(1),Ne()),2&e){const t=Ft(2);ct(1),Rv("",t.currentImageIndex+1," of ",t.totalImages,"")}}const Hz=function(e,n,t){return{"margin-left":e,"grid-template-columns":n,transition:t}},Gz=function(e,n){return{show:e,hide:n}};function $z(e,n){if(1&e){const t=Gt();ke(0,"div",1)(1,"div",2)(2,"a",3),ft("click",function(){return Tn(t),_n(Ft().closeLightbox())}),Ne(),ke(3,"div",4,5),At(5,Bz,2,0,"div",6),ke(6,"div",7),At(7,zz,4,15,"div",8),Ne(),ke(8,"div",9),bt(9),Ne(),At(10,Vz,2,3,"a",10),At(11,Uz,2,3,"a",11),Ne()(),At(12,jz,2,2,"div",12),Ne()}if(2&e){const t=Ft();ct(5),ot("ngIf",t.showLoading),ct(1),ot("ngStyle",Vv(9,Hz,t.marginLeft+"px","repeat("+t.images.length+",1fr)",t.effectStyle)),ct(1),ot("ngForOf",t.images),ct(1),ot("dir",t.direction)("ngClass",su(13,Gz,t.title,!t.title)),ct(1),ou(t.title),ct(1),ot("ngIf",t.images.length>1),ct(1),ot("ngIf",t.images.length>1),ct(1),ot("ngIf",t.paginationShow)}}const qz=["sliderMain"],Wz=["imageDiv"];function Zz(e,n){if(1&e&&(ke(0,"div",16),bt(1),Ne()),2&e){const t=Ft().$implicit;ot("dir",Ft(2).textDirection),ct(1),ou(null==t?null:t.title)}}const Qz=function(e,n){return{"image-popup":e,"selected-image":n}},Xz=function(e,n,t){return{width:e,"margin-left":n,"margin-right":t}};function Kz(e,n){if(1&e){const t=Gt();ke(0,"div",12,13),ft("click",function(){const u=Tn(t).$implicit;return _n(Ft(2).imageOnClick(u.index))})("mouseenter",function(){Tn(t);const l=Ft(2);return _n(l.stopSlideOnHover&&l.imageMouseEnterHandler())})("mouseleave",function(){Tn(t);const l=Ft(2);return _n(l.stopSlideOnHover&&l.imageAutoSlide())}),Dt(2,"custom-img",14),At(3,Zz,2,2,"div",15),Ne()}if(2&e){const t=n.$implicit,r=n.index,l=Ft(2);ot("ngClass",su(10,Qz,l.imagePopup,l.activeImageIndex==r))("ngStyle",Vv(13,Xz,l.sliderImageWidth+"px",l.imageMargin+"px",l.imageMargin+"px")),ct(2),ot("imageUrl",(null==t?null:t.thumbImage)||(null==t?null:t.posterImage)||(null==t?null:t.video))("isVideo",!!(null!=t&&t.posterImage||null!=t&&t.video))("alt",(null==t?null:t.alt)||(null==t?null:t.title)||"")("title",(null==t?null:t.title)||(null==t?null:t.alt)||"")("direction",l.textDirection)("ratio",l.manageImageRatio)("lazy",l.lazyLoading),ct(1),ot("ngIf",null==t?null:t.title)}}const Jz=function(e){return{"with-ng-main-pagination":e}},Yz=function(e,n,t){return{"margin-left":e,width:n,transition:t}};function e3(e,n){if(1&e){const t=Gt();ke(0,"div",10),ft("touchstart",function(l){return Tn(t),_n(Ft().swipe(l,"start"))})("touchend",function(l){return Tn(t),_n(Ft().swipe(l,"end"))}),At(1,Kz,4,17,"div",11),Ne()}if(2&e){const t=Ft();ot("ngClass",Cs(3,Jz,t.paginationShow))("ngStyle",Vv(5,Yz,t.leftPos+"px",t.imageParentDivWidth+"px",t.effectStyle)),ct(1),ot("ngForOf",t.imageObj)}}function t3(e,n){1&e&&(ke(0,"div",17),Dt(1,"span",18),Ne())}function n3(e,n){if(1&e){const t=Gt();ke(0,"a",19),ft("click",function(){return Tn(t),_n(Ft().prev())})("mouseenter",function(){Tn(t);const l=Ft();return _n(l.stopSlideOnHover&&l.imageMouseEnterHandler())})("mouseleave",function(){Tn(t);const l=Ft();return _n(l.stopSlideOnHover&&l.imageAutoSlide())}),bt(1,"\u2039"),Ne()}if(2&e){const t=Ft();ot("ngClass",Cs(1,KA,t.sliderPrevDisable))}}function r3(e,n){if(1&e){const t=Gt();ke(0,"a",20),ft("click",function(){return Tn(t),_n(Ft().next())})("mouseenter",function(){return Tn(t),_n(Ft().imageMouseEnterHandler())})("mouseleave",function(){return Tn(t),_n(Ft().imageAutoSlide())}),bt(1,"\u203a"),Ne()}if(2&e){const t=Ft();ot("ngClass",Cs(1,KA,t.sliderNextDisable))}}function o3(e,n){if(1&e&&(ke(0,"div",21),bt(1),Ne()),2&e){const t=Ft();ct(1),Rv("",t.visiableImageIndex+1," of ",t.totalImages,"")}}function s3(e,n){if(1&e){const t=Gt();ke(0,"div")(1,"slider-lightbox",22),ft("prevImage",function(l){return Tn(t),_n(Ft().lightboxArrowClickHandler(l))})("nextImage",function(l){return Tn(t),_n(Ft().lightboxArrowClickHandler(l))})("close",function(){return Tn(t),_n(Ft().close())}),Ne()()}if(2&e){const t=Ft();ct(1),ot("paginationShow",t.paginationShow)("showVideoControls",t.showVideoControls)("arrowKeyMove",t.arrowKeyMove)("images",t.ligthboxImageObj)("infinite",t.infinite)("animationSpeed",t.speed)("imageIndex",t.activeImageIndex)("show",t.ligthboxShow)("direction",t.textDirection)("videoAutoPlay",t.videoAutoPlay)}}const vD=function(e){return{height:e}};let zw=(()=>{class e{constructor(){}isBase64(t){return/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/.test(t)}base64FileExtension(t){return t.substring(11,t.indexOf(";base64"))}orderArray(t=[],r="ASC"){return t?.length&&r?t.sort((l,u)=>null!==l.order&&l.order?null!==u.order&&u.order?l.order>u.order?"DESC"===r?-1:1:l.order<u.order?"DESC"===r?1:-1:void 0:-1:1):t}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac}),e})();const l3=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/,xD=["jpeg","jpg","gif","png"],bD=["mp4"];let wD=(()=>{class e{constructor(t,r,l){this.imageSliderService=t,this.sanitizer=r,this.YOUTUBE="youtube",this.IMAGE="image",this.VIDEO="video",this.fileUrl="",this.fileExtension="",this.type=this.IMAGE,this.imageLoading=!0,this.showVideo=!1,this.videoAutoPlay=!1,this.showVideoControls=1,this.speed=1,this.isVideo=!1,this.alt="",this.title="",this.direction="ltr",this.ratio=!1,this.lazy=!1}ngOnChanges(t){this.imageUrl&&this.imageUrl&&this.imageUrl&&"string"==typeof this.imageUrl&&(t.imageUrl&&t.imageUrl.firstChange||this.videoAutoPlay)&&this.setUrl()}setUrl(){const t=this.imageUrl;this.imageLoading=!0,this.fileUrl=this.sanitizer.bypassSecurityTrustResourceUrl(t),this.fileExtension=t.split(".").pop().split(/\#|\?/)[0],this.imageSliderService.base64FileExtension(t)&&(xD.indexOf(this.imageSliderService.base64FileExtension(t).toLowerCase())>-1||bD.indexOf(this.imageSliderService.base64FileExtension(t).toLowerCase())>-1)&&(this.fileExtension=this.imageSliderService.base64FileExtension(t));const r=t.match(l3);if(r&&11===r[2].length)this.showVideo?(this.type=this.YOUTUBE,this.fileUrl=this.sanitizer.bypassSecurityTrustResourceUrl(`https://www.youtube.com/embed/${r[2]}${this.videoAutoPlay?"?autoplay=1&enablejsapi=1":"?autoplay=0&enablejsapi=1"}&controls=${this.showVideoControls}`)):(this.type=this.IMAGE,this.fileUrl=this.sanitizer.bypassSecurityTrustResourceUrl(`https://img.youtube.com/vi/${r[2]}/0.jpg`));else if(this.fileExtension&&xD.indexOf(this.fileExtension.toLowerCase())>-1)this.type=this.IMAGE;else if(this.fileExtension&&bD.indexOf(this.fileExtension.toLowerCase())>-1&&(this.type=this.VIDEO,this.videoAutoPlay&&document.getElementById(`video_${this.imageIndex}`))){const l=document.getElementById(`video_${this.imageIndex}`);setTimeout(()=>{l.play()},1e3*this.speed)}}videoClickHandler(t){t&&t.srcElement&&!this.showVideoControls&&(t.srcElement.paused?t.srcElement.play():t.srcElement.pause())}}return e.\u0275fac=function(t){return new(t||e)(qe(zw),qe(E_),qe(Ri))},e.\u0275cmp=vr({type:e,selectors:[["custom-img"]],inputs:{showVideo:"showVideo",videoAutoPlay:"videoAutoPlay",showVideoControls:"showVideoControls",currentImageIndex:"currentImageIndex",imageIndex:"imageIndex",speed:"speed",imageUrl:"imageUrl",isVideo:"isVideo",alt:"alt",title:"title",direction:"direction",ratio:"ratio",lazy:"lazy"},features:[Hi],decls:1,vars:1,consts:[["class","custom-image-main",3,"ngClass",4,"ngIf"],[1,"custom-image-main",3,"ngClass"],["class","image",3,"ngClass","src","alt","title","load",4,"ngIf"],["class","youtube","frameborder","0","allow","autoplay","allowfullscreen","",3,"src",4,"ngIf"],["class","video","type","video/mp4","controlsList","nodownload",3,"id","ngClass","autoplay","click",4,"ngIf"],["class","invalid-msg",3,"dir",4,"ngIf"],["class","youtube-icon",4,"ngIf"],[1,"image",3,"ngClass","src","alt","title","load"],["frameborder","0","allow","autoplay","allowfullscreen","",1,"youtube",3,"src"],["type","video/mp4","controlsList","nodownload",1,"video",3,"id","ngClass","autoplay","click"],["type","video/mp4",3,"src"],[1,"invalid-msg",3,"dir"],[1,"youtube-icon"]],template:function(t,r){1&t&&At(0,Oz,6,8,"div",0),2&t&&ot("ngIf",r.fileUrl)},dependencies:[np,ip],encapsulation:2}),e})(),h3=(()=>{class e{constructor(t,r,l,u){this.cdRef=t,this.sanitizer=r,this.elRef=l,this.document=u,this.totalImages=0,this.nextImageIndex=-1,this.popupWidth=1200,this.marginLeft=0,this.imageFullscreenView=!1,this.lightboxPrevDisable=!1,this.lightboxNextDisable=!1,this.showLoading=!0,this.effectStyle="none",this.speed=1,this.title="",this.currentImageIndex=0,this.images=[],this.videoAutoPlay=!1,this.direction="ltr",this.paginationShow=!1,this.infinite=!1,this.arrowKeyMove=!0,this.showVideoControls=!0,this.close=new ri,this.prevImage=new ri,this.nextImage=new ri}set imageIndex(t){void 0!==t&&t>-1&&t<this.images.length&&(this.currentImageIndex=t),this.nextPrevDisable()}set show(t){this.imageFullscreenView=t,this.elRef.nativeElement.ownerDocument.body.style.overflow="",!0===t&&(this.elRef.nativeElement.ownerDocument.body.style.overflow="hidden",this.setPopupSliderWidth())}set animationSpeed(t){t&&"number"==typeof t&&t>=.1&&t<=5&&(this.speed=t)}onResize(t){this.effectStyle="none",this.setPopupSliderWidth()}handleKeyboardEvent(t){t&&t.key&&this.arrowKeyMove&&("arrowright"===t.key.toLowerCase()&&this.nextImageLightbox(),"arrowleft"===t.key.toLowerCase()&&this.prevImageLightbox(),"escape"===t.key.toLowerCase()&&this.closeLightbox())}ngOnInit(){}ngAfterViewInit(){}ngOnDestroy(){this.resetState()}setPopupSliderWidth(){window&&window.innerWidth&&(this.popupWidth=window.innerWidth,this.totalImages=this.images.length,"number"==typeof this.currentImageIndex&&void 0!==this.currentImageIndex&&(this.marginLeft=-1*this.popupWidth*this.currentImageIndex,this.getImageData(),this.nextPrevDisable(),setTimeout(()=>{this.showLoading=!1},500)))}closeLightbox(){this.close.emit()}prevImageLightbox(){this.effectStyle=`all ${this.speed}s ease-in-out`,this.currentImageIndex>0&&!this.lightboxPrevDisable&&(this.currentImageIndex--,this.prevImage.emit("lightbox previous"),this.marginLeft=-1*this.popupWidth*this.currentImageIndex,this.getImageData(),this.nextPrevDisable())}nextImageLightbox(){this.effectStyle=`all ${this.speed}s ease-in-out`,this.currentImageIndex<this.images.length-1&&!this.lightboxNextDisable&&(this.currentImageIndex++,this.nextImage.emit("lightbox next"),this.marginLeft=-1*this.popupWidth*this.currentImageIndex,this.getImageData(),this.nextPrevDisable())}nextPrevDisable(){this.lightboxNextDisable=!0,this.lightboxPrevDisable=!0,setTimeout(()=>{this.applyButtonDisableCondition()},1e3*this.speed)}applyButtonDisableCondition(){this.lightboxNextDisable=!1,this.lightboxPrevDisable=!1,!this.infinite&&this.currentImageIndex>=this.images.length-1&&(this.lightboxNextDisable=!0),!this.infinite&&this.currentImageIndex<=0&&(this.lightboxPrevDisable=!0)}getImageData(){if(this.images&&this.images.length&&"number"==typeof this.currentImageIndex&&void 0!==this.currentImageIndex&&this.images[this.currentImageIndex]&&(this.images[this.currentImageIndex].image||this.images[this.currentImageIndex].video)){this.title=this.images[this.currentImageIndex].title||"",this.totalImages=this.images.length;for(const t in this.document.getElementsByTagName("iframe"))this.document.getElementsByTagName("iframe")[t]&&this.document.getElementsByTagName("iframe")[t].contentWindow&&this.document.getElementsByTagName("iframe")[t].contentWindow.postMessage&&this.document.getElementsByTagName("iframe")[t].contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");for(const t in this.document.getElementsByTagName("video"))this.document.getElementsByTagName("video")[t]&&this.document.getElementsByTagName("video")[t].pause&&this.document.getElementsByTagName("video")[t].pause()}}resetState(){this.images=[]}swipeLightboxImg(t,r){const l=[t.changedTouches[0].pageX,t.changedTouches[0].pageY],u=(new Date).getTime();if("start"===r)this.swipeLightboxImgCoord=l,this.swipeLightboxImgTime=u;else if("end"===r){const g=[l[0]-this.swipeLightboxImgCoord[0],l[1]-this.swipeLightboxImgCoord[1]];u-this.swipeLightboxImgTime<1e3&&Math.abs(g[0])>30&&Math.abs(g[0])>Math.abs(3*g[1])&&(g[0]<0?this.nextImageLightbox():this.prevImageLightbox())}}}return e.\u0275fac=function(t){return new(t||e)(qe($f),qe(E_),qe(jr),qe(Ri))},e.\u0275cmp=vr({type:e,selectors:[["slider-lightbox"]],viewQuery:function(t,r){if(1&t&&(Yd(Fz,5),Yd(Lz,5)),2&t){let l;Sh(l=kh())&&(r.lightboxDiv=l.first),Sh(l=kh())&&(r.lightboxImageDiv=l.first)}},hostBindings:function(t,r){1&t&&ft("resize",function(u){return r.onResize(u)},0,Ld)("keyup",function(u){return r.handleKeyboardEvent(u)},!1,gf)},inputs:{images:"images",imageIndex:"imageIndex",show:"show",videoAutoPlay:"videoAutoPlay",direction:"direction",paginationShow:"paginationShow",animationSpeed:"animationSpeed",infinite:"infinite",arrowKeyMove:"arrowKeyMove",showVideoControls:"showVideoControls"},outputs:{close:"close",prevImage:"prevImage",nextImage:"nextImage"},decls:1,vars:1,consts:[["class","ng-image-fullscreen-view",4,"ngIf"],[1,"ng-image-fullscreen-view"],[1,"lightbox-wrapper"],[1,"close",3,"click"],[1,"lightbox-div"],["lightboxDiv",""],["class","pre-loader",4,"ngIf"],[1,"lightbox-image-main",3,"ngStyle"],["class","lightbox-image",3,"ngStyle","touchstart","touchend",4,"ngFor","ngForOf"],[1,"caption",3,"dir","ngClass"],["class","prev icons prev-icon",3,"ngClass","click",4,"ngIf"],["class","next icons next-icon",3,"ngClass","click",4,"ngIf"],["class","popup-pagination",4,"ngIf"],[1,"pre-loader"],[1,"mnml-spinner"],[1,"lightbox-image",3,"ngStyle","touchstart","touchend"],["lightboxImageDiv",""],[1,"close-outside",3,"click"],[3,"imageUrl","isVideo","currentImageIndex","imageIndex","speed","videoAutoPlay","showVideoControls","alt","title","showVideo","direction"],[1,"prev","icons","prev-icon",3,"ngClass","click"],[1,"next","icons","next-icon",3,"ngClass","click"],[1,"popup-pagination"]],template:function(t,r){1&t&&At(0,$z,13,16,"div",0),2&t&&ot("ngIf",r.imageFullscreenView)},dependencies:[np,A_,ip,xb,wD],encapsulation:2}),e})(),f3=(()=>{class e{constructor(t,r,l,u){this.cdRef=t,this.platformId=r,this.imageSliderService=l,this.elRef=u,this.sliderMainDivWidth=0,this.imageParentDivWidth=0,this.imageObj=[],this.ligthboxImageObj=[],this.totalImages=0,this.leftPos=0,this.effectStyle="all 1s ease-in-out",this.speed=1,this.sliderPrevDisable=!1,this.sliderNextDisable=!1,this.slideImageCount=1,this.sliderImageWidth=205,this.sliderImageReceivedWidth=205,this.sliderImageHeight=200,this.sliderImageReceivedHeight=205,this.sliderImageSizeWithPadding=211,this.autoSlideCount=0,this.stopSlideOnHover=!0,this.showArrowButton=!0,this.textDirection="ltr",this.imageMargin=3,this.sliderOrderType="ASC",this.ligthboxShow=!1,this.activeImageIndex=-1,this.visiableImageIndex=0,this.infinite=!1,this.imagePopup=!0,this.images=[],this.videoAutoPlay=!1,this.paginationShow=!1,this.arrowKeyMove=!0,this.manageImageRatio=!1,this.showVideoControls=!0,this.lazyLoading=!1,this.imageClick=new ri,this.arrowClick=new ri,this.lightboxArrowClick=new ri,this.lightboxClose=new ri}set imageSize(t){t&&"object"==typeof t&&(t.hasOwnProperty("space")&&"number"==typeof t.space&&t.space>-1&&(this.imageMargin=t.space),t.hasOwnProperty("width")&&("number"==typeof t.width||"string"==typeof t.width)&&(this.sliderImageReceivedWidth=t.width),t.hasOwnProperty("height")&&("number"==typeof t.height||"string"==typeof t.height)&&(this.sliderImageReceivedHeight=t.height))}set direction(t){t&&(this.textDirection=t)}set animationSpeed(t){t&&"number"==typeof t&&t>=.1&&t<=5&&(this.speed=t,this.effectStyle=`all ${this.speed}s ease-in-out`)}set slideImage(t){t&&"number"==typeof t&&(this.slideImageCount=Math.round(t))}set autoSlide(t){t&&("number"==typeof t||"boolean"==typeof t||"object"==typeof t)&&("number"==typeof t&&t>=1&&t<=5?t=Math.round(t):"boolean"==typeof t?t=1:"object"==typeof t&&t.hasOwnProperty("interval")&&Math.round(t.interval)&&Math.round(t.interval)>=1&&Math.round(t.interval)<=5&&(this.stopSlideOnHover=!t.hasOwnProperty("stopOnHover")||t.stopOnHover,t=Math.round(t.interval)),this.autoSlideCount=1e3*t)}set showArrow(t){void 0!==t&&"boolean"==typeof t&&(this.showArrowButton=t)}set orderType(t){void 0!==t&&"string"==typeof t&&(this.sliderOrderType=t.toUpperCase())}set defaultActiveImage(t){"number"==typeof t&&t>-1&&(this.activeImageIndex=t)}onResize(t){this.setSliderWidth()}handleKeyboardEvent(t){t&&t.key&&("arrowright"===t.key.toLowerCase()&&!this.ligthboxShow&&this.arrowKeyMove&&this.next(),"arrowleft"===t.key.toLowerCase()&&!this.ligthboxShow&&this.arrowKeyMove&&this.prev(),"escape"===t.key.toLowerCase()&&this.ligthboxShow&&this.close())}ngOnInit(){if(this.infinite){this.effectStyle="none",this.leftPos=-1*this.sliderImageSizeWithPadding*this.slideImageCount;for(let t=1;t<=this.slideImageCount;t++)this.imageObj.unshift(this.imageObj[this.imageObj.length-t])}}ngAfterViewInit(){this.setSliderWidth(),this.cdRef.detectChanges(),Eb(this.platformId)&&this.imageAutoSlide()}ngOnDestroy(){this.autoSlideInterval&&clearInterval(this.autoSlideInterval),!0===this.ligthboxShow&&this.close()}ngOnChanges(t){if(t.images&&t.images.hasOwnProperty("previousValue")&&t.images.hasOwnProperty("currentValue")&&t.images.previousValue!=t.images.currentValue&&this.setSliderImages(t.images.currentValue),t&&t.imageSize){const r=t.imageSize;r&&r.previousValue&&r.currentValue&&r.previousValue.width&&r.previousValue.height&&r.currentValue.width&&r.currentValue.height&&(r.previousValue.width!==r.currentValue.width||r.previousValue.height!==r.currentValue.height)&&this.setSliderWidth()}}ngDoCheck(){this.images&&this.ligthboxImageObj&&this.images.length!==this.ligthboxImageObj.length&&this.setSliderImages(this.images)}setSliderImages(t){t&&t instanceof Array&&t.length?(t.find(l=>{if(l.hasOwnProperty("order"))return!0})&&(t=this.imageSliderService.orderArray(t,this.sliderOrderType.toUpperCase())),this.imageObj=t.map((l,u)=>(l.index=u,l)),this.ligthboxImageObj=[...this.imageObj],this.totalImages=this.imageObj.length):(this.imageObj=[],this.ligthboxImageObj=[],this.totalImages=0,this.imageParentDivWidth=0,this.activeImageIndex=0),this.setSliderWidth()}setSliderWidth(){this.sliderMain&&this.sliderMain.nativeElement&&this.sliderMain.nativeElement.offsetWidth&&(this.sliderMainDivWidth=this.sliderMain.nativeElement.offsetWidth),this.sliderMainDivWidth&&this.sliderImageReceivedWidth&&("number"==typeof this.sliderImageReceivedWidth?this.sliderImageWidth=this.sliderImageReceivedWidth:"string"==typeof this.sliderImageReceivedWidth&&(this.sliderImageReceivedWidth.indexOf("px")>=0?this.sliderImageWidth=parseFloat(this.sliderImageReceivedWidth):this.sliderImageReceivedWidth.indexOf("%")>=0?this.sliderImageWidth=+(this.sliderMainDivWidth*parseFloat(this.sliderImageReceivedWidth)/100).toFixed(2):parseFloat(this.sliderImageReceivedWidth)&&(this.sliderImageWidth=parseFloat(this.sliderImageReceivedWidth)))),Eb(this.platformId)&&window&&window.innerHeight&&this.sliderImageReceivedHeight&&("number"==typeof this.sliderImageReceivedHeight?this.sliderImageHeight=this.sliderImageReceivedHeight:"string"==typeof this.sliderImageReceivedHeight&&(this.sliderImageReceivedHeight.indexOf("px")>=0?this.sliderImageHeight=parseFloat(this.sliderImageReceivedHeight):this.sliderImageReceivedHeight.indexOf("%")>=0?this.sliderImageHeight=+(window.innerHeight*parseFloat(this.sliderImageReceivedHeight)/100).toFixed(2):parseFloat(this.sliderImageReceivedHeight)&&(this.sliderImageHeight=parseFloat(this.sliderImageReceivedHeight)))),this.sliderImageSizeWithPadding=this.sliderImageWidth+2*this.imageMargin,this.imageParentDivWidth=this.imageObj.length*this.sliderImageSizeWithPadding,this.imageDiv&&this.imageDiv.nativeElement&&this.imageDiv.nativeElement.offsetWidth&&(this.leftPos=this.infinite?-1*this.sliderImageSizeWithPadding*this.slideImageCount:0-(this.sliderImageSizeWithPadding*this.visiableImageIndex+2*this.imageMargin)),this.nextPrevSliderButtonDisable()}imageOnClick(t){this.activeImageIndex=t,this.imagePopup&&this.showLightbox(),this.imageClick.emit(t)}imageAutoSlide(){this.infinite&&this.autoSlideCount&&!this.ligthboxShow&&(this.autoSlideInterval=setInterval(()=>{this.next()},this.autoSlideCount))}imageMouseEnterHandler(){this.infinite&&this.autoSlideCount&&this.autoSlideInterval&&clearInterval(this.autoSlideInterval)}prev(){this.sliderPrevDisable||(this.infinite?this.infinitePrevImg():this.prevImg(),this.sliderArrowDisableTeam("previous"),this.getVisiableIndex())}next(){this.sliderNextDisable||(this.infinite?this.infiniteNextImg():this.nextImg(),this.sliderArrowDisableTeam("next"),this.getVisiableIndex())}prevImg(){0>=this.leftPos+this.sliderImageSizeWithPadding*this.slideImageCount?this.leftPos+=this.sliderImageSizeWithPadding*this.slideImageCount:this.leftPos=0}nextImg(){this.imageParentDivWidth+this.leftPos-this.sliderMainDivWidth>this.sliderImageSizeWithPadding*this.slideImageCount?this.leftPos-=this.sliderImageSizeWithPadding*this.slideImageCount:this.imageParentDivWidth+this.leftPos-this.sliderMainDivWidth>0&&(this.leftPos-=this.imageParentDivWidth+this.leftPos-this.sliderMainDivWidth)}infinitePrevImg(){this.effectStyle=`all ${this.speed}s ease-in-out`,this.leftPos=0,setTimeout(()=>{this.effectStyle="none",this.leftPos=-1*this.sliderImageSizeWithPadding*this.slideImageCount;for(let t=0;t<this.slideImageCount;t++)this.imageObj.unshift(this.imageObj[this.imageObj.length-this.slideImageCount-1]),this.imageObj.pop()},1e3*this.speed)}infiniteNextImg(){this.effectStyle=`all ${this.speed}s ease-in-out`,this.leftPos=-2*this.sliderImageSizeWithPadding*this.slideImageCount,setTimeout(()=>{this.effectStyle="none";for(let t=0;t<this.slideImageCount;t++)this.imageObj.push(this.imageObj[this.slideImageCount]),this.imageObj.shift();this.leftPos=-1*this.sliderImageSizeWithPadding*this.slideImageCount},1e3*this.speed)}getVisiableIndex(){const t=Math.round((Math.abs(this.leftPos)+this.sliderImageWidth)/this.sliderImageWidth);this.imageObj[t-1]&&void 0!==this.imageObj[t-1].index&&(this.visiableImageIndex=this.imageObj[t-1].index)}sliderArrowDisableTeam(t){this.sliderNextDisable=!0,this.sliderPrevDisable=!0,setTimeout(()=>{this.nextPrevSliderButtonDisable(t)},1e3*this.speed)}nextPrevSliderButtonDisable(t){this.sliderNextDisable=!1,this.sliderPrevDisable=!1;const r={};this.infinite||(this.imageParentDivWidth+this.leftPos<=this.sliderMainDivWidth&&(this.sliderNextDisable=!0),this.leftPos>=0&&(this.sliderPrevDisable=!0),r.prevDisable=this.sliderPrevDisable,r.nextDisable=this.sliderNextDisable),t&&this.arrowClick.emit({action:t,...r})}showLightbox(){this.imageObj.length&&(this.imageMouseEnterHandler(),this.ligthboxShow=!0,this.elRef.nativeElement.ownerDocument.body.style.overflow="hidden")}close(){this.ligthboxShow=!1,this.elRef.nativeElement.ownerDocument.body.style.overflow="",this.lightboxClose.emit(),this.imageAutoSlide()}lightboxArrowClickHandler(t){this.lightboxArrowClick.emit(t)}swipe(t,r){const l=[t.changedTouches[0].pageX,t.changedTouches[0].pageY],u=(new Date).getTime();if("start"===r)this.swipeCoord=l,this.swipeTime=u;else if("end"===r){const g=[l[0]-this.swipeCoord[0],l[1]-this.swipeCoord[1]];u-this.swipeTime<1e3&&Math.abs(g[0])>30&&Math.abs(g[0])>Math.abs(3*g[1])&&(g[0]<0?this.next():this.prev())}}}return e.\u0275fac=function(t){return new(t||e)(qe($f),qe(g_),qe(zw),qe(jr))},e.\u0275cmp=vr({type:e,selectors:[["ng-image-slider"]],viewQuery:function(t,r){if(1&t&&(Yd(qz,5),Yd(Wz,5)),2&t){let l;Sh(l=kh())&&(r.sliderMain=l.first),Sh(l=kh())&&(r.imageDiv=l.first)}},hostBindings:function(t,r){1&t&&ft("resize",function(u){return r.onResize(u)},0,Ld)("keyup",function(u){return r.handleKeyboardEvent(u)},!1,gf)},inputs:{imageSize:"imageSize",infinite:"infinite",imagePopup:"imagePopup",direction:"direction",animationSpeed:"animationSpeed",images:"images",slideImage:"slideImage",autoSlide:"autoSlide",showArrow:"showArrow",orderType:"orderType",videoAutoPlay:"videoAutoPlay",paginationShow:"paginationShow",arrowKeyMove:"arrowKeyMove",manageImageRatio:"manageImageRatio",showVideoControls:"showVideoControls",defaultActiveImage:"defaultActiveImage",lazyLoading:"lazyLoading"},outputs:{imageClick:"imageClick",arrowClick:"arrowClick",lightboxArrowClick:"lightboxArrowClick",lightboxClose:"lightboxClose"},features:[Hi],decls:10,vars:12,consts:[[1,"ng-image-slider",3,"ngStyle"],[1,"ng-image-slider-container"],[1,"main",3,"ngStyle"],["sliderMain",""],["class","main-inner",3,"ngClass","ngStyle","touchstart","touchend",4,"ngIf"],["class","ng-image-slider-error",4,"ngIf"],["class","prev icons prev-icon",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","next icons next-icon",3,"ngClass","click","mouseenter","mouseleave",4,"ngIf"],["class","ng-main-pagination",4,"ngIf"],[4,"ngIf"],[1,"main-inner",3,"ngClass","ngStyle","touchstart","touchend"],["class","img-div",3,"ngClass","ngStyle","click","mouseenter","mouseleave",4,"ngFor","ngForOf"],[1,"img-div",3,"ngClass","ngStyle","click","mouseenter","mouseleave"],["imageDiv",""],[3,"imageUrl","isVideo","alt","title","direction","ratio","lazy"],["class","caption",3,"dir",4,"ngIf"],[1,"caption",3,"dir"],[1,"ng-image-slider-error"],[1,"ng-image-slider-loader"],[1,"prev","icons","prev-icon",3,"ngClass","click","mouseenter","mouseleave"],[1,"next","icons","next-icon",3,"ngClass","click","mouseenter","mouseleave"],[1,"ng-main-pagination"],[3,"paginationShow","showVideoControls","arrowKeyMove","images","infinite","animationSpeed","imageIndex","show","direction","videoAutoPlay","prevImage","nextImage","close"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"div",1)(2,"div",2,3),At(4,e3,2,9,"div",4),At(5,t3,2,0,"div",5),At(6,n3,2,3,"a",6),At(7,r3,2,3,"a",7),Ne(),At(8,o3,2,2,"div",8),Ne()(),At(9,s3,2,10,"div",9)),2&t&&(ot("ngStyle",Cs(8,vD,r.sliderImageHeight+"px")),ct(2),ot("ngStyle",Cs(10,vD,r.sliderImageHeight+"px")),ct(2),ot("ngIf",r.imageObj.length),ct(1),ot("ngIf",!r.imageObj.length),ct(1),ot("ngIf",r.showArrowButton&&r.imageObj.length>1),ct(1),ot("ngIf",r.showArrowButton&&r.imageObj.length>1),ct(1),ot("ngIf",r.imageObj.length&&r.paginationShow),ct(1),ot("ngIf",r.ligthboxShow))},dependencies:[np,A_,ip,xb,wD,h3],styles:[".ng-image-slider{display:inline-block;position:relative;width:100%}.ng-image-slider .ng-image-slider-container .main{overflow:hidden;position:absolute;height:200px;width:100%}.ng-image-slider .ng-image-slider-container .main .main-inner{width:1760px;padding:0;height:100%}.ng-image-slider .ng-image-slider-container .main .main-inner.with-ng-main-pagination{height:calc(100% - 30px)}.ng-image-slider .ng-image-slider-container .main .main-inner .full-screen{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAF+klEQVRoge2Yz28UyRXHv6+q50d7ftqDl42wrU1QFIXVkuAZD5pEzoYrihIhuERw2D8gl1UOKFeiaBfBIZGQIkVKGHGIQHsmspQoillgBfE4vpgQy4pFTIAdPB6Pe365u7peDsx4Z8z0/GDtS3Y+Uh+66vWr963u11X1gCFDhgz5qiEymYy5X86oW2c6nU4w8zcAxJhZaa2tZh8zK8MwLK11XAgRdF3360KIdxYWFn7VzWcqlfoJM38C4B8ASgC2WrpNZg4CgBCCAPiYeZOIfrOwsPC3Tv4Mr4GOHz8ecl13JRQKfS6ldJVSkpnJcZwQABARGYZRJiImIg4Gg/VCoTABoKsAZqZIJPKvy5cvjxQKBVEqlcJ7bUzTlOFw2ACA27dv6/n5+Z8BGEyAaZphpZR/fn7+290CavLkyZMnZ8+eVb3smNk1DEOl0+nv9uM3n89/dufOnddENvEUoJQ6YhjGFgDPhzugexkIIfxCiJ52TY4ePRoBEPDq9xTAzEoI4fY7UDAY9HUbqMVvvVwux69du/ZpIpEw4vG4b2JiInL48OF4IpEYk1L6Wu2LxeIOM5ffREBJKRXa237z5s17d+/edV6+fGmUSqVAtVoNO44TUkpFiejTXgLq9fqfiegP169f/xYRjTHzKBFpAAzAPX369L1Lly79sGlfKBRsIrK8/HUVoLWOtLY9f/786dWrV98D8DEzbwghiq7rFqWUm1LKlw8ePPhvLwHLy8s2PBJ9enr6R/fv3/9la9vm5qZi5uLAApaWlraTyaTftm3H7/f7AMC2bReAlcvlPuoV6JsghBBSyrb8KBaLmog8BYgu/jSAsmVZu9+fbdsKQN95MShEVK3Vam15VKlUGEDN6xnPN9BAK6V2f42FQqECQH6pKLuglKo015m9cXg900sAM/PuzdbW1g5eJduBIIQoa60H2mb0EtBGuVxW6PI6vyxSyrLruv7WNq01iMhz0np+Qo8ePVq3bbsOACsrK1Uiqu5DrF5sA4icOXPms3A47FarVfnixYtJZvZc4btu5qanp28Q0ffxSmgAwCYz/25xcfHX+xv3F8zMzHxPa/1NZg4IIbYBOMz8l1wuVzqoMYcMGTLkK0zXdeDkyZMTWmu/67phrXXNcZzny8vLnoeL/eDEiRM/kFJ+wMzNk6AiomWvYoGngFQq9VNm/r1hGBtSSsd1XZ9SalxKeezhw4drBxI9gGQy+dvJycnvnDt3jqWUtLGxobLZ7GypVAqurq7u7LXvdqB569ixYw9v3LjxfrMtk8msKaXGARyYACIKz87O2ufPn38feLUXymaznvbdzgOvYRiGo7Ue5JA/MMwcCoVCr30Z4+PjHWPtKoCI2hwZhmELIQ5UAIBwLBbre5fsKYCZCXv2/qZp1luS60Bg5lAikdjdUjfmkCuVysBvwBcIBNoEhMNhh5k7nZj2DSIKRCIRX8s9AFRM0+w4cZ6vioii8Xi8TQAzY5CiVD9kMhmzXq+PGoYx6rruGICo67qVVhshhLWzsxMF8Pne57t9a7FYLNaWA1NTU/ba2tovpqenf0xERSIqNkoeRQD/zuVyf0IfR85UKvUhM38IYNy27aAQoiaE2BgZGdmampp6kU6n0632Pp+vqpSKdfLVVcDo6GibgCtXrszmcrl/Pnv27O319fXRp0+futvb22RZllhZWXknmUz+PJfLfdJLADN/cPHixfVTp04FI5EIBwIBE8Bk43oNv99fq9VqgwsYGxtr6xdCiJmZmXc7GV+4cOHe48eP3+4VfAN15MiRkUOHDo33YyyldKWUHXPAM4mJqJ7P53tWm5s4jiPQ/4Gfte4/larVahTAfzr1dVuJC/l8/i3LsrZ1YzTLsqpa693CVjQaDRGRME0z2Kgc9Pv/ltlsdvvWrVvzlmV1nES/369N0wQzw7bt48zcsT7a7S/017m5uTNzc3NBAH4AFQCtNZsKgHqjzQcgxcx/7FPA35eWlhSA1Ubl2Wn4aI4tAUQbt1Vm/mhxcXG1T99vhEgmkyeTyeTXDnKQIUOG/B/yP/QEm5iXakbiAAAAAElFTkSuQmCC);background-size:40px 40px;background-repeat:no-repeat;position:absolute;z-index:8;display:block;height:40px;width:40px;top:4px;right:8px;opacity:.4;transition:all .5s ease-in-out;cursor:pointer}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:205px;height:100%;margin-right:3px;margin-left:3px;position:relative;display:inline-block;box-shadow:inset 0 0 1px #0000003d,0 0 2px #0000001f;border-radius:5px}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div.image-popup{cursor:pointer}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div img,.ng-image-slider .ng-image-slider-container .main .main-inner .img-div video{position:absolute;margin:auto;height:100%;width:100%;inset:0;border-radius:5px}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div img.ratio,.ng-image-slider .ng-image-slider-container .main .main-inner .img-div video.ratio{width:auto;height:auto;max-width:100%;max-height:100%}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div .youtube-icon{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAUAAAAC0CAMAAADSOgUjAAAAA3NCSVQICAjb4U/gAAAC9FBMVEX///+vr6+lpaWPj498fHx4eHh2dnZ0dHRvb29sbGxqampmZmZiYmJeXl5aWlpYWFhUVFRSUlJQUFBMTExKSkpISEhERERCQkJAQEA+Pj44ODg2NjYzMzMwMDAuLi4sLCwqKiooKCgkJCQiIiIgICAYGBgUFBQSEhIODg4MDAwKCgoICAgGBgYEBAQAAADj4+PV1dXBwcG/v7+9vb23t7ezs7Ovr6+rq6ulpaWhoaGPj4+Li4uJiYmHh4eDg4OBgYF+fn58fHx4eHhycnJvb29sbGxmZmZiYmJeXl5aWlpWVlZUVFRSUlJQUFBOTk5KSkpISEhGRkZERERCQkI+Pj47Ozs4ODg2NjYzMzMwMDAuLi4oKCgkJCQiIiIgICAeHh4cHBwUFBQSEhIODg4ICAgEBAQAAADl5eWrq6unp6ejo6OhoaGdnZ2ZmZmVlZWTk5OPj4+Li4uJiYmHh4eBgYF+fn58fHx4eHh0dHRycnJsbGxqampmZmZiYmJWVlYiIiIaGhoAAADMzMzDw8PBwcG/v7+9vb27u7u5ubm3t7e1tbWzs7OxsbGvr6+tra2pqamnp6elpaWhoaGfn5+dnZ2ZmZmVlZWTk5ORkZGJiYlISEjv7+/p6enj4+PT09PPz8/MzMzJycnHx8fFxcXDw8PBwcG/v7+9vb27u7u5ubm3t7ezs7Ovr6+Li4vf39/Z2dnX19fV1dXT09PR0dHPz8/MzMzJycnHx8e9vb3t7e3l5eXj4+Pf39/d3d3b29vZ2dnX19fV1dXT09PR0dHPz8/MzMzp6enn5+fl5eXj4+Ph4eHf39/d3d3X19fT09O9vb3v7+/t7e3r6+vp6enn5+fl5eXj4+Pf39/Z2dnT09PHx8f19fXz8/Px8fHv7+/t7e3r6+vp6enn5+fl5eXj4+P5+fn39/f19fXz8/Px8fHv7+/t7e3f39/7+/v5+fn39/f19fXz8/Px8fHv7+/////7+/v5+fn39/fz8/P////7+/v///9a1shPAAAA/HRSTlMAERERERERERERERERERERERERERERERERERERERERERERERERERERERERERERESIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzRERERERERERERERERERERERERERERERERFVVVVVVVVVVVVVVVVVVVVVVVVVmZmZmZmZmZmZmZnd3d3d3d3d3d3d3d3eIiIiIiIiIiIiImZmZmZmZmZmZmZmqqqqqqqqqqqqqu7u7u7u7u7vMzMzMzMzM3d3d3d3u7v9/AAjkAAAACXBIWXMAAAsSAAALEgHS3X78AAAAFnRFWHRDcmVhdGlvbiBUaW1lADA2LzEyLzE09BLGOQAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTNXG14zYAAA/MSURBVHic7Z15fBTlGcenhz20rbWXKHhU5RDhra22ilal0IpC1VJb1IKlVpmiRUBiuBEBFWIQMXgfAUtIREAIgciVBIpCLjUXeITdRITsJrqHurPp7PzTea+59pjZza7JOzu/z8eoO7PvO893n+d933nned/hOEeOHDly5MiRI0eOHDly5MiRI0eOsAAAvX0JbApAdFpxDkirAonU2xfX15UQngMxsSzBcyDGU1L4HIRGmQByECZUTDLg+1f/+pe/+JesSy+/8rvngpgnOgy5KCryJ6OWvvRyXbPbGwx2h8Pd3YGgx9VWve+lV6YOiQM7m2Xk8WDh7gaPPyJCSaKEJGIJgWMNe/KnOAg10nEAY/P3tfoEUVWISPOJ4G/cmTPJQYikY/D7R/d0aLmJemk/CzVsnfFDB6HW/u9N3+cRJcJJyy0SiRgxouD2NRZfmeUINaYPyGsSZHwqvJAQCLpr6g8eLC8p2bjhrbf217Z4A35B64uS6Cmdms0ENU3fskbofBSf4GmvK189lzd2FROe23ig2uXXOqK/YjqXpQQ1Ri9zK/gkMdxWWZhLDvE64c/uzN9W97ncNxOEUqBqdFYiVC0ecUjANEKSFOp6a/nYKHIGjBy4YtPRIA14SQpuzcIwVg1+w6/Eo7d29WgDPeX/tB/L51wwq7wlRBFGGvOyjKBq7fJW3J5BfG8u0NIzNoD6qJb/647n63z0y769t2QTQsXQG/eGCAHBU3SbSicePcKQnAemzD7sRwjlPx1Z5ISKmf92YXxS5Nha1fcSwjM6Yu7hIAlk4b9naDsmG0sxcq1fwm3Y59sBlxQ+FSHgprVEJPwzNF+ZFQSphT/bE8H8hNoxHEgOnhYi4Io6CcHgo+qh3jYzY6L2XdtIwte7SfGm5IUJjqsP4bKEnUBpP3vb0AyJWvcrL/GalpHx8RkeY0Y95lQQgtcDuLhQpc0JUtuWEYOF8v5x+MUtwUgRf3t6Gy5QrLE1QWr0I6j7kId+BTHxWS5H44Q/rYpgl27qb70c1kQNy/Nhb2keE6PzSLIsihCAInRLI0qN/exKkFr1BOFXMymKXyrlKU6Yj9oFuVm90KZRTGy6l/CrB0Z+KZaoELzPgwiKtUo7mAErek/EpBEeSe4tRfEg7UF7FG/6MH7Ai9vWCq5HhfZNEYtOd2MveTst/IwE53YigpF19msGqUHV+Obf6H9pKBkRzMU+GH7Cds0gsWY75lefPn4GgjOCiKDnOpu5IDFmqYD4HRmq45em0jHB/DCqoukiWxEktlzzBXIP923p5acjyK3FP9J+O3Uk1JQW1IH4Z6abn94HK1EzEV5uI4LEkPW4ASzW8kt3HXLBk9vgQFPqvNA2AIkdN5xENwq1GeGnJZjrQxUdTE8f1QdErDiMHKNrHMgIPy3BjcjVhedsApAYgXtg4akMOaAWIKhBd4uNU+wxGMQ2DIZPkETxQMb4aQnmBOGPFVpvi3tiYkIhnK+Tum7KVACrVUGC/0FB3HqHHQhiCy6Ed6liZFMm+akEQb+PYXXiVo59gMQA6BKi1AwsAkzRYtUFn0Utrqcf8y5ITOrnhh4hFHAW+CmjjxSsVlwQHJUH7WLkVY71foRcfQlqkxo0PYjZV1KEqLjg09AFJfclrLsgvvpT25ADrjYPYDC4ZwRVF2yGLii+lro39w3hq39UdUATfuC03btP6QlCSpB7DE7LSG2MA8QXP6AFpSGYO6B84Dut0smt3wAGJVuj7ILDYe4D8nqWCeJrH4FuTt13W+AHftIqieLJslFA22GnRLBYgB1//TCWXZBcehmK4F3AAj9w1jEJ5vt53p5vfGqXXKXyFztgrR0jWQ5ifOXnozFMYJElgP1d+Mma9MWBkakhVFxwG5o9W84wQHLl02EES/XAZAiDj53jRh4Is8e/rJpvTP1IolqefwjGsFh3FrsEyXWXotuqzdYAnteGAaI1D1+886Ix8dJytfKXGqELBq5lHeCwJuiA3pGWIhhMxABp6nnw3YeSRqjEcDmak1nJbj+Mr/sPfhiQ7w8GJjch2OpJFCBF6H930T1JIqQAn0cxXHExqwCJuXloIrDYzAE5HHeT2hWAdPVS97uz/2lMg7NSMRgPey/J9VdWY5hcdgUEGLzMUgTz/N8/1gDEEEUp/OELyQSyclIVbH39sxkH6IIO2D7eLNkiHkD8KA8itJ7NRc/YRJ2fZYATYBMoVlmKYPmkydEAEUGp+4MXLCfE0eMzAzCGqxgFSIx40gcBFnLWmkD+H8ejASoInzF6YeKqwSloFqglvQ/xvzKRa94G0wH9eRb7kDgA0dBaRvh+gbW2kBwcWgPntLx/YRrgIWi7Z4HZIMYUIF4TFz6+ZYoFhPTYTli5bw7TABugDW2g5wAJQuGTZyfqEcatG4AV6EtPs9kI4mse5oamN5tGsBWAdGHxic1m+V34c567NAxDv4RlgNd7rXXCCsBPEgAkjaEUObFJhzBO3QBcHiRP85kFyE0NQJvLTSOYAnzYFCAaWkdOFE9JNDtBAI5E+RA1TLaB5JKXwWGg8Fo6AWKE4sdv8vHXMxBi49vh6S2ARYLkigvhDb2wCpiOxZIBiOcZIl27JsYplFY2tAWe3chkyjm54lcgQP/z5iYkBZB0J5HOdadzCQnWwhA+Zu7/fVDkil+OQIC56Q1hJZBFsWPbt7gY5VKAaCbDwy5AnnsJAZybbg9UA1n0vfGD+ABhwrTYweTaLy3AwMKMACQT/w2/iQ+wCgI8ybwHZgygjK/r5UQhvF8PkCGCgABEbWBgTiYAoh0/tp4fsxfRhbCHxWXsOoD+B9MOELV/4XfmcKTkmNUrnQiDAPXDmOfSP4yR/7y/hY/XulGA7A9jlqKB9JPpBYjwfbplsTopE7t2ANBA2s0yQHwrtzHN98Ki+OWuxfyS+PmahN+ZTfALLSwDVCYT0uWBqPH733sv8ksS8KMAr0OTCbUMAwQ3oOmsynTdCyN83R9CfEt4UwcEl+mns1gECNCE6mEuPSGMBs6fbVmyJDE/xf/xhOoGJgFGTemnASDk9+nmJUZ+8QGugIMocQ2Ld3LKrQh+qLTI1AksAJTx4caP4DPjB0A5SvOdyzBAwJXCcYwv3yrAeFP6eKu8jxZFu1+Ch0oDq+FjTc94lgGCVYYH64lOjwsQz/6d2KLBl7BXIoe+iXJjm6ew2Amrs+o+/FTJzAsowFhP5RC+Ty3jU+p+QJ/awSZA4III2m/tAUA0cH7vYWvRq617U0iXXMQowAqUaHu5leysWADxwPkj3HdYw6fOxaD0tlxGAaoJlhBBkcX0NgNAPGX64bxY0WsK8M8owdI9kc0+RDFjIUrxrbvYxAzigZMNAOV/Pkui8dPVPAst8KkbyqgDUjPuQUnmnaNNXJB4oC4/ELrul5sXJ9H4aSsG61GS+WZWI1ixAy1zMLWDAFQyVEN01iCp4NXWfDda5hC8ilmAlCBeultnJUuf5+9sp+tE4A7xusbPIj2l3vloAHX0bDZHgVDEkP5oONthdjeHAU6iAOWR3ydJN36aaulSrxJ2HVCJYbzY0MwSbDZeJ4JmnHelhE+tthWNn5gdxHCqJfehHSDaEsw+qWfDlUrocdvbt8cY+VmCgH8JLk+gS/SYBUgJ/vwI2jb/mcS+gA+dCz1QEj6YzfOp4aOV4nk0YQ2Ts9FU1PDlKIYbTWxBh85xS6J4HKbjk9hNeqM84oBT8ZL/gQxHMKcQnIB3PVlpwQXPapW8JbcBnk8Rn/KjHUL7nhQz7YDaIS3sFw6ZtEfwwI8O7fl2D/ApAXxfN3T6rrsYB0jt+Rtchy6G8xPvgwMPDBwEtG9OSjr86DfQVGpknfmzmD4uCmC9svWTaRBHK/n6QAHq+DtvYt0BlUHtALz52EoTj+ghPqWAwU1olfx20wVmfV+EILdORFsxDbAymk4Zn+LwG1C33zGWeQdUXfDMY+jGaoe1hf+p4VO+PMqDRuNFTA+iqagLrsBbgN5vYVyWss0UYI1Eb32Yd0DFKB4cQpvQuq/P3MiW8ivCm9A+bQsHVIN4rh+/7eOSTBGkFc0MoBSG/Wb7rLAixQXfRI4R2pAhx6D+d44bb8Q9xiYOqFo25CjeCn52ZlyQlrkX9ffC47bhp7rgOPy+FJfZWKYntXDrI6il2Gllt1FWRAlyq/CbFjLx8jda3jQBDaGPDLGPA2pckCsV6bsqkp8msFAD4K4jL2S5MbP7LX/VUggOasYEd6SXIC0KjEIvKhWFAnvx0xC81YUJbgdpJKjwG+PCr7wqsxs/DcHpHpztUnqxSrBnRiqlgDkuXPY++/FTAPJguR9bWTkoPQTVMmaS36ZmeMLsVUZFzZQJhvEmnzUXaF+m3sNi5QLWBPDzvCN3pTKT3fcVRVBqPoNL9olb/EK5R7pxqccvALbkp4libiMh6L6XS23eXl8i6o/eiOAym86wYQOIpfGWFYRgYC3QhnFKk89Io5tIJubRHwN7BjCUhuDjHST95fBYoFeSZWE91kH41d9uY34agjyY6SYmux4fYkBoOfuKnn5zpYALE0oHpfQolB1pCN5cHSFWV/xWH8cmthtxD1t6jPwWQd0b6+zIT9/sl/nxi+Ulz9oBRiqYgJ5B1PvpkabWRsj76dtzU9x9nylpCHJPdRGCYvuG2HQSSmbFXVNJfwWhMtW3FzAm1X4ejKuLUIRtxUM4wBsjOSE+jrt2b5Am8n/+WJbw0xMEhV6JbBYdcRUO5KLawvjiuHv3BET8bUmsuUrX/NmZn54g97t6ge63HfHuzrHugYUNAYmmUneWDM8ifjqCPLhkTWOIbuIk+lvL5k02ZTd8QsGeDoEuYhL9ZTeBrOKnHYlAs+8uaY0oNERfY9mqBefHp/enGRtqO0Kiiq96oQGf/flxRoRgnSuixKMohTzNFa+ufuBrp1Ec6N8Xff2KGa+V1rh9dBEJ7HsCh3Os729uKwEdQg4sawyTHgHtuS2Jgt/bVFtRVlael59XvGPHgbpqd9APX9OiniR6D9zPGbwvW/gZfFDuTcC0eq/MhDoXhCjpVm1K6AN6VJTCbUU301TMLOTHGZ1Q/vvHotqAssqLcNIv3FQ+FdwHCkDU1vpZhY/T39USENNer/MIouJqRkHPE0P+9p0rx8XAl238jPMCGMfgES/srHYHQqIkGiVz9XmbKjZffWoselnIjzMgVNqz8ybMW/Xq/pomb4ffBycNI4Lf73W11JeVPDvu7GFKDjqf9fig9E6kzc/n77r1oQXzcmbl5MyaPX/hLbfz2hOSmP+yvUCUYkJS145E3zD3tgm9rWiEOl58InYOPqRYXBBGQDvouPM0vX3pfUXx+Jioty+7T8mh12M5+NIgB14a5MBLhxx2aZIDzpEjR44cOXLkyJEjR44cOXLkyJGjdOr/ODCzC5DKTiMAAAAASUVORK5CYII=);background-size:140px 80px;background-repeat:no-repeat;position:absolute;z-index:6;display:block;height:100%;width:100%;top:0;left:0;background-position:center center}.ng-image-slider .ng-image-slider-container .main .main-inner .img-div .caption{position:absolute;bottom:0;padding:5px;color:#fff;background-image:linear-gradient(to right,rgba(0,0,0,.1),rgba(0,0,0,.25),rgba(0,0,0,.5),rgba(0,0,0,.25),rgba(0,0,0,.1));width:100%;text-align:center;box-sizing:border-box;border-radius:0 0 5px 5px}.ng-image-slider .ng-image-slider-container .main .main-inner:hover .full-screen{transition:all .5s ease-in-out;opacity:1}.ng-image-slider .ng-image-slider-container .main .next,.ng-image-slider .ng-image-slider-container .main .prev{position:absolute;right:10px;top:50%;background-color:#fff;border-radius:50%;cursor:pointer;margin-top:-16px;outline:0;width:35px;height:35px;font-size:35px;line-height:30px;z-index:8;transition:all .5s ease-in-out;text-align:center}.ng-image-slider .ng-image-slider-container .main .next:hover,.ng-image-slider .ng-image-slider-container .main .prev:hover{background-color:#d4cdcd;background-position:-192px -415px}.ng-image-slider .ng-image-slider-container .main .next.disable,.ng-image-slider .ng-image-slider-container .main .prev.disable{color:#bbb;background-color:#fff;opacity:.5;cursor:default}.ng-image-slider .ng-image-slider-container .main .prev{left:10px}.ng-image-slider .ng-image-slider-container .main .prev:hover{background-position:-194px -450px}.ng-image-slider .ng-image-slider-container .ng-main-pagination{background-color:inherit;color:inherit;position:absolute;height:30px;width:calc(100% - 6px);text-align:center;bottom:0;font-size:16px;line-height:30px;border-radius:0 0 5px 5px;margin:0 3px}.ng-image-slider .ng-image-slider-error{height:100%;position:relative;display:flex;justify-content:center;align-items:center}.ng-image-slider .ng-image-slider-error .ng-image-slider-loader{background-image:url(data:image/gif;base64,R0lGODlhQABAAKUAAAQCBISChMTCxDQ2NOzq7KyqrExOTBweHJSSlNTW1PT29FxaXLS2tCwqLAwKDIyKjMzKzERCRPTy9FRWVCQmJJyanNze3Pz+/GRiZLy+vExKTAQGBISGhMTGxOzu7KyurFRSVCQiJJSWlNza3Pz6/FxeXLy6vCwuLAwODIyOjMzOzERGRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAsACwAAAAAQABAAAAG/kCWcEgsGo/IpHLJbDqf0CgRtXg8FiipdjshXL4XwmRLdk7A6Mu4zD6ivOkvIduuCzFxNMbOHCwWA0opeWApfEkgI2gWIEgPhF8Ph0cBhAFHJZAXe0gHHBkmHAdaZ5BrUx6EHnRGGhJoChpRABaaFgBGpXELna9pEqNPA5pfgUYLcHKnRg8keZJPeMScRiglViWsRwKEAlDSmtRkGd1Qw8TGZY/PULS2uGwHvmjAUbp5vHUaCrCyUpV5LvE58EBAhgfBSNUCY2HZpDoDSpRI97CixYsYM2pkgoICBW0bo0Rg4OwCCQYRQkLZIIJQBXgql1TQhCDmkhXELqwIeaCA/gcJBRIOIUcsw8YGyS54CEHEQUlNJBxo/BDnA5ETOb+c0DgPjAQiDbJe2Jqx65evQ5zmjDq1ahGimoxqRIrGA4UiEXKm3NhTAlChQ2ZCqmlTyQbBcSpsKMwkgomSJEzsZdzEAYUGUilr3sw5yYkUCSR4SJCCbGciLJ+CISFi8WkWG+DmyeC6c0tiIk43UE2IRAM+FJhKuZ0zd5sQEL5AEP4kgdgEdZKDgRCFNyQSx+PcfWK9dxsK2qE4zwq9jXTlUYjjrhNCxRcVzJ2c6J7GN/DfWhBDqpBkgwEDmWXkADeQCFBbEQ64d4EKAWLEEiGtIYJGIyE1gEBoEoyAAH4SG4JB4WtGbCAdBAeCSAQABoAAk4kstujii00EAQAh+QQJCQApACwAAAAAQABAAIUEAgSEgoTEwsREQkSsrqwcGhzk5uRsamyUkpT09vQMDgxcWlwkJiR0dnTMysxMSky8urycmpwMCgyMiowkIiTs7ux0cnT8/vwEBgTExsRERkS0trQcHhzs6uxsbmyUlpT8+vwUFhQsLix8fnzMzsxMTky8vrycnpyMjowAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCUcEgsGo/IpHLJbDqf0Kh0Sl0uMheQY1HtOj+XsPjjLSMX4vSFa24LHWqxw90GgOJhEICeFE02GxMiSQAJeFl7fEUAE3dpE4lGcHhzikUThxNnh2xIEiMZGSMSUyKHYYNHCHERSgokaSQKUpinmmeTW0sBcQFSEKcXEG1YapVQwKfDZpNpx08owShtvGq+UaanqWWvsbNS0XjTbhIBGQ4BpFMA4WkokZZdIigQGyjb8fn6+/z9/v8AAxLB8MCDhwcYBD7x0CFNhQMKmZw4dCJikgPBPASkwMBThWAV1PHjkIuCkRLBwmjw1+zCMyEWUl5o0I9CnI5EYqakyY/B/s0iKFM+YOnMiISPp0L64wDrAgmTRjwEgwiQAU4kE/FUtJjEAtIwFSxwXSKhoIUHIseqXcu2bRIFVr+5JTJggyMQGwbMTYEBDJ4I8NRGCIagrQaZK9eakGnCTYgGFkJIkeAoGIi0AylQSMikgIEwBgpgk4nKyAMIdyGUWDIizYjRpPFJIHCIgFwjrcW8hkJZ5uUhGAQEE8DZSIGGFzqIjrI4ZeMhtYLdOvK4wfIoA2TqFRKi8qkEki0NPlV4CEbSVBVhGM+qeAr2KbfGG4A6D4TtRGiTJsBPQlwk8AUjn0XnyZSeRQV4dwgI4Y0V3SnjqCVBMYc4gBlXCugXh217CZVgwl0mrOZGEAAh+QQJCQAyACwAAAAAQABAAIUEAgSEgoREQkTEwsQkIiSkoqRsamzk4uT08vQUFhRUVlQ0MjS0srSUlpR0dnQMCgxMSkzU0tSsqqzs6uz8+vw8OjzMyswsLix0cnQcHhxcXly8vrycnpwEBgSEhoRERkTExsQkJiSkpqRsbmzk5uT09vQcGhxcWlw0NjS0trScmpx8fnwMDgxMTkysrqzs7uz8/vw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCZcEgsGo/IpHLJbDqf0Kh0Sq1ar8lLilJKXbBg5AUBK8MQ37BamDKbU2s1gOIuUwBxZYdA6CwBJXUwd3lHDwETZS8BD0ptdXCFRR0bght+SAtkZmhNHXhVAYJlAUpaFBQpC0wsHAglHCxTHYmjE5hgIm4iUyGjZiFhD3RmFLhPvr8wwWAdxHbHTrS/t2oSbhJUHr8eaywFrwWyswOCA9FgAKBVDx4vZQiMkmEAIX3z+Pn6+/z9/v8AA06p0AAECBUVBDLpwEEQB3QKhzQcxSHikRjKYMTwl8ABhgRIJv6qyM8EiTIkTByxkNFCvxVuVqxs+TLmEZEU+5moNUGl/hGMyjb26+jA55ECvwpYPNIBaZ0CEJfKiKHCoAqhUrNq3cq1q8IKATgUCJCwSgcII0ZAiEoFBcs6FlBMGVFLkYEwCp7VKXEiCk43JK2g0CuIglwnBjKOsAIgQsYyEdYpefBO2YtGVAQ8NiOgSYvNH6ps2wyjGxMMmx0gAYDixAkUkodcI53tdGojAAwccEPCQGxdtD1vhjDJxS8Xx0ZvNr2EcsbLRVRkbEDkA2kYnZuMyHiXyALCglYJabw58pO/ZgIPkf5YBZEK4N1QKPsEQ2V4i404fhyhSN5fFPQlxQNoYbAWErs9doARbgkSFz77ZdQfbjF4UEABHsQQWx4NKWzmnlQobHaYVOi58WFWHTDwCwNsCZTbSWZM4JtXMgBQgQYaVLDhFUEAACH5BAkJACoALAAAAABAAEAAhQQCBISChDw6PMTGxOTm5CQiJFRWVKSipNTW1CwuLAwODJSWlERGRGxqbMzOzPT29LS2tNze3AwKDERCRCwqLGRiZDQ2NJyenPz+/AQGBISGhDw+PMzKzCQmJFxaXKyqrNza3DQyNBQWFJyanExKTGxubNTS1Pz6/Ly6vOTi5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJVwSCwaj8ikcslsOp/QqHRKrVqvS0oHy10WHBiMqdAtF03hsMPM7qTTFHaZ8g7H5UqRyIlOm/BJJH0IJEwFfWOARwx1GAxNFHdNEgYeElYIjQhsEpkYCJdTIo1he2UVbxVUo6SmXahpqlQgjSBsCp4gClWMdYWcHpZXJLQYIL+KXHrJzM3Oz9DR0tPUzgIBFwcBAtVMFhyNHBZJEiEhGdEGJ6QYDx5GGRoPYQ8a6M0C8+wYJ+NDCn3eONiVDEDAfSYADFnAbgGzCfvqTBCiQF+jBwQBaYj4RoOQEBH9AfrAMc0HIRZCJiNZEsNJFQrWkToRSmNLDB6FMCTlMFn+r5ITKR4MYyIjIIMlExKJJ/OEPWsy2Z3gZkSChRA1namT+q7bkW/hRHo1AmCDhgMHNGxQOLat27djJVSAAAIBhAb3pghYMGDACKpdLKRolEKskwwXGl3IayUfuweAnSQmdQGLhMH7UjBesiHihisNSjZ4MpldZSsoSqJ4Am4fhysRSkZgHfE1kgQBPqRNgCQ2x9mSI54uImHnmxGbVaTmuNpJ532fiwBY3ggF2yElSpaAcoDdgSOh940mIoFAxBRGmWToXudAchW+2QEnMsFinalTNozoOyK6kQIlkVGEAJi9kUJkcoDEkWFCSNAAXSCgUEFWeADIkYBuxUdKCnAgqRAeO+O9lQF1dVjXoQqINYLciUOEoMEHH2gQAovQBAEAIfkECQkAMAAsAAAAAEAAQACFBAIEhIKEREJExMbEJCIk5ObkbGpsrKqsFBIUNDI09Pb03NrcVFJUdHZ0tLa0DAoMlJKULCos7O7sHBocPDo8zM7MtLK0/P785OLkXFpcfH58BAYEhIaETEpMzMrMJCYk7OrsbG5srK6sFBYUNDY0/Pr83N7cVFZUfHp8vLq8DA4MlJaULC4s9PL0HB4cPD48AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5AmHBILBqPyKRyyWw6n9CodEqtWq/YbHaiCUy0YCNBcrlICEwAi8FgAcJMTbkcUG5QhfmlgNrAkwF6GkkjA3p6AyN/R2NlZ0gbHoeHA35SGwIvD04TAV5JDSWTh4NRCSZlJglZAHmjeiBvTw+ocwWbVwmvkyRQL5MvWBm7hxm+wMLEesazrmW3WLrKZb1Qp6mrWBsg0yCWUA8CArhZDdOli1GRxB7f6VCFr4nvVHfccyB99FYACWwJsvYJHEiwoMEwDww4WLDAgQF3B5WQqKUHQ7UjAD58CDjwhahRCigcOYGhDIYTBGkRwwDxxCSUAg1MM0Ck1SQMHNOlmJaCyP6HVx8EUtxlwidQgSWVFR1i81CBnIt2KutJxGWxgTKVhTCSIenJlM5GYVCBMUIEqPQ8viohMqISCkkrtnVrRyHDFA/p6t3Lt69fOA/MkqvyIEECiFk+HFBQpsSBoFM2cGB8QQEHxFU6tJjUooMUFRUmVSCLJcJmkBGirHi1IssBYgegqPg4SQFpwrRHlRi8RNqri1RYTGPxhAQx4Ece8C4iXBlxJ7PXLhfyoMGCMgv0GXmQe9JuKKtHtT6CwNAhDwiOvN4VW3boQxXSHxHxysKRD6c5p47ygMPHEhxMB4NvoyAnhGaceUbFAyQkIKAQcuyCThERiPCfCPvRAwExEC8o8QALLDwIBwrEoPCXEMbtYiBfFtR34hAIvKdHfC8O8QAKtZiAgoh+qcBjjYsEAQAh+QQJCQAuACwAAAAAQABAAIUEAgSMioxEQkTMysxkYmTk5uQkIiSsqqxUUlT09vSUlpTc2tx0cnQcGhwsLiwMCgxMSkzU0tRsamzs7uxcWlyUkpQsKiy0trT8/vycnpwEBgSMjoxERkTMzsxkZmTs6uwkJiSsrqxUVlT8+vycmpzk4uR8enw0MjQMDgxMTkzU1tRsbmz08vRcXlwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCXcEgsGo8ayCYU2kAAx6h0Sp1yVJisdiGoer9fz0hLxowk4LR6yBmXy921nKrBvssqzXx/TN3vCHyCQxV/bxWDgxeGZRdHBisKFSsGiVOLjFqORA8kblkjGQ+WR4WZWYhDDwN/A6OkRAinWYFDCowZcycBGydRAHaMC1BCBp93I5VqDglZCQ5RbZlxQgynDGu3WgpSYn9nRSSnuWqmWdxSAgtvXEYZ42sObiPQUwBKTBVPR9aZ2GsnNvQiZYzRCBCwBL0zRC7hngcd/nR45XAPioVkMqComMgAAwUkGCjjSLKkyZMoU6o0+cCCBYorwYA40MzMAYQxvUBg8YYF/gQpKCBA2KjSAs87CSwcETAhywRqJw8wOmAERVMtE4iyrPkNpgs/ZVKgdHCq3hCwZMSePFG2iFUyWVE+OPZmhFcXAo6ygGpSqiGqR4IOXWn0DwulOafs7PkzMRULIeaFQOy4ygMHDu5W3sy5s+fPoCuioBAgAAWtcwCAAEEMlogPZD6I2COiRJYSs0mJ+JNbze4yvQWhgH3nA2ovAAq8KdGaDwFGBNSA+INT0AZGG6RTTxSAUQA1yd8UaG4EAAcTJjiQJ/LcUHTfbyhMARGBTATKbq++ibuGgm0MuE3RgHJlFNBAFL/FtwcALq1XhDZvoHMEBcRlIRtKBIo3BQoELpTWwnEcacCIHqFVWMYHoQkBYRkSgjbgGx8cmKILFgSDgQr4pWgeevvM6CNnQQAAIfkECQkAJgAsAAAAAEAAQACFBAIEhIaEREJExMbEJCIkZGJktLK07OrsnJqcVFZUDA4MNDI0/Pr8jI6M5OLkdHZ0TEpMzM7MLCosvL689PL0XF5cFBYUBAYEjIqMzMrMJCYkZGZk7O7snJ6cXFpcFBIUNDY0/P78lJKUfHp8TE5MxMLEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5Ak3BILBqPyKRyyWyaPo/BwTF4KJzYrBJyCHm/B4h2PIYwvugQQ0xuLxWcdJrzcduPI7l8dGcSAhkOBwMBBEcDemkDfUkAAWdpDBgARXGJXxSMRxcGlyEGlEMUnl6ZRgAFE1MTBRdaAaQhGESIpItFFrVoAxZYGpCeDBpDeaR8RAC6iq5NDbFeDUMflol0RQWeG04RzyERRGaXbEQlnhNOo8+mQwLUXxzjRO5yHE7zl+vSI1IHGSNXR9JV29btm5tyl841EdEtmpsN2Zz8isVAgh0AGRJlCNUEQ6xZdyxkTJOhFxZOngwwuwNgQ4kDB0ps4IgFAAZgXyTR1NRHQ/6ACDAjYDDEs6jRo0iTKl3KtKlTIQo8YMDgAeBTLQm6gElwNUuCRFyRgOiAAERXBVrlHLBKZEG6ilexXSpwBAGaDledXXJYpMPdqx4vgSyyABKDBVcreKJ7REKHDoivwqnGtmuSr3o8WHbiIW2IA2E3N1FQYGqFOqJTq17NurXr17Bj90kwgAGFAaHbKIAAoTIjhmlEuGnnhYOAopjl5MYy+Z1vNyPl3NJCQg4JTQBwomGws0n1NNcZARAYqTuT5sWft4muqI2AdBSOM1kwYoRZJcnTLM+yuzcTAH590YF5QwCHhnBOPSDHA0t4UBsDA2j2lANyOCCbEAAkQiBrFBqmYeGFJiiYBoMgAnjXhq6BUN99ILboYmxBAAAh+QQJCQAnACwAAAAAQABAAIUEAgSMiozExsRUUlQkIiSkpqTk5uQUEhQ0MjS0srT09vScmpx8enwMCgw8Ojzk4uRcWlwsKiysrqz08vQcHhy8urz8/vykoqQEBgSUkpTMzsxUVlQkJiSsqqzs6uwUFhQ0NjS0trT8+vycnpx8fnwMDgw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCTcEgsGo/IpHLJbA4PINDBSa02ESGRxSIKIazg8Gmj3ZpFG7GaiVCY39zIen4MweEhuhNDoWCSB2V3WyJTekkOEm4WChIORw6DcI+HRgABkgEARSCSb5RHBAMDHGKYngFFB55mhkUEFW8VBFYmrFsmRXaeFUcUBnceFFUJtxZ5RAiCcCJyRrGDvXuLrAp/RBDLhGlGHKylTd7GFuDJFWUiFV9HG6zcTOLG5aogDq5HA+572oMi12IEvlEpdisBHWh3pDmxdSvXHAIegtGqcirToQ8SZE2scinTpkqiSK1JhC4BqEooMRDwg7Kly5cnMHyEqcfBCGAWDIw4SdNK/oMCkgo06GmlhAZWGu4RXdLBWIelQjYIEKFAwDshkcbxfFnRTAYiQMcVIApB0jucxgwQFSBJwJBxZobCBMCP0Ee4W+S+BECN2ceI4zysbTskrLGxPcsOepfV2FaXGe58BesU6gkIU0UIgGDEKFK9lpWUaDqoA+jQSxxceLDlwYXHqJlg+Be7tu3buHPr3s3bSYQsCkI4UwNixAIQLiNMeDNhOJg2hJzr2fUGWZgFb0agpHtHxEwrI7Jv72tXjDJC6ypRN2M9TIQLI9JXUs5cOtEBBToMaPJbRBf7PTHwBgO9HVHCMiKUUGARCNwh34IHvpHggkUIaAYJFBoxQAf6CWXo4YcghmhEEAA7YnVPZzU3UnNDZXVsS2VVYlhjelFTNkFCd2NQbHA4Umg0WUJramlqdElnNVhRWVphVGtSTmNwSno1Zm5mZ0ZOWA==);background-repeat:no-repeat;background-position:center center;background-size:25px 25px;width:25px;height:25px}.close-outside{height:100%;width:100%;position:absolute;top:0;left:0}@media (max-width: 1199px){.ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:170px;max-width:100%}}@media (max-width: 991px){.ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:297px;max-width:100%}}@media (max-width: 768px){.ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:247px;max-width:100%}}@media (max-width: 576px){.ng-image-slider .ng-image-slider-container .main .main-inner .img-div{width:350px;max-width:100%}}.ng-image-fullscreen-view{position:fixed;z-index:1031;background-color:#0009;width:100%;height:100%;top:0;overflow:hidden;transition:all .5s ease-in-out;left:0;text-align:center}.ng-image-fullscreen-view.image-fullview-hide{display:none!important}.ng-image-fullscreen-view .lightbox-wrapper{position:fixed;top:0;left:0;width:100%;height:100%;background-color:#1f1f1f;transition:all .5s ease;display:flex;justify-content:center;align-items:center}.ng-image-fullscreen-view .lightbox-wrapper.ng-ligthbox-pagination{height:calc(100% - 30px)}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div{width:100%;height:100%;border:1px solid;border-color:#00000059;position:relative;overflow:hidden}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .pre-loader{background-color:inherit;width:100%;height:100%}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .pre-loader .mnml-spinner{background-image:url(data:image/gif;base64,R0lGODlhQABAAKUAAAQCBISChMTCxDQ2NOzq7KyqrExOTBweHJSSlNTW1PT29FxaXLS2tCwqLAwKDIyKjMzKzERCRPTy9FRWVCQmJJyanNze3Pz+/GRiZLy+vExKTAQGBISGhMTGxOzu7KyurFRSVCQiJJSWlNza3Pz6/FxeXLy6vCwuLAwODIyOjMzOzERGRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAsACwAAAAAQABAAAAG/kCWcEgsGo/IpHLJbDqf0CgRtXg8FiipdjshXL4XwmRLdk7A6Mu4zD6ivOkvIduuCzFxNMbOHCwWA0opeWApfEkgI2gWIEgPhF8Ph0cBhAFHJZAXe0gHHBkmHAdaZ5BrUx6EHnRGGhJoChpRABaaFgBGpXELna9pEqNPA5pfgUYLcHKnRg8keZJPeMScRiglViWsRwKEAlDSmtRkGd1Qw8TGZY/PULS2uGwHvmjAUbp5vHUaCrCyUpV5LvE58EBAhgfBSNUCY2HZpDoDSpRI97CixYsYM2pkgoICBW0bo0Rg4OwCCQYRQkLZIIJQBXgql1TQhCDmkhXELqwIeaCA/gcJBRIOIUcsw8YGyS54CEHEQUlNJBxo/BDnA5ETOb+c0DgPjAQiDbJe2Jqx65evQ5zmjDq1ahGimoxqRIrGA4UiEXKm3NhTAlChQ2ZCqmlTyQbBcSpsKMwkgomSJEzsZdzEAYUGUilr3sw5yYkUCSR4SJCCbGciLJ+CISFi8WkWG+DmyeC6c0tiIk43UE2IRAM+FJhKuZ0zd5sQEL5AEP4kgdgEdZKDgRCFNyQSx+PcfWK9dxsK2qE4zwq9jXTlUYjjrhNCxRcVzJ2c6J7GN/DfWhBDqpBkgwEDmWXkADeQCFBbEQ64d4EKAWLEEiGtIYJGIyE1gEBoEoyAAH4SG4JB4WtGbCAdBAeCSAQABoAAk4kstujii00EAQAh+QQJCQApACwAAAAAQABAAIUEAgSEgoTEwsREQkSsrqwcGhzk5uRsamyUkpT09vQMDgxcWlwkJiR0dnTMysxMSky8urycmpwMCgyMiowkIiTs7ux0cnT8/vwEBgTExsRERkS0trQcHhzs6uxsbmyUlpT8+vwUFhQsLix8fnzMzsxMTky8vrycnpyMjowAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCUcEgsGo/IpHLJbDqf0Kh0Sl0uMheQY1HtOj+XsPjjLSMX4vSFa24LHWqxw90GgOJhEICeFE02GxMiSQAJeFl7fEUAE3dpE4lGcHhzikUThxNnh2xIEiMZGSMSUyKHYYNHCHERSgokaSQKUpinmmeTW0sBcQFSEKcXEG1YapVQwKfDZpNpx08owShtvGq+UaanqWWvsbNS0XjTbhIBGQ4BpFMA4WkokZZdIigQGyjb8fn6+/z9/v8AAxLB8MCDhwcYBD7x0CFNhQMKmZw4dCJikgPBPASkwMBThWAV1PHjkIuCkRLBwmjw1+zCMyEWUl5o0I9CnI5EYqakyY/B/s0iKFM+YOnMiISPp0L64wDrAgmTRjwEgwiQAU4kE/FUtJjEAtIwFSxwXSKhoIUHIseqXcu2bRIFVr+5JTJggyMQGwbMTYEBDJ4I8NRGCIagrQaZK9eakGnCTYgGFkJIkeAoGIi0AylQSMikgIEwBgpgk4nKyAMIdyGUWDIizYjRpPFJIHCIgFwjrcW8hkJZ5uUhGAQEE8DZSIGGFzqIjrI4ZeMhtYLdOvK4wfIoA2TqFRKi8qkEki0NPlV4CEbSVBVhGM+qeAr2KbfGG4A6D4TtRGiTJsBPQlwk8AUjn0XnyZSeRQV4dwgI4Y0V3SnjqCVBMYc4gBlXCugXh217CZVgwl0mrOZGEAAh+QQJCQAyACwAAAAAQABAAIUEAgSEgoREQkTEwsQkIiSkoqRsamzk4uT08vQUFhRUVlQ0MjS0srSUlpR0dnQMCgxMSkzU0tSsqqzs6uz8+vw8OjzMyswsLix0cnQcHhxcXly8vrycnpwEBgSEhoRERkTExsQkJiSkpqRsbmzk5uT09vQcGhxcWlw0NjS0trScmpx8fnwMDgxMTkysrqzs7uz8/vw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCZcEgsGo/IpHLJbDqf0Kh0Sq1ar8lLilJKXbBg5AUBK8MQ37BamDKbU2s1gOIuUwBxZYdA6CwBJXUwd3lHDwETZS8BD0ptdXCFRR0bght+SAtkZmhNHXhVAYJlAUpaFBQpC0wsHAglHCxTHYmjE5hgIm4iUyGjZiFhD3RmFLhPvr8wwWAdxHbHTrS/t2oSbhJUHr8eaywFrwWyswOCA9FgAKBVDx4vZQiMkmEAIX3z+Pn6+/z9/v8AA06p0AAECBUVBDLpwEEQB3QKhzQcxSHikRjKYMTwl8ABhgRIJv6qyM8EiTIkTByxkNFCvxVuVqxs+TLmEZEU+5moNUGl/hGMyjb26+jA55ECvwpYPNIBaZ0CEJfKiKHCoAqhUrNq3cq1q8IKATgUCJCwSgcII0ZAiEoFBcs6FlBMGVFLkYEwCp7VKXEiCk43JK2g0CuIglwnBjKOsAIgQsYyEdYpefBO2YtGVAQ8NiOgSYvNH6ps2wyjGxMMmx0gAYDixAkUkodcI53tdGojAAwccEPCQGxdtD1vhjDJxS8Xx0ZvNr2EcsbLRVRkbEDkA2kYnZuMyHiXyALCglYJabw58pO/ZgIPkf5YBZEK4N1QKPsEQ2V4i404fhyhSN5fFPQlxQNoYbAWErs9doARbgkSFz77ZdQfbjF4UEABHsQQWx4NKWzmnlQobHaYVOi58WFWHTDwCwNsCZTbSWZM4JtXMgBQgQYaVLDhFUEAACH5BAkJACoALAAAAABAAEAAhQQCBISChDw6PMTGxOTm5CQiJFRWVKSipNTW1CwuLAwODJSWlERGRGxqbMzOzPT29LS2tNze3AwKDERCRCwqLGRiZDQ2NJyenPz+/AQGBISGhDw+PMzKzCQmJFxaXKyqrNza3DQyNBQWFJyanExKTGxubNTS1Pz6/Ly6vOTi5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJVwSCwaj8ikcslsOp/QqHRKrVqvS0oHy10WHBiMqdAtF03hsMPM7qTTFHaZ8g7H5UqRyIlOm/BJJH0IJEwFfWOARwx1GAxNFHdNEgYeElYIjQhsEpkYCJdTIo1he2UVbxVUo6SmXahpqlQgjSBsCp4gClWMdYWcHpZXJLQYIL+KXHrJzM3Oz9DR0tPUzgIBFwcBAtVMFhyNHBZJEiEhGdEGJ6QYDx5GGRoPYQ8a6M0C8+wYJ+NDCn3eONiVDEDAfSYADFnAbgGzCfvqTBCiQF+jBwQBaYj4RoOQEBH9AfrAMc0HIRZCJiNZEsNJFQrWkToRSmNLDB6FMCTlMFn+r5ITKR4MYyIjIIMlExKJJ/OEPWsy2Z3gZkSChRA1namT+q7bkW/hRHo1AmCDhgMHNGxQOLat27djJVSAAAIBhAb3pghYMGDACKpdLKRolEKskwwXGl3IayUfuweAnSQmdQGLhMH7UjBesiHihisNSjZ4MpldZSsoSqJ4Am4fhysRSkZgHfE1kgQBPqRNgCQ2x9mSI54uImHnmxGbVaTmuNpJ532fiwBY3ggF2yElSpaAcoDdgSOh940mIoFAxBRGmWToXudAchW+2QEnMsFinalTNozoOyK6kQIlkVGEAJi9kUJkcoDEkWFCSNAAXSCgUEFWeADIkYBuxUdKCnAgqRAeO+O9lQF1dVjXoQqINYLciUOEoMEHH2gQAovQBAEAIfkECQkAMAAsAAAAAEAAQACFBAIEhIKEREJExMbEJCIk5ObkbGpsrKqsFBIUNDI09Pb03NrcVFJUdHZ0tLa0DAoMlJKULCos7O7sHBocPDo8zM7MtLK0/P785OLkXFpcfH58BAYEhIaETEpMzMrMJCYk7OrsbG5srK6sFBYUNDY0/Pr83N7cVFZUfHp8vLq8DA4MlJaULC4s9PL0HB4cPD48AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5AmHBILBqPyKRyyWw6n9CodEqtWq/YbHaiCUy0YCNBcrlICEwAi8FgAcJMTbkcUG5QhfmlgNrAkwF6GkkjA3p6AyN/R2NlZ0gbHoeHA35SGwIvD04TAV5JDSWTh4NRCSZlJglZAHmjeiBvTw+ocwWbVwmvkyRQL5MvWBm7hxm+wMLEesazrmW3WLrKZb1Qp6mrWBsg0yCWUA8CArhZDdOli1GRxB7f6VCFr4nvVHfccyB99FYACWwJsvYJHEiwoMEwDww4WLDAgQF3B5WQqKUHQ7UjAD58CDjwhahRCigcOYGhDIYTBGkRwwDxxCSUAg1MM0Ck1SQMHNOlmJaCyP6HVx8EUtxlwidQgSWVFR1i81CBnIt2KutJxGWxgTKVhTCSIenJlM5GYVCBMUIEqPQ8viohMqISCkkrtnVrRyHDFA/p6t3Lt69fOA/MkqvyIEECiFk+HFBQpsSBoFM2cGB8QQEHxFU6tJjUooMUFRUmVSCLJcJmkBGirHi1IssBYgegqPg4SQFpwrRHlRi8RNqri1RYTGPxhAQx4Ece8C4iXBlxJ7PXLhfyoMGCMgv0GXmQe9JuKKtHtT6CwNAhDwiOvN4VW3boQxXSHxHxysKRD6c5p47ygMPHEhxMB4NvoyAnhGaceUbFAyQkIKAQcuyCThERiPCfCPvRAwExEC8o8QALLDwIBwrEoPCXEMbtYiBfFtR34hAIvKdHfC8O8QAKtZiAgoh+qcBjjYsEAQAh+QQJCQAuACwAAAAAQABAAIUEAgSMioxEQkTMysxkYmTk5uQkIiSsqqxUUlT09vSUlpTc2tx0cnQcGhwsLiwMCgxMSkzU0tRsamzs7uxcWlyUkpQsKiy0trT8/vycnpwEBgSMjoxERkTMzsxkZmTs6uwkJiSsrqxUVlT8+vycmpzk4uR8enw0MjQMDgxMTkzU1tRsbmz08vRcXlwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCXcEgsGo8ayCYU2kAAx6h0Sp1yVJisdiGoer9fz0hLxowk4LR6yBmXy921nKrBvssqzXx/TN3vCHyCQxV/bxWDgxeGZRdHBisKFSsGiVOLjFqORA8kblkjGQ+WR4WZWYhDDwN/A6OkRAinWYFDCowZcycBGydRAHaMC1BCBp93I5VqDglZCQ5RbZlxQgynDGu3WgpSYn9nRSSnuWqmWdxSAgtvXEYZ42sObiPQUwBKTBVPR9aZ2GsnNvQiZYzRCBCwBL0zRC7hngcd/nR45XAPioVkMqComMgAAwUkGCjjSLKkyZMoU6o0+cCCBYorwYA40MzMAYQxvUBg8YYF/gQpKCBA2KjSAs87CSwcETAhywRqJw8wOmAERVMtE4iyrPkNpgs/ZVKgdHCq3hCwZMSePFG2iFUyWVE+OPZmhFcXAo6ygGpSqiGqR4IOXWn0DwulOafs7PkzMRULIeaFQOy4ygMHDu5W3sy5s+fPoCuioBAgAAWtcwCAAEEMlogPZD6I2COiRJYSs0mJ+JNbze4yvQWhgH3nA2ovAAq8KdGaDwFGBNSA+INT0AZGG6RTTxSAUQA1yd8UaG4EAAcTJjiQJ/LcUHTfbyhMARGBTATKbq++ibuGgm0MuE3RgHJlFNBAFL/FtwcALq1XhDZvoHMEBcRlIRtKBIo3BQoELpTWwnEcacCIHqFVWMYHoQkBYRkSgjbgGx8cmKILFgSDgQr4pWgeevvM6CNnQQAAIfkECQkAJgAsAAAAAEAAQACFBAIEhIaEREJExMbEJCIkZGJktLK07OrsnJqcVFZUDA4MNDI0/Pr8jI6M5OLkdHZ0TEpMzM7MLCosvL689PL0XF5cFBYUBAYEjIqMzMrMJCYkZGZk7O7snJ6cXFpcFBIUNDY0/P78lJKUfHp8TE5MxMLEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5Ak3BILBqPyKRyyWyaPo/BwTF4KJzYrBJyCHm/B4h2PIYwvugQQ0xuLxWcdJrzcduPI7l8dGcSAhkOBwMBBEcDemkDfUkAAWdpDBgARXGJXxSMRxcGlyEGlEMUnl6ZRgAFE1MTBRdaAaQhGESIpItFFrVoAxZYGpCeDBpDeaR8RAC6iq5NDbFeDUMflol0RQWeG04RzyERRGaXbEQlnhNOo8+mQwLUXxzjRO5yHE7zl+vSI1IHGSNXR9JV29btm5tyl841EdEtmpsN2Zz8isVAgh0AGRJlCNUEQ6xZdyxkTJOhFxZOngwwuwNgQ4kDB0ps4IgFAAZgXyTR1NRHQ/6ACDAjYDDEs6jRo0iTKl3KtKlTIQo8YMDgAeBTLQm6gElwNUuCRFyRgOiAAERXBVrlHLBKZEG6ilexXSpwBAGaDledXXJYpMPdqx4vgSyyABKDBVcreKJ7REKHDoivwqnGtmuSr3o8WHbiIW2IA2E3N1FQYGqFOqJTq17NurXr17Bj90kwgAGFAaHbKIAAoTIjhmlEuGnnhYOAopjl5MYy+Z1vNyPl3NJCQg4JTQBwomGws0n1NNcZARAYqTuT5sWft4muqI2AdBSOM1kwYoRZJcnTLM+yuzcTAH590YF5QwCHhnBOPSDHA0t4UBsDA2j2lANyOCCbEAAkQiBrFBqmYeGFJiiYBoMgAnjXhq6BUN99ILboYmxBAAAh+QQJCQAnACwAAAAAQABAAIUEAgSMiozExsRUUlQkIiSkpqTk5uQUEhQ0MjS0srT09vScmpx8enwMCgw8Ojzk4uRcWlwsKiysrqz08vQcHhy8urz8/vykoqQEBgSUkpTMzsxUVlQkJiSsqqzs6uwUFhQ0NjS0trT8+vycnpx8fnwMDgw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCTcEgsGo/IpHLJbA4PINDBSa02ESGRxSIKIazg8Gmj3ZpFG7GaiVCY39zIen4MweEhuhNDoWCSB2V3WyJTekkOEm4WChIORw6DcI+HRgABkgEARSCSb5RHBAMDHGKYngFFB55mhkUEFW8VBFYmrFsmRXaeFUcUBnceFFUJtxZ5RAiCcCJyRrGDvXuLrAp/RBDLhGlGHKylTd7GFuDJFWUiFV9HG6zcTOLG5aogDq5HA+572oMi12IEvlEpdisBHWh3pDmxdSvXHAIegtGqcirToQ8SZE2scinTpkqiSK1JhC4BqEooMRDwg7Kly5cnMHyEqcfBCGAWDIw4SdNK/oMCkgo06GmlhAZWGu4RXdLBWIelQjYIEKFAwDshkcbxfFnRTAYiQMcVIApB0jucxgwQFSBJwJBxZobCBMCP0Ee4W+S+BECN2ceI4zysbTskrLGxPcsOepfV2FaXGe58BesU6gkIU0UIgGDEKFK9lpWUaDqoA+jQSxxceLDlwYXHqJlg+Be7tu3buHPr3s3bSYQsCkI4UwNixAIQLiNMeDNhOJg2hJzr2fUGWZgFb0agpHtHxEwrI7Jv72tXjDJC6ypRN2M9TIQLI9JXUs5cOtEBBToMaPJbRBf7PTHwBgO9HVHCMiKUUGARCNwh34IHvpHggkUIaAYJFBoxQAf6CWXo4YcghmhEEAA7YnVPZzU3UnNDZXVsS2VVYlhjelFTNkFCd2NQbHA4Umg0WUJramlqdElnNVhRWVphVGtSTmNwSno1Zm5mZ0ZOWA==);background-repeat:no-repeat;background-position:center center;width:100%;height:100%}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main{display:grid;grid-template-columns:repeat(6,1fr);grid-template-rows:100%;grid-column-gap:0px;height:100%}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image{width:1299px;height:100%;position:relative}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image .custom-image-main.ng-fullimage-loading{background-image:url(data:image/gif;base64,R0lGODlhQABAAKUAAAQCBISChMTCxDQ2NOzq7KyqrExOTBweHJSSlNTW1PT29FxaXLS2tCwqLAwKDIyKjMzKzERCRPTy9FRWVCQmJJyanNze3Pz+/GRiZLy+vExKTAQGBISGhMTGxOzu7KyurFRSVCQiJJSWlNza3Pz6/FxeXLy6vCwuLAwODIyOjMzOzERGRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQJCQAsACwAAAAAQABAAAAG/kCWcEgsGo/IpHLJbDqf0CgRtXg8FiipdjshXL4XwmRLdk7A6Mu4zD6ivOkvIduuCzFxNMbOHCwWA0opeWApfEkgI2gWIEgPhF8Ph0cBhAFHJZAXe0gHHBkmHAdaZ5BrUx6EHnRGGhJoChpRABaaFgBGpXELna9pEqNPA5pfgUYLcHKnRg8keZJPeMScRiglViWsRwKEAlDSmtRkGd1Qw8TGZY/PULS2uGwHvmjAUbp5vHUaCrCyUpV5LvE58EBAhgfBSNUCY2HZpDoDSpRI97CixYsYM2pkgoICBW0bo0Rg4OwCCQYRQkLZIIJQBXgql1TQhCDmkhXELqwIeaCA/gcJBRIOIUcsw8YGyS54CEHEQUlNJBxo/BDnA5ETOb+c0DgPjAQiDbJe2Jqx65evQ5zmjDq1ahGimoxqRIrGA4UiEXKm3NhTAlChQ2ZCqmlTyQbBcSpsKMwkgomSJEzsZdzEAYUGUilr3sw5yYkUCSR4SJCCbGciLJ+CISFi8WkWG+DmyeC6c0tiIk43UE2IRAM+FJhKuZ0zd5sQEL5AEP4kgdgEdZKDgRCFNyQSx+PcfWK9dxsK2qE4zwq9jXTlUYjjrhNCxRcVzJ2c6J7GN/DfWhBDqpBkgwEDmWXkADeQCFBbEQ64d4EKAWLEEiGtIYJGIyE1gEBoEoyAAH4SG4JB4WtGbCAdBAeCSAQABoAAk4kstujii00EAQAh+QQJCQApACwAAAAAQABAAIUEAgSEgoTEwsREQkSsrqwcGhzk5uRsamyUkpT09vQMDgxcWlwkJiR0dnTMysxMSky8urycmpwMCgyMiowkIiTs7ux0cnT8/vwEBgTExsRERkS0trQcHhzs6uxsbmyUlpT8+vwUFhQsLix8fnzMzsxMTky8vrycnpyMjowAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCUcEgsGo/IpHLJbDqf0Kh0Sl0uMheQY1HtOj+XsPjjLSMX4vSFa24LHWqxw90GgOJhEICeFE02GxMiSQAJeFl7fEUAE3dpE4lGcHhzikUThxNnh2xIEiMZGSMSUyKHYYNHCHERSgokaSQKUpinmmeTW0sBcQFSEKcXEG1YapVQwKfDZpNpx08owShtvGq+UaanqWWvsbNS0XjTbhIBGQ4BpFMA4WkokZZdIigQGyjb8fn6+/z9/v8AAxLB8MCDhwcYBD7x0CFNhQMKmZw4dCJikgPBPASkwMBThWAV1PHjkIuCkRLBwmjw1+zCMyEWUl5o0I9CnI5EYqakyY/B/s0iKFM+YOnMiISPp0L64wDrAgmTRjwEgwiQAU4kE/FUtJjEAtIwFSxwXSKhoIUHIseqXcu2bRIFVr+5JTJggyMQGwbMTYEBDJ4I8NRGCIagrQaZK9eakGnCTYgGFkJIkeAoGIi0AylQSMikgIEwBgpgk4nKyAMIdyGUWDIizYjRpPFJIHCIgFwjrcW8hkJZ5uUhGAQEE8DZSIGGFzqIjrI4ZeMhtYLdOvK4wfIoA2TqFRKi8qkEki0NPlV4CEbSVBVhGM+qeAr2KbfGG4A6D4TtRGiTJsBPQlwk8AUjn0XnyZSeRQV4dwgI4Y0V3SnjqCVBMYc4gBlXCugXh217CZVgwl0mrOZGEAAh+QQJCQAyACwAAAAAQABAAIUEAgSEgoREQkTEwsQkIiSkoqRsamzk4uT08vQUFhRUVlQ0MjS0srSUlpR0dnQMCgxMSkzU0tSsqqzs6uz8+vw8OjzMyswsLix0cnQcHhxcXly8vrycnpwEBgSEhoRERkTExsQkJiSkpqRsbmzk5uT09vQcGhxcWlw0NjS0trScmpx8fnwMDgxMTkysrqzs7uz8/vw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCZcEgsGo/IpHLJbDqf0Kh0Sq1ar8lLilJKXbBg5AUBK8MQ37BamDKbU2s1gOIuUwBxZYdA6CwBJXUwd3lHDwETZS8BD0ptdXCFRR0bght+SAtkZmhNHXhVAYJlAUpaFBQpC0wsHAglHCxTHYmjE5hgIm4iUyGjZiFhD3RmFLhPvr8wwWAdxHbHTrS/t2oSbhJUHr8eaywFrwWyswOCA9FgAKBVDx4vZQiMkmEAIX3z+Pn6+/z9/v8AA06p0AAECBUVBDLpwEEQB3QKhzQcxSHikRjKYMTwl8ABhgRIJv6qyM8EiTIkTByxkNFCvxVuVqxs+TLmEZEU+5moNUGl/hGMyjb26+jA55ECvwpYPNIBaZ0CEJfKiKHCoAqhUrNq3cq1q8IKATgUCJCwSgcII0ZAiEoFBcs6FlBMGVFLkYEwCp7VKXEiCk43JK2g0CuIglwnBjKOsAIgQsYyEdYpefBO2YtGVAQ8NiOgSYvNH6ps2wyjGxMMmx0gAYDixAkUkodcI53tdGojAAwccEPCQGxdtD1vhjDJxS8Xx0ZvNr2EcsbLRVRkbEDkA2kYnZuMyHiXyALCglYJabw58pO/ZgIPkf5YBZEK4N1QKPsEQ2V4i404fhyhSN5fFPQlxQNoYbAWErs9doARbgkSFz77ZdQfbjF4UEABHsQQWx4NKWzmnlQobHaYVOi58WFWHTDwCwNsCZTbSWZM4JtXMgBQgQYaVLDhFUEAACH5BAkJACoALAAAAABAAEAAhQQCBISChDw6PMTGxOTm5CQiJFRWVKSipNTW1CwuLAwODJSWlERGRGxqbMzOzPT29LS2tNze3AwKDERCRCwqLGRiZDQ2NJyenPz+/AQGBISGhDw+PMzKzCQmJFxaXKyqrNza3DQyNBQWFJyanExKTGxubNTS1Pz6/Ly6vOTi5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAb+QJVwSCwaj8ikcslsOp/QqHRKrVqvS0oHy10WHBiMqdAtF03hsMPM7qTTFHaZ8g7H5UqRyIlOm/BJJH0IJEwFfWOARwx1GAxNFHdNEgYeElYIjQhsEpkYCJdTIo1he2UVbxVUo6SmXahpqlQgjSBsCp4gClWMdYWcHpZXJLQYIL+KXHrJzM3Oz9DR0tPUzgIBFwcBAtVMFhyNHBZJEiEhGdEGJ6QYDx5GGRoPYQ8a6M0C8+wYJ+NDCn3eONiVDEDAfSYADFnAbgGzCfvqTBCiQF+jBwQBaYj4RoOQEBH9AfrAMc0HIRZCJiNZEsNJFQrWkToRSmNLDB6FMCTlMFn+r5ITKR4MYyIjIIMlExKJJ/OEPWsy2Z3gZkSChRA1namT+q7bkW/hRHo1AmCDhgMHNGxQOLat27djJVSAAAIBhAb3pghYMGDACKpdLKRolEKskwwXGl3IayUfuweAnSQmdQGLhMH7UjBesiHihisNSjZ4MpldZSsoSqJ4Am4fhysRSkZgHfE1kgQBPqRNgCQ2x9mSI54uImHnmxGbVaTmuNpJ532fiwBY3ggF2yElSpaAcoDdgSOh940mIoFAxBRGmWToXudAchW+2QEnMsFinalTNozoOyK6kQIlkVGEAJi9kUJkcoDEkWFCSNAAXSCgUEFWeADIkYBuxUdKCnAgqRAeO+O9lQF1dVjXoQqINYLciUOEoMEHH2gQAovQBAEAIfkECQkAMAAsAAAAAEAAQACFBAIEhIKEREJExMbEJCIk5ObkbGpsrKqsFBIUNDI09Pb03NrcVFJUdHZ0tLa0DAoMlJKULCos7O7sHBocPDo8zM7MtLK0/P785OLkXFpcfH58BAYEhIaETEpMzMrMJCYk7OrsbG5srK6sFBYUNDY0/Pr83N7cVFZUfHp8vLq8DA4MlJaULC4s9PL0HB4cPD48AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5AmHBILBqPyKRyyWw6n9CodEqtWq/YbHaiCUy0YCNBcrlICEwAi8FgAcJMTbkcUG5QhfmlgNrAkwF6GkkjA3p6AyN/R2NlZ0gbHoeHA35SGwIvD04TAV5JDSWTh4NRCSZlJglZAHmjeiBvTw+ocwWbVwmvkyRQL5MvWBm7hxm+wMLEesazrmW3WLrKZb1Qp6mrWBsg0yCWUA8CArhZDdOli1GRxB7f6VCFr4nvVHfccyB99FYACWwJsvYJHEiwoMEwDww4WLDAgQF3B5WQqKUHQ7UjAD58CDjwhahRCigcOYGhDIYTBGkRwwDxxCSUAg1MM0Ck1SQMHNOlmJaCyP6HVx8EUtxlwidQgSWVFR1i81CBnIt2KutJxGWxgTKVhTCSIenJlM5GYVCBMUIEqPQ8viohMqISCkkrtnVrRyHDFA/p6t3Lt69fOA/MkqvyIEECiFk+HFBQpsSBoFM2cGB8QQEHxFU6tJjUooMUFRUmVSCLJcJmkBGirHi1IssBYgegqPg4SQFpwrRHlRi8RNqri1RYTGPxhAQx4Ece8C4iXBlxJ7PXLhfyoMGCMgv0GXmQe9JuKKtHtT6CwNAhDwiOvN4VW3boQxXSHxHxysKRD6c5p47ygMPHEhxMB4NvoyAnhGaceUbFAyQkIKAQcuyCThERiPCfCPvRAwExEC8o8QALLDwIBwrEoPCXEMbtYiBfFtR34hAIvKdHfC8O8QAKtZiAgoh+qcBjjYsEAQAh+QQJCQAuACwAAAAAQABAAIUEAgSMioxEQkTMysxkYmTk5uQkIiSsqqxUUlT09vSUlpTc2tx0cnQcGhwsLiwMCgxMSkzU0tRsamzs7uxcWlyUkpQsKiy0trT8/vycnpwEBgSMjoxERkTMzsxkZmTs6uwkJiSsrqxUVlT8+vycmpzk4uR8enw0MjQMDgxMTkzU1tRsbmz08vRcXlwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/kCXcEgsGo8ayCYU2kAAx6h0Sp1yVJisdiGoer9fz0hLxowk4LR6yBmXy921nKrBvssqzXx/TN3vCHyCQxV/bxWDgxeGZRdHBisKFSsGiVOLjFqORA8kblkjGQ+WR4WZWYhDDwN/A6OkRAinWYFDCowZcycBGydRAHaMC1BCBp93I5VqDglZCQ5RbZlxQgynDGu3WgpSYn9nRSSnuWqmWdxSAgtvXEYZ42sObiPQUwBKTBVPR9aZ2GsnNvQiZYzRCBCwBL0zRC7hngcd/nR45XAPioVkMqComMgAAwUkGCjjSLKkyZMoU6o0+cCCBYorwYA40MzMAYQxvUBg8YYF/gQpKCBA2KjSAs87CSwcETAhywRqJw8wOmAERVMtE4iyrPkNpgs/ZVKgdHCq3hCwZMSePFG2iFUyWVE+OPZmhFcXAo6ygGpSqiGqR4IOXWn0DwulOafs7PkzMRULIeaFQOy4ygMHDu5W3sy5s+fPoCuioBAgAAWtcwCAAEEMlogPZD6I2COiRJYSs0mJ+JNbze4yvQWhgH3nA2ovAAq8KdGaDwFGBNSA+INT0AZGG6RTTxSAUQA1yd8UaG4EAAcTJjiQJ/LcUHTfbyhMARGBTATKbq++ibuGgm0MuE3RgHJlFNBAFL/FtwcALq1XhDZvoHMEBcRlIRtKBIo3BQoELpTWwnEcacCIHqFVWMYHoQkBYRkSgjbgGx8cmKILFgSDgQr4pWgeevvM6CNnQQAAIfkECQkAJgAsAAAAAEAAQACFBAIEhIaEREJExMbEJCIkZGJktLK07OrsnJqcVFZUDA4MNDI0/Pr8jI6M5OLkdHZ0TEpMzM7MLCosvL689PL0XF5cFBYUBAYEjIqMzMrMJCYkZGZk7O7snJ6cXFpcFBIUNDY0/P78lJKUfHp8TE5MxMLEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv5Ak3BILBqPyKRyyWyaPo/BwTF4KJzYrBJyCHm/B4h2PIYwvugQQ0xuLxWcdJrzcduPI7l8dGcSAhkOBwMBBEcDemkDfUkAAWdpDBgARXGJXxSMRxcGlyEGlEMUnl6ZRgAFE1MTBRdaAaQhGESIpItFFrVoAxZYGpCeDBpDeaR8RAC6iq5NDbFeDUMflol0RQWeG04RzyERRGaXbEQlnhNOo8+mQwLUXxzjRO5yHE7zl+vSI1IHGSNXR9JV29btm5tyl841EdEtmpsN2Zz8isVAgh0AGRJlCNUEQ6xZdyxkTJOhFxZOngwwuwNgQ4kDB0ps4IgFAAZgXyTR1NRHQ/6ACDAjYDDEs6jRo0iTKl3KtKlTIQo8YMDgAeBTLQm6gElwNUuCRFyRgOiAAERXBVrlHLBKZEG6ilexXSpwBAGaDledXXJYpMPdqx4vgSyyABKDBVcreKJ7REKHDoivwqnGtmuSr3o8WHbiIW2IA2E3N1FQYGqFOqJTq17NurXr17Bj90kwgAGFAaHbKIAAoTIjhmlEuGnnhYOAopjl5MYy+Z1vNyPl3NJCQg4JTQBwomGws0n1NNcZARAYqTuT5sWft4muqI2AdBSOM1kwYoRZJcnTLM+yuzcTAH590YF5QwCHhnBOPSDHA0t4UBsDA2j2lANyOCCbEAAkQiBrFBqmYeGFJiiYBoMgAnjXhq6BUN99ILboYmxBAAAh+QQJCQAnACwAAAAAQABAAIUEAgSMiozExsRUUlQkIiSkpqTk5uQUEhQ0MjS0srT09vScmpx8enwMCgw8Ojzk4uRcWlwsKiysrqz08vQcHhy8urz8/vykoqQEBgSUkpTMzsxUVlQkJiSsqqzs6uwUFhQ0NjS0trT8+vycnpx8fnwMDgw8PjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAG/sCTcEgsGo/IpHLJbA4PINDBSa02ESGRxSIKIazg8Gmj3ZpFG7GaiVCY39zIen4MweEhuhNDoWCSB2V3WyJTekkOEm4WChIORw6DcI+HRgABkgEARSCSb5RHBAMDHGKYngFFB55mhkUEFW8VBFYmrFsmRXaeFUcUBnceFFUJtxZ5RAiCcCJyRrGDvXuLrAp/RBDLhGlGHKylTd7GFuDJFWUiFV9HG6zcTOLG5aogDq5HA+572oMi12IEvlEpdisBHWh3pDmxdSvXHAIegtGqcirToQ8SZE2scinTpkqiSK1JhC4BqEooMRDwg7Kly5cnMHyEqcfBCGAWDIw4SdNK/oMCkgo06GmlhAZWGu4RXdLBWIelQjYIEKFAwDshkcbxfFnRTAYiQMcVIApB0jucxgwQFSBJwJBxZobCBMCP0Ee4W+S+BECN2ceI4zysbTskrLGxPcsOepfV2FaXGe58BesU6gkIU0UIgGDEKFK9lpWUaDqoA+jQSxxceLDlwYXHqJlg+Be7tu3buHPr3s3bSYQsCkI4UwNixAIQLiNMeDNhOJg2hJzr2fUGWZgFb0agpHtHxEwrI7Jv72tXjDJC6ypRN2M9TIQLI9JXUs5cOtEBBToMaPJbRBf7PTHwBgO9HVHCMiKUUGARCNwh34IHvpHggkUIaAYJFBoxQAf6CWXo4YcghmhEEAA7YnVPZzU3UnNDZXVsS2VVYlhjelFTNkFCd2NQbHA4Umg0WUJramlqdElnNVhRWVphVGtSTmNwSno1Zm5mZ0ZOWA==);background-repeat:no-repeat;background-position:center center}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image.ng-image-slider-show{opacity:1;display:block}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image.ng-image-slider-hide{opacity:0;display:none}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image .custom-image-main{width:100%;height:100%}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image .custom-image-main img{transition:all .5s ease-in-out;width:auto;height:auto;max-height:100%;max-width:100%;position:absolute;z-index:11;margin:auto;inset:0}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image .custom-image-main iframe{inset:0;margin:auto;width:100%;height:100%;border:0}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .lightbox-image-main .lightbox-image .custom-image-main video{inset:0;margin:auto;width:100%;height:100%;border:0}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .caption{position:absolute;z-index:11;top:0;margin:auto;padding:5px;color:#fff;background-color:#00000059;max-width:100%;left:0;right:0}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .caption.show{display:block}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .caption.hide{display:none}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .next,.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .prev{position:absolute;right:10px;top:50%;background-color:#fff;border-radius:50%;cursor:pointer;margin-top:-16px;width:38px;height:38px;font-size:35px;z-index:12;line-height:30px;outline:0;color:#000;transition:all .3s ease-in-out}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .next:hover,.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .prev:hover{background-color:#d4cdcd}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .next.disable,.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .prev.disable{color:#bbb;background-color:#fff}.ng-image-fullscreen-view .lightbox-wrapper .lightbox-div .prev{left:10px}.ng-image-fullscreen-view .lightbox-wrapper .close{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAACXBIWXMAAA7EAAAOxAGVKw4bAAAQK0lEQVRYCQEgEN/vAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIyMjLuvr60L8/Pwz/Pz8HAQEBBYAAAAA/Pz86gQEBOQEBATPFRUVvt3d3dAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPT09DNPT02T4+Php/v7+FgQEBLwBAQHHCAgI4AQEBO4AAAAA/Pz8Evn5+SD+/v43/Pz8RAICAu4ICAiZKysrmsXFxfIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVFRVcBQUF5wkJCcEYGBhOZGRkBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY2NjBBgYGEwJCQm9BgYG6xQUFGAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMTExDgwMDK0FBQXhGBgYSgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGRkZRgYGBt8LCwuvLCwsDgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAuLi4WBwcH0QsLC7EzMzMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADU1NQ4LCwutBwcH0ygoKBgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMA4ICAjRDQ0NnWxsbAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABycnICDQ0NlwcHB9UqKioQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsLC7ELCwuvcHBwBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAd3d3AgwMDKkLCwu3d3d3AgAAAAAAAAAAAAAAAAAAAAAAFBQUYgYGBt01NTUOAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADk5OQwGBgbZFBQUagAAAAAAAAAAAAAAAAA3NzcQBgYG6xoaGkQAAAAAAAAAAAAAAAAAAAAACAgIkQMDA/sHBweZPz8/BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPz8/BAcHB5kDAwP7CAgIkwAAAAAAAAAAAAAAAAAAAAAaGho8BgYG7zIyMhQAAAAAAAAAAAAODg56CgoKuQAAAAAAAAAAAAAAAAAAAAAAAAAAAwMD+wAAAP8AAAD/BwcHoz8/PwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/Pz8EBwcHowAAAP8AAAD/AgIC/QAAAAAAAAAAAAAAAAAAAAAAAAAACQkJsQ4ODoEAAAAAAHNzcwIHBwfjHBwcRAAAAAAAAAAAAAAAAAAAAAAAAAAABwcHmwAAAP8AAAD/AAAA/wcHB6M/Pz8EAAAAAAAAAAAAAAAAAAAAAD8/PwQHBwejAAAA/wAAAP8AAAD/BwcHmwAAAAAAAAAAAAAAAAAAAAAAAAAAHh4ePgYGBudqamoEACAgIDwGBgblbW1tAgAAAAAAAAAAAAAAAAAAAAAAAAAAOjo6BAcHB6UAAAD/AAAA/wAAAP8HBwejPz8/BAAAAAAAAAAAPz8/BAcHB6MAAAD/AAAA/wAAAP8HBwelOjo6BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcHB98cHBxCAA4ODn4LCwudAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADo6OgQHBwelAAAA/wAAAP8AAAD/BwcHoz8/PwQ/Pz8EBwcHowAAAP8AAAD/AAAA/wcHB6U6OjoEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDJcNDQ2FAAoKCrESEhJoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6OjoEBwcHpQAAAP8AAAD/AAAA/wcHB6MHBwejAAAA/wAAAP8AAAD/BwcHpTo6OgQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABISEmIICAi1AAkJCdUZGRlEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOjo6BAcHB6UAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8HBwelOjo6BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0dHT4JCQnbAAUFBeElJSUyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADo6OgQHBwelAAAA/wAAAP8AAAD/AAAA/wcHB6U6OjoEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA4ODiQCAgLjAv///wD+/v7+AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAUFBQAAAAD+AAAAAAAAAAAAAAAAAAAAAAAAAP4FBQUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP7+/v4AAAACAAoKCtkcHBxAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPz8/BAcHB6MAAAD/AAAA/wAAAP8AAAD/AAAA/wAAAP8HBwejPz8/BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACMjIzwJCQnfAAgICLcTExNgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/Pz8EBwcHowAAAP8AAAD/AAAA/wcHB6UHBwelAAAA/wAAAP8AAAD/BwcHoz8/PwQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAQEFgHBwe7AA0NDYkMDAyTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD8/PwQHBwejAAAA/wAAAP8AAAD/BwcHpTo6OgQ6OjoEBwcHpQAAAP8AAAD/AAAA/wcHB6M/Pz8EAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDI0NDQ2PABcXF0YICAjZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPz8/BAcHB6MAAAD/AAAA/wAAAP8HBwelOjo6BAAAAAAAAAAAOjo6BAcHB6UAAAD/AAAA/wAAAP8HBwejPz8/BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgICNMVFRVOAFtbWwYFBQXtIiIiMgAAAAAAAAAAAAAAAAAAAAAAAAAABwcHmQAAAP8AAAD/AAAA/wcHB6U6OjoEAAAAAAAAAAAAAAAAAAAAADo6OgQHBwelAAAA/wAAAP8AAAD/BwcHmwAAAAAAAAAAAAAAAAAAAAAAAAAAJSUlLAYGBvFLS0sIAAAAAAAMDAyPCwsLowAAAAAAAAAAAAAAAAAAAAAAAAAAAwMD+wAAAP8AAAD/BwcHpTo6OgQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA6OjoEBwcHpQAAAP8AAAD/AgIC/QAAAAAAAAAAAAAAAAAAAAAAAAAADAwMnQwMDJUAAAAAAAAAAAAnJyccBQUF8x8fHy4AAAAAAAAAAAAAAAAAAAAACAgIkwICAv0HBwebOjo6BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOjo6BAcHB5sCAgL9CAgIlQAAAAAAAAAAAAAAAAAAAAAhISEoBQUF9SgoKCAAAAAAAAAAAAAAAAAAEBAQfggICMlaWloEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAGpqagQJCQnDDw8PhQAAAAAAAAAAAAAAAAAAAAAASkpKBggICMsPDw+PAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA8PD4cICAjPPz8/CAAAAAAAAAAAAAAAAAAAAAAAAAAAACIiIh4GBgbnEBAQcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAExMTbgYGBukhISEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAaGhooBgYG5xAQEItoaGgEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHBwcAQPDw+FBQUF6RkZGSwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIyMjIAgICM8JCQnDICAgJgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIyMjJAkJCb8HBwfRISEhIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEFBQQgODg6HBQUF9QwMDJcmJiYmAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACYmJiIMDAyTBQUF9Q4ODo1BQUEKAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIiIiJOnp6Xf7+/taAgIC1AUFBbgLCwvLDg4O3DExMfYAAAD+0NDQDPLy8iT09PQy+/v7R/7+/jAFBQWoGBgYid3d3doAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA3NzcM3t7eTvX19UH///8y/f39HgICAhQAAAAA/v7+7gMDA+ABAQHQCgoKvScnJ7TFxcXyAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAx6aIH59j4jkAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:center center;background-size:32px;position:absolute;top:10px;right:10px;color:#000;background-color:#fff;padding:0;opacity:1;border-radius:50%;height:36px;width:36px;z-index:12;cursor:pointer;transition:all .2s ease}.ng-image-fullscreen-view .lightbox-wrapper.error-msg{background-image:none}.ng-image-fullscreen-view .invalid-msg{color:#fff;font-size:18px;position:absolute;top:45%;left:45%}.ng-image-fullscreen-view .popup-pagination{background-color:#1f1f1f;color:#fff;position:absolute;height:30px;width:100%;text-align:center;bottom:0;font-size:16px;line-height:30px}@media (max-width: 768px){.ng-image-fullscreen-view .lightbox-wrapper{width:100%;height:100%}.ng-image-fullscreen-view .lightbox-wrapper.error-msg{background-image:none}}\n"],encapsulation:2}),e})(),m3=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({providers:[zw],imports:[lI]}),e})();function g3(e,n){if(1&e&&(ke(0,"div",41),Dt(1,"img",42),bt(2),ke(3,"span",43),bt(4,"C"),Ne(),ke(5,"div",44)(6,"div"),Dt(7,"i",45),bt(8),ke(9,"span",46),bt(10,"C"),Ne()(),ke(11,"div"),Dt(12,"i",47),bt(13),ke(14,"span",46),bt(15,"%"),Ne()(),ke(16,"div"),Dt(17,"i",48),bt(18),ke(19,"span",46),bt(20,"m/s"),Ne()(),ke(21,"div"),Dt(22,"i",49),bt(23),ke(24,"span",46),bt(25,"mmHg"),Ne()()(),ke(26,"div",50),bt(27),Ne()()),2&e){const t=n.$implicit;ct(1),ru("src",t.icon,wa),ct(1),Yr(" ",t.temperature,"\xb0"),ct(6),Yr(": ",t.feelsLike,"\xb0"),ct(5),Yr(": ",t.humidity,""),ct(5),Yr(": ",t.wind,""),ct(5),Yr(" ",t.pressure,""),ct(4),ou(t.date)}}function _3(e,n){if(1&e&&(ke(0,"div",51)(1,"div",52),Dt(2,"img",42),bt(3),ke(4,"span",43),bt(5,"C"),Ne()(),ke(6,"div",53)(7,"div",54),bt(8),Ne(),ke(9,"div",55),Dt(10,"i",45),bt(11),ke(12,"span",46),bt(13,"C"),Ne()(),ke(14,"div",55),Dt(15,"i",47),bt(16),ke(17,"span",46),bt(18,"%"),Ne()(),ke(19,"div",55),Dt(20,"i",48),bt(21),ke(22,"span",46),bt(23,"m/s"),Ne()(),ke(24,"div",56),Dt(25,"i",49),bt(26),ke(27,"span",46),bt(28,"mmHg"),Ne()()()()),2&e){const t=n.$implicit;ct(2),ru("src",t.icon,wa),ct(1),Yr(" ",t.temperature,"\xb0"),ct(5),ou(t.date),ct(3),Yr(": ",t.feelsLike,"\xb0"),ct(5),Yr(": ",t.humidity,""),ct(5),Yr(": ",t.wind,""),ct(5),Yr(" ",t.pressure,"")}}const Vw=function(e,n){return{"fav-active":e,"filled-star":n}},y3=function(){return{width:"33%",height:300}},v3=function(){return{width:"50%",height:300}},A3=function(){return{width:"100%",height:300}},x3=[{path:"",redirectTo:"capitals",pathMatch:"full"},{path:"capitals",component:_w},{path:"capitals/:id",component:(()=>{class e{constructor(t,r,l){this.activatedRoute=t,this.helper=r,this.weatherService=l,this.imageObject=[{image:"https://mobilnist.kpi.ua/wp-content/uploads/2021/08/Kyiv-2.png",thumbImage:"https://mobilnist.kpi.ua/wp-content/uploads/2021/08/Kyiv-2.png"},{image:"https://content.r9cdn.net/rimg/dimg/27/bb/1e63bfbb-city-15139-1645cdf896a.jpg?width=1366&height=768&xhint=2663&yhint=911&crop=true",thumbImage:"https://content.r9cdn.net/rimg/dimg/27/bb/1e63bfbb-city-15139-1645cdf896a.jpg?width=1366&height=768&xhint=2663&yhint=911&crop=true"},{image:"https://thumbs.dreamstime.com/b/evening-aerial-scenery-kyiv-ukraine-scenic-summer-view-dnieper-river-pier-port-55234256.jpg",thumbImage:"https://thumbs.dreamstime.com/b/evening-aerial-scenery-kyiv-ukraine-scenic-summer-view-dnieper-river-pier-port-55234256.jpg"},{image:"https://emerging-europe.com/wp-content/uploads/2022/02/bigstock-kyiv-ukraine-nov-441124805.jpeg",thumbImage:"https://emerging-europe.com/wp-content/uploads/2022/02/bigstock-kyiv-ukraine-nov-441124805.jpeg"},{image:"https://cloudfront-us-east-1.images.arcpublishing.com/bostonglobe/XE6DBP72PVDO2I5ZGH2KJ3FMM4.jpg",thumbImage:"https://cloudfront-us-east-1.images.arcpublishing.com/bostonglobe/XE6DBP72PVDO2I5ZGH2KJ3FMM4.jpg"}],this.capitalId=-1,this.capitalsTemp=[],this.imgURL=""}ngOnInit(){this.capitalsFromLocalStorage=localStorage.getItem("capitals"),this.capitalsTemp=this.capitalsFromLocalStorage?JSON.parse(this.capitalsFromLocalStorage):[...this.helper.capitals];const t=this.activatedRoute.snapshot.paramMap.get("id");if(t){const r=Number(t);isNaN(r)||(this.capitalId=r)}this.capital=this.getCapitalById(this.capitalId),this.helper.capitalIdSubject.next(this.capitalId),this.getGeoPipe(),this.imageObject=this.transformToImageObject(this.capital.images)}addImg(){if(""!==this.imgURL.trim()){if(this.capital.images.length<4&&this.capital.images.includes("https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png")){const r=this.capital.images.indexOf("https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png");this.capital.images[r]=this.imgURL}else this.capital.images.push(this.imgURL);for(;this.capital.images.length<3;)this.capital.images.push("https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png");this.imageObject=this.transformToImageObject(this.capital.images);const t=this.capitalsTemp.find(r=>r.id===this.capitalId);t&&(t.images=this.capital.images),localStorage.setItem("capitals",JSON.stringify(this.capitalsTemp)),this.imgURL=""}}deleteImg(){if(this.capital.images.length>0){let t=-1;for(let l=this.capital.images.length-1;l>=0;l--)if("https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png"!==this.capital.images[l]){t=l;break}this.capital.images.length<4&&(this.capital.images[t]="https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png"),-1!==t&&"https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png"!=this.capital.images[t]&&this.capital.images.splice(t,1),this.imageObject=this.transformToImageObject(this.capital.images);const r=this.capitalsTemp.find(l=>l.id===this.capitalId);r&&(r.images=this.capital.images),localStorage.setItem("capitals",JSON.stringify(this.capitalsTemp))}}transformToImageObject(t){return t.map(r=>({image:r,thumbImage:r}))}getCapitalById(t){for(let r=0;r<this.capitalsTemp.length;r++)if(this.capitalsTemp[r].id==t)return this.capitalsTemp[r];return console.log(this.capitalsTemp[5].id),this.capitalsTemp[0]}replaceData(){const t=this.capitalsTemp.findIndex(r=>r.id===this.capitalId);-1!==t&&(this.capitalsTemp[t]=this.capital),localStorage.setItem("capitals",JSON.stringify(this.capitalsTemp))}getGeo(){return this.weatherService.getGeo(this.capital.capital).pipe(kr(t=>{this.geos=t}))}getGeoPipe(){this.getGeo().pipe(ml(()=>this.weatherService.getWeatherForecast(this.capital.capital))).subscribe(t=>{this.days=t.map((r,l)=>({id:l,date:new Date(r.date).toLocaleDateString("en-GB",{month:"long",day:"numeric"}),temperature:Math.round(10*r.temperature)/10,humidity:r.humidity,weather:r.description,wind:Math.round(10*r.wind)/10,feelsLike:Math.round(10*r.feelsLike)/10,pressure:r.pressure,icon:r.icon})),this.getMap()})}getMap(){hM.accessToken="pk.eyJ1IjoiYXVndXNoYSIsImEiOiJjbGk2YWF6NG8wZDJyM2tsdWRjZmJ2M2U1In0.sPx40hp41fPkrVb0q9Esaw",new hM.Map({container:"map",style:"mapbox://styles/mapbox/streets-v12",center:[this.geos.lon,this.geos.lat],zoom:9})}getGoogleMapsLink(){return`https://www.google.com/maps?q=${encodeURIComponent(this.capital.capital)}`}onclickFavourite(){this.capitalsTemp[this.capitalId].favourite=!this.capitalsTemp[this.capitalId].favourite,this.capital.favourite=this.capitalsTemp[this.capitalId].favourite}onclickVisited(){this.capitalsTemp[this.capitalId].visited=!this.capitalsTemp[this.capitalId].visited,this.capital.visited=this.capitalsTemp[this.capitalId].visited}onclickPlanned(){this.capitalsTemp[this.capitalId].planned=!this.capitalsTemp[this.capitalId].planned,this.capital.planned=this.capitalsTemp[this.capitalId].planned}ngOnDestroy(){this.replaceData()}unloadHandler(){this.replaceData()}}return e.\u0275fac=function(t){return new(t||e)(qe(Nh),qe(j_),qe(VA))},e.\u0275cmp=vr({type:e,selectors:[["app-capital-page"]],hostBindings:function(t,r){1&t&&ft("beforeunload",function(u){return r.unloadHandler(u)},0,Ld)},decls:56,vars:41,consts:[[1,"container","main-container"],[1,"container","my-5","content","p-0"],[1,"row","info","px-2","py-0"],[1,"col-sm-12","title","position-relative","m-0","px-4","py-3"],[1,"capital"],[1,"country"],[1,"row","flex-row-reverse","row-buttons"],[1,"favourite",3,"ngClass","click"],[1,"icon"],[1,"bi",3,"ngClass"],[1,"planned",3,"ngClass","click"],[1,"visited",3,"ngClass","click"],[1,"row","add-image","add-image-small"],[1,"col-auto","add-image-text-container"],["placeholder","Image URL",1,"input-url","form-control",3,"ngModel","keyup.enter","ngModelChange"],[1,"col-auto","icon","add","add-small",3,"click"],[1,"bi","bi-plus"],[1,"col-auto","icon","delete","delete-small",3,"click"],[1,"bi","bi-x"],[1,"row","px-2","py-0","info-middle"],[1,"col-sm-12","flex-row-reverse","row","add-image","add-image-big"],[1,"col-2","icon","delete",3,"click"],[1,"col-2","icon","add",3,"click"],[1,"col-8","add-image-text-container","add-image-text-container-big"],["placeholder","Add image by URL",1,"form-control","input-url","input-url-big",3,"ngModel","keyup.enter","ngModelChange"],[1,"col-sm-12","mx-auto","py-3","px-4","image-slider","slider-big"],["slideImage","1",3,"images","imagePopup","infinite","autoSlide","imageSize"],["nav",""],[1,"col-sm-12","mx-auto","py-3","px-4","image-slider","slider-mid"],[1,"col-sm-12","mx-auto","py-3","px-4","image-slider","slider-small"],[1,"col-sm-12","col-lg-4","description","px-4","py-4"],[1,"text-description","mt-2"],[1,"col-sm-12","col-lg-8","m-0","p-0","cards-container"],[1,"row","p-0","m-0","cards-vertical"],["class","column card-weather",4,"ngFor","ngForOf"],[1,"row","p-0","m-0","cards-horizontal"],["class","card-weather row p-0 m-0",4,"ngFor","ngForOf"],[1,"row","px-2","py-0"],[1,"container","map-container"],["id","map",1,"map-window"],["target","\u201d_blank\u201d",1,"button","map-button",3,"href"],[1,"column","card-weather"],[1,"weather-icon",3,"src"],[1,"text-celsius"],[1,"details","my-4","py-4"],[1,"bi","bi-thermometer-half"],[1,"text-small"],[1,"bi","bi-moisture"],[1,"bi","bi-wind"],[1,"bi","bi-speedometer"],[1,"time","pb-4"],[1,"card-weather","row","p-0","m-0"],[1,"col-4","px-0"],[1,"col-8","row","details","my-0","py-0"],[1,"col-12","time","my-2"],[1,"col-12","px-3"],[1,"col-12","px-3","pb-1"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h1",4),bt(5),Ne(),ke(6,"h2",5),bt(7),Ne(),ke(8,"div",6)(9,"button",7),ft("click",function(){return r.onclickFavourite()}),ke(10,"div",8),Dt(11,"i",9),Ne()(),ke(12,"button",10),ft("click",function(){return r.onclickPlanned()}),ke(13,"div",8),Dt(14,"i",9),Ne()(),ke(15,"button",11),ft("click",function(){return r.onclickVisited()}),ke(16,"div",8),Dt(17,"i",9),Ne()()(),ke(18,"div",12)(19,"div",13)(20,"input",14),ft("keyup.enter",function(){return r.addImg()})("ngModelChange",function(u){return r.imgURL=u}),Ne()(),ke(21,"div",15),ft("click",function(){return r.addImg()}),Dt(22,"i",16),Ne(),ke(23,"div",17),ft("click",function(){return r.deleteImg()}),Dt(24,"i",18),Ne()()()(),ke(25,"div",19)(26,"div",20)(27,"div",21),ft("click",function(){return r.deleteImg()}),Dt(28,"i",18),Ne(),ke(29,"div",22),ft("click",function(){return r.addImg()}),Dt(30,"i",16),Ne(),ke(31,"div",23)(32,"input",24),ft("keyup.enter",function(){return r.addImg()})("ngModelChange",function(u){return r.imgURL=u}),Ne()()(),ke(33,"div",25),Dt(34,"ng-image-slider",26,27),Ne(),ke(36,"div",28),Dt(37,"ng-image-slider",26,27),Ne(),ke(39,"div",29),Dt(40,"ng-image-slider",26,27),Ne(),ke(42,"div",30)(43,"p",31),bt(44),Ne()(),ke(45,"div",32)(46,"div",33),At(47,g3,28,7,"div",34),Ne()(),ke(48,"div",32)(49,"div",35),At(50,_3,29,7,"div",36),Ne()()(),ke(51,"div",37)(52,"div",38),Dt(53,"div",39),ke(54,"a",40),bt(55,"Open with Google Maps"),Ne()()()()()),2&t&&(ct(5),ou(r.capital.capital),ct(2),Yr("",r.capital.country," "),ct(2),ot("ngClass",su(29,Vw,r.capital.favourite,r.capital.favourite)),ct(2),ot("ngClass",r.capital.favourite?"bi-star-fill":"bi-star"),ct(1),ot("ngClass",su(32,Vw,r.capital.planned,r.capital.planned)),ct(2),ot("ngClass",r.capital.planned?"bi-calendar-check":"bi-calendar"),ct(1),ot("ngClass",su(35,Vw,r.capital.visited,r.capital.visited)),ct(2),ot("ngClass",r.capital.visited?"bi-eye-fill":"bi-eye"),ct(3),ot("ngModel",r.imgURL),ct(12),ot("ngModel",r.imgURL),ct(2),ot("images",r.imageObject)("imagePopup",!1)("infinite",!1)("autoSlide",!1)("imageSize",zv(38,y3)),ct(3),ot("images",r.imageObject)("imagePopup",!1)("infinite",!1)("autoSlide",!1)("imageSize",zv(39,v3)),ct(3),ot("images",r.imageObject)("imagePopup",!1)("infinite",!1)("autoSlide",!1)("imageSize",zv(40,A3)),ct(4),Yr(" ",r.capital.description," "),ct(3),ot("ngForOf",r.days),ct(3),ot("ngForOf",r.days),ct(4),ot("href",r.getGoogleMapsLink(),wa))},dependencies:[np,A_,cp,H_,am,f3],styles:[".main-container[_ngcontent-%COMP%]{margin-top:0!important;padding-top:150px;padding-right:0;padding-left:0;width:98%!important}.content[_ngcontent-%COMP%]{margin:0!important;width:100%!important;overflow:hidden;box-shadow:#63636333 0 -1px 5px;border-radius:1rem;background-color:#fff9;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:rgb(255,255,255) 3px solid}.capital[_ngcontent-%COMP%]{font-size:2.2rem}.description[_ngcontent-%COMP%]{border-top:white 3px solid;background:rgba(255,255,255,.5);overflow-y:scroll}.column[_ngcontent-%COMP%]{padding:10px 10px 0;width:20%}.cards[_ngcontent-%COMP%]{background-size:cover;background:linear-gradient(to left,rgba(255,255,255,0) 75%,rgba(255,255,255,.6));height:auto}.cards-container[_ngcontent-%COMP%]{background:rgba(255,255,255,.5)!important}.card-weather[_ngcontent-%COMP%]{margin:0;font-size:2rem;text-align:center;font-weight:400;border-left:rgb(255,255,255) 3px solid;border-top:white 3px solid;padding:0}.text-celsius[_ngcontent-%COMP%]{font-size:1.6rem}.weather[_ngcontent-%COMP%]{font-size:1.5rem}.weather-icon[_ngcontent-%COMP%]{width:120px;height:120px;filter:drop-shadow(0px 1px 6px #a9a9a9)}.details[_ngcontent-%COMP%]{font-size:1.2rem;border-bottom:rgba(255,255,255,.2) 3px solid;border-top:rgba(255,255,255,.2) 3px solid}.text-small[_ngcontent-%COMP%]{font-size:.9rem}.time[_ngcontent-%COMP%]{text-align:center;font-size:1.4rem}.info[_ngcontent-%COMP%]{padding:15px 15px 15px 30px;z-index:3;color:#333;height:125px}.info-middle[_ngcontent-%COMP%]{border-bottom:3px white solid}.title[_ngcontent-%COMP%]{border-bottom:3px white solid;background-color:#ffffff80}.country[_ngcontent-%COMP%]{font-size:1.5rem}button[_ngcontent-%COMP%]{border:none;background:transparent!important}.row-buttons[_ngcontent-%COMP%]{overflow:hidden;position:absolute;top:-1px;right:12px;z-index:4;background-color:#fffc;border-bottom-left-radius:.5rem;border-left:3px white solid;border-bottom:3px white solid}.add-image[_ngcontent-%COMP%]{text-align:center;background-color:#fffc;padding:5px 8px 5px 5px}.add-image-small[_ngcontent-%COMP%]{position:absolute;bottom:0;right:12px;border-right:3px white solid;border-top:3px white solid;border-top-left-radius:.5rem}.add-image-big[_ngcontent-%COMP%]{margin:0;width:100%;border-bottom:3px white solid;padding-right:12px}.add[_ngcontent-%COMP%]{background-color:#1e90ff;padding:0;height:42px}.add[_ngcontent-%COMP%]:hover{background-color:#83b8fa;transition:.2s}.delete[_ngcontent-%COMP%]{border-top-right-radius:.5rem;border-bottom-right-radius:.5rem;background-color:#de5050;padding:0;height:42px}.delete[_ngcontent-%COMP%]:hover{background-color:#fc8d8d;transition:.2s}.delete[_ngcontent-%COMP%], .add[_ngcontent-%COMP%]{cursor:pointer}.bi-plus[_ngcontent-%COMP%]{max-height:32px!important;position:relative}.bi-plus[_ngcontent-%COMP%]:before{position:absolute;top:6px;right:-15px}.bi-x[_ngcontent-%COMP%]{max-height:32px!important;position:relative}.bi-x[_ngcontent-%COMP%]:before{position:absolute;top:6px;right:-15px}.input-url[_ngcontent-%COMP%]{width:150px;height:100%;background-color:#eee;border:none;border-top-left-radius:.5rem;border-bottom-left-radius:.5rem;padding:7px 12px}.input-url-big[_ngcontent-%COMP%]{width:100%}.add-small[_ngcontent-%COMP%], .delete-small[_ngcontent-%COMP%]{width:42px}.add-icon[_ngcontent-%COMP%]{width:100%}.add-image-text-container[_ngcontent-%COMP%]{padding-left:6px;padding-right:0;height:42px}.add-image-text[_ngcontent-%COMP%]{margin:0}.favourite[_ngcontent-%COMP%], .visited[_ngcontent-%COMP%], .planned[_ngcontent-%COMP%]{height:48px;width:48px;padding:0;background:transparent}.favourite[_ngcontent-%COMP%]{margin-right:5px}.bi-calendar-check[_ngcontent-%COMP%], .bi-calendar[_ngcontent-%COMP%]:hover{color:#23c26b}.bi-eye-fill[_ngcontent-%COMP%], .bi-eye[_ngcontent-%COMP%]:hover{color:#1e90ff}.bi-star-fill[_ngcontent-%COMP%], .bi-star[_ngcontent-%COMP%]:hover{color:#fdda18}.icon[_ngcontent-%COMP%]{font-size:2rem;text-align:center}.icon[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{transition:color .1s}.bi-star[_ngcontent-%COMP%]{color:#333;margin-top:0;padding-top:0}.text-description[_ngcontent-%COMP%]{font-size:1.1rem;text-align:start;text-indent:25px}.text-description-title[_ngcontent-%COMP%]{font-size:1.3rem}.info-bottom[_ngcontent-%COMP%]{border-top:3px white solid}.map-container[_ngcontent-%COMP%]{padding:5px 10px;height:300px;position:relative}.map-window[_ngcontent-%COMP%]{height:100%;width:100%;background:#cce7cf;border-radius:10px;overflow:hidden}.map-button[_ngcontent-%COMP%]{position:absolute;right:15px;top:10px;padding:5px 10px;border-radius:5px;background:rgba(255,255,255,.5)!important;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);border:2px white solid;text-decoration:none;color:#333}.custom-slider[_ngcontent-%COMP%]   .nav-btn[_ngcontent-%COMP%]{background-color:red;color:#fff;font-size:24px}.custom-slider[_ngcontent-%COMP%]   .nav-btn[_ngcontent-%COMP%]:hover{background-color:#8b0000}@media (max-width: 992px){.slider-big[_ngcontent-%COMP%]{display:none}.content[_ngcontent-%COMP%]{max-height:100%}}@media (min-width: 992px){.slider-mid[_ngcontent-%COMP%]{display:none}.description[_ngcontent-%COMP%]{max-height:445px;overflow-y:auto}}@media (max-width: 768px){.content[_ngcontent-%COMP%]{max-width:570px}.card-weather[_ngcontent-%COMP%]{width:20%!important}.ng-image-slider[_ngcontent-%COMP%]   .ng-image-slider-wrapper[_ngcontent-%COMP%]   .ng-image-slider-content[_ngcontent-%COMP%]   .ng-image-slider-content-wrapper[_ngcontent-%COMP%]{width:50%}.weather-icon[_ngcontent-%COMP%]{width:80px;height:80px}.slider-mid[_ngcontent-%COMP%]{display:none}}@media (min-width: 768px){.slider-small[_ngcontent-%COMP%]{display:none}}@media (min-width: 576px){.cards-horizontal[_ngcontent-%COMP%], .add-image-big[_ngcontent-%COMP%]{display:none}}@media (max-width: 576px){.content[_ngcontent-%COMP%]{width:95%}.cards-vertical[_ngcontent-%COMP%], .add-image-small[_ngcontent-%COMP%]{display:none!important}.card-weather[_ngcontent-%COMP%]{width:100%!important;display:flex}.details[_ngcontent-%COMP%]{border:none;text-align:right;margin:0;padding:0;border-left:rgba(255,255,255,.4) 3px solid}.time[_ngcontent-%COMP%]{border-bottom:rgba(255,255,255,.4) 3px solid;margin:0 auto}.weather-icon[_ngcontent-%COMP%]{width:100px;height:100px}}"]}),e})()}];let b3=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[XT.forRoot(x3,{useHash:!0}),XT]}),e})(),w3=(()=>{class e{constructor(t){this.helper=t,this.isOpen=!1,this.enteredSearchValue=""}toggleMenu(){setTimeout(()=>{this.isOpen=!this.isOpen},100)}onSearchTextChanged(){this.helper.searchValueSubject.next(this.enteredSearchValue)}scrollTo(t){document.getElementById(t).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}}return e.\u0275fac=function(t){return new(t||e)(qe(j_))},e.\u0275cmp=vr({type:e,selectors:[["app-dropdown"]],decls:20,vars:5,consts:[[1,"menu-container"],[1,"menu-toggler",3,"click"],[1,"bi","bi-list"],[1,"background",3,"click"],[1,"menu"],[1,"menu-item"],[1,"form-inline","mx-2"],[1,"input-group"],["type","search","placeholder","Search","name","something",1,"form-control","s-field",3,"ngModel","ngModelChange","keyup","emptied"],["type","submit",1,"btn","bg-success",2,"color","#f0f4ff",3,"click"],[1,"menu-item",3,"click"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"div",1),ft("click",function(){return r.toggleMenu()}),Dt(2,"i",2),Ne(),ke(3,"div",3),ft("click",function(){return r.toggleMenu()}),Ne(),ke(4,"div",4)(5,"div",5)(6,"form",6)(7,"div",7)(8,"input",8),ft("ngModelChange",function(u){return r.enteredSearchValue=u})("keyup",function(){return r.onSearchTextChanged()})("emptied",function(){return r.onSearchTextChanged()}),Ne(),ke(9,"button",9),ft("click",function(){return r.onSearchTextChanged()}),bt(10,"Search"),Ne()()()(),ke(11,"div",10),ft("click",function(){return r.scrollTo("home")}),ke(12,"a"),bt(13,"Home"),Ne()(),ke(14,"div",10),ft("click",function(){return r.scrollTo("capitals")}),ke(15,"a"),bt(16,"Capitals"),Ne()(),ke(17,"div",10),ft("click",function(){return r.scrollTo("about")}),ke(18,"a"),bt(19,"About"),Ne()()()()),2&t&&(ct(3),zf("open",r.isOpen),ct(1),zf("open",r.isOpen),ct(4),ot("ngModel",r.enteredSearchValue))},dependencies:[Pw,cp,H_,xw,am,Z_],styles:[".menu-container[_ngcontent-%COMP%]{position:relative}.background[_ngcontent-%COMP%]{position:fixed;top:85px;left:0;right:0;width:100vw!important;height:0;background-color:#0000;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:20}.menu-toggler[_ngcontent-%COMP%]{margin:0;padding:0 8px;background:white;border-radius:2rem;cursor:pointer;z-index:100}.bi-list[_ngcontent-%COMP%]{margin:0 auto;text-align:center;font-size:2rem;font-weight:1200}.menu[_ngcontent-%COMP%]{width:200px;margin:0;top:80px;right:0;background:rgba(255,255,255,.8);border:3px white solid;border-radius:15px;position:absolute;z-index:-1;transition:transform .1s ease;transform:scale(var(--ggs, 0));box-shadow:#32325d40 0 50px 100px -20px,#0000004d 0 30px 60px -30px;z-index:100}.menu.open[_ngcontent-%COMP%]{transform:scale(1)}.background.open[_ngcontent-%COMP%]{transform:scale(1);height:100vh}.menu-item[_ngcontent-%COMP%]{padding:10px 0;color:#323232;text-align:center;border-bottom:3px white solid;width:100%}.menu-item[_ngcontent-%COMP%]:last-child{border:none}.s-field[_ngcontent-%COMP%]{border:none}.input-group[_ngcontent-%COMP%]{border-radius:2rem}"]}),e})();function E3(e,n){if(1&e){const t=Gt();ke(0,"form",11)(1,"div",12)(2,"input",13),ft("ngModelChange",function(l){return Tn(t),_n(Ft().enteredSearchValue=l)})("keyup",function(){return Tn(t),_n(Ft().onSearchTextChanged())})("emptied",function(){return Tn(t),_n(Ft().onSearchTextChanged())}),Ne(),ke(3,"button",14),ft("click",function(){return Tn(t),_n(Ft().onSearchTextChanged())}),bt(4,"Search"),Ne()()()}if(2&e){const t=Ft();ct(2),ot("ngModel",t.enteredSearchValue)}}let Uw,C3=(()=>{class e{constructor(t,r){this.route=t,this.helper=r,this.enteredSearchValue="",this.capitalId=-1,this.searchTextChanged=new ri}ngOnInit(){this.helper.capitalIdSubject.subscribe(t=>{this.capitalId=t})}onSearchTextChanged(){this.helper.searchValueSubject.next(this.enteredSearchValue)}scrollTo(t){document.getElementById(t).scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"})}}return e.\u0275fac=function(t){return new(t||e)(qe(Nh),qe(j_))},e.\u0275cmp=vr({type:e,selectors:[["app-header"]],outputs:{searchTextChanged:"searchTextChanged"},decls:19,vars:1,consts:[[1,"navbar","navbar-expand-lg","mx-0"],[1,"container"],["href","#",1,"navbar-brand","px-3"],["id","navbarSupportedContent",1,"collapse","navbar-collapse"],[1,"navbar-nav","ms-auto"],[1,"nav-item","active"],["class","form-inline",4,"ngIf"],[1,"nav-item","active","px-2"],[1,"nav-link","current",3,"click"],[1,"nav-item","px-2"],[1,"nav-link",3,"click"],[1,"form-inline"],[1,"input-group"],["type","search","placeholder","Search here","name","something",1,"form-control","s-field",3,"ngModel","ngModelChange","keyup","emptied"],["type","submit",1,"btn","bg-success",2,"color","#f0f4ff",3,"click"]],template:function(t,r){1&t&&(ke(0,"header")(1,"nav",0)(2,"div",1)(3,"a",2),bt(4,"European capitals"),Ne(),Dt(5,"app-dropdown"),ke(6,"div",3)(7,"ul",4)(8,"li",5),At(9,E3,5,1,"form",6),Ne(),ke(10,"li",7)(11,"a",8),ft("click",function(){return r.scrollTo("home")}),bt(12,"Home"),Ne()(),ke(13,"li",9)(14,"a",10),ft("click",function(){return r.scrollTo("capitals")}),bt(15,"Capitals"),Ne()(),ke(16,"li",9)(17,"a",10),ft("click",function(){return r.scrollTo("about")}),bt(18,"About"),Ne()()()()()()()),2&t&&(ct(9),ot("ngIf",-1==r.capitalId))},dependencies:[ip,Pw,cp,H_,xw,am,Z_,w3],styles:["header[_ngcontent-%COMP%]{font-weight:500}.navbar[_ngcontent-%COMP%]{width:100%;height:85px;background-color:#ffffff80;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px);box-shadow:#63636333 0 1px 5px;z-index:9999;position:fixed;top:0;border-bottom:rgb(255,255,255) 3px solid}.menu[_ngcontent-%COMP%]{border-radius:2rem;border:none;padding:8px 10px}.navbar-brand[_ngcontent-%COMP%]{color:#24292e;font-size:2rem;font-weight:bolder;background:rgba(255,255,255,.9);border-radius:2rem;transition:.3s}.navbar-brand[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.5)}.nav-item[_ngcontent-%COMP%]{margin-left:15px;border-radius:2em;transition:.3s;background:rgba(255,255,255,.8);overflow:hidden;cursor:pointer}.nav-item[_ngcontent-%COMP%]:hover{background:rgba(255,255,255,.5)}.s-field[_ngcontent-%COMP%]{background:rgba(255,255,255,.9);border:none;height:100%;padding-top:10px;padding-bottom:10px}.s-field[_ngcontent-%COMP%]:focus{box-shadow:none;background:rgba(255,255,255,.6);outline:0}.bg-success[_ngcontent-%COMP%]:hover{background:#207044!important}[_ngcontent-%COMP%]::placeholder{color:#80818f}.nav-link[_ngcontent-%COMP%]{color:#24292e}@media (max-width: 576px){.navbar-brand[_ngcontent-%COMP%]{font-size:1.5rem;margin-right:0}.navbar[_ngcontent-%COMP%]{margin-left:5px}}@media (min-width: 992px){app-dropdown[_ngcontent-%COMP%]{display:none}}"]}),e})(),I3=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vr({type:e,selectors:[["app-about"]],decls:5,vars:0,consts:[["id","about",1,"container"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"h1"),bt(2,"About Us:"),Ne(),ke(3,"h2"),bt(4," At \"European Capitals\", we are dedicated to helping you plan the perfect European weekend getaway. Our platform provides detailed weather and temperature information for various European capitals, allowing you to make informed decisions about your destination. Whether you're seeking a cultural adventure, culinary delights, or simply a relaxing escape, we're here to assist you in curating a memorable experience. Explore our site, discover your ideal European capital, and embark on a weekend getaway like never before."),Ne()())},styles:[".container[_ngcontent-%COMP%]{text-align:center;margin-bottom:50px;margin-top:25px;color:#323232;overflow:hidden;width:98%;background-color:#ffffffb3;border-radius:1rem;border:rgb(255,255,255) 3px solid;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);box-shadow:#63636333 0 1px 5px;padding-top:25px;padding-bottom:25px}h2[_ngcontent-%COMP%]{font-size:1.1rem;width:90%;margin:0 auto;line-height:1.5em}@media (max-width: 576px){h2[_ngcontent-%COMP%]{font-size:1rem;width:100%}}"]}),e})(),T3=(()=>{class e{constructor(){this.title="my-app",this.images=["https://s1.it.atcdn.net/wp-content/uploads/2019/12/Vilnius-hero.jpg","https://d10mzz35brm2m8.cloudfront.net//sitecore/media%20library/PriorityPass/Images/february-2023-content-5-1c15b085-7298-4e73-b55a-3ba1ebef2a61.jpg","https://cdn.kimkim.com/files/a/images/0fb396488cca12f8626efb22722a4074556ca535/big-862477076899f85eafbb423590a3d120.jpg","https://www.nationsonline.org/gallery/Switzerland/Sunrise-on-the-Matterhorn.jpg","https://cdn.i-scmp.com/sites/default/files/d8/images/methode/2019/10/10/078b97ea-eb5a-11e9-9e8e-4022fb9638c4_image_hires_203601.jpg","https://travellersworldwide.com/wp-content/uploads/2022/12/Shutterstock_2045606852.jpg"]}ngOnInit(){this.currentIndex=0,this.currentImage=this.images[this.currentIndex],this.preloadNextImage(),this.changeBackgroundImage()}preloadNextImage(){this.nextImage=this.images[(this.currentIndex+1)%this.images.length],(new Image).src=this.nextImage}changeBackgroundImage(){setInterval(()=>{this.previousImage=this.currentImage,this.currentIndex=(this.currentIndex+1)%this.images.length,this.currentImage=this.images[this.currentIndex],this.preloadNextImage()},8e3)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vr({type:e,selectors:[["app-root"]],decls:6,vars:4,consts:[[1,"background-container"],["role","main",1,"all-content"]],template:function(t,r){1&t&&(Dt(0,"div")(1,"div",0),ke(2,"div",1),Dt(3,"app-header")(4,"router-outlet")(5,"app-about"),Ne()),2&t&&(Nf("background-image","url("+r.nextImage+")"),ct(1),Nf("background-image","url("+r.currentImage+")"))},dependencies:[Jb,C3,I3],styles:['.all-content[_ngcontent-%COMP%]{padding-bottom:10px;padding-top:0}.background-container[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background-image:url("https://www.travelandleisure.com/thmb/Etq4zWgOW-z9H7ZScs5_6WDcDvQ=/1500x0/filters:no_upscale():max_bytes(150000):strip_icc()/berlin-germany-aerial-lead-BERLINTG0921-475e3a333c7f4fdea7743c6fc2f261af.jpg");background-size:cover;background-position:center;z-index:-1;transition:background-image 3s ease}']}),e})();try{Uw=typeof Intl<"u"&&Intl.v8BreakIterator}catch{Uw=!1}let Q_,ED=(()=>{class e{constructor(t){this._platformId=t,this.isBrowser=this._platformId?Eb(this._platformId):"object"==typeof document&&!!document,this.EDGE=this.isBrowser&&/(edge)/i.test(navigator.userAgent),this.TRIDENT=this.isBrowser&&/(msie|trident)/i.test(navigator.userAgent),this.BLINK=this.isBrowser&&!(!window.chrome&&!Uw)&&typeof CSS<"u"&&!this.EDGE&&!this.TRIDENT,this.WEBKIT=this.isBrowser&&/AppleWebKit/i.test(navigator.userAgent)&&!this.BLINK&&!this.EDGE&&!this.TRIDENT,this.IOS=this.isBrowser&&/iPad|iPhone|iPod/.test(navigator.userAgent)&&!("MSStream"in window),this.FIREFOX=this.isBrowser&&/(firefox|minefield)/i.test(navigator.userAgent),this.ANDROID=this.isBrowser&&/android/i.test(navigator.userAgent)&&!this.TRIDENT,this.SAFARI=this.isBrowser&&/safari/i.test(navigator.userAgent)&&this.WEBKIT}}return e.\u0275fac=function(t){return new(t||e)(gt(g_))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function JA(e){return function M3(){if(null==Q_&&typeof window<"u")try{window.addEventListener("test",null,Object.defineProperty({},"passive",{get:()=>Q_=!0}))}finally{Q_=Q_||!1}return Q_}()?e:!!e.capture}function ID(e){return Array.isArray(e)?e:[e]}function TD(e){return e instanceof jr?e.nativeElement:e}class z3 extends je{constructor(n,t){super()}schedule(n,t=0){return this}}const e0={setInterval(e,n,...t){const{delegate:r}=e0;return r?.setInterval?r.setInterval(e,n,...t):setInterval(e,n,...t)},clearInterval(e){const{delegate:n}=e0;return(n?.clearInterval||clearInterval)(e)},delegate:void 0},MD={now:()=>(MD.delegate||Date).now(),delegate:void 0};class X_{constructor(n,t=X_.now){this.schedulerActionCtor=n,this.now=t}schedule(n,t=0,r){return new this.schedulerActionCtor(this,n).schedule(r,t)}}X_.now=MD.now;const j3=new class U3 extends X_{constructor(n,t=X_.now){super(n,t),this.actions=[],this._active=!1}flush(n){const{actions:t}=this;if(this._active)return void t.push(n);let r;this._active=!0;do{if(r=n.execute(n.state,n.delay))break}while(n=t.shift());if(this._active=!1,r){for(;n=t.shift();)n.unsubscribe();throw r}}}(class V3 extends z3{constructor(n,t){super(n,t),this.scheduler=n,this.work=t,this.pending=!1}schedule(n,t=0){var r;if(this.closed)return this;this.state=n;const l=this.id,u=this.scheduler;return null!=l&&(this.id=this.recycleAsyncId(u,l,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(u,this.id,t),this}requestAsyncId(n,t,r=0){return e0.setInterval(n.flush.bind(n,this),r)}recycleAsyncId(n,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&e0.clearInterval(t)}execute(n,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(n,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,t){let l,r=!1;try{this.work(n)}catch(u){r=!0,l=u||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),l}unsubscribe(){if(!this.closed){const{id:n,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,p(r,this),null!=n&&(this.id=this.recycleAsyncId(t,n,null)),this.delay=null,super.unsubscribe()}}});function G3(e){return pi((n,t)=>{Ot(e).subscribe(ei(t,()=>t.complete(),Mo)),!t.closed&&n.subscribe(t)})}const DD=new Set;let cm,$3=(()=>{class e{constructor(t){this._platform=t,this._matchMedia=this._platform.isBrowser&&window.matchMedia?window.matchMedia.bind(window):W3}matchMedia(t){return(this._platform.WEBKIT||this._platform.BLINK)&&function q3(e){if(!DD.has(e))try{cm||(cm=document.createElement("style"),cm.setAttribute("type","text/css"),document.head.appendChild(cm)),cm.sheet&&(cm.sheet.insertRule(`@media ${e} {body{ }}`,0),DD.add(e))}catch(n){console.error(n)}}(t),this._matchMedia(t)}}return e.\u0275fac=function(t){return new(t||e)(gt(ED))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function W3(e){return{matches:"all"===e||""===e,media:e,addListener:()=>{},removeListener:()=>{}}}let Z3=(()=>{class e{constructor(t,r){this._mediaMatcher=t,this._zone=r,this._queries=new Map,this._destroySubject=new rr}ngOnDestroy(){this._destroySubject.next(),this._destroySubject.complete()}isMatched(t){return SD(ID(t)).some(l=>this._registerQuery(l).mql.matches)}observe(t){let u=Fb(SD(ID(t)).map(g=>this._registerQuery(g).observable));return u=pA(u.pipe(rp(1)),u.pipe(function N3(e){return nc((n,t)=>e<=t)}(1),function H3(e,n=j3){return pi((t,r)=>{let l=null,u=null,g=null;const w=()=>{if(l){l.unsubscribe(),l=null;const S=u;u=null,r.next(S)}};function I(){const S=g+e,L=n.now();if(L<S)return l=this.schedule(void 0,S-L),void r.add(l);w()}t.subscribe(ei(r,S=>{u=S,g=n.now(),l||(l=n.schedule(I,e),r.add(l))},()=>{w(),r.complete()},void 0,()=>{u=l=null}))})}(0))),u.pipe(ht(g=>{const w={matches:!1,breakpoints:{}};return g.forEach(({matches:I,query:S})=>{w.matches=w.matches||I,w.breakpoints[S]=I}),w}))}_registerQuery(t){if(this._queries.has(t))return this._queries.get(t);const r=this._mediaMatcher.matchMedia(t),u={observable:new fn(g=>{const w=I=>this._zone.run(()=>g.next(I));return r.addListener(w),()=>{r.removeListener(w)}}).pipe(HI(r),ht(({matches:g})=>({query:t,matches:g})),G3(this._destroySubject)),mql:r};return this._queries.set(t,u),u}}return e.\u0275fac=function(t){return new(t||e)(gt($3),gt(ir))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();function SD(e){return e.map(n=>n.split(",")).reduce((n,t)=>n.concat(t)).map(n=>n.trim())}const OD="cdk-high-contrast-black-on-white",FD="cdk-high-contrast-white-on-black",Hw="cdk-high-contrast-active";let o5=(()=>{class e{constructor(t,r){this._platform=t,this._document=r,this._breakpointSubscription=Wt(Z3).observe("(forced-colors: active)").subscribe(()=>{this._hasCheckedHighContrastMode&&(this._hasCheckedHighContrastMode=!1,this._applyBodyHighContrastModeCssClasses())})}getHighContrastMode(){if(!this._platform.isBrowser)return 0;const t=this._document.createElement("div");t.style.backgroundColor="rgb(1,2,3)",t.style.position="absolute",this._document.body.appendChild(t);const r=this._document.defaultView||window,l=r&&r.getComputedStyle?r.getComputedStyle(t):null,u=(l&&l.backgroundColor||"").replace(/ /g,"");switch(t.remove(),u){case"rgb(0,0,0)":case"rgb(45,50,54)":case"rgb(32,32,32)":return 2;case"rgb(255,255,255)":case"rgb(255,250,239)":return 1}return 0}ngOnDestroy(){this._breakpointSubscription.unsubscribe()}_applyBodyHighContrastModeCssClasses(){if(!this._hasCheckedHighContrastMode&&this._platform.isBrowser&&this._document.body){const t=this._document.body.classList;t.remove(Hw,OD,FD),this._hasCheckedHighContrastMode=!0;const r=this.getHighContrastMode();1===r?t.add(Hw,OD):2===r&&t.add(Hw,FD)}}}return e.\u0275fac=function(t){return new(t||e)(gt(ED),gt(Ri))},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),LD=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({}),e})();const c5=new xt("mat-sanity-checks",{providedIn:"root",factory:function l5(){return!0}});let zD=(()=>{class e{constructor(t,r,l){this._sanityChecks=r,this._document=l,this._hasDoneGlobalChecks=!1,t._applyBodyHighContrastModeCssClasses(),this._hasDoneGlobalChecks||(this._hasDoneGlobalChecks=!0)}_checkIsEnabled(t){return!function k3(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}()&&("boolean"==typeof this._sanityChecks?this._sanityChecks:!!this._sanityChecks[t])}}return e.\u0275fac=function(t){return new(t||e)(gt(o5),gt(c5,8),gt(Ri))},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[LD,LD]}),e})();class h5{constructor(n,t,r,l=!1){this._renderer=n,this.element=t,this.config=r,this._animationForciblyDisabledThroughCss=l,this.state=3}fadeOut(){this._renderer.fadeOutRipple(this)}}const VD=JA({passive:!0,capture:!0});class d5{constructor(){this._events=new Map,this._delegateEventHandler=n=>{const t=function S3(e){return e.composedPath?e.composedPath()[0]:e.target}(n);t&&this._events.get(n.type)?.forEach((r,l)=>{(l===t||l.contains(t))&&r.forEach(u=>u.handleEvent(n))})}}addHandler(n,t,r,l){const u=this._events.get(t);if(u){const g=u.get(r);g?g.add(l):u.set(r,new Set([l]))}else this._events.set(t,new Map([[r,new Set([l])]])),n.runOutsideAngular(()=>{document.addEventListener(t,this._delegateEventHandler,VD)})}removeHandler(n,t,r){const l=this._events.get(n);if(!l)return;const u=l.get(t);u&&(u.delete(r),0===u.size&&l.delete(t),0===l.size&&(this._events.delete(n),document.removeEventListener(n,this._delegateEventHandler,VD)))}}const UD={enterDuration:225,exitDuration:150},jD=JA({passive:!0,capture:!0}),HD=["mousedown","touchstart"],GD=["mouseup","mouseleave","touchend","touchcancel"];class t0{constructor(n,t,r,l){this._target=n,this._ngZone=t,this._platform=l,this._isPointerDown=!1,this._activeRipples=new Map,this._pointerUpEventsRegistered=!1,l.isBrowser&&(this._containerElement=TD(r))}fadeInRipple(n,t,r={}){const l=this._containerRect=this._containerRect||this._containerElement.getBoundingClientRect(),u={...UD,...r.animation};r.centered&&(n=l.left+l.width/2,t=l.top+l.height/2);const g=r.radius||function f5(e,n,t){const r=Math.max(Math.abs(e-t.left),Math.abs(e-t.right)),l=Math.max(Math.abs(n-t.top),Math.abs(n-t.bottom));return Math.sqrt(r*r+l*l)}(n,t,l),w=n-l.left,I=t-l.top,S=u.enterDuration,L=document.createElement("div");L.classList.add("mat-ripple-element"),L.style.left=w-g+"px",L.style.top=I-g+"px",L.style.height=2*g+"px",L.style.width=2*g+"px",null!=r.color&&(L.style.backgroundColor=r.color),L.style.transitionDuration=`${S}ms`,this._containerElement.appendChild(L);const j=window.getComputedStyle(L),se=j.transitionDuration,he="none"===j.transitionProperty||"0s"===se||"0s, 0s"===se||0===l.width&&0===l.height,Ie=new h5(this,L,r,he);L.style.transform="scale3d(1, 1, 1)",Ie.state=0,r.persistent||(this._mostRecentTransientRipple=Ie);let Ue=null;return!he&&(S||u.exitDuration)&&this._ngZone.runOutsideAngular(()=>{const $e=()=>this._finishRippleTransition(Ie),_t=()=>this._destroyRipple(Ie);L.addEventListener("transitionend",$e),L.addEventListener("transitioncancel",_t),Ue={onTransitionEnd:$e,onTransitionCancel:_t}}),this._activeRipples.set(Ie,Ue),(he||!S)&&this._finishRippleTransition(Ie),Ie}fadeOutRipple(n){if(2===n.state||3===n.state)return;const t=n.element,r={...UD,...n.config.animation};t.style.transitionDuration=`${r.exitDuration}ms`,t.style.opacity="0",n.state=2,(n._animationForciblyDisabledThroughCss||!r.exitDuration)&&this._finishRippleTransition(n)}fadeOutAll(){this._getActiveRipples().forEach(n=>n.fadeOut())}fadeOutAllNonPersistent(){this._getActiveRipples().forEach(n=>{n.config.persistent||n.fadeOut()})}setupTriggerEvents(n){const t=TD(n);!this._platform.isBrowser||!t||t===this._triggerElement||(this._removeTriggerEvents(),this._triggerElement=t,HD.forEach(r=>{t0._eventManager.addHandler(this._ngZone,r,t,this)}))}handleEvent(n){"mousedown"===n.type?this._onMousedown(n):"touchstart"===n.type?this._onTouchStart(n):this._onPointerUp(),this._pointerUpEventsRegistered||(this._ngZone.runOutsideAngular(()=>{GD.forEach(t=>{this._triggerElement.addEventListener(t,this,jD)})}),this._pointerUpEventsRegistered=!0)}_finishRippleTransition(n){0===n.state?this._startFadeOutTransition(n):2===n.state&&this._destroyRipple(n)}_startFadeOutTransition(n){const t=n===this._mostRecentTransientRipple,{persistent:r}=n.config;n.state=1,!r&&(!t||!this._isPointerDown)&&n.fadeOut()}_destroyRipple(n){const t=this._activeRipples.get(n)??null;this._activeRipples.delete(n),this._activeRipples.size||(this._containerRect=null),n===this._mostRecentTransientRipple&&(this._mostRecentTransientRipple=null),n.state=3,null!==t&&(n.element.removeEventListener("transitionend",t.onTransitionEnd),n.element.removeEventListener("transitioncancel",t.onTransitionCancel)),n.element.remove()}_onMousedown(n){const t=function n5(e){return 0===e.buttons||0===e.offsetX&&0===e.offsetY}(n),r=this._lastTouchStartEvent&&Date.now()<this._lastTouchStartEvent+800;!this._target.rippleDisabled&&!t&&!r&&(this._isPointerDown=!0,this.fadeInRipple(n.clientX,n.clientY,this._target.rippleConfig))}_onTouchStart(n){if(!this._target.rippleDisabled&&!function i5(e){const n=e.touches&&e.touches[0]||e.changedTouches&&e.changedTouches[0];return!(!n||-1!==n.identifier||null!=n.radiusX&&1!==n.radiusX||null!=n.radiusY&&1!==n.radiusY)}(n)){this._lastTouchStartEvent=Date.now(),this._isPointerDown=!0;const t=n.changedTouches;for(let r=0;r<t.length;r++)this.fadeInRipple(t[r].clientX,t[r].clientY,this._target.rippleConfig)}}_onPointerUp(){this._isPointerDown&&(this._isPointerDown=!1,this._getActiveRipples().forEach(n=>{!n.config.persistent&&(1===n.state||n.config.terminateOnPointerUp&&0===n.state)&&n.fadeOut()}))}_getActiveRipples(){return Array.from(this._activeRipples.keys())}_removeTriggerEvents(){const n=this._triggerElement;n&&(HD.forEach(t=>t0._eventManager.removeHandler(t,n,this)),this._pointerUpEventsRegistered&&GD.forEach(t=>n.removeEventListener(t,this,jD)))}}t0._eventManager=new d5;let A5=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e}),e.\u0275inj=fi({imports:[zD,zD]}),e})(),x5=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=vr({type:e,selectors:[["app-hello"]],decls:5,vars:0,consts:[[1,"container"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"h1"),bt(2,"Discover Your Perfect European Weekend Getaway!"),Ne(),ke(3,"h2"),bt(4,"Plan Your Weekend Adventure with Detailed Weather and Temperature Insights"),Ne()())},styles:[".container[_ngcontent-%COMP%]{margin-top:0;padding-top:160px;text-align:center;margin-bottom:0;color:#fff;text-shadow:1px 1px 2px rgb(100,100,100)}h2[_ngcontent-%COMP%]{color:#fff;font-size:1.2rem;width:90%;margin:0 auto}@media (max-width: 992px){.container[_ngcontent-%COMP%]{padding-top:130px}}"]}),e})();function QD(e,n){return function(){return e.apply(n,arguments)}}const{toString:b5}=Object.prototype,{getPrototypeOf:$w}=Object,o0=(e=Object.create(null),n=>{const t=b5.call(n);return e[t]||(e[t]=t.slice(8,-1).toLowerCase())}),ac=e=>(e=e.toLowerCase(),n=>o0(n)===e),s0=e=>n=>typeof n===e,{isArray:um}=Array,Y_=s0("undefined");var e;const XD=ac("ArrayBuffer"),C5=s0("string"),ka=s0("function"),KD=s0("number"),a0=e=>null!==e&&"object"==typeof e,l0=e=>{if("object"!==o0(e))return!1;const n=$w(e);return!(null!==n&&n!==Object.prototype&&null!==Object.getPrototypeOf(n)||Symbol.toStringTag in e||Symbol.iterator in e)},T5=ac("Date"),M5=ac("File"),D5=ac("Blob"),S5=ac("FileList"),R5=ac("URLSearchParams");function ey(e,n,{allOwnKeys:t=!1}={}){if(null===e||typeof e>"u")return;let r,l;if("object"!=typeof e&&(e=[e]),um(e))for(r=0,l=e.length;r<l;r++)n.call(null,e[r],r,e);else{const u=t?Object.getOwnPropertyNames(e):Object.keys(e),g=u.length;let w;for(r=0;r<g;r++)w=u[r],n.call(null,e[w],w,e)}}function JD(e,n){n=n.toLowerCase();const t=Object.keys(e);let l,r=t.length;for(;r-- >0;)if(l=t[r],n===l.toLowerCase())return l;return null}const YD=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,eS=e=>!Y_(e)&&e!==YD,U5=(e=>n=>e&&n instanceof e)(typeof Uint8Array<"u"&&$w(Uint8Array)),G5=ac("HTMLFormElement"),tS=(({hasOwnProperty:e})=>(n,t)=>e.call(n,t))(Object.prototype),q5=ac("RegExp"),nS=(e,n)=>{const t=Object.getOwnPropertyDescriptors(e),r={};ey(t,(l,u)=>{!1!==n(l,u,e)&&(r[u]=l)}),Object.defineProperties(e,r)},Ww="abcdefghijklmnopqrstuvwxyz",iS="0123456789",rS={DIGIT:iS,ALPHA:Ww,ALPHA_DIGIT:Ww+Ww.toUpperCase()+iS},e4=ac("AsyncFunction"),Je={isArray:um,isArrayBuffer:XD,isBuffer:function w5(e){return null!==e&&!Y_(e)&&null!==e.constructor&&!Y_(e.constructor)&&ka(e.constructor.isBuffer)&&e.constructor.isBuffer(e)},isFormData:e=>{let n;return e&&("function"==typeof FormData&&e instanceof FormData||ka(e.append)&&("formdata"===(n=o0(e))||"object"===n&&ka(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function E5(e){let n;return n=typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&XD(e.buffer),n},isString:C5,isNumber:KD,isBoolean:e=>!0===e||!1===e,isObject:a0,isPlainObject:l0,isUndefined:Y_,isDate:T5,isFile:M5,isBlob:D5,isRegExp:q5,isFunction:ka,isStream:e=>a0(e)&&ka(e.pipe),isURLSearchParams:R5,isTypedArray:U5,isFileList:S5,forEach:ey,merge:function qw(){const{caseless:e}=eS(this)&&this||{},n={},t=(r,l)=>{const u=e&&JD(n,l)||l;n[u]=l0(n[u])&&l0(r)?qw(n[u],r):l0(r)?qw({},r):um(r)?r.slice():r};for(let r=0,l=arguments.length;r<l;r++)arguments[r]&&ey(arguments[r],t);return n},extend:(e,n,t,{allOwnKeys:r}={})=>(ey(n,(l,u)=>{e[u]=t&&ka(l)?QD(l,t):l},{allOwnKeys:r}),e),trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,n,t,r)=>{e.prototype=Object.create(n.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:n.prototype}),t&&Object.assign(e.prototype,t)},toFlatObject:(e,n,t,r)=>{let l,u,g;const w={};if(n=n||{},null==e)return n;do{for(l=Object.getOwnPropertyNames(e),u=l.length;u-- >0;)g=l[u],(!r||r(g,e,n))&&!w[g]&&(n[g]=e[g],w[g]=!0);e=!1!==t&&$w(e)}while(e&&(!t||t(e,n))&&e!==Object.prototype);return n},kindOf:o0,kindOfTest:ac,endsWith:(e,n,t)=>{e=String(e),(void 0===t||t>e.length)&&(t=e.length);const r=e.indexOf(n,t-=n.length);return-1!==r&&r===t},toArray:e=>{if(!e)return null;if(um(e))return e;let n=e.length;if(!KD(n))return null;const t=new Array(n);for(;n-- >0;)t[n]=e[n];return t},forEachEntry:(e,n)=>{const r=(e&&e[Symbol.iterator]).call(e);let l;for(;(l=r.next())&&!l.done;){const u=l.value;n.call(e,u[0],u[1])}},matchAll:(e,n)=>{let t;const r=[];for(;null!==(t=e.exec(n));)r.push(t);return r},isHTMLForm:G5,hasOwnProperty:tS,hasOwnProp:tS,reduceDescriptors:nS,freezeMethods:e=>{nS(e,(n,t)=>{if(ka(e)&&-1!==["arguments","caller","callee"].indexOf(t))return!1;if(ka(e[t])){if(n.enumerable=!1,"writable"in n)return void(n.writable=!1);n.set||(n.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},toObjectSet:(e,n)=>{const t={},r=l=>{l.forEach(u=>{t[u]=!0})};return um(e)?r(e):r(String(e).split(n)),t},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,l){return r.toUpperCase()+l}),noop:()=>{},toFiniteNumber:(e,n)=>(e=+e,Number.isFinite(e)?e:n),findKey:JD,global:YD,isContextDefined:eS,ALPHABET:rS,generateString:(e=16,n=rS.ALPHA_DIGIT)=>{let t="";const{length:r}=n;for(;e--;)t+=n[Math.random()*r|0];return t},isSpecCompliantForm:function J5(e){return!!(e&&ka(e.append)&&"FormData"===e[Symbol.toStringTag]&&e[Symbol.iterator])},toJSONObject:e=>{const n=new Array(10),t=(r,l)=>{if(a0(r)){if(n.indexOf(r)>=0)return;if(!("toJSON"in r)){n[l]=r;const u=um(r)?[]:{};return ey(r,(g,w)=>{const I=t(g,l+1);!Y_(I)&&(u[w]=I)}),n[l]=void 0,u}}return r};return t(e,0)},isAsyncFn:e4,isThenable:e=>e&&(a0(e)||ka(e))&&ka(e.then)&&ka(e.catch)};function hm(e,n,t,r,l){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",n&&(this.code=n),t&&(this.config=t),r&&(this.request=r),l&&(this.response=l)}Je.inherits(hm,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Je.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const oS=hm.prototype,sS={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{sS[e]={value:e}}),Object.defineProperties(hm,sS),Object.defineProperty(oS,"isAxiosError",{value:!0}),hm.from=(e,n,t,r,l,u)=>{const g=Object.create(oS);return Je.toFlatObject(e,g,function(I){return I!==Error.prototype},w=>"isAxiosError"!==w),hm.call(g,e.message,n,t,r,l),g.cause=e,g.name=e.name,u&&Object.assign(g,u),g};const di=hm;function Zw(e){return Je.isPlainObject(e)||Je.isArray(e)}function lS(e){return Je.endsWith(e,"[]")?e.slice(0,-2):e}function cS(e,n,t){return e?e.concat(n).map(function(l,u){return l=lS(l),!t&&u?"["+l+"]":l}).join(t?".":""):n}const n4=Je.toFlatObject(Je,{},null,function(n){return/^is[A-Z]/.test(n)}),c0=function i4(e,n,t){if(!Je.isObject(e))throw new TypeError("target must be an object");n=n||new FormData;const r=(t=Je.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Ie,Ue){return!Je.isUndefined(Ue[Ie])})).metaTokens,l=t.visitor||L,u=t.dots,g=t.indexes,I=(t.Blob||typeof Blob<"u"&&Blob)&&Je.isSpecCompliantForm(n);if(!Je.isFunction(l))throw new TypeError("visitor must be a function");function S(he){if(null===he)return"";if(Je.isDate(he))return he.toISOString();if(!I&&Je.isBlob(he))throw new di("Blob is not supported. Use a Buffer instead.");return Je.isArrayBuffer(he)||Je.isTypedArray(he)?I&&"function"==typeof Blob?new Blob([he]):Buffer.from(he):he}function L(he,Ie,Ue){let $e=he;if(he&&!Ue&&"object"==typeof he)if(Je.endsWith(Ie,"{}"))Ie=r?Ie:Ie.slice(0,-2),he=JSON.stringify(he);else if(Je.isArray(he)&&function t4(e){return Je.isArray(e)&&!e.some(Zw)}(he)||(Je.isFileList(he)||Je.endsWith(Ie,"[]"))&&($e=Je.toArray(he)))return Ie=lS(Ie),$e.forEach(function(Ke,$t){!Je.isUndefined(Ke)&&null!==Ke&&n.append(!0===g?cS([Ie],$t,u):null===g?Ie:Ie+"[]",S(Ke))}),!1;return!!Zw(he)||(n.append(cS(Ue,Ie,u),S(he)),!1)}const j=[],ne=Object.assign(n4,{defaultVisitor:L,convertValue:S,isVisitable:Zw});if(!Je.isObject(e))throw new TypeError("data must be an object");return function se(he,Ie){if(!Je.isUndefined(he)){if(-1!==j.indexOf(he))throw Error("Circular reference detected in "+Ie.join("."));j.push(he),Je.forEach(he,function($e,_t){!0===(!(Je.isUndefined($e)||null===$e)&&l.call(n,$e,Je.isString(_t)?_t.trim():_t,Ie,ne))&&se($e,Ie?Ie.concat(_t):[_t])}),j.pop()}}(e),n};function uS(e){const n={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return n[r]})}function hS(e,n){this._pairs=[],e&&c0(e,this,n)}const dS=hS.prototype;dS.append=function(n,t){this._pairs.push([n,t])},dS.toString=function(n){const t=n?function(r){return n.call(this,r,uS)}:uS;return this._pairs.map(function(l){return t(l[0])+"="+t(l[1])},"").join("&")};const pS=hS;function r4(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function fS(e,n,t){if(!n)return e;const r=t&&t.encode||r4,l=t&&t.serialize;let u;if(u=l?l(n,t):Je.isURLSearchParams(n)?n.toString():new pS(n,t).toString(r),u){const g=e.indexOf("#");-1!==g&&(e=e.slice(0,g)),e+=(-1===e.indexOf("?")?"?":"&")+u}return e}const mS=class o4{constructor(){this.handlers=[]}use(n,t,r){return this.handlers.push({fulfilled:n,rejected:t,synchronous:!!r&&r.synchronous,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(n){this.handlers[n]&&(this.handlers[n]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(n){Je.forEach(this.handlers,function(r){null!==r&&n(r)})}},gS={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},s4=typeof URLSearchParams<"u"?URLSearchParams:pS,a4=typeof FormData<"u"?FormData:null,l4=typeof Blob<"u"?Blob:null,c4=(()=>{let e;return(!(typeof navigator<"u")||"ReactNative"!==(e=navigator.product)&&"NativeScript"!==e&&"NS"!==e)&&typeof window<"u"&&typeof document<"u"})(),lc={isBrowser:!0,classes:{URLSearchParams:s4,FormData:a4,Blob:l4},isStandardBrowserEnv:c4,isStandardBrowserWebWorkerEnv:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&"function"==typeof self.importScripts,protocols:["http","https","file","blob","url","data"]},_S=function f4(e){function n(t,r,l,u){let g=t[u++];const w=Number.isFinite(+g),I=u>=t.length;return g=!g&&Je.isArray(l)?l.length:g,I?(l[g]=Je.hasOwnProp(l,g)?[l[g],r]:r,!w):((!l[g]||!Je.isObject(l[g]))&&(l[g]=[]),n(t,r,l[g],u)&&Je.isArray(l[g])&&(l[g]=function p4(e){const n={},t=Object.keys(e);let r;const l=t.length;let u;for(r=0;r<l;r++)u=t[r],n[u]=e[u];return n}(l[g])),!w)}if(Je.isFormData(e)&&Je.isFunction(e.entries)){const t={};return Je.forEachEntry(e,(r,l)=>{n(function d4(e){return Je.matchAll(/\w+|\[(\w*)]/g,e).map(n=>"[]"===n[0]?"":n[1]||n[0])}(r),l,t,0)}),t}return null},m4={"Content-Type":void 0},u0={transitional:gS,adapter:["xhr","http"],transformRequest:[function(n,t){const r=t.getContentType()||"",l=r.indexOf("application/json")>-1,u=Je.isObject(n);if(u&&Je.isHTMLForm(n)&&(n=new FormData(n)),Je.isFormData(n))return l&&l?JSON.stringify(_S(n)):n;if(Je.isArrayBuffer(n)||Je.isBuffer(n)||Je.isStream(n)||Je.isFile(n)||Je.isBlob(n))return n;if(Je.isArrayBufferView(n))return n.buffer;if(Je.isURLSearchParams(n))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),n.toString();let w;if(u){if(r.indexOf("application/x-www-form-urlencoded")>-1)return function h4(e,n){return c0(e,new lc.classes.URLSearchParams,Object.assign({visitor:function(t,r,l,u){return lc.isNode&&Je.isBuffer(t)?(this.append(r,t.toString("base64")),!1):u.defaultVisitor.apply(this,arguments)}},n))}(n,this.formSerializer).toString();if((w=Je.isFileList(n))||r.indexOf("multipart/form-data")>-1){const I=this.env&&this.env.FormData;return c0(w?{"files[]":n}:n,I&&new I,this.formSerializer)}}return u||l?(t.setContentType("application/json",!1),function g4(e,n,t){if(Je.isString(e))try{return(n||JSON.parse)(e),Je.trim(e)}catch(r){if("SyntaxError"!==r.name)throw r}return(t||JSON.stringify)(e)}(n)):n}],transformResponse:[function(n){const t=this.transitional||u0.transitional,r=t&&t.forcedJSONParsing,l="json"===this.responseType;if(n&&Je.isString(n)&&(r&&!this.responseType||l)){const g=!(t&&t.silentJSONParsing)&&l;try{return JSON.parse(n)}catch(w){if(g)throw"SyntaxError"===w.name?di.from(w,di.ERR_BAD_RESPONSE,this,null,this.response):w}}return n}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:lc.classes.FormData,Blob:lc.classes.Blob},validateStatus:function(n){return n>=200&&n<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Je.forEach(["delete","get","head"],function(n){u0.headers[n]={}}),Je.forEach(["post","put","patch"],function(n){u0.headers[n]=Je.merge(m4)});const Qw=u0,_4=Je.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),yS=Symbol("internals");function ty(e){return e&&String(e).trim().toLowerCase()}function h0(e){return!1===e||null==e?e:Je.isArray(e)?e.map(h0):String(e)}function Xw(e,n,t,r,l){if(Je.isFunction(r))return r.call(this,n,t);if(l&&(n=t),Je.isString(n)){if(Je.isString(r))return-1!==n.indexOf(r);if(Je.isRegExp(r))return r.test(n)}}class d0{constructor(n){n&&this.set(n)}set(n,t,r){const l=this;function u(w,I,S){const L=ty(I);if(!L)throw new Error("header name must be a non-empty string");const j=Je.findKey(l,L);(!j||void 0===l[j]||!0===S||void 0===S&&!1!==l[j])&&(l[j||I]=h0(w))}const g=(w,I)=>Je.forEach(w,(S,L)=>u(S,L,I));return Je.isPlainObject(n)||n instanceof this.constructor?g(n,t):Je.isString(n)&&(n=n.trim())&&!(e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))(n)?g((e=>{const n={};let t,r,l;return e&&e.split("\n").forEach(function(g){l=g.indexOf(":"),t=g.substring(0,l).trim().toLowerCase(),r=g.substring(l+1).trim(),!(!t||n[t]&&_4[t])&&("set-cookie"===t?n[t]?n[t].push(r):n[t]=[r]:n[t]=n[t]?n[t]+", "+r:r)}),n})(n),t):null!=n&&u(t,n,r),this}get(n,t){if(n=ty(n)){const r=Je.findKey(this,n);if(r){const l=this[r];if(!t)return l;if(!0===t)return function v4(e){const n=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(e);)n[r[1]]=r[2];return n}(l);if(Je.isFunction(t))return t.call(this,l,r);if(Je.isRegExp(t))return t.exec(l);throw new TypeError("parser must be boolean|regexp|function")}}}has(n,t){if(n=ty(n)){const r=Je.findKey(this,n);return!(!r||void 0===this[r]||t&&!Xw(0,this[r],r,t))}return!1}delete(n,t){const r=this;let l=!1;function u(g){if(g=ty(g)){const w=Je.findKey(r,g);w&&(!t||Xw(0,r[w],w,t))&&(delete r[w],l=!0)}}return Je.isArray(n)?n.forEach(u):u(n),l}clear(n){const t=Object.keys(this);let r=t.length,l=!1;for(;r--;){const u=t[r];(!n||Xw(0,this[u],u,n,!0))&&(delete this[u],l=!0)}return l}normalize(n){const t=this,r={};return Je.forEach(this,(l,u)=>{const g=Je.findKey(r,u);if(g)return t[g]=h0(l),void delete t[u];const w=n?function x4(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(n,t,r)=>t.toUpperCase()+r)}(u):String(u).trim();w!==u&&delete t[u],t[w]=h0(l),r[w]=!0}),this}concat(...n){return this.constructor.concat(this,...n)}toJSON(n){const t=Object.create(null);return Je.forEach(this,(r,l)=>{null!=r&&!1!==r&&(t[l]=n&&Je.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([n,t])=>n+": "+t).join("\n")}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(n){return n instanceof this?n:new this(n)}static concat(n,...t){const r=new this(n);return t.forEach(l=>r.set(l)),r}static accessor(n){const r=(this[yS]=this[yS]={accessors:{}}).accessors,l=this.prototype;function u(g){const w=ty(g);r[w]||(function b4(e,n){const t=Je.toCamelCase(" "+n);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+t,{value:function(l,u,g){return this[r].call(this,n,l,u,g)},configurable:!0})})}(l,g),r[w]=!0)}return Je.isArray(n)?n.forEach(u):u(n),this}}d0.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),Je.freezeMethods(d0.prototype),Je.freezeMethods(d0);const fu=d0;function Kw(e,n){const t=this||Qw,r=n||t,l=fu.from(r.headers);let u=r.data;return Je.forEach(e,function(w){u=w.call(t,u,l.normalize(),n?n.status:void 0)}),l.normalize(),u}function vS(e){return!(!e||!e.__CANCEL__)}function AS(e,n,t){di.call(this,e??"canceled",di.ERR_CANCELED,n,t),this.name="CanceledError"}Je.inherits(AS,di,{__CANCEL__:!0});const p0=AS,E4=lc.isStandardBrowserEnv?{write:function(t,r,l,u,g,w){const I=[];I.push(t+"="+encodeURIComponent(r)),Je.isNumber(l)&&I.push("expires="+new Date(l).toGMTString()),Je.isString(u)&&I.push("path="+u),Je.isString(g)&&I.push("domain="+g),!0===w&&I.push("secure"),document.cookie=I.join("; ")},read:function(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}};function xS(e,n){return e&&!function C4(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(n)?function I4(e,n){return n?e.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):e}(e,n):n}const T4=lc.isStandardBrowserEnv?function(){const n=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function l(u){let g=u;return n&&(t.setAttribute("href",g),g=t.href),t.setAttribute("href",g),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:"/"===t.pathname.charAt(0)?t.pathname:"/"+t.pathname}}return r=l(window.location.href),function(g){const w=Je.isString(g)?l(g):g;return w.protocol===r.protocol&&w.host===r.host}}():function(){return!0},S4=function D4(e,n){e=e||10;const t=new Array(e),r=new Array(e);let g,l=0,u=0;return n=void 0!==n?n:1e3,function(I){const S=Date.now(),L=r[u];g||(g=S),t[l]=I,r[l]=S;let j=u,ne=0;for(;j!==l;)ne+=t[j++],j%=e;if(l=(l+1)%e,l===u&&(u=(u+1)%e),S-g<n)return;const se=L&&S-L;return se?Math.round(1e3*ne/se):void 0}};function bS(e,n){let t=0;const r=S4(50,250);return l=>{const u=l.loaded,g=l.lengthComputable?l.total:void 0,w=u-t,I=r(w);t=u;const L={loaded:u,total:g,progress:g?u/g:void 0,bytes:w,rate:I||void 0,estimated:I&&g&&u<=g?(g-u)/I:void 0,event:l};L[n?"download":"upload"]=!0,e(L)}}const f0={http:null,xhr:typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(t,r){let l=e.data;const u=fu.from(e.headers).normalize(),g=e.responseType;let w;function I(){e.cancelToken&&e.cancelToken.unsubscribe(w),e.signal&&e.signal.removeEventListener("abort",w)}Je.isFormData(l)&&(lc.isStandardBrowserEnv||lc.isStandardBrowserWebWorkerEnv?u.setContentType(!1):u.setContentType("multipart/form-data;",!1));let S=new XMLHttpRequest;if(e.auth){const se=e.auth.username||"",he=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";u.set("Authorization","Basic "+btoa(se+":"+he))}const L=xS(e.baseURL,e.url);function j(){if(!S)return;const se=fu.from("getAllResponseHeaders"in S&&S.getAllResponseHeaders());(function w4(e,n,t){const r=t.config.validateStatus;t.status&&r&&!r(t.status)?n(new di("Request failed with status code "+t.status,[di.ERR_BAD_REQUEST,di.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t)):e(t)})(function($e){t($e),I()},function($e){r($e),I()},{data:g&&"text"!==g&&"json"!==g?S.response:S.responseText,status:S.status,statusText:S.statusText,headers:se,config:e,request:S}),S=null}if(S.open(e.method.toUpperCase(),fS(L,e.params,e.paramsSerializer),!0),S.timeout=e.timeout,"onloadend"in S?S.onloadend=j:S.onreadystatechange=function(){!S||4!==S.readyState||0===S.status&&(!S.responseURL||0!==S.responseURL.indexOf("file:"))||setTimeout(j)},S.onabort=function(){S&&(r(new di("Request aborted",di.ECONNABORTED,e,S)),S=null)},S.onerror=function(){r(new di("Network Error",di.ERR_NETWORK,e,S)),S=null},S.ontimeout=function(){let he=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded";e.timeoutErrorMessage&&(he=e.timeoutErrorMessage),r(new di(he,(e.transitional||gS).clarifyTimeoutError?di.ETIMEDOUT:di.ECONNABORTED,e,S)),S=null},lc.isStandardBrowserEnv){const se=(e.withCredentials||T4(L))&&e.xsrfCookieName&&E4.read(e.xsrfCookieName);se&&u.set(e.xsrfHeaderName,se)}void 0===l&&u.setContentType(null),"setRequestHeader"in S&&Je.forEach(u.toJSON(),function(he,Ie){S.setRequestHeader(Ie,he)}),Je.isUndefined(e.withCredentials)||(S.withCredentials=!!e.withCredentials),g&&"json"!==g&&(S.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&S.addEventListener("progress",bS(e.onDownloadProgress,!0)),"function"==typeof e.onUploadProgress&&S.upload&&S.upload.addEventListener("progress",bS(e.onUploadProgress)),(e.cancelToken||e.signal)&&(w=se=>{S&&(r(!se||se.type?new p0(null,e,S):se),S.abort(),S=null)},e.cancelToken&&e.cancelToken.subscribe(w),e.signal&&(e.signal.aborted?w():e.signal.addEventListener("abort",w)));const ne=function M4(e){const n=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return n&&n[1]||""}(L);ne&&-1===lc.protocols.indexOf(ne)?r(new di("Unsupported protocol "+ne+":",di.ERR_BAD_REQUEST,e)):S.send(l||null)})}};Je.forEach(f0,(e,n)=>{if(e){try{Object.defineProperty(e,"name",{value:n})}catch{}Object.defineProperty(e,"adapterName",{value:n})}});const k4={getAdapter:e=>{e=Je.isArray(e)?e:[e];const{length:n}=e;let t,r;for(let l=0;l<n&&(t=e[l],!(r=Je.isString(t)?f0[t.toLowerCase()]:t));l++);if(!r)throw!1===r?new di(`Adapter ${t} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(Je.hasOwnProp(f0,t)?`Adapter '${t}' is not available in the build`:`Unknown adapter '${t}'`);if(!Je.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:f0};function Jw(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new p0(null,e)}function wS(e){return Jw(e),e.headers=fu.from(e.headers),e.data=Kw.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1),k4.getAdapter(e.adapter||Qw.adapter)(e).then(function(r){return Jw(e),r.data=Kw.call(e,e.transformResponse,r),r.headers=fu.from(r.headers),r},function(r){return vS(r)||(Jw(e),r&&r.response&&(r.response.data=Kw.call(e,e.transformResponse,r.response),r.response.headers=fu.from(r.response.headers))),Promise.reject(r)})}const ES=e=>e instanceof fu?e.toJSON():e;function dm(e,n){n=n||{};const t={};function r(S,L,j){return Je.isPlainObject(S)&&Je.isPlainObject(L)?Je.merge.call({caseless:j},S,L):Je.isPlainObject(L)?Je.merge({},L):Je.isArray(L)?L.slice():L}function l(S,L,j){return Je.isUndefined(L)?Je.isUndefined(S)?void 0:r(void 0,S,j):r(S,L,j)}function u(S,L){if(!Je.isUndefined(L))return r(void 0,L)}function g(S,L){return Je.isUndefined(L)?Je.isUndefined(S)?void 0:r(void 0,S):r(void 0,L)}function w(S,L,j){return j in n?r(S,L):j in e?r(void 0,S):void 0}const I={url:u,method:u,data:u,baseURL:g,transformRequest:g,transformResponse:g,paramsSerializer:g,timeout:g,timeoutMessage:g,withCredentials:g,adapter:g,responseType:g,xsrfCookieName:g,xsrfHeaderName:g,onUploadProgress:g,onDownloadProgress:g,decompress:g,maxContentLength:g,maxBodyLength:g,beforeRedirect:g,transport:g,httpAgent:g,httpsAgent:g,cancelToken:g,socketPath:g,responseEncoding:g,validateStatus:w,headers:(S,L)=>l(ES(S),ES(L),!0)};return Je.forEach(Object.keys(Object.assign({},e,n)),function(L){const j=I[L]||l,ne=j(e[L],n[L],L);Je.isUndefined(ne)&&j!==w||(t[L]=ne)}),t}const CS="1.4.0",Yw={};["object","boolean","number","function","string","symbol"].forEach((e,n)=>{Yw[e]=function(r){return typeof r===e||"a"+(n<1?"n ":" ")+e}});const IS={};Yw.transitional=function(n,t,r){function l(u,g){return"[Axios v"+CS+"] Transitional option '"+u+"'"+g+(r?". "+r:"")}return(u,g,w)=>{if(!1===n)throw new di(l(g," has been removed"+(t?" in "+t:"")),di.ERR_DEPRECATED);return t&&!IS[g]&&(IS[g]=!0,console.warn(l(g," has been deprecated since v"+t+" and will be removed in the near future"))),!n||n(u,g,w)}};const e1={assertOptions:function P4(e,n,t){if("object"!=typeof e)throw new di("options must be an object",di.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let l=r.length;for(;l-- >0;){const u=r[l],g=n[u];if(g){const w=e[u],I=void 0===w||g(w,u,e);if(!0!==I)throw new di("option "+u+" must be "+I,di.ERR_BAD_OPTION_VALUE)}else if(!0!==t)throw new di("Unknown option "+u,di.ERR_BAD_OPTION)}},validators:Yw},Gh=e1.validators;class m0{constructor(n){this.defaults=n,this.interceptors={request:new mS,response:new mS}}request(n,t){"string"==typeof n?(t=t||{}).url=n:t=n||{},t=dm(this.defaults,t);const{transitional:r,paramsSerializer:l,headers:u}=t;let g;void 0!==r&&e1.assertOptions(r,{silentJSONParsing:Gh.transitional(Gh.boolean),forcedJSONParsing:Gh.transitional(Gh.boolean),clarifyTimeoutError:Gh.transitional(Gh.boolean)},!1),null!=l&&(Je.isFunction(l)?t.paramsSerializer={serialize:l}:e1.assertOptions(l,{encode:Gh.function,serialize:Gh.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase(),g=u&&Je.merge(u.common,u[t.method]),g&&Je.forEach(["delete","get","head","post","put","patch","common"],he=>{delete u[he]}),t.headers=fu.concat(g,u);const w=[];let I=!0;this.interceptors.request.forEach(function(Ie){"function"==typeof Ie.runWhen&&!1===Ie.runWhen(t)||(I=I&&Ie.synchronous,w.unshift(Ie.fulfilled,Ie.rejected))});const S=[];this.interceptors.response.forEach(function(Ie){S.push(Ie.fulfilled,Ie.rejected)});let L,ne,j=0;if(!I){const he=[wS.bind(this),void 0];for(he.unshift.apply(he,w),he.push.apply(he,S),ne=he.length,L=Promise.resolve(t);j<ne;)L=L.then(he[j++],he[j++]);return L}ne=w.length;let se=t;for(j=0;j<ne;){const he=w[j++],Ie=w[j++];try{se=he(se)}catch(Ue){Ie.call(this,Ue);break}}try{L=wS.call(this,se)}catch(he){return Promise.reject(he)}for(j=0,ne=S.length;j<ne;)L=L.then(S[j++],S[j++]);return L}getUri(n){return fS(xS((n=dm(this.defaults,n)).baseURL,n.url),n.params,n.paramsSerializer)}}Je.forEach(["delete","get","head","options"],function(n){m0.prototype[n]=function(t,r){return this.request(dm(r||{},{method:n,url:t,data:(r||{}).data}))}}),Je.forEach(["post","put","patch"],function(n){function t(r){return function(u,g,w){return this.request(dm(w||{},{method:n,headers:r?{"Content-Type":"multipart/form-data"}:{},url:u,data:g}))}}m0.prototype[n]=t(),m0.prototype[n+"Form"]=t(!0)});const g0=m0;class t1{constructor(n){if("function"!=typeof n)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(u){t=u});const r=this;this.promise.then(l=>{if(!r._listeners)return;let u=r._listeners.length;for(;u-- >0;)r._listeners[u](l);r._listeners=null}),this.promise.then=l=>{let u;const g=new Promise(w=>{r.subscribe(w),u=w}).then(l);return g.cancel=function(){r.unsubscribe(u)},g},n(function(u,g,w){r.reason||(r.reason=new p0(u,g,w),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(n){this.reason?n(this.reason):this._listeners?this._listeners.push(n):this._listeners=[n]}unsubscribe(n){if(!this._listeners)return;const t=this._listeners.indexOf(n);-1!==t&&this._listeners.splice(t,1)}static source(){let n;return{token:new t1(function(l){n=l}),cancel:n}}}const R4=t1,n1={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(n1).forEach(([e,n])=>{n1[n]=e});const L4=n1,qr=function TS(e){const n=new g0(e),t=QD(g0.prototype.request,n);return Je.extend(t,g0.prototype,n,{allOwnKeys:!0}),Je.extend(t,n,null,{allOwnKeys:!0}),t.create=function(l){return TS(dm(e,l))},t}(Qw);qr.Axios=g0,qr.CanceledError=p0,qr.CancelToken=R4,qr.isCancel=vS,qr.VERSION=CS,qr.toFormData=c0,qr.AxiosError=di,qr.Cancel=qr.CanceledError,qr.all=function(n){return Promise.all(n)},qr.spread=function O4(e){return function(t){return e.apply(null,t)}},qr.isAxiosError=function F4(e){return Je.isObject(e)&&!0===e.isAxiosError},qr.mergeConfig=dm,qr.AxiosHeaders=fu,qr.formToJSON=e=>_S(Je.isHTMLForm(e)?new FormData(e):e),qr.HttpStatusCode=L4,qr.default=qr;const B4=qr;let N4=(()=>{class e{constructor(){this.apiUrl="https://api.openai.com/v1/engines/text-davinci-003/completions",this.apiKey="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"}sendMessage(t){return console.log("hello world"),B4.post(this.apiUrl,{prompt:t,max_tokens:500},{headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.apiKey}`}})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Tt({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const z4=["secondInput"],V4=["thirdInput"];function U4(e,n){if(1&e&&(ke(0,"h2",19),bt(1),Ne()),2&e){const t=Ft();ct(1),Yr("",t.errorMessage,"!")}}const j4=function(e){return{hide:e}};let H4=(()=>{class e{constructor(t,r,l,u,g){this.http=t,this.weatherService=r,this.helper=l,this.test=u,this.chatGptService=g,this.shouldHide=!1,this.capital="",this.country="",this.description="",this.temperature=-1,this.icon="",this.errorMessage="",this.url="",this.loading=!1,this.loadingText="Loading"}ngOnInit(){setInterval(()=>{this.loadingText=this.loadingText+".",this.loadingText.length>10&&(this.loadingText="Loading")},500)}onSubmit(){this.weatherService.getWeather(this.capital).subscribe(t=>{console.log(t.temp);let r="";-1e4!==t.temp&&""!==this.capital?""===this.url?this.searchCountryImage(this.capital,l=>{r=l||"https://www.grouphealth.ca/wp-content/uploads/2018/05/placeholder-image.png",this.addCapital(r,t)}):(r=this.url,this.addCapital(r,t)):this.errorMessage=""===this.country?"Missing country name":t.message})}searchCountryImage(t,r){const g=`https://api.unsplash.com/search/photos?query=${encodeURIComponent(`${t} city`)}&client_id=JEEcrWMwrI_Y9PV0hUX_MZw5ICMhPMHlIW3W7XOHkUM`;this.http.get(g).subscribe(w=>{r(w.results&&w.results.length>0?w.results[0].urls.regular:null)})}fetchUnsplashImages(t,r){const w=`https://api.unsplash.com/search/photos?query=${encodeURIComponent(`${t} city`)}&per_page=4&client_id=JEEcrWMwrI_Y9PV0hUX_MZw5ICMhPMHlIW3W7XOHkUM`;this.http.get(w).subscribe(I=>{if(I.results&&I.results.length>0){const S=I.results.map(L=>L.urls.regular);r(S)}else r([])})}addCapital(t,r){this.loading=!0,this.fetchUnsplashImages(this.capital,l=>{this.description?(this.helper.capitals.push({id:this.helper.capitals.length+1,capital:this.capital,country:this.country,favourite:!1,visited:!1,planned:!1,url:t,temperature:Math.round(10*r.temp)/10,icon:r.icon,description:this.description,images:l.length>0?l:["https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png"]}),localStorage.setItem("capitals",JSON.stringify(this.helper.capitals)),this.loading=!1,this.helper.dialog()):this.chatGptService.sendMessage(`Write description for:\n\n        Capital: ${this.capital}\nCountry: ${this.country}\n\n        Example of description:\n\n        Paris is the capital of France and one of the most popular tourist destinations in the world. The city is located on the Seine River in the north-central part of France. Paris has a population of over 2.2 million people and is the most populous city in France. Paris is a city with a rich history dating back to the Roman era. The city has been home to many important events in history, including the French Revolution and the World Wars. Paris is also a city of art and culture, and is home to many famous landmarks, including the Eiffel Tower, the Louvre Museum, and the Notre Dame Cathedral.\n\n        \nyou can write the description bigger than this example BUT not smaller`).then(g=>{console.log("hello world");const w=g.data.choices[0].text.trim();this.helper.capitals.push({id:this.helper.capitals.length+1,capital:this.capital,country:this.country,favourite:!1,visited:!1,planned:!1,url:t,temperature:Math.round(10*r.temp)/10,icon:r.icon,description:w,images:l.length>0?l:["https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png","https://storage.googleapis.com/proudcity/mebanenc/uploads/2021/03/placeholder-image.png"]}),localStorage.setItem("capitals",JSON.stringify(this.helper.capitals)),this.helper.dialog()}).catch(g=>{console.error(g)})})}onTextChanged(){this.errorMessage=""}onFirstInputEnter(){this.secondInputRef.nativeElement.focus()}onSecondInputEnter(){this.thirdInputRef.nativeElement.focus()}onThirdInputEnter(){this.thirdInputRef.nativeElement.focus()}onClose(){this.shouldHide=!0,setTimeout(()=>{this.helper.dialog()},300)}}return e.\u0275fac=function(t){return new(t||e)(qe(im),qe(VA),qe(j_),qe(_w),qe(N4))},e.\u0275cmp=vr({type:e,selectors:[["app-add-capital"]],viewQuery:function(t,r){if(1&t&&(Yd(z4,5),Yd(V4,5)),2&t){let l;Sh(l=kh())&&(r.secondInputRef=l.first),Sh(l=kh())&&(r.thirdInputRef=l.first)}},decls:33,vars:11,consts:[[1,"container-main",3,"ngClass"],[1,"dialog"],[1,"row"],[1,"col-4"],[1,"px-1"],[1,"col-8"],["class","float-end text-failure",4,"ngIf"],[1,"input-group","mb-3"],["type","text","aria-label","Default","aria-describedby","inputGroup-sizing-default","placeholder","City name",1,"form-control",3,"ngModel","keyup","keyup.enter","ngModelChange"],["type","text","aria-label","Default","aria-describedby","inputGroup-sizing-default","placeholder","Country name",1,"form-control",3,"ngModel","keyup.enter","ngModelChange"],["secondInput",""],["type","text","aria-label","Default","aria-describedby","inputGroup-sizing-default","placeholder","Description",1,"form-control","description",2,"resize","none",3,"ngModel","ngModelChange"],["thirdInput",""],["type","text","aria-label","Default","aria-describedby","inputGroup-sizing-default","placeholder","http://..",1,"form-control",3,"ngModel","keyup.enter","ngModelChange"],["fourthInput",""],[1,"row","row-buttons","mx-0","px-0","mt-4"],[1,"col-6","px-0","my-auto"],[1,"btn","btn-cancel",3,"disabled","click"],[1,"btn","btn-success",3,"disabled","click"],[1,"float-end","text-failure"]],template:function(t,r){1&t&&(ke(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2",4),bt(5,"Capital"),Ne()(),ke(6,"div",5),At(7,U4,2,1,"h2",6),Ne()(),ke(8,"div",7)(9,"input",8),ft("keyup",function(){return r.onTextChanged()})("keyup.enter",function(){return r.onFirstInputEnter()})("ngModelChange",function(u){return r.capital=u}),Ne()(),ke(10,"h2",4),bt(11,"Country"),Ne(),ke(12,"div",7)(13,"input",9,10),ft("keyup.enter",function(){return r.onSecondInputEnter()})("ngModelChange",function(u){return r.country=u}),Ne()(),ke(15,"h2",4),bt(16,"Description (optional)"),Ne(),ke(17,"div",7)(18,"textarea",11,12),ft("ngModelChange",function(u){return r.description=u}),bt(20,"      "),Ne()(),ke(21,"h2",4),bt(22,"Image URL (optional)"),Ne(),ke(23,"div",7)(24,"input",13,14),ft("keyup.enter",function(){return r.onSubmit()})("ngModelChange",function(u){return r.url=u}),Ne()(),ke(26,"div",15)(27,"div",16)(28,"button",17),ft("click",function(){return r.onClose()}),bt(29,"Cancel"),Ne()(),ke(30,"div",16)(31,"button",18),ft("click",function(){return r.onSubmit()}),bt(32),Ne()()()()()),2&t&&(ot("ngClass",Cs(9,j4,r.shouldHide)),ct(7),ot("ngIf",r.errorMessage),ct(2),ot("ngModel",r.capital),ct(4),ot("ngModel",r.country),ct(5),ot("ngModel",r.description),ct(6),ot("ngModel",r.url),ct(4),ot("disabled",r.loading),ct(3),ot("disabled",r.loading),ct(1),Yr(" ",r.loading?r.loadingText:"Submit"," "))},dependencies:[np,ip,cp,H_,am],styles:[".container-main[_ngcontent-%COMP%]{position:fixed;top:85px;left:0;right:0;width:100vw!important;height:100vh;background-color:#64646400;-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);z-index:20}.container-main.hide[_ngcontent-%COMP%]{transition:opacity .3s ease-out;opacity:0}.dialog[_ngcontent-%COMP%]{position:relative;margin:45px auto 0;width:400px;padding:20px 20px 85px;border-radius:1rem;background-color:#fff9;border:white 3px solid;box-shadow:#0000001a 0 4px 12px}.description[_ngcontent-%COMP%]{height:130px;border-radius:1rem!important;overflow-y:scroll}h2[_ngcontent-%COMP%]{font-size:1.2rem}@media (max-width: 768px){.dialog[_ngcontent-%COMP%]{width:350px}}.input-group[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{border-radius:2rem;outline:none!important}.btn[_ngcontent-%COMP%]{width:100%;border-radius:2rem}.text-failure[_ngcontent-%COMP%]{color:#cc2e2e;font-weight:800;animation:_ngcontent-%COMP%_pulse 1s infinite}.row-buttons[_ngcontent-%COMP%]{background-color:#fff6;border-radius:2rem;width:50%;box-sizing:inherit;border:3px white solid;position:absolute;right:20px}.btn-cancel[_ngcontent-%COMP%]:hover{font-weight:600;transition:.1s}.btn-cancel[disabled][_ngcontent-%COMP%]{border:none}@keyframes _ngcontent-%COMP%_pulse{0%{opacity:1}50%{opacity:.5}to{opacity:1}}"]}),e})(),G4=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=Vi({type:e,bootstrap:[T3]}),e.\u0275inj=fi({imports:[gF,b3,A5,Tz,IN,m3]}),e})();(function od(e,n,t){const r=e.\u0275cmp;r.directiveDefs=Sl(n,!1),r.pipeDefs=Sl(t,!0)})(_w,[np,A_,ip,LA,sD,lD,x5,H4],[]),mF().bootstrapModule(G4).catch(e=>console.error(e))},898:function(pm){pm.exports=function(){"use strict";var mu,gu,oi;function $h(p,je){if(mu)if(gu){var Yo="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+mu+")(sharedChunk); ("+gu+")(sharedChunk); self.onerror = null;",co={};mu(co),oi=je(co),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(oi.workerUrl=window.URL.createObjectURL(new Blob([Yo],{type:"text/javascript"})))}else gu=je;else mu=je}return $h(0,function(p){var je=typeof self<"u"?self:{},Yo="2.15.0";let co;const Jt={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==co){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{co=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{co=o}}return co},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Jt.API_URL)return null;try{const o=new URL(Jt.API_URL);return"api.mapbox.cn"===o.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===o.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Xt={supported:!1,testSupport:function(o){!Mo&&Rr&&(Ts?cc(o):Ni=o)}};let Ni,Rr,Mo=!1,Ts=!1;function cc(o){const i=o.createTexture();o.bindTexture(o.TEXTURE_2D,i);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,Rr),o.isContextLost())return;Xt.supported=!0}catch{}o.deleteTexture(i),Mo=!0}je.document&&(Rr=je.document.createElement("img"),Rr.onload=function(){Ni&&cc(Ni),Ni=null,Ts=!0},Rr.onerror=function(){Mo=!0,Ni=null},Rr.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const gl="01";function eo(o){return o&&o.__esModule&&Object.prototype.hasOwnProperty.call(o,"default")?o.default:o}var uo=Wr;function Wr(o,i,s,c){this.cx=3*o,this.bx=3*(s-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*i,this.by=3*(c-i)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=i,this.p2x=s,this.p2y=c}Wr.prototype={sampleCurveX:function(o){return((this.ax*o+this.bx)*o+this.cx)*o},sampleCurveY:function(o){return((this.ay*o+this.by)*o+this.cy)*o},sampleCurveDerivativeX:function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},solveCurveX:function(o,i){if(void 0===i&&(i=1e-6),o<0)return 0;if(o>1)return 1;for(var s=o,c=0;c<8;c++){var d=this.sampleCurveX(s)-o;if(Math.abs(d)<i)return s;var m=this.sampleCurveDerivativeX(s);if(Math.abs(m)<1e-6)break;s-=d/m}var y=0,x=1;for(s=o,c=0;c<20&&(d=this.sampleCurveX(s),!(Math.abs(d-o)<i));c++)o>d?y=s:x=s,s=.5*(x-y)+y;return s},solve:function(o,i){return this.sampleCurveY(this.solveCurveX(o,i))}};var Pa=eo(uo),Ms=Do;function Do(o,i){this.x=o,this.y=i}Do.prototype={clone:function(){return new Do(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,i){return this.clone()._rotateAround(o,i)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var i=o.x-this.x,s=o.y-this.y;return i*i+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,i){return Math.atan2(this.x*i-this.y*o,this.x*o+this.y*i)},_matMult:function(o){var i=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=i,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var i=Math.cos(o),s=Math.sin(o),c=s*this.x+i*this.y;return this.x=i*this.x-s*this.y,this.y=c,this},_rotateAround:function(o,i){var s=Math.cos(o),c=Math.sin(o),d=i.y+c*(this.x-i.x)+s*(this.y-i.y);return this.x=i.x+s*(this.x-i.x)-c*(this.y-i.y),this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Do.convert=function(o){return o instanceof Do?o:Array.isArray(o)?new Do(o[0],o[1]):o};var lt=eo(Ms);const qh=Math.PI/180,Ra=180/Math.PI;function sn(o){return o*qh}function qi(o){return o*Ra}const uc=[[0,0],[1,0],[1,1],[0,1]];function _u(o){if(o<=0)return 0;if(o>=1)return 1;const i=o*o,s=i*o;return 4*(o<.5?s:3*(o-i)+s-.75)}function Oa(o,i,s,c){const d=new Pa(o,i,s,c);return function(m){return d.solve(m)}}const es=Oa(.25,.1,.25,1);function un(o,i,s){return Math.min(s,Math.max(i,o))}function Fa(o,i,s){return(s=un((s-o)/(i-o),0,1))*s*(3-2*s)}function fn(o,i,s){const c=s-i,d=((o-i)%c+c)%c+i;return d===i?s:d}function zi(o,i,s){if(!o.length)return s(null,[]);let c=o.length;const d=new Array(o.length);let m=null;o.forEach((y,x)=>{i(y,(E,C)=>{E&&(m=E),d[x]=C,0==--c&&s(m,d)})})}function ta(o){const i=[];for(const s in o)i.push(o[s]);return i}function Ii(o,...i){for(const s of i)for(const c in s)o[c]=s[c];return o}let na=1;function rr(){return na++}function Ds(){return function o(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function ts(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function pi(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function ei(o,i){o.forEach(s=>{i[s]&&(i[s]=i[s].bind(i))})}function _l(o,i){return-1!==o.indexOf(i,o.length-i.length)}function ht(o,i,s){const c={};for(const d in o)c[d]=i.call(s||this,o[d],d,o);return c}function ia(o,i,s){const c={};for(const d in o)i.call(s||this,o[d],d,o)&&(c[d]=o[d]);return c}function ho(o){return Array.isArray(o)?o.map(ho):"object"==typeof o&&o?ht(o,ho):o}const yl={};function ci(o){yl[o]||(typeof console<"u"&&console.warn(o),yl[o]=!0)}function So(o,i,s){return(s.y-o.y)*(i.x-o.x)>(i.y-o.y)*(s.x-o.x)}function Wh(o){let i=0;for(let s,c,d=0,m=o.length,y=m-1;d<m;y=d++)s=o[d],c=o[y],i+=(c.x-s.x)*(s.y+c.y);return i}function ra(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function po(o){const i={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,d,m)=>{const y=d||m;return i[c]=!y||y.toLowerCase(),""}),i["max-age"]){const s=parseInt(i["max-age"],10);isNaN(s)?delete i["max-age"]:i["max-age"]=s}return i}let yu=null;function hc(o){if(null==yu){const i=o.navigator?o.navigator.userAgent:null;yu=!!o.safari||!(!i||!(/\b(iPad|iPhone|iPod)\b/.test(i)||i.match("Safari")&&!i.match("Chrome")))}return yu}function vu(o){try{const i=je[o];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}}function oa(o,i){return[o[4*i],o[4*i+1],o[4*i+2],o[4*i+3]]}const dc="mapbox-tiles";let to,sa,pc=500,Zh=50;function Au(){try{return je.caches}catch{}}function vl(){Au()&&!to&&(to=je.caches.open(dc))}function fc(o){const i=o.indexOf("?");if(i<0)return o;const c=function(d){const m=d.indexOf("?");return m>0?d.slice(m+1).split("&"):[]}(o).filter(d=>{const m=d.split("=");return"language"===m[0]||"worldview"===m[0]});return c.length?`${o.slice(0,i)}?${c.join("&")}`:o.slice(0,i)}let ko=1/0;const La={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(La);class Ba extends Error{constructor(i,s,c){401===s&&Ee(c)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Na=ra()?()=>self.worker&&self.worker.referrer:()=>("blob:"===je.location.protocol?je.parent:je).location.href,Al=function(o,i){if(!(/^file:/.test(s=o.url)||/^file:/.test(Na())&&!/^\w+:/.test(s))){if(je.fetch&&je.Request&&je.AbortController&&je.Request.prototype.hasOwnProperty("signal"))return function(c,d){const m=new je.AbortController,y=new je.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:Na(),referrerPolicy:c.referrerPolicy,signal:m.signal});let x=!1,E=!1;const C=(D=y.url).indexOf("sku=")>0&&Ee(D);var D;"json"===c.type&&y.headers.set("Accept","application/json");const P=(B,N,U)=>{if(E)return;if(B&&"SecurityError"!==B.message&&ci(B.toString()),N&&U)return R(N);const q=Date.now();je.fetch(y).then(Y=>{if(Y.ok){const ae=C?Y.clone():null;return R(Y,ae,q)}return d(new Ba(Y.statusText,Y.status,c.url))}).catch(Y=>{"AbortError"!==Y.name&&d(new Error(`${Y.message} ${c.url}`))})},R=(B,N,U)=>{("arrayBuffer"===c.type?B.arrayBuffer():"json"===c.type?B.json():B.text()).then(q=>{E||(N&&U&&function(Y,ae,J){if(vl(),!to)return;const oe={status:ae.status,statusText:ae.statusText,headers:new je.Headers};ae.headers.forEach((xe,we)=>oe.headers.set(we,xe));const ue=po(ae.headers.get("Cache-Control")||"");if(ue["no-store"])return;ue["max-age"]&&oe.headers.set("Expires",new Date(J+1e3*ue["max-age"]).toUTCString());const ce=oe.headers.get("Expires");ce&&(new Date(ce).getTime()-J<42e4||function(xe,we){if(void 0===sa)try{new Response(new ReadableStream),sa=!0}catch{sa=!1}sa?we(xe.body):xe.blob().then(we)}(ae,xe=>{const we=new je.Response(xe,oe);vl(),to&&to.then(Oe=>Oe.put(fc(Y.url),we)).catch(Oe=>ci(Oe.message))}))}(y,N,U),x=!0,d(null,q,B.headers.get("Cache-Control"),B.headers.get("Expires")))}).catch(q=>{E||d(new Error(q.message))})};return C?function(B,N){if(vl(),!to)return N(null);const U=fc(B.url);to.then(q=>{q.match(U).then(Y=>{const ae=function(J){if(!J)return!1;const oe=new Date(J.headers.get("Expires")||0),ue=po(J.headers.get("Cache-Control")||"");return oe>Date.now()&&!ue["no-cache"]}(Y);q.delete(U),ae&&q.put(U,Y.clone()),N(null,Y,ae)}).catch(N)}).catch(N)}(y,P):P(null,null),{cancel:()=>{E=!0,x||m.abort()}}}(o,i);if(ra()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,i,void 0,!0)}var s;return function(c,d){const m=new je.XMLHttpRequest;m.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(m.responseType="arraybuffer");for(const y in c.headers)m.setRequestHeader(y,c.headers[y]);return"json"===c.type&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials="include"===c.credentials,m.onerror=()=>{d(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||0===m.status)&&null!==m.response){let y=m.response;if("json"===c.type)try{y=JSON.parse(m.response)}catch(x){return d(x)}d(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else d(new Ba(m.statusText,m.status,c.url))},m.send(c.body),{cancel:()=>m.abort()}}(o,i)},xl=function(o,i){return Al(Ii(o,{type:"arrayBuffer"}),i)};function Qh(o){const i=je.document.createElement("a");return i.href=o,i.protocol===je.document.location.protocol&&i.host===je.document.location.host}const le="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let H,G;H=[],G=0;const re=function(o,i){if(Xt.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),G>=Jt.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:o,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return H.push(m),m}G++;let s=!1;const c=()=>{if(!s)for(s=!0,G--;H.length&&G<Jt.MAX_PARALLEL_IMAGE_REQUESTS;){const m=H.shift(),{requestParameters:y,callback:x,cancelled:E}=m;E||(m.cancel=re(y,x).cancel)}},d=xl(o,(m,y,x,E)=>{c(),m?i(m):y&&(je.createImageBitmap?function(C,D){const P=new je.Blob([new Uint8Array(C)],{type:"image/png"});je.createImageBitmap(P).then(R=>{D(null,R)}).catch(R=>{D(new Error(`Could not load image because of ${R.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(C,D)=>i(C,D,x,E)):function(C,D){const P=new je.Image,R=je.URL;P.onload=()=>{D(null,P),R.revokeObjectURL(P.src),P.onload=null,je.requestAnimationFrame(()=>{P.src=le})},P.onerror=()=>D(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const B=new je.Blob([new Uint8Array(C)],{type:"image/png"});P.src=C.byteLength?R.createObjectURL(B):le}(y,(C,D)=>i(C,D,x,E)))});return{cancel:()=>{d.cancel(),c()}}},de="NO_ACCESS_TOKEN";function _e(o){return 0===o.indexOf("mapbox:")}function Ee(o){return Jt.API_URL_REGEX.test(o)}function be(o){return Jt.API_CDN_URL_REGEX.test(o)}function ge(o){return Jt.API_STYLE_REGEX.test(o)&&!Pe(o)}function Pe(o){return Jt.API_SPRITE_REGEX.test(o)}const rt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function at(o){const i=o.match(rt);if(!i)throw new Error("Unable to parse URL object");return{protocol:i[1],authority:i[2],path:i[3]||"/",params:i[4]?i[4].split("&"):[]}}function tt(o){const i=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${i}`}const Ht="mapbox.eventData";function Ot(o){if(!o)return null;const i=o.split(".");if(!i||3!==i.length)return null;try{return JSON.parse(decodeURIComponent(je.atob(i[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class qt{constructor(i){this.type=i,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(i){const s=Ot(Jt.ACCESS_TOKEN);let c="";return c=s&&s.u?je.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(d,m)=>String.fromCharCode(Number("0x"+m)))):Jt.ACCESS_TOKEN||"",i?`${Ht}.${i}:${c}`:`${Ht}:${c}`}fetchEventData(){const i=vu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{const d=je.localStorage.getItem(s);d&&(this.eventData=JSON.parse(d));const m=je.localStorage.getItem(c);m&&(this.anonId=m)}catch{ci("Unable to read from LocalStorage")}}saveEventData(){const i=vu("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(i)try{je.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&je.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{ci("Unable to write to LocalStorage")}}processRequests(i){}postEvent(i,s,c,d){if(!Jt.EVENTS_URL)return;const m=at(Jt.EVENTS_URL);m.params.push(`access_token=${d||Jt.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(i).toISOString()},x=s?Ii(y,s):y,E={url:tt(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([x])};var D;this.pendingRequest=(D=C=>{this.pendingRequest=null,c(C),this.saveEventData(),this.processRequests(d)},Al(Ii(E,{method:"POST"}),D))}queueRequest(i,s){this.queue.push(i),this.processRequests(s)}}const rn=new class extends qt{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,i){Jt.EVENTS_URL&&Jt.ACCESS_TOKEN&&Array.isArray(o)&&o.some(s=>_e(s)||Ee(s))&&this.queueRequest(Date.now(),i)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const i=Ot(Jt.ACCESS_TOKEN),s=i?i.u:Jt.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;pi(this.anonId)||(this.anonId=Ds(),c=!0);const d=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(d),x=(d-this.eventData.lastSuccess)/864e5;c=c||x>=1||x<-1||m.getDate()!==y.getDate()}else c=!0;c?this.postEvent(d,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Yo,skuId:gl,"enabled.telemetry":!1,userId:this.anonId},m=>{m||(this.eventData.lastSuccess=d,this.eventData.tokenU=s)},o):this.processRequests()}},mn=rn.postTurnstileEvent.bind(rn),si=new class extends qt{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,i,s,c){this.skuToken=i,this.errorCb=c,Jt.EVENTS_URL&&(s||Jt.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(de)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:s}=this.queue.shift();i&&this.success[i]||(this.anonId||this.fetchEventData(),pi(this.anonId)||(this.anonId=Ds()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Yo,skuId:gl,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):i&&(this.success[i]=!0)},o))}},Ai=si.postMapLoadEvent.bind(si),gr=new class extends qt{constructor(){super("gljs.performance")}postPerformanceEvent(o,i){Jt.EVENTS_URL&&(o||Jt.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:i},o)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:i,performanceData:s}=this.queue.shift(),c=function(d){const m=je.performance.getEntriesByType("resource"),y=je.performance.getEntriesByType("mark"),x=function(R){const B={};if(R)for(const N in R)if("other"!==N)for(const U of R[N]){const q=`${N}ResolveRangeMin`,Y=`${N}ResolveRangeMax`,ae=`${N}RequestCount`,J=`${N}RequestCachedCount`;B[q]=Math.min(B[q]||1/0,U.startTime),B[Y]=Math.max(B[Y]||-1/0,U.responseEnd);const oe=ue=>{void 0===B[ue]&&(B[ue]=0),++B[ue]};void 0!==U.transferSize&&0===U.transferSize&&oe(J),oe(ae)}return B}(function(R,B){const N={};if(R)for(const U of R){const q=B(U);void 0===N[q]&&(N[q]=[]),N[q].push(U)}return N}(m,mm)),E=je.devicePixelRatio,C=je.navigator.connection||je.navigator.mozConnection||je.navigator.webkitConnection,D={counters:[],metadata:[],attributes:[]},P=(R,B,N)=>{null!=N&&R.push({name:B,value:N.toString()})};for(const R in x)P(D.counters,R,x[R]);if(d.interactionRange[0]!==1/0&&d.interactionRange[1]!==-1/0&&(P(D.counters,"interactionRangeMin",d.interactionRange[0]),P(D.counters,"interactionRangeMax",d.interactionRange[1])),y)for(const R of Object.keys(Po)){const B=Po[R],N=y.find(U=>U.name===B);N&&P(D.counters,B,N.startTime)}return P(D.counters,"visibilityHidden",d.visibilityHidden),P(D.attributes,"style",function(R){if(R)for(const B of R){const N=B.name.split("?")[0];if(ge(N)){const U=N.split("/").slice(-2);if(2===U.length)return`mapbox://styles/${U[0]}/${U[1]}`}}}(m)),P(D.attributes,"terrainEnabled",d.terrainEnabled?"true":"false"),P(D.attributes,"fogEnabled",d.fogEnabled?"true":"false"),P(D.attributes,"projection",d.projection),P(D.attributes,"zoom",d.zoom),P(D.metadata,"devicePixelRatio",E),P(D.metadata,"connectionEffectiveType",C?C.effectiveType:void 0),P(D.metadata,"navigatorUserAgent",je.navigator.userAgent),P(D.metadata,"screenWidth",je.screen.width),P(D.metadata,"screenHeight",je.screen.height),P(D.metadata,"windowWidth",je.innerWidth),P(D.metadata,"windowHeight",je.innerHeight),P(D.metadata,"mapWidth",d.width/E),P(D.metadata,"mapHeight",d.height/E),P(D.metadata,"webglRenderer",d.renderer),P(D.metadata,"webglVendor",d.vendor),P(D.metadata,"sdkVersion",Yo),P(D.metadata,"sdkIdentifier","mapbox-gl-js"),D}(s);for(const d of c.metadata);for(const d of c.counters);for(const d of c.attributes);this.postEvent(i,c,()=>{},o)}},Oi=gr.postPerformanceEvent.bind(gr),Wi=new class extends qt{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,i,s,c){if(!Jt.API_URL||!Jt.SESSION_PATH)return;const d=at(Jt.API_URL+Jt.SESSION_PATH);d.params.push(`sku=${i||""}`),d.params.push(`access_token=${c||Jt.ACCESS_TOKEN||""}`);const m={url:tt(d),headers:{"Content-Type":"text/plain"}};var x;this.pendingRequest=(x=y=>{this.pendingRequest=null,s(y),this.saveEventData(),this.processRequests(c)},Al(Ii(m,{method:"GET"}),x))}getSessionAPI(o,i,s,c){this.skuToken=i,this.errorCb=c,Jt.SESSION_PATH&&Jt.API_URL&&(s||Jt.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(de)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:i,timestamp:s}=this.queue.shift();i&&this.success[i]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):i&&(this.success[i]=!0)},o)}},Zi=Wi.getSessionAPI.bind(Wi),Vn=new Set,Po={create:"create",load:"load",fullLoad:"fullLoad"},ns={mark(o){je.performance.mark(o)},measure(o,i,s){je.performance.measure(o,i,s)}};function mm(o){const i=o.name.split("?")[0];return be(i)&&i.includes("mapbox-gl.js")?"javascript":be(i)&&i.includes("mapbox-gl.css")?"css":Jt.API_FONTS_REGEX.test(i)?"fontRange":Pe(i)?"sprite":ge(i)?"style":Jt.API_TILEJSON_REGEX.test(i)?"tilejson":"other"}const Dn=je.performance;function Xh(o){const i=o?o.url.toString():void 0;return Dn.getEntriesByName(i)}let za,xu,aa,is;const rs={now:()=>void 0!==aa?aa:je.performance.now(),setNow(o){aa=o},restoreNow(){aa=void 0},frame(o){const i=je.requestAnimationFrame(o);return{cancel:()=>je.cancelAnimationFrame(i)}},getImageData(o,i=0){const{width:s,height:c}=o;is||(is=je.document.createElement("canvas"));const d=is.getContext("2d",{willReadFrequently:!0});if(!d)throw new Error("failed to create canvas 2d context");return(s>is.width||c>is.height)&&(is.width=s,is.height=c),d.clearRect(-i,-i,s+2*i,c+2*i),d.drawImage(o,0,0,s,c),d.getImageData(-i,-i,s+2*i,c+2*i)},resolveURL:o=>(za||(za=je.document.createElement("a")),za.href=o,za.href),get devicePixelRatio(){return je.devicePixelRatio},get prefersReducedMotion(){return!!je.matchMedia&&(null==xu&&(xu=je.matchMedia("(prefers-reduced-motion: reduce)")),xu.matches)}};function bu(o,i,s){s[o]&&-1!==s[o].indexOf(i)||(s[o]=s[o]||[],s[o].push(i))}function Kh(o,i,s){if(s&&s[o]){const c=s[o].indexOf(i);-1!==c&&s[o].splice(c,1)}}class Va{constructor(i,s={}){Ii(this,s),this.type=i}}class Ss extends Va{constructor(i,s={}){super("error",Ii({error:i},s))}}class mc{on(i,s){return this._listeners=this._listeners||{},bu(i,s,this._listeners),this}off(i,s){return Kh(i,s,this._listeners),Kh(i,s,this._oneTimeListeners),this}once(i,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},bu(i,s,this._oneTimeListeners),this):new Promise(c=>this.once(i,c))}fire(i,s){"string"==typeof i&&(i=new Va(i,s||{}));const c=i.type;if(this.listens(c)){i.target=this;const d=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const x of d)x.call(this,i);const m=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const x of m)Kh(c,x,this._oneTimeListeners),x.call(this,i);const y=this._eventedParent;y&&(Ii(i,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(i))}else i instanceof Ss&&console.error(i.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,s){return this._eventedParent=i,this._eventedParentData=s,this}}var Fe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function ks(o,...i){for(const s of i)for(const c in s)o[c]=s[c];return o}function Ti(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function xn(o){if(Array.isArray(o))return o.map(xn);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const i={};for(const s in o)i[s]=xn(o[s]);return i}return Ti(o)}class pp extends Error{constructor(i,s){super(s),this.message=s,this.key=i}}var Ro=pp;class gc{constructor(i,s=[]){this.parent=i,this.bindings={};for(const[c,d]of s)this.bindings[c]=d}concat(i){return new gc(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}var Xn=gc;const la={kind:"null"},et={kind:"number"},an={kind:"string"},ln={kind:"boolean"},vn={kind:"color"},Pt={kind:"object"},Yt={kind:"value"},Or={kind:"collator"},wu={kind:"formatted"},os={kind:"resolvedImage"};function st(o,i){return{kind:"array",itemType:o,N:i}}function Zn(o){if("array"===o.kind){const i=Zn(o.itemType);return"number"==typeof o.N?`array<${i}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${i}>`}return o.kind}const en=[la,et,an,ln,vn,wu,Pt,st(Yt),os];function An(o,i){if("error"===i.kind)return null;if("array"===o.kind){if("array"===i.kind&&(0===i.N&&"value"===i.itemType.kind||!An(o.itemType,i.itemType))&&("number"!=typeof o.N||o.N===i.N))return null}else{if(o.kind===i.kind)return null;if("value"===o.kind)for(const s of en)if(!An(s,i))return null}return`Expected ${Zn(o)} but found ${Zn(i)} instead.`}function _c(o,i){return i.some(s=>s.kind===o.kind)}function Eu(o,i){return i.some(s=>"null"===s?null===o:"array"===s?Array.isArray(o):"object"===s?o&&!Array.isArray(o)&&"object"==typeof o:s===typeof o)}var Jh,yc={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function or(o){return(o=Math.round(o))<0?0:o>255?255:o}function Cu(o){return or("%"===o[o.length-1]?parseFloat(o)/100*255:parseInt(o))}function Iu(o){return(i="%"===o[o.length-1]?parseFloat(o)/100:parseFloat(o))<0?0:i>1?1:i;var i}function vc(o,i,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?o+(i-o)*s*6:2*s<1?i:3*s<2?o+(i-o)*(2/3-s)*6:o}try{Jh={}.parseCSSColor=function(o){var i,s=o.replace(/ /g,"").toLowerCase();if(s in yc)return yc[s].slice();if("#"===s[0])return 4===s.length?(i=parseInt(s.substr(1),16))>=0&&i<=4095?[(3840&i)>>4|(3840&i)>>8,240&i|(240&i)>>4,15&i|(15&i)<<4,1]:null:7===s.length&&(i=parseInt(s.substr(1),16))>=0&&i<=16777215?[(16711680&i)>>16,(65280&i)>>8,255&i,1]:null;var c=s.indexOf("("),d=s.indexOf(")");if(-1!==c&&d+1===s.length){var m=s.substr(0,c),y=s.substr(c+1,d-(c+1)).split(","),x=1;switch(m){case"rgba":if(4!==y.length)return null;x=Iu(y.pop());case"rgb":return 3!==y.length?null:[Cu(y[0]),Cu(y[1]),Cu(y[2]),x];case"hsla":if(4!==y.length)return null;x=Iu(y.pop());case"hsl":if(3!==y.length)return null;var E=(parseFloat(y[0])%360+360)%360/360,C=Iu(y[1]),D=Iu(y[2]),P=D<=.5?D*(C+1):D+C-D*C,R=2*D-P;return[or(255*vc(R,P,E+1/3)),or(255*vc(R,P,E)),or(255*vc(R,P,E-1/3)),x];default:return null}}return null}}catch{}class Mi{constructor(i,s,c,d=1){this.r=i,this.g=s,this.b=c,this.a=d}static parse(i){if(!i)return;if(i instanceof Mi)return i;if("string"!=typeof i)return;const s=Jh(i);return s?new Mi(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[i,s,c,d]=this.toArray();return`rgba(${Math.round(i)},${Math.round(s)},${Math.round(c)},${d})`}toArray(){const{r:i,g:s,b:c,a:d}=this;return 0===d?[0,0,0,0]:[255*i/d,255*s/d,255*c/d,d]}toArray01(){const{r:i,g:s,b:c,a:d}=this;return 0===d?[0,0,0,0]:[i/d,s/d,c/d,d]}toArray01PremultipliedAlpha(){const{r:i,g:s,b:c,a:d}=this;return[i,s,c,d]}}Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0),Mi.red=new Mi(1,0,0,1),Mi.blue=new Mi(0,0,1,1);var Di=Mi;class fp{constructor(i,s,c){this.sensitivity=i?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,s){return this.collator.compare(i,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class mp{constructor(i,s,c,d,m){this.text=i.normalize?i.normalize():i,this.image=s,this.scale=c,this.fontStack=d,this.textColor=m}}class no{constructor(i){this.sections=i}static fromString(i){return new no([new mp(i,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(i=>0!==i.text.length||i.image&&0!==i.image.name.length)}static factory(i){return i instanceof no?i:no.fromString(i)}toString(){return 0===this.sections.length?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const s of this.sections){if(s.image){i.push(["image",s.image.name]);continue}i.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),i.push(c)}return i}}class fo{constructor(i){this.name=i.name,this.available=i.available}toString(){return this.name}static fromString(i){return i?new fo({name:i,available:!1}):null}serialize(){return["image",this.name]}}function gm(o,i,s,c){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof i&&i>=0&&i<=255&&"number"==typeof s&&s>=0&&s<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:`Invalid rgba value [${[o,i,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof c?[o,i,s,c]:[o,i,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ac(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof Di||o instanceof fp||o instanceof no||o instanceof fo)return!0;if(Array.isArray(o)){for(const i of o)if(!Ac(i))return!1;return!0}if("object"==typeof o){for(const i in o)if(!Ac(o[i]))return!1;return!0}return!1}function xi(o){if(null===o)return la;if("string"==typeof o)return an;if("boolean"==typeof o)return ln;if("number"==typeof o)return et;if(o instanceof Di)return vn;if(o instanceof fp)return Or;if(o instanceof no)return wu;if(o instanceof fo)return os;if(Array.isArray(o)){const i=o.length;let s;for(const c of o){const d=xi(c);if(s){if(s===d)continue;s=Yt;break}s=d}return st(s||Yt,i)}return Pt}function _r(o){const i=typeof o;return null===o?"":"string"===i||"number"===i||"boolean"===i?String(o):o instanceof Di||o instanceof no||o instanceof fo?o.toString():JSON.stringify(o)}class Nn{constructor(i,s){this.type=i,this.value=s}static parse(i,s){if(2!==i.length)return s.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!Ac(i[1]))return s.error("invalid value");const c=i[1];let d=xi(c);const m=s.expectedType;return"array"!==d.kind||0!==d.N||!m||"array"!==m.kind||"number"==typeof m.N&&0!==m.N||(d=m),new Nn(d,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Di?["rgba"].concat(this.value.toArray()):this.value instanceof no?this.value.serialize():this.value}}var bl=Nn,yr=class{constructor(o){this.name="ExpressionEvaluationError",this.message=o}toJSON(){return this.message}};const gp={string:an,number:et,boolean:ln,object:Pt};class Tt{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");let c,d=1;const m=i[0];if("array"===m){let x,E;if(i.length>2){const C=i[1];if("string"!=typeof C||!(C in gp)||"object"===C)return s.error('The item type argument of "array" must be one of string, number, boolean',1);x=gp[C],d++}else x=Yt;if(i.length>3){if(null!==i[2]&&("number"!=typeof i[2]||i[2]<0||i[2]!==Math.floor(i[2])))return s.error('The length argument to "array" must be a positive integer literal',2);E=i[2],d++}c=st(x,E)}else c=gp[m];const y=[];for(;d<i.length;d++){const x=s.parse(i[d],d,Yt);if(!x)return null;y.push(x)}return new Tt(c,y)}evaluate(i){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(i);if(!An(this.type,xi(c)))return c;if(s===this.args.length-1)throw new yr(`Expected value to be of type ${Zn(this.type)}, but found ${Zn(xi(c))} instead.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,s=[i.kind];if("array"===i.kind){const c=i.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){s.push(c.kind);const d=i.N;("number"==typeof d||this.args.length>1)&&s.push(d)}}return s.concat(this.args.map(c=>c.serialize()))}}var ca=Tt;class fi{constructor(i){this.type=wu,this.sections=i}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const c=i[1];if(!Array.isArray(c)&&"object"==typeof c)return s.error("First argument must be an image or text section.");const d=[];let m=!1;for(let y=1;y<=i.length-1;++y){const x=i[y];if(m&&"object"==typeof x&&!Array.isArray(x)){m=!1;let E=null;if(x["font-scale"]&&(E=s.parse(x["font-scale"],1,et),!E))return null;let C=null;if(x["text-font"]&&(C=s.parse(x["text-font"],1,st(an)),!C))return null;let D=null;if(x["text-color"]&&(D=s.parse(x["text-color"],1,vn),!D))return null;const P=d[d.length-1];P.scale=E,P.font=C,P.textColor=D}else{const E=s.parse(i[y],1,Yt);if(!E)return null;const C=E.type.kind;if("string"!==C&&"value"!==C&&"null"!==C&&"resolvedImage"!==C)return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,d.push({content:E,scale:null,font:null,textColor:null})}}return new fi(d)}evaluate(i){return new no(this.sections.map(s=>{const c=s.content.evaluate(i);return xi(c)===os?new mp("",c,null,null,null):new mp(_r(c),null,s.scale?s.scale.evaluate(i):null,s.font?s.font.evaluate(i).join(","):null,s.textColor?s.textColor.evaluate(i):null)}))}eachChild(i){for(const s of this.sections)i(s.content),s.scale&&i(s.scale),s.font&&i(s.font),s.textColor&&i(s.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const s of this.sections){i.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),i.push(c)}return i}}class Ua{constructor(i){this.type=os,this.input=i}static parse(i,s){if(2!==i.length)return s.error("Expected two arguments.");const c=s.parse(i[1],1,an);return c?new Ua(c):s.error("No image name provided.")}evaluate(i){const s=this.input.evaluate(i),c=fo.fromString(s);return c&&i.availableImages&&(c.available=i.availableImages.indexOf(s)>-1),c}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const _m={"to-boolean":ln,"to-color":vn,"to-number":et,"to-string":an};class Tu{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expected at least one argument.");const c=i[0];if(("to-boolean"===c||"to-string"===c)&&2!==i.length)return s.error("Expected one argument.");const d=_m[c],m=[];for(let y=1;y<i.length;y++){const x=s.parse(i[y],y,Yt);if(!x)return null;m.push(x)}return new Tu(d,m)}evaluate(i){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(i));if("color"===this.type.kind){let s,c;for(const d of this.args){if(s=d.evaluate(i),c=null,s instanceof Di)return s;if("string"==typeof s){const m=i.parseColor(s);if(m)return m}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:gm(s[0],s[1],s[2],s[3]),!c))return new Di(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new yr(c||`Could not parse color from value '${"string"==typeof s?s:String(JSON.stringify(s))}'`)}if("number"===this.type.kind){let s=null;for(const c of this.args){if(s=c.evaluate(i),null===s)return 0;const d=Number(s);if(!isNaN(d))return d}throw new yr(`Could not convert ${JSON.stringify(s)} to number.`)}return"formatted"===this.type.kind?no.fromString(_r(this.args[0].evaluate(i))):"resolvedImage"===this.type.kind?fo.fromString(_r(this.args[0].evaluate(i))):_r(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if("formatted"===this.type.kind)return new fi([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new Ua(this.args[0]).serialize();const i=[`to-${this.type.kind}`];return this.eachChild(s=>{i.push(s.serialize())}),i}}var wl=Tu;const ss=["Unknown","Point","LineString","Polygon"];var Mu=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?ss[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const o=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*i-o[0])+this.featureDistanceData.bearing[1]*(c*i-o[1])}return 0}parseColor(o){let i=this._parseColorCache[o];return i||(i=this._parseColorCache[o]=Di.parse(o)),i}};class as{constructor(i,s,c,d){this.name=i,this.type=s,this._evaluate=c,this.args=d}evaluate(i){return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,s){const c=i[0],d=as.definitions[c];if(!d)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(d)?d[0]:d.type,y=Array.isArray(d)?[[d[1],d[2]]]:d.overloads,x=y.filter(([C])=>!Array.isArray(C)||C.length===i.length-1);let E=null;for(const[C,D]of x){E=new Tl(s.registry,s.path,null,s.scope);const P=[];let R=!1;for(let B=1;B<i.length;B++){const N=i[B],U=Array.isArray(C)?C[B-1]:C.type,q=E.parse(N,1+P.length,U);if(!q){R=!0;break}P.push(q)}if(!R)if(Array.isArray(C)&&C.length!==P.length)E.error(`Expected ${C.length} arguments, but found ${P.length} instead.`);else{for(let B=0;B<P.length;B++){const N=Array.isArray(C)?C[B]:C.type,U=P[B];E.concat(B+1).checkSubtype(N,U.type)}if(0===E.errors.length)return new as(c,m,D,P)}}if(1===x.length)s.errors.push(...E.errors);else{const C=(x.length?x:y).map(([P])=>{return R=P,Array.isArray(R)?`(${R.map(Zn).join(", ")})`:`(${Zn(R.type)}...)`;var R}).join(" | "),D=[];for(let P=1;P<i.length;P++){const R=s.parse(i[P],1+D.length);if(!R)return null;D.push(Zn(R.type))}s.error(`Expected arguments of type ${C}, but found (${D.join(", ")}) instead.`)}return null}static register(i,s){as.definitions=s;for(const c in s)i[c]=as}}var Oo=as;class El{constructor(i,s,c){this.type=Or,this.locale=c,this.caseSensitive=i,this.diacriticSensitive=s}static parse(i,s){if(2!==i.length)return s.error("Expected one argument.");const c=i[1];if("object"!=typeof c||Array.isArray(c))return s.error("Collator options argument must be an object.");const d=s.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,ln);if(!d)return null;const m=s.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,ln);if(!m)return null;let y=null;return c.locale&&(y=s.parse(c.locale,1,an),!y)?null:new El(d,m,y)}evaluate(i){return new fp(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}const Ps=8192;function Bt(o,i){o[0]=Math.min(o[0],i[0]),o[1]=Math.min(o[1],i[1]),o[2]=Math.max(o[2],i[0]),o[3]=Math.max(o[3],i[1])}function ua(o,i){return!(o[0]<=i[0]||o[2]>=i[2]||o[1]<=i[1]||o[3]>=i[3])}function xc(o,i){const s=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,d=Math.pow(2,i.z);return[Math.round(s*d*Ps),Math.round(c*d*Ps)]}function io(o,i,s){const c=o[0]-i[0],d=o[1]-i[1],m=o[0]-s[0],y=o[1]-s[1];return c*y-m*d==0&&c*m<=0&&d*y<=0}function bc(o,i){let s=!1;for(let y=0,x=i.length;y<x;y++){const E=i[y];for(let C=0,D=E.length;C<D-1;C++){if(io(o,E[C],E[C+1]))return!1;(d=E[C])[1]>(c=o)[1]!=(m=E[C+1])[1]>c[1]&&c[0]<(m[0]-d[0])*(c[1]-d[1])/(m[1]-d[1])+d[0]&&(s=!s)}}var c,d,m;return s}function _p(o,i){for(let s=0;s<i.length;s++)if(bc(o,i[s]))return!0;return!1}function ti(o,i,s,c){const d=c[0]-s[0],m=c[1]-s[1],y=(o[0]-s[0])*m-d*(o[1]-s[1]),x=(i[0]-s[0])*m-d*(i[1]-s[1]);return y>0&&x<0||y<0&&x>0}function wc(o,i,s){for(const C of s)for(let D=0;D<C.length-1;++D)if((x=[(y=C[D+1])[0]-(m=C[D])[0],y[1]-m[1]])[0]*(E=[(d=i)[0]-(c=o)[0],d[1]-c[1]])[1]-x[1]*E[0]!=0&&ti(c,d,m,y)&&ti(m,y,c,d))return!0;var c,d,m,y,x,E;return!1}function On(o,i){for(let s=0;s<o.length;++s)if(!bc(o[s],i))return!1;for(let s=0;s<o.length-1;++s)if(wc(o[s],o[s+1],i))return!1;return!0}function ny(o,i){for(let s=0;s<i.length;s++)if(On(o,i[s]))return!0;return!1}function ja(o,i,s){const c=[];for(let d=0;d<o.length;d++){const m=[];for(let y=0;y<o[d].length;y++){const x=xc(o[d][y],s);Bt(i,x),m.push(x)}c.push(m)}return c}function Du(o,i,s){const c=[];for(let d=0;d<o.length;d++){const m=ja(o[d],i,s);c.push(m)}return c}function Cl(o,i,s,c){if(o[0]<s[0]||o[0]>s[2]){const d=.5*c;let m=o[0]-s[0]>d?-c:s[0]-o[0]>d?c:0;0===m&&(m=o[0]-s[2]>d?-c:s[2]-o[0]>d?c:0),o[0]+=m}Bt(i,o)}function yp(o,i,s,c){const d=Math.pow(2,c.z)*Ps,m=[c.x*Ps,c.y*Ps],y=[];if(!o)return y;for(const x of o)for(const E of x){const C=[E.x+m[0],E.y+m[1]];Cl(C,i,s,d),y.push(C)}return y}function Yh(o,i,s,c){const d=Math.pow(2,c.z)*Ps,m=[c.x*Ps,c.y*Ps],y=[];if(!o)return y;for(const E of o){const C=[];for(const D of E){const P=[D.x+m[0],D.y+m[1]];Bt(i,P),C.push(P)}y.push(C)}if(i[2]-i[0]<=d/2){(x=i)[0]=x[1]=1/0,x[2]=x[3]=-1/0;for(const E of y)for(const C of E)Cl(C,i,s,d)}var x;return y}class Il{constructor(i,s){this.type=ln,this.geojson=i,this.geometries=s}static parse(i,s){if(2!==i.length)return s.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(Ac(i[1])){const c=i[1];if("FeatureCollection"===c.type)for(let d=0;d<c.features.length;++d){const m=c.features[d].geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new Il(c,c.features[d].geometry)}else if("Feature"===c.type){const d=c.geometry.type;if("Polygon"===d||"MultiPolygon"===d)return new Il(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new Il(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(null!=i.geometry()&&null!=i.canonicalID()){if("Point"===i.geometryType())return function(s,c){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(!y)return!1;if("Polygon"===c.type){const x=ja(c.coordinates,m,y),E=yp(s.geometry(),d,m,y);if(!ua(d,m))return!1;for(const C of E)if(!bc(C,x))return!1}if("MultiPolygon"===c.type){const x=Du(c.coordinates,m,y),E=yp(s.geometry(),d,m,y);if(!ua(d,m))return!1;for(const C of E)if(!_p(C,x))return!1}return!0}(i,this.geometries);if("LineString"===i.geometryType())return function(s,c){const d=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(!y)return!1;if("Polygon"===c.type){const x=ja(c.coordinates,m,y),E=Yh(s.geometry(),d,m,y);if(!ua(d,m))return!1;for(const C of E)if(!On(C,x))return!1}if("MultiPolygon"===c.type){const x=Du(c.coordinates,m,y),E=Yh(s.geometry(),d,m,y);if(!ua(d,m))return!1;for(const C of E)if(!ny(C,x))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ec=Il;function ls(o){if(o instanceof Oo&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof Ec)return!1;let i=!0;return o.eachChild(s=>{i&&!ls(s)&&(i=!1)}),i}function Zr(o){if(o instanceof Oo&&"feature-state"===o.name)return!1;let i=!0;return o.eachChild(s=>{i&&!Zr(s)&&(i=!1)}),i}function Ha(o,i){if(o instanceof Oo&&i.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(c=>{s&&!Ha(c,i)&&(s=!1)}),s}class gt{constructor(i,s){this.type=s.type,this.name=i,this.boundExpression=s}static parse(i,s){if(2!==i.length||"string"!=typeof i[1])return s.error("'var' expression requires exactly one string literal argument.");const c=i[1];return s.scope.has(c)?new gt(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var ed=gt;class Wt{constructor(i,s=[],c,d=new Xn,m=[]){this.registry=i,this.path=s,this.key=s.map(y=>`[${y}]`).join(""),this.scope=d,this.errors=m,this.expectedType=c}parse(i,s,c,d,m={}){return s?this.concat(s,c,d)._parse(i,m):this._parse(i,m)}_parse(i,s){function c(d,m,y){return"assert"===y?new ca(m,[d]):"coerce"===y?new wl(m,[d]):d}if(null!==i&&"string"!=typeof i&&"boolean"!=typeof i&&"number"!=typeof i||(i=["literal",i]),Array.isArray(i)){if(0===i.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const d=i[0];if("string"!=typeof d)return this.error(`Expression name must be a string, but found ${typeof d} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[d];if(m){let y=m.parse(i,this);if(!y)return null;if(this.expectedType){const x=this.expectedType,E=y.type;if("string"!==x.kind&&"number"!==x.kind&&"boolean"!==x.kind&&"object"!==x.kind&&"array"!==x.kind||"value"!==E.kind)if("color"!==x.kind&&"formatted"!==x.kind&&"resolvedImage"!==x.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(x,E))return null}else y=c(y,x,s.typeAnnotation||"coerce");else y=c(y,x,s.typeAnnotation||"assert")}if(!(y instanceof bl)&&"resolvedImage"!==y.type.kind&&Cc(y)){const x=new Mu;try{y=new bl(y.type,y.evaluate(x))}catch(E){return this.error(E.message),null}}return y}return this.error(`Unknown expression "${d}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===i?"'undefined' value invalid. Use null instead.":"object"==typeof i?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,s,c){const d="number"==typeof i?this.path.concat(i):this.path,m=c?this.scope.concat(c):this.scope;return new Wt(this.registry,d,s||null,m,this.errors)}error(i,...s){const c=`${this.key}${s.map(d=>`[${d}]`).join("")}`;this.errors.push(new Ro(c,i))}checkSubtype(i,s){const c=An(i,s);return c&&this.error(c),c}}var Tl=Wt;function Cc(o){if(o instanceof ed)return Cc(o.boundExpression);if(o instanceof Oo&&"error"===o.name||o instanceof El||o instanceof Ec)return!1;const i=o instanceof wl||o instanceof ca;let s=!0;return o.eachChild(c=>{s=i?s&&Cc(c):s&&c instanceof bl}),!!s&&ls(o)&&Ha(o,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ha(o,i){const s=o.length-1;let c,d,m=0,y=s,x=0;for(;m<=y;)if(x=Math.floor((m+y)/2),c=o[x],d=o[x+1],c<=i){if(x===s||i<d)return x;m=x+1}else{if(!(c>i))throw new yr("Input is not a number.");y=x-1}return 0}class Su{constructor(i,s,c){this.type=i,this.input=s,this.labels=[],this.outputs=[];for(const[d,m]of c)this.labels.push(d),this.outputs.push(m)}static parse(i,s){if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(i[1],1,et);if(!c)return null;const d=[];let m=null;s.expectedType&&"value"!==s.expectedType.kind&&(m=s.expectedType);for(let y=1;y<i.length;y+=2){const x=1===y?-1/0:i[y],E=i[y+1],C=y,D=y+1;if("number"!=typeof x)return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',C);if(d.length&&d[d.length-1][0]>=x)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',C);const P=s.parse(E,D,m);if(!P)return null;m=m||P.type,d.push([x,P])}return new Su(m,c,d)}evaluate(i){const s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(i);const d=this.input.evaluate(i);if(d<=s[0])return c[0].evaluate(i);const m=s.length;return d>=s[m-1]?c[m-1].evaluate(i):c[ha(s,d)].evaluate(i)}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&i.push(this.labels[s]),i.push(this.outputs[s].serialize());return i}}var td=Su;function bn(o,i,s){return o*(1-s)+i*s}var ro=Object.freeze({__proto__:null,array:function(o,i,s){return o.map((c,d)=>bn(c,i[d],s))},color:function(o,i,s){return new Di(bn(o.r,i.r,s),bn(o.g,i.g,s),bn(o.b,i.b,s),bn(o.a,i.a,s))},number:bn});const Fo=.95047,mo=1.08883,cs=4/29,wn=6/29,Ml=3*wn*wn,nd=wn*wn*wn,id=Math.PI/180,vp=180/Math.PI;function Lo(o){return o>nd?Math.pow(o,1/3):o/Ml+cs}function Ga(o){return o>wn?o*o*o:Ml*(o-cs)}function rd(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function vr(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function od(o){const i=vr(o.r),s=vr(o.g),c=vr(o.b),d=Lo((.4124564*i+.3575761*s+.1804375*c)/Fo),m=Lo((.2126729*i+.7151522*s+.072175*c)/1);return{l:116*m-16,a:500*(d-m),b:200*(m-Lo((.0193339*i+.119192*s+.9503041*c)/mo)),alpha:o.a}}function Ap(o){let i=(o.l+16)/116,s=isNaN(o.a)?i:i+o.a/500,c=isNaN(o.b)?i:i-o.b/200;return i=1*Ga(i),s=Fo*Ga(s),c=mo*Ga(c),new Di(rd(3.2404542*s-1.5371385*i-.4985314*c),rd(-.969266*s+1.8760108*i+.041556*c),rd(.0556434*s-.2040259*i+1.0572252*c),o.alpha)}function ym(o,i,s){const c=i-o;return o+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const Vi={forward:od,reverse:Ap,interpolate:function(o,i,s){return{l:bn(o.l,i.l,s),a:bn(o.a,i.a,s),b:bn(o.b,i.b,s),alpha:bn(o.alpha,i.alpha,s)}}},Dl={forward:function(o){const{l:i,a:s,b:c}=od(o),d=Math.atan2(c,s)*vp;return{h:d<0?d+360:d,c:Math.sqrt(s*s+c*c),l:i,alpha:o.a}},reverse:function(o){const i=o.h*id,s=o.c;return Ap({l:o.l,a:Math.cos(i)*s,b:Math.sin(i)*s,alpha:o.alpha})},interpolate:function(o,i,s){return{h:ym(o.h,i.h,s),c:bn(o.c,i.c,s),l:bn(o.l,i.l,s),alpha:bn(o.alpha,i.alpha,s)}}};var ku=Object.freeze({__proto__:null,hcl:Dl,lab:Vi});class Nt{constructor(i,s,c,d,m){this.type=i,this.operator=s,this.interpolation=c,this.input=d,this.labels=[],this.outputs=[];for(const[y,x]of m)this.labels.push(y),this.outputs.push(x)}static interpolationFactor(i,s,c,d){let m=0;if("exponential"===i.name)m=Ar(s,i.base,c,d);else if("linear"===i.name)m=Ar(s,1,c,d);else if("cubic-bezier"===i.name){const y=i.controlPoints;m=new Pa(y[0],y[1],y[2],y[3]).solve(Ar(s,1,c,d))}return m}static parse(i,s){let[c,d,m,...y]=i;if(!Array.isArray(d)||0===d.length)return s.error("Expected an interpolation type expression.",1);if("linear"===d[0])d={name:"linear"};else if("exponential"===d[0]){const C=d[1];if("number"!=typeof C)return s.error("Exponential interpolation requires a numeric base.",1,1);d={name:"exponential",base:C}}else{if("cubic-bezier"!==d[0])return s.error(`Unknown interpolation type ${String(d[0])}`,1,0);{const C=d.slice(1);if(4!==C.length||C.some(D=>"number"!=typeof D||D<0||D>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);d={name:"cubic-bezier",controlPoints:C}}}if(i.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(m=s.parse(m,2,et),!m)return null;const x=[];let E=null;"interpolate-hcl"===c||"interpolate-lab"===c?E=vn:s.expectedType&&"value"!==s.expectedType.kind&&(E=s.expectedType);for(let C=0;C<y.length;C+=2){const D=y[C],P=y[C+1],R=C+3,B=C+4;if("number"!=typeof D)return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',R);if(x.length&&x[x.length-1][0]>=D)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',R);const N=s.parse(P,B,E);if(!N)return null;E=E||N.type,x.push([D,N])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Nt(E,c,d,m,x):s.error(`Type ${Zn(E)} is not interpolatable.`)}evaluate(i){const s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(i);const d=this.input.evaluate(i);if(d<=s[0])return c[0].evaluate(i);const m=s.length;if(d>=s[m-1])return c[m-1].evaluate(i);const y=ha(s,d),x=Nt.interpolationFactor(this.interpolation,d,s[y],s[y+1]),E=c[y].evaluate(i),C=c[y+1].evaluate(i);return"interpolate"===this.operator?ro[this.type.kind.toLowerCase()](E,C,x):"interpolate-hcl"===this.operator?Dl.reverse(Dl.interpolate(Dl.forward(E),Dl.forward(C),x)):Vi.reverse(Vi.interpolate(Vi.forward(E),Vi.forward(C),x))}eachChild(i){i(this.input);for(const s of this.outputs)i(s)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,i,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function Ar(o,i,s,c){const d=c-s,m=o-s;return 0===d?0:1===i?m/d:(Math.pow(i,m)-1)/(Math.pow(i,d)-1)}var gn=Nt;class Ui{constructor(i,s){this.type=i,this.args=s}static parse(i,s){if(i.length<2)return s.error("Expectected at least one argument.");let c=null;const d=s.expectedType;d&&"value"!==d.kind&&(c=d);const m=[];for(const x of i.slice(1)){const E=s.parse(x,1+m.length,c,void 0,{typeAnnotation:"omit"});if(!E)return null;c=c||E.type,m.push(E)}const y=d&&m.some(x=>An(d,x.type));return new Ui(y?Yt:c,m)}evaluate(i){let s,c=null,d=0;for(const m of this.args){if(d++,c=m.evaluate(i),c&&c instanceof fo&&!c.available&&(s||(s=c),c=null,d===this.args.length))return s;if(null!==c)break}return c}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(s=>{i.push(s.serialize())}),i}}var xr=Ui;class Rs{constructor(i,s){this.type=s.type,this.bindings=[].concat(i),this.result=s}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const s of this.bindings)i(s[1]);i(this.result)}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const c=[];for(let m=1;m<i.length-1;m+=2){const y=i[m];if("string"!=typeof y)return s.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return s.error("Variable names must contain only alphanumeric characters or '_'.",m);const x=s.parse(i[m+1],m+1);if(!x)return null;c.push([y,x])}const d=s.parse(i[i.length-1],i.length-1,s.expectedType,c);return d?new Rs(c,d):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[s,c]of this.bindings)i.push(s,c.serialize());return i.push(this.result.serialize()),i}}var Qr=Rs;class Pu{constructor(i,s,c){this.type=i,this.index=s,this.input=c}static parse(i,s){if(3!==i.length)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const c=s.parse(i[1],1,et),d=s.parse(i[2],2,st(s.expectedType||Yt));return c&&d?new Pu(d.type.itemType,c,d):null}evaluate(i){const s=this.index.evaluate(i),c=this.input.evaluate(i);if(s<0)throw new yr(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new yr(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new yr(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var xp=Pu;class Sl{constructor(i,s){this.type=ln,this.needle=i,this.haystack=s}static parse(i,s){if(3!==i.length)return s.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const c=s.parse(i[1],1,Yt),d=s.parse(i[2],2,Yt);return c&&d?_c(c.type,[ln,an,et,la,Yt])?new Sl(c,d):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(c.type)} instead`):null}evaluate(i){const s=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(null==c)return!1;if(!Eu(s,["boolean","string","number","null"]))throw new yr(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(xi(s))} instead.`);if(!Eu(c,["string","array"]))throw new yr(`Expected second argument to be of type array or string, but found ${Zn(xi(c))} instead.`);return c.indexOf(s)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var go=Sl;class wt{constructor(i,s,c){this.type=et,this.needle=i,this.haystack=s,this.fromIndex=c}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const c=s.parse(i[1],1,Yt),d=s.parse(i[2],2,Yt);if(!c||!d)return null;if(!_c(c.type,[ln,an,et,la,Yt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(c.type)} instead`);if(4===i.length){const m=s.parse(i[3],3,et);return m?new wt(c,d,m):null}return new wt(c,d)}evaluate(i){const s=this.needle.evaluate(i),c=this.haystack.evaluate(i);if(!Eu(s,["boolean","string","number","null"]))throw new yr(`Expected first argument to be of type boolean, string, number or null, but found ${Zn(xi(s))} instead.`);if(!Eu(c,["string","array"]))throw new yr(`Expected second argument to be of type array or string, but found ${Zn(xi(c))} instead.`);if(this.fromIndex){const d=this.fromIndex.evaluate(i);return c.indexOf(s,d)}return c.indexOf(s)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var hn=wt;class ui{constructor(i,s,c,d,m,y){this.inputType=i,this.type=s,this.input=c,this.cases=d,this.outputs=m,this.otherwise=y}static parse(i,s){if(i.length<5)return s.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return s.error("Expected an even number of arguments.");let c,d;s.expectedType&&"value"!==s.expectedType.kind&&(d=s.expectedType);const m={},y=[];for(let C=2;C<i.length-1;C+=2){let D=i[C];const P=i[C+1];Array.isArray(D)||(D=[D]);const R=s.concat(C);if(0===D.length)return R.error("Expected at least one branch label.");for(const N of D){if("number"!=typeof N&&"string"!=typeof N)return R.error("Branch labels must be numbers or strings.");if("number"==typeof N&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return R.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof N&&Math.floor(N)!==N)return R.error("Numeric branch labels must be integer values.");if(c){if(R.checkSubtype(c,xi(N)))return null}else c=xi(N);if(void 0!==m[String(N)])return R.error("Branch labels must be unique.");m[String(N)]=y.length}const B=s.parse(P,C,d);if(!B)return null;d=d||B.type,y.push(B)}const x=s.parse(i[1],1,Yt);if(!x)return null;const E=s.parse(i[i.length-1],i.length-1,d);return E?"value"!==x.type.kind&&s.concat(1).checkSubtype(c,x.type)?null:new ui(c,d,x,m,y,E):null}evaluate(i){const s=this.input.evaluate(i);return(xi(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],d={};for(const y of s){const x=d[this.cases[y]];void 0===x?(d[this.cases[y]]=c.length,c.push([this.cases[y],[y]])):c[x][1].push(y)}const m=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,x]of c)i.push(1===x.length?m(x[0]):x.map(m)),i.push(this.outputs[y].serialize());return i.push(this.otherwise.serialize()),i}}var Bo=ui;class Os{constructor(i,s,c){this.type=i,this.branches=s,this.otherwise=c}static parse(i,s){if(i.length<4)return s.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&"value"!==s.expectedType.kind&&(c=s.expectedType);const d=[];for(let y=1;y<i.length-1;y+=2){const x=s.parse(i[y],y,ln);if(!x)return null;const E=s.parse(i[y+1],y+1,c);if(!E)return null;d.push([x,E]),c=c||E.type}const m=s.parse(i[i.length-1],i.length-1,c);return m?new Os(c,d,m):null}evaluate(i){for(const[s,c]of this.branches)if(s.evaluate(i))return c.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[s,c]of this.branches)i(s),i(c);i(this.otherwise)}outputDefined(){return this.branches.every(([i,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(s=>{i.push(s.serialize())}),i}}var sr=Os;class us{constructor(i,s,c,d){this.type=i,this.input=s,this.beginIndex=c,this.endIndex=d}static parse(i,s){if(i.length<=2||i.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const c=s.parse(i[1],1,Yt),d=s.parse(i[2],2,et);if(!c||!d)return null;if(!_c(c.type,[st(Yt),an,Yt]))return s.error(`Expected first argument to be of type array or string, but found ${Zn(c.type)} instead`);if(4===i.length){const m=s.parse(i[3],3,et);return m?new us(c.type,c,d,m):null}return new us(c.type,c,d)}evaluate(i){const s=this.input.evaluate(i),c=this.beginIndex.evaluate(i);if(!Eu(s,["string","array"]))throw new yr(`Expected first argument to be of type array or string, but found ${Zn(xi(s))} instead.`);if(this.endIndex){const d=this.endIndex.evaluate(i);return s.slice(c,d)}return s.slice(c)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var bi=us;function $a(o,i){return"=="===o||"!="===o?"boolean"===i.kind||"string"===i.kind||"number"===i.kind||"null"===i.kind||"value"===i.kind:"string"===i.kind||"number"===i.kind||"value"===i.kind}function Ic(o,i,s,c){return 0===c.compare(i,s)}function tn(o,i,s){const c="=="!==o&&"!="!==o;return class MS{constructor(m,y,x){this.type=ln,this.lhs=m,this.rhs=y,this.collator=x,this.hasUntypedArgument="value"===m.type.kind||"value"===y.type.kind}static parse(m,y){if(3!==m.length&&4!==m.length)return y.error("Expected two or three arguments.");const x=m[0];let E=y.parse(m[1],1,Yt);if(!E)return null;if(!$a(x,E.type))return y.concat(1).error(`"${x}" comparisons are not supported for type '${Zn(E.type)}'.`);let C=y.parse(m[2],2,Yt);if(!C)return null;if(!$a(x,C.type))return y.concat(2).error(`"${x}" comparisons are not supported for type '${Zn(C.type)}'.`);if(E.type.kind!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return y.error(`Cannot compare types '${Zn(E.type)}' and '${Zn(C.type)}'.`);c&&("value"===E.type.kind&&"value"!==C.type.kind?E=new ca(C.type,[E]):"value"!==E.type.kind&&"value"===C.type.kind&&(C=new ca(E.type,[C])));let D=null;if(4===m.length){if("string"!==E.type.kind&&"string"!==C.type.kind&&"value"!==E.type.kind&&"value"!==C.type.kind)return y.error("Cannot use collator to compare non-string types.");if(D=y.parse(m[3],3,Or),!D)return null}return new MS(E,C,D)}evaluate(m){const y=this.lhs.evaluate(m),x=this.rhs.evaluate(m);if(c&&this.hasUntypedArgument){const E=xi(y),C=xi(x);if(E.kind!==C.kind||"string"!==E.kind&&"number"!==E.kind)throw new yr(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${E.kind}, ${C.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const E=xi(y),C=xi(x);if("string"!==E.kind||"string"!==C.kind)return i(m,y,x)}return this.collator?s(m,y,x,this.collator.evaluate(m)):i(m,y,x)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[o];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const sd=tn("==",function(o,i,s){return i===s},Ic),Tc=tn("!=",function(o,i,s){return i!==s},function(o,i,s,c){return!Ic(0,i,s,c)}),bp=tn("<",function(o,i,s){return i<s},function(o,i,s,c){return c.compare(i,s)<0}),kl=tn(">",function(o,i,s){return i>s},function(o,i,s,c){return c.compare(i,s)>0}),br=tn("<=",function(o,i,s){return i<=s},function(o,i,s,c){return c.compare(i,s)<=0}),Pl=tn(">=",function(o,i,s){return i>=s},function(o,i,s,c){return c.compare(i,s)>=0});class Fs{constructor(i,s,c,d,m,y){this.type=an,this.number=i,this.locale=s,this.currency=c,this.unit=d,this.minFractionDigits=m,this.maxFractionDigits=y}static parse(i,s){if(3!==i.length)return s.error("Expected two arguments.");const c=s.parse(i[1],1,et);if(!c)return null;const d=i[2];if("object"!=typeof d||Array.isArray(d))return s.error("NumberFormat options argument must be an object.");let m=null;if(d.locale&&(m=s.parse(d.locale,1,an),!m))return null;let y=null;if(d.currency&&(y=s.parse(d.currency,1,an),!y))return null;let x=null;if(d.unit&&(x=s.parse(d.unit,1,an),!x))return null;let E=null;if(d["min-fraction-digits"]&&(E=s.parse(d["min-fraction-digits"],1,et),!E))return null;let C=null;return d["max-fraction-digits"]&&(C=s.parse(d["max-fraction-digits"],1,et),!C)?null:new Fs(c,m,y,x,E,C)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class Fr{constructor(i){this.type=et,this.input=i}static parse(i,s){if(2!==i.length)return s.error(`Expected 1 argument, but found ${i.length-1} instead.`);const c=s.parse(i[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?s.error(`Expected argument of type string or array, but found ${Zn(c.type)} instead.`):new Fr(c):null}evaluate(i){const s=this.input.evaluate(i);if("string"==typeof s||Array.isArray(s))return s.length;throw new yr(`Expected value to be of type string or array, but found ${Zn(xi(s))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(s=>{i.push(s.serialize())}),i}}const Rl={"==":sd,"!=":Tc,">":kl,"<":bp,">=":Pl,"<=":br,array:ca,at:xp,boolean:ca,case:sr,coalesce:xr,collator:El,format:fi,image:Ua,in:go,"index-of":hn,interpolate:gn,"interpolate-hcl":gn,"interpolate-lab":gn,length:Fr,let:Qr,literal:bl,match:Bo,number:ca,"number-format":Fs,object:ca,slice:bi,step:td,string:ca,"to-boolean":wl,"to-color":wl,"to-number":wl,"to-string":wl,var:ed,within:Ec};function ad(o,[i,s,c,d]){i=i.evaluate(o),s=s.evaluate(o),c=c.evaluate(o);const m=d?d.evaluate(o):1,y=gm(i,s,c,m);if(y)throw new yr(y);return new Di(i/255*m,s/255*m,c/255*m,m)}function Fn(o,i){return o in i}function ld(o,i){const s=i[o];return void 0===s?null:s}function Xr(o){return{type:o}}Oo.register(Rl,{error:[{kind:"error"},[an],(o,[i])=>{throw new yr(i.evaluate(o))}],typeof:[an,[Yt],(o,[i])=>Zn(xi(i.evaluate(o)))],"to-rgba":[st(et,4),[vn],(o,[i])=>i.evaluate(o).toArray()],rgb:[vn,[et,et,et],ad],rgba:[vn,[et,et,et,et],ad],has:{type:ln,overloads:[[[an],(o,[i])=>Fn(i.evaluate(o),o.properties())],[[an,Pt],(o,[i,s])=>Fn(i.evaluate(o),s.evaluate(o))]]},get:{type:Yt,overloads:[[[an],(o,[i])=>ld(i.evaluate(o),o.properties())],[[an,Pt],(o,[i,s])=>ld(i.evaluate(o),s.evaluate(o))]]},"feature-state":[Yt,[an],(o,[i])=>ld(i.evaluate(o),o.featureState||{})],properties:[Pt,[],o=>o.properties()],"geometry-type":[an,[],o=>o.geometryType()],id:[Yt,[],o=>o.id()],zoom:[et,[],o=>o.globals.zoom],pitch:[et,[],o=>o.globals.pitch||0],"distance-from-center":[et,[],o=>o.distanceFromCenter()],"heatmap-density":[et,[],o=>o.globals.heatmapDensity||0],"line-progress":[et,[],o=>o.globals.lineProgress||0],"sky-radial-progress":[et,[],o=>o.globals.skyRadialProgress||0],accumulated:[Yt,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[et,Xr(et),(o,i)=>{let s=0;for(const c of i)s+=c.evaluate(o);return s}],"*":[et,Xr(et),(o,i)=>{let s=1;for(const c of i)s*=c.evaluate(o);return s}],"-":{type:et,overloads:[[[et,et],(o,[i,s])=>i.evaluate(o)-s.evaluate(o)],[[et],(o,[i])=>-i.evaluate(o)]]},"/":[et,[et,et],(o,[i,s])=>i.evaluate(o)/s.evaluate(o)],"%":[et,[et,et],(o,[i,s])=>i.evaluate(o)%s.evaluate(o)],ln2:[et,[],()=>Math.LN2],pi:[et,[],()=>Math.PI],e:[et,[],()=>Math.E],"^":[et,[et,et],(o,[i,s])=>Math.pow(i.evaluate(o),s.evaluate(o))],sqrt:[et,[et],(o,[i])=>Math.sqrt(i.evaluate(o))],log10:[et,[et],(o,[i])=>Math.log(i.evaluate(o))/Math.LN10],ln:[et,[et],(o,[i])=>Math.log(i.evaluate(o))],log2:[et,[et],(o,[i])=>Math.log(i.evaluate(o))/Math.LN2],sin:[et,[et],(o,[i])=>Math.sin(i.evaluate(o))],cos:[et,[et],(o,[i])=>Math.cos(i.evaluate(o))],tan:[et,[et],(o,[i])=>Math.tan(i.evaluate(o))],asin:[et,[et],(o,[i])=>Math.asin(i.evaluate(o))],acos:[et,[et],(o,[i])=>Math.acos(i.evaluate(o))],atan:[et,[et],(o,[i])=>Math.atan(i.evaluate(o))],min:[et,Xr(et),(o,i)=>Math.min(...i.map(s=>s.evaluate(o)))],max:[et,Xr(et),(o,i)=>Math.max(...i.map(s=>s.evaluate(o)))],abs:[et,[et],(o,[i])=>Math.abs(i.evaluate(o))],round:[et,[et],(o,[i])=>{const s=i.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[et,[et],(o,[i])=>Math.floor(i.evaluate(o))],ceil:[et,[et],(o,[i])=>Math.ceil(i.evaluate(o))],"filter-==":[ln,[an,Yt],(o,[i,s])=>o.properties()[i.value]===s.value],"filter-id-==":[ln,[Yt],(o,[i])=>o.id()===i.value],"filter-type-==":[ln,[an],(o,[i])=>o.geometryType()===i.value],"filter-<":[ln,[an,Yt],(o,[i,s])=>{const c=o.properties()[i.value],d=s.value;return typeof c==typeof d&&c<d}],"filter-id-<":[ln,[Yt],(o,[i])=>{const s=o.id(),c=i.value;return typeof s==typeof c&&s<c}],"filter->":[ln,[an,Yt],(o,[i,s])=>{const c=o.properties()[i.value],d=s.value;return typeof c==typeof d&&c>d}],"filter-id->":[ln,[Yt],(o,[i])=>{const s=o.id(),c=i.value;return typeof s==typeof c&&s>c}],"filter-<=":[ln,[an,Yt],(o,[i,s])=>{const c=o.properties()[i.value],d=s.value;return typeof c==typeof d&&c<=d}],"filter-id-<=":[ln,[Yt],(o,[i])=>{const s=o.id(),c=i.value;return typeof s==typeof c&&s<=c}],"filter->=":[ln,[an,Yt],(o,[i,s])=>{const c=o.properties()[i.value],d=s.value;return typeof c==typeof d&&c>=d}],"filter-id->=":[ln,[Yt],(o,[i])=>{const s=o.id(),c=i.value;return typeof s==typeof c&&s>=c}],"filter-has":[ln,[Yt],(o,[i])=>i.value in o.properties()],"filter-has-id":[ln,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[ln,[st(an)],(o,[i])=>i.value.indexOf(o.geometryType())>=0],"filter-id-in":[ln,[st(Yt)],(o,[i])=>i.value.indexOf(o.id())>=0],"filter-in-small":[ln,[an,st(Yt)],(o,[i,s])=>s.value.indexOf(o.properties()[i.value])>=0],"filter-in-large":[ln,[an,st(Yt)],(o,[i,s])=>function(c,d,m,y){for(;m<=y;){const x=m+y>>1;if(d[x]===c)return!0;d[x]>c?y=x-1:m=x+1}return!1}(o.properties()[i.value],s.value,0,s.value.length-1)],all:{type:ln,overloads:[[[ln,ln],(o,[i,s])=>i.evaluate(o)&&s.evaluate(o)],[Xr(ln),(o,i)=>{for(const s of i)if(!s.evaluate(o))return!1;return!0}]]},any:{type:ln,overloads:[[[ln,ln],(o,[i,s])=>i.evaluate(o)||s.evaluate(o)],[Xr(ln),(o,i)=>{for(const s of i)if(s.evaluate(o))return!0;return!1}]]},"!":[ln,[ln],(o,[i])=>!i.evaluate(o)],"is-supported-script":[ln,[an],(o,[i])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(i.evaluate(o))}],upcase:[an,[an],(o,[i])=>i.evaluate(o).toUpperCase()],downcase:[an,[an],(o,[i])=>i.evaluate(o).toLowerCase()],concat:[an,Xr(Yt),(o,i)=>i.map(s=>_r(s.evaluate(o))).join("")],"resolved-locale":[an,[Or],(o,[i])=>i.evaluate(o).resolvedLocale()]});var Ol=Rl;function Mc(o){return{result:"success",value:o}}function hs(o){return{result:"error",value:o}}function No(o){return"data-driven"===o["property-type"]}function Qi(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function cd(o){return!!o.expression&&o.expression.interpolated}function Zt(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}function Lr(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Ru(o){return o}function da(o,i){const s="color"===i.type,c=o.stops&&"object"==typeof o.stops[0][0],d=c||!(c||void 0!==o.property),m=o.type||(cd(i)?"exponential":"interval");if(s&&((o=ks({},o)).stops&&(o.stops=o.stops.map(C=>[C[0],Di.parse(C[1])])),o.default=Di.parse(o.default?o.default:i.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!ku[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let y,x,E;if("exponential"===m)y=pa;else if("interval"===m)y=Ou;else if("categorical"===m){y=_o,x=Object.create(null);for(const C of o.stops)x[C[0]]=C[1];E=typeof o.stops[0][0]}else{if("identity"!==m)throw new Error(`Unknown function type "${m}"`);y=wp}if(c){const C={},D=[];for(let B=0;B<o.stops.length;B++){const N=o.stops[B],U=N[0].zoom;void 0===C[U]&&(C[U]={zoom:U,type:o.type,property:o.property,default:o.default,stops:[]},D.push(U)),C[U].stops.push([N[0].value,N[1]])}const P=[];for(const B of D)P.push([C[B].zoom,da(C[B],i)]);const R={name:"linear"};return{kind:"composite",interpolationType:R,interpolationFactor:gn.interpolationFactor.bind(void 0,R),zoomStops:P.map(B=>B[0]),evaluate:({zoom:B},N)=>pa({stops:P,base:o.base},i,B).evaluate(B,N)}}if(d){const C="exponential"===m?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:gn.interpolationFactor.bind(void 0,C),zoomStops:o.stops.map(D=>D[0]),evaluate:({zoom:D})=>y(o,i,D,x,E)}}return{kind:"source",evaluate(C,D){const P=D&&D.properties?D.properties[o.property]:void 0;return void 0===P?Ls(o.default,i.default):y(o,i,P,x,E)}}}function Ls(o,i,s){return void 0!==o?o:void 0!==i?i:void 0!==s?s:void 0}function _o(o,i,s,c,d){return Ls(typeof s===d?c[s]:void 0,o.default,i.default)}function Ou(o,i,s){if("number"!==Zt(s))return Ls(o.default,i.default);const c=o.stops.length;if(1===c||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[c-1][0])return o.stops[c-1][1];const d=ha(o.stops.map(m=>m[0]),s);return o.stops[d][1]}function pa(o,i,s){const c=void 0!==o.base?o.base:1;if("number"!==Zt(s))return Ls(o.default,i.default);const d=o.stops.length;if(1===d||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[d-1][0])return o.stops[d-1][1];const m=ha(o.stops.map(D=>D[0]),s),y=function(D,P,R,B){const N=B-R,U=D-R;return 0===N?0:1===P?U/N:(Math.pow(P,U)-1)/(Math.pow(P,N)-1)}(s,c,o.stops[m][0],o.stops[m+1][0]),x=o.stops[m][1],E=o.stops[m+1][1];let C=ro[i.type]||Ru;if(o.colorSpace&&"rgb"!==o.colorSpace){const D=ku[o.colorSpace];C=(P,R)=>D.reverse(D.interpolate(D.forward(P),D.forward(R),y))}return"function"==typeof x.evaluate?{evaluate(...D){const P=x.evaluate.apply(void 0,D),R=E.evaluate.apply(void 0,D);if(void 0!==P&&void 0!==R)return C(P,R,y)}}:C(x,E,y)}function wp(o,i,s){return"color"===i.type?s=Di.parse(s):"formatted"===i.type?s=no.fromString(s.toString()):"resolvedImage"===i.type?s=fo.fromString(s.toString()):Zt(s)===i.type||"enum"===i.type&&i.values[s]||(s=void 0),Ls(s,o.default,i.default)}class Fu{constructor(i,s){var c;this.expression=i,this._warningHistory={},this._evaluator=new Mu,this._defaultValue=s?"color"===(c=s).type&&(Lr(c.default)||Array.isArray(c.default))?new Di(0,0,0,0):"color"===c.type?Di.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=s&&"enum"===s.type?s.values:null}evaluateWithoutErrorHandling(i,s,c,d,m,y,x,E){return this._evaluator.globals=i,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(i,s,c,d,m,y,x,E){this._evaluator.globals=i,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=d||null,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=x||null,this._evaluator.featureDistanceData=E||null;try{const C=this.expression.evaluate(this._evaluator);if(null==C||"number"==typeof C&&C!=C)return this._defaultValue;if(this._enumValues&&!(C in this._enumValues))throw new yr(`Expected value to be one of ${Object.keys(this._enumValues).map(D=>JSON.stringify(D)).join(", ")}, but found ${JSON.stringify(C)} instead.`);return C}catch(C){return this._warningHistory[C.message]||(this._warningHistory[C.message]=!0,typeof console<"u"&&console.warn(C.message)),this._defaultValue}}}function Dc(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in Ol}function Sc(o,i){const s=new Tl(Ol,[],i?function(d){const m={color:vn,string:an,number:et,enum:an,boolean:ln,formatted:wu,resolvedImage:os};return"array"===d.type?st(m[d.value]||Yt,d.length):m[d.type]}(i):void 0),c=s.parse(o,void 0,void 0,void 0,i&&"string"===i.type?{typeAnnotation:"coerce"}:void 0);return c?Mc(new Fu(c,i)):hs(s.errors)}class Ep{constructor(i,s){this.kind=i,this._styleExpression=s,this.isStateDependent="constant"!==i&&!Zr(s.expression)}evaluateWithoutErrorHandling(i,s,c,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(i,s,c,d,m,y)}evaluate(i,s,c,d,m,y){return this._styleExpression.evaluate(i,s,c,d,m,y)}}class Lu{constructor(i,s,c,d){this.kind=i,this.zoomStops=c,this._styleExpression=s,this.isStateDependent="camera"!==i&&!Zr(s.expression),this.interpolationType=d}evaluateWithoutErrorHandling(i,s,c,d,m,y){return this._styleExpression.evaluateWithoutErrorHandling(i,s,c,d,m,y)}evaluate(i,s,c,d,m,y){return this._styleExpression.evaluate(i,s,c,d,m,y)}interpolationFactor(i,s,c){return this.interpolationType?gn.interpolationFactor(this.interpolationType,i,s,c):0}}function Bu(o,i){if("error"===(o=Sc(o,i)).result)return o;const s=o.value.expression,c=ls(s);if(!c&&!No(i))return hs([new Ro("","data expressions not supported")]);const d=Ha(s,["zoom","pitch","distance-from-center"]);if(!d&&!Qi(i))return hs([new Ro("","zoom expressions not supported")]);const m=hd(s);return m||d?m instanceof Ro?hs([m]):m instanceof gn&&!cd(i)?hs([new Ro("",'"interpolate" expressions cannot be used with this property')]):Mc(m?new Lu(c?"camera":"composite",o.value,m.labels,m instanceof gn?m.interpolation:void 0):new Ep(c?"constant":"source",o.value)):hs([new Ro("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ud{constructor(i,s){this._parameters=i,this._specification=s,ks(this,da(this._parameters,this._specification))}static deserialize(i){return new ud(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function hd(o){let i=null;if(o instanceof Qr)i=hd(o.result);else if(o instanceof xr){for(const s of o.args)if(i=hd(s),i)break}else(o instanceof td||o instanceof gn)&&o.input instanceof Oo&&"zoom"===o.input.name&&(i=o);return i instanceof Ro||o.eachChild(s=>{const c=hd(s);c instanceof Ro?i=c:!i&&c?i=new Ro("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):i&&c&&i!==c&&(i=new Ro("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}class mt{constructor(i,s,c,d){this.message=(i?`${i}: `:"")+c,d&&(this.identifier=d),null!=s&&s.__line__&&(this.line=s.__line__)}}function ds(o){const i=o.key,s=o.value,c=o.valueSpec||{},d=o.objectElementValidators||{},m=o.style,y=o.styleSpec;let x=[];const E=Zt(s);if("object"!==E)return[new mt(i,s,`object expected, ${E} found`)];for(const C in s){const D=C.split(".")[0];let P;d[D]?P=d[D]:c[D]?P=mi:d["*"]?P=d["*"]:c["*"]&&(P=mi),P?x=x.concat(P({key:(i&&`${i}.`)+C,value:s[C],valueSpec:c[D]||c["*"],style:m,styleSpec:y,object:s,objectKey:C},s)):x.push(new mt(i,s[C],`unknown property "${C}"`))}for(const C in c)d[C]||c[C].required&&void 0===c[C].default&&void 0===s[C]&&x.push(new mt(i,s,`missing required property "${C}"`));return x}function vm(o){const i=o.value,s=o.valueSpec,c=o.style,d=o.styleSpec,m=o.key,y=o.arrayElementValidator||mi;if("array"!==Zt(i))return[new mt(m,i,`array expected, ${Zt(i)} found`)];if(s.length&&i.length!==s.length)return[new mt(m,i,`array length ${s.length} expected, length ${i.length} found`)];if(s["min-length"]&&i.length<s["min-length"])return[new mt(m,i,`array length at least ${s["min-length"]} expected, length ${i.length} found`)];let x={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};d.$version<7&&(x.function=s.function),"object"===Zt(s.value)&&(x=s.value);let E=[];for(let C=0;C<i.length;C++)E=E.concat(y({array:i,arrayIndex:C,value:i[C],valueSpec:x,style:c,styleSpec:d,key:`${m}[${C}]`}));return E}function Nu(o){const i=o.key,s=o.value,c=o.valueSpec;let d=Zt(s);if("number"===d&&s!=s&&(d="NaN"),"number"!==d)return[new mt(i,s,`number expected, ${d} found`)];if("minimum"in c){let m=c.minimum;if("array"===Zt(c.minimum)&&(m=c.minimum[o.arrayIndex]),s<m)return[new mt(i,s,`${s} is less than the minimum value ${m}`)]}if("maximum"in c){let m=c.maximum;if("array"===Zt(c.maximum)&&(m=c.maximum[o.arrayIndex]),s>m)return[new mt(i,s,`${s} is greater than the maximum value ${m}`)]}return[]}function zu(o){const i=o.valueSpec,s=Ti(o.value.type);let c,d,m,y={};const x="categorical"!==s&&void 0===o.value.property,E=!x,C="array"===Zt(o.value.stops)&&"array"===Zt(o.value.stops[0])&&"object"===Zt(o.value.stops[0][0]),D=ds({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(B){if("identity"===s)return[new mt(B.key,B.value,'identity function may not have a "stops" property')];let N=[];const U=B.value;return N=N.concat(vm({key:B.key,value:U,valueSpec:B.valueSpec,style:B.style,styleSpec:B.styleSpec,arrayElementValidator:P})),"array"===Zt(U)&&0===U.length&&N.push(new mt(B.key,U,"array must have at least one stop")),N},default:function(B){return mi({key:B.key,value:B.value,valueSpec:i,style:B.style,styleSpec:B.styleSpec})}}});return"identity"===s&&x&&D.push(new mt(o.key,o.value,'missing required property "property"')),"identity"===s||o.value.stops||D.push(new mt(o.key,o.value,'missing required property "stops"')),"exponential"===s&&o.valueSpec.expression&&!cd(o.valueSpec)&&D.push(new mt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(E&&!No(o.valueSpec)?D.push(new mt(o.key,o.value,"property functions not supported")):x&&!Qi(o.valueSpec)&&D.push(new mt(o.key,o.value,"zoom functions not supported"))),"categorical"!==s&&!C||void 0!==o.value.property||D.push(new mt(o.key,o.value,'"property" property is required')),D;function P(B){let N=[];const U=B.value,q=B.key;if("array"!==Zt(U))return[new mt(q,U,`array expected, ${Zt(U)} found`)];if(2!==U.length)return[new mt(q,U,`array length 2 expected, length ${U.length} found`)];if(C){if("object"!==Zt(U[0]))return[new mt(q,U,`object expected, ${Zt(U[0])} found`)];if(void 0===U[0].zoom)return[new mt(q,U,"object stop key must have zoom")];if(void 0===U[0].value)return[new mt(q,U,"object stop key must have value")];const Y=Ti(U[0].zoom);if("number"!=typeof Y)return[new mt(q,U[0].zoom,"stop zoom values must be numbers")];if(m&&m>Y)return[new mt(q,U[0].zoom,"stop zoom values must appear in ascending order")];Y!==m&&(m=Y,d=void 0,y={}),N=N.concat(ds({key:`${q}[0]`,value:U[0],valueSpec:{zoom:{}},style:B.style,styleSpec:B.styleSpec,objectElementValidators:{zoom:Nu,value:R}}))}else N=N.concat(R({key:`${q}[0]`,value:U[0],valueSpec:{},style:B.style,styleSpec:B.styleSpec},U));return Dc(xn(U[1]))?N.concat([new mt(`${q}[1]`,U[1],"expressions are not allowed in function stops.")]):N.concat(mi({key:`${q}[1]`,value:U[1],valueSpec:i,style:B.style,styleSpec:B.styleSpec}))}function R(B,N){const U=Zt(B.value),q=Ti(B.value),Y=null!==B.value?B.value:N;if(c){if(U!==c)return[new mt(B.key,Y,`${U} stop domain type must match previous stop domain type ${c}`)]}else c=U;if("number"!==U&&"string"!==U&&"boolean"!==U&&"number"!=typeof q&&"string"!=typeof q&&"boolean"!=typeof q)return[new mt(B.key,Y,"stop domain value must be a number, string, or boolean")];if("number"!==U&&"categorical"!==s){let ae=`number expected, ${U} found`;return No(i)&&void 0===s&&(ae+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new mt(B.key,Y,ae)]}return"categorical"!==s||"number"!==U||"number"==typeof q&&isFinite(q)&&Math.floor(q)===q?"categorical"!==s&&"number"===U&&"number"==typeof q&&"number"==typeof d&&void 0!==d&&q<d?[new mt(B.key,Y,"stop domain values must appear in ascending order")]:(d=q,"categorical"===s&&q in y?[new mt(B.key,Y,"stop domain values must be unique")]:(y[q]=!0,[])):[new mt(B.key,Y,`integer expected, found ${String(q)}`)]}}function ji(o){const i=("property"===o.expressionContext?Bu:Sc)(xn(o.value),o.valueSpec);if("error"===i.result)return i.value.map(c=>new mt(`${o.key}${c.key}`,o.value,c.message));const s=i.value.expression||i.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!s.outputDefined())return[new mt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!Zr(s))return[new mt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext)return Fl(s,o);if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!Ha(s,["zoom","feature-state"]))return[new mt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!ls(s))return[new mt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Fl(o,i){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(i.valueSpec&&i.valueSpec.expression)for(const d of i.valueSpec.expression.parameters)s.delete(d);if(0===s.size)return[];const c=[];return o instanceof Oo&&s.has(o.name)?[new mt(i.key,i.value,`["${o.name}"] expression is not supported in a filter for a ${i.object.type} layer with id: ${i.object.id}`)]:(o.eachChild(d=>{c.push(...Fl(d,i))}),c)}function dd(o){const i=o.key,s=o.value,c=o.valueSpec,d=[];return Array.isArray(c.values)?-1===c.values.indexOf(Ti(s))&&d.push(new mt(i,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):-1===Object.keys(c.values).indexOf(Ti(s))&&d.push(new mt(i,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),d}function Cp(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const i of o.slice(1))if(!Cp(i)&&"boolean"!=typeof i)return!1;return!0;default:return!0}}function pd(o,i="fill"){if(null==o)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Cp(o)||(o=qa(o));const s=o;let c=!0;try{c=function(C){if(!Hi(C))return C;let D=xn(C);return Vu(D),D=fa(D),D}(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(s,null,2)}\n        `)}const d=Fe[`filter_${i}`],m=Sc(c,d);let y=null;if("error"===m.result)throw new Error(m.value.map(C=>`${C.key}: ${C.message}`).join(", "));y=(C,D,P)=>m.value.evaluate(C,D,{},P);let x=null,E=null;if(c!==s){const C=Sc(s,d);if("error"===C.result)throw new Error(C.value.map(D=>`${D.key}: ${D.message}`).join(", "));x=(D,P,R,B,N)=>C.value.evaluate(D,P,{},R,void 0,void 0,B,N),E=!ls(C.value.expression)}return{filter:y,dynamicFilter:x||void 0,needGeometry:Ip(c),needFeature:!!E}}function fa(o){if(!Array.isArray(o))return o;const i=function(s){if(Uu.has(s[0]))for(let c=1;c<s.length;c++)if(Hi(s[c]))return!0;return s}(o);return!0===i?i:i.map(s=>fa(s))}function Vu(o){let i=!1;const s=[];if("case"===o[0]){for(let c=1;c<o.length-1;c+=2)i=i||Hi(o[c]),s.push(o[c+1]);s.push(o[o.length-1])}else if("match"===o[0]){i=i||Hi(o[1]);for(let c=2;c<o.length-1;c+=2)s.push(o[c+1]);s.push(o[o.length-1])}else if("step"===o[0]){i=i||Hi(o[1]);for(let c=1;c<o.length-1;c+=2)s.push(o[c+1])}i&&(o.length=0,o.push("any",...s));for(let c=1;c<o.length;c++)Vu(o[c])}function Hi(o){if(!Array.isArray(o))return!1;if("pitch"===(i=o[0])||"distance-from-center"===i)return!0;var i;for(let s=1;s<o.length;s++)if(Hi(o[s]))return!0;return!1}const Uu=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Am(o,i){return o<i?-1:o>i?1:0}function Ip(o){if(!Array.isArray(o))return!1;if("within"===o[0])return!0;for(let i=1;i<o.length;i++)if(Ip(o[i]))return!0;return!1}function qa(o){if(!o)return!0;const i=o[0];return o.length<=1?"any"!==i:"=="===i?ju(o[1],o[2],"=="):"!="===i?Hu(ju(o[1],o[2],"==")):"<"===i||">"===i||"<="===i||">="===i?ju(o[1],o[2],i):"any"===i?(s=o.slice(1),["any"].concat(s.map(qa))):"all"===i?["all"].concat(o.slice(1).map(qa)):"none"===i?["all"].concat(o.slice(1).map(qa).map(Hu)):"in"===i?fd(o[1],o.slice(2)):"!in"===i?Hu(fd(o[1],o.slice(2))):"has"===i?kc(o[1]):"!has"===i?Hu(kc(o[1])):"within"!==i||o;var s}function ju(o,i,s){switch(o){case"$type":return[`filter-type-${s}`,i];case"$id":return[`filter-id-${s}`,i];default:return[`filter-${s}`,o,i]}}function fd(o,i){if(0===i.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(s=>typeof s!=typeof i[0])?["filter-in-large",o,["literal",i.sort(Am)]]:["filter-in-small",o,["literal",i]]}}function kc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function Hu(o){return["!",o]}function wr(o){return Cp(xn(o.value))?ji(ks({},o,{expressionContext:"filter",valueSpec:o.styleSpec[`filter_${o.layerType||"fill"}`]})):Ll(o)}function Ll(o){const i=o.value,s=o.key;if("array"!==Zt(i))return[new mt(s,i,`array expected, ${Zt(i)} found`)];const c=o.styleSpec;let d,m=[];if(i.length<1)return[new mt(s,i,"filter array must have at least 1 element")];switch(m=m.concat(dd({key:`${s}[0]`,value:i[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),Ti(i[0])){case"<":case"<=":case">":case">=":i.length>=2&&"$type"===Ti(i[1])&&m.push(new mt(s,i,`"$type" cannot be use with operator "${i[0]}"`));case"==":case"!=":3!==i.length&&m.push(new mt(s,i,`filter array for operator "${i[0]}" must have 3 elements`));case"in":case"!in":i.length>=2&&(d=Zt(i[1]),"string"!==d&&m.push(new mt(`${s}[1]`,i[1],`string expected, ${d} found`)));for(let y=2;y<i.length;y++)d=Zt(i[y]),"$type"===Ti(i[1])?m=m.concat(dd({key:`${s}[${y}]`,value:i[y],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==d&&"number"!==d&&"boolean"!==d&&m.push(new mt(`${s}[${y}]`,i[y],`string, number, or boolean expected, ${d} found`));break;case"any":case"all":case"none":for(let y=1;y<i.length;y++)m=m.concat(Ll({key:`${s}[${y}]`,value:i[y],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":d=Zt(i[1]),2!==i.length?m.push(new mt(s,i,`filter array for "${i[0]}" operator must have 2 elements`)):"string"!==d&&m.push(new mt(`${s}[1]`,i[1],`string expected, ${d} found`));break;case"within":d=Zt(i[1]),2!==i.length?m.push(new mt(s,i,`filter array for "${i[0]}" operator must have 2 elements`)):"object"!==d&&m.push(new mt(`${s}[1]`,i[1],`object expected, ${d} found`))}return m}function Gu(o,i){const s=o.key,c=o.style,d=o.styleSpec,m=o.value,y=o.objectKey,x=d[`${i}_${o.layerType}`];if(!x)return[];const E=y.match(/^(.*)-transition$/);if("paint"===i&&E&&x[E[1]]&&x[E[1]].transition)return mi({key:s,value:m,valueSpec:d.transition,style:c,styleSpec:d});const C=o.valueSpec||x[y];if(!C)return[new mt(s,m,`unknown property "${y}"`)];let D;if("string"===Zt(m)&&No(C)&&!C.tokens&&(D=/^{([^}]+)}$/.exec(m))){const R=`\`{ "type": "identity", "property": ${D?JSON.stringify(D[1]):'"_"'} }\``;return[new mt(s,m,`"${y}" does not support interpolation syntax\nUse an identity property function instead: ${R}.`)]}const P=[];return"symbol"===o.layerType&&("text-field"===y&&c&&!c.glyphs&&P.push(new mt(s,m,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&Lr(xn(m))&&"identity"===Ti(m.type)&&P.push(new mt(s,m,'"text-font" does not support identity functions'))),P.concat(mi({key:o.key,value:m,valueSpec:C,style:c,styleSpec:d,expressionContext:"property",propertyType:i,propertyKey:y}))}function Xi(o){return Gu(o,"paint")}function md(o){return Gu(o,"layout")}function Pc(o){let i=[];const s=o.value,c=o.key,d=o.style,m=o.styleSpec;s.type||s.ref||i.push(new mt(c,s,'either "type" or "ref" is required'));let y=Ti(s.type);const x=Ti(s.ref);if(s.id){const E=Ti(s.id);for(let C=0;C<o.arrayIndex;C++){const D=d.layers[C];Ti(D.id)===E&&i.push(new mt(c,s.id,`duplicate layer id "${s.id}", previously used at line ${D.id.__line__}`))}}if("ref"in s){let E;["type","source","source-layer","filter","layout"].forEach(C=>{C in s&&i.push(new mt(c,s[C],`"${C}" is prohibited for ref layers`))}),d.layers.forEach(C=>{Ti(C.id)===x&&(E=C)}),E?E.ref?i.push(new mt(c,s.ref,"ref cannot reference another ref layer")):y=Ti(E.type):"string"==typeof x&&i.push(new mt(c,s.ref,`ref layer "${x}" not found`))}else if("background"!==y&&"sky"!==y)if(s.source){const E=d.sources&&d.sources[s.source],C=E&&Ti(E.type);E?"vector"===C&&"raster"===y?i.push(new mt(c,s.source,`layer "${s.id}" requires a raster source`)):"raster"===C&&"raster"!==y?i.push(new mt(c,s.source,`layer "${s.id}" requires a vector source`)):"vector"!==C||s["source-layer"]?"raster-dem"===C&&"hillshade"!==y?i.push(new mt(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||"geojson"===C&&E.lineMetrics||i.push(new mt(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):i.push(new mt(c,s,`layer "${s.id}" must specify a "source-layer"`)):i.push(new mt(c,s.source,`source "${s.source}" not found`))}else i.push(new mt(c,s,'missing required property "source"'));return i=i.concat(ds({key:c,value:s,valueSpec:m.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>mi({key:`${c}.type`,value:s.type,valueSpec:m.layer.type,style:o.style,styleSpec:o.styleSpec,object:s,objectKey:"type"}),filter:E=>wr(ks({layerType:y},E)),layout:E=>ds({layer:s,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>md(ks({layerType:y},C))}}),paint:E=>ds({layer:s,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":C=>Xi(ks({layerType:y},C))}})}})),i}function Fi(o){const i=o.value,s=o.key,c=Zt(i);return"string"!==c?[new mt(s,i,`string expected, ${c} found`)]:[]}const Tp={promoteId:function({key:o,value:i}){if("string"===Zt(i))return Fi({key:o,value:i});{const s=[];for(const c in i)s.push(...Fi({key:`${o}.${c}`,value:i[c]}));return s}}};function gd(o){const i=o.value,s=o.key,c=o.styleSpec,d=o.style;if(!i.type)return[new mt(s,i,'"type" is required')];const m=Ti(i.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=ds({key:s,value:i,valueSpec:c[`source_${m.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Tp}),y;case"geojson":if(y=ds({key:s,value:i,valueSpec:c.source_geojson,style:d,styleSpec:c,objectElementValidators:Tp}),i.cluster)for(const x in i.clusterProperties){const[E,C]=i.clusterProperties[x],D="string"==typeof E?[E,["accumulated"],["get",x]]:E;y.push(...ji({key:`${s}.${x}.map`,value:C,expressionContext:"cluster-map"})),y.push(...ji({key:`${s}.${x}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return y;case"video":return ds({key:s,value:i,valueSpec:c.source_video,style:d,styleSpec:c});case"image":return ds({key:s,value:i,valueSpec:c.source_image,style:d,styleSpec:c});case"canvas":return[new mt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return dd({key:`${s}.type`,value:i.type,valueSpec:{values:Bl(c)},style:d,styleSpec:c})}}function Bl(o){return o.source.reduce((i,s)=>{const c=o[s];return"enum"===c.type.type&&(i=i.concat(Object.keys(c.type.values))),i},[])}function Br(o){const i=o.value,s=o.styleSpec,c=s.light,d=o.style;let m=[];const y=Zt(i);if(void 0===i)return m;if("object"!==y)return m=m.concat([new mt("light",i,`object expected, ${y} found`)]),m;for(const x in i){const E=x.match(/^(.*)-transition$/);m=m.concat(E&&c[E[1]]&&c[E[1]].transition?mi({key:x,value:i[x],valueSpec:s.transition,style:d,styleSpec:s}):c[x]?mi({key:x,value:i[x],valueSpec:c[x],style:d,styleSpec:s}):[new mt(x,i[x],`unknown property "${x}"`)])}return m}function _d(o){const i=o.value,s=o.key,c=o.style,d=o.styleSpec,m=d.terrain;let y=[];const x=Zt(i);if(void 0===i)return y;if("object"!==x)return y=y.concat([new mt("terrain",i,`object expected, ${x} found`)]),y;for(const E in i){const C=E.match(/^(.*)-transition$/);y=y.concat(C&&m[C[1]]&&m[C[1]].transition?mi({key:E,value:i[E],valueSpec:d.transition,style:c,styleSpec:d}):m[E]?mi({key:E,value:i[E],valueSpec:m[E],style:c,styleSpec:d}):[new mt(E,i[E],`unknown property "${E}"`)])}if(i.source){const E=c.sources&&c.sources[i.source],C=E&&Ti(E.type);E?"raster-dem"!==C&&y.push(new mt(s,i.source,`terrain cannot be used with a source of type ${String(C)}, it only be used with a "raster-dem" source type`)):y.push(new mt(s,i.source,`source "${i.source}" not found`))}else y.push(new mt(s,i,'terrain is missing required property "source"'));return y}function Rc(o){const i=o.value,s=o.style,c=o.styleSpec,d=c.fog;let m=[];const y=Zt(i);if(void 0===i)return m;if("object"!==y)return m=m.concat([new mt("fog",i,`object expected, ${y} found`)]),m;for(const x in i){const E=x.match(/^(.*)-transition$/);m=m.concat(E&&d[E[1]]&&d[E[1]].transition?mi({key:x,value:i[x],valueSpec:c.transition,style:s,styleSpec:c}):d[x]?mi({key:x,value:i[x],valueSpec:d[x],style:s,styleSpec:c}):[new mt(x,i[x],`unknown property "${x}"`)])}return m}const Mp={"*":()=>[],array:vm,boolean:function(o){const i=o.value,s=o.key,c=Zt(i);return"boolean"!==c?[new mt(s,i,`boolean expected, ${c} found`)]:[]},number:Nu,color:function(o){const i=o.key,s=o.value,c=Zt(s);return"string"!==c?[new mt(i,s,`color expected, ${c} found`)]:null===Jh(s)?[new mt(i,s,`color expected, "${s}" found`)]:[]},enum:dd,filter:wr,function:zu,layer:Pc,object:ds,source:gd,light:Br,terrain:_d,fog:Rc,string:Fi,formatted:function(o){return 0===Fi(o).length?[]:ji(o)},resolvedImage:function(o){return 0===Fi(o).length?[]:ji(o)},projection:function(o){const i=o.value,s=o.styleSpec,c=s.projection,d=o.style;let m=[];const y=Zt(i);if("object"===y)for(const x in i)m=m.concat(mi({key:x,value:i[x],valueSpec:c[x],style:d,styleSpec:s}));else"string"!==y&&(m=m.concat([new mt("projection",i,`object or string expected, ${y} found`)]));return m}};function mi(o){const i=o.value,s=o.valueSpec,c=o.styleSpec;return s.expression&&Lr(Ti(i))?zu(o):s.expression&&Dc(xn(i))?ji(o):s.type&&Mp[s.type]?Mp[s.type](o):ds(ks({},o,{valueSpec:s.type?c[s.type]:s}))}function Dp(o){const i=o.value,s=o.key,c=Fi(o);return c.length||(-1===i.indexOf("{fontstack}")&&c.push(new mt(s,i,'"glyphs" url must include a "{fontstack}" token')),-1===i.indexOf("{range}")&&c.push(new mt(s,i,'"glyphs" url must include a "{range}" token'))),c}function $u(o,i=Fe){return zo(mi({key:"",value:o,valueSpec:i.$root,styleSpec:i,style:o,objectElementValidators:{glyphs:Dp,"*":()=>[]}}))}const on=o=>zo(Xi(o)),Sp=o=>zo(md(o));function zo(o){return o.slice().sort((i,s)=>i.line&&s.line?i.line-s.line:0)}function kp(o,i){let s=!1;if(i&&i.length)for(const c of i)o.fire(new Ss(new Error(c.message))),s=!0;return s}var xm=Uo,Vo=3;function Uo(o,i,s){var c=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var d=new Int32Array(this.arrayBuffer);o=d[0],this.d=(i=d[1])+2*(s=d[2]);for(var m=0;m<this.d*this.d;m++){var y=d[Vo+m],x=d[Vo+m+1];c.push(y===x?null:d.subarray(y,x))}var E=d[Vo+c.length+1];this.keys=d.subarray(d[Vo+c.length],E),this.bboxes=d.subarray(E),this.insert=this._insertReadonly}else{this.d=i+2*s;for(var C=0;C<this.d*this.d;C++)c.push([]);this.keys=[],this.bboxes=[]}this.n=i,this.extent=o,this.padding=s,this.scale=i/o,this.uid=0;var D=s/i*o;this.min=-D,this.max=o+D}Uo.prototype.insert=function(o,i,s,c,d){this._forEachCell(i,s,c,d,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(d)},Uo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Uo.prototype._insertCell=function(o,i,s,c,d,m){this.cells[d].push(m)},Uo.prototype.query=function(o,i,s,c,d){var m=this.min,y=this.max;if(o<=m&&i<=m&&y<=s&&y<=c&&!d)return Array.prototype.slice.call(this.keys);var x=[];return this._forEachCell(o,i,s,c,this._queryCell,x,{},d),x},Uo.prototype._queryCell=function(o,i,s,c,d,m,y,x){var E=this.cells[d];if(null!==E)for(var C=this.keys,D=this.bboxes,P=0;P<E.length;P++){var R=E[P];if(void 0===y[R]){var B=4*R;(x?x(D[B+0],D[B+1],D[B+2],D[B+3]):o<=D[B+2]&&i<=D[B+3]&&s>=D[B+0]&&c>=D[B+1])?(y[R]=!0,m.push(C[R])):y[R]=!1}}},Uo.prototype._forEachCell=function(o,i,s,c,d,m,y,x){for(var E=this._convertToCellCoord(o),C=this._convertToCellCoord(i),D=this._convertToCellCoord(s),P=this._convertToCellCoord(c),R=E;R<=D;R++)for(var B=C;B<=P;B++){var N=this.d*B+R;if((!x||x(this._convertFromCellCoord(R),this._convertFromCellCoord(B),this._convertFromCellCoord(R+1),this._convertFromCellCoord(B+1)))&&d.call(this,o,i,s,c,N,m,y,x))return}},Uo.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Uo.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Uo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,i=Vo+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var d=new Int32Array(i+s+this.keys.length+this.bboxes.length);d[0]=this.extent,d[1]=this.n,d[2]=this.padding;for(var m=i,y=0;y<o.length;y++){var x=o[y];d[Vo+y]=m,d.set(x,m),m+=x.length}return d[Vo+o.length]=m,d.set(this.keys,m),d[Vo+o.length+1]=m+=this.keys.length,d.set(this.bboxes,m),m+=this.bboxes.length,d.buffer};var Wa=eo(xm);const qu={};function Ae(o,i,s={}){Object.defineProperty(o,"_classRegistryKey",{value:i,writeable:!1}),qu[i]={klass:o,omit:s.omit||[]}}Ae(Object,"Object"),Wa.serialize=function(o,i){const s=o.toArrayBuffer();return i&&i.push(s),{buffer:s}},Wa.deserialize=function(o){return new Wa(o.buffer)},Object.defineProperty(Wa,"name",{value:"Grid"}),Ae(Wa,"Grid"),Ae(Di,"Color"),Ae(Error,"Error"),Ae(Ba,"AJAXError"),Ae(fo,"ResolvedImage"),Ae(ud,"StylePropertyFunction"),Ae(Fu,"StyleExpression",{omit:["_evaluator"]}),Ae(Lu,"ZoomDependentExpression"),Ae(Ep,"ZoomConstantExpression"),Ae(Oo,"CompoundExpression",{omit:["_evaluate"]});for(const o in Ol)qu[Ol[o]._classRegistryKey]||Ae(Ol[o],`Expression${o}`);function In(o){return o&&typeof ArrayBuffer<"u"&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function Tn(o){return je.ImageBitmap&&o instanceof je.ImageBitmap}function _n(o,i){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(In(o)||Tn(o))return i&&i.push(o),o;if(ArrayBuffer.isView(o)){const s=o;return i&&i.push(s.buffer),s}if(o instanceof je.ImageData)return i&&i.push(o.data.buffer),o;if(Array.isArray(o)){const s=[];for(const c of o)s.push(_n(c,i));return s}if("object"==typeof o){const s=o.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const d=s.serialize?s.serialize(o,i):{};if(!s.serialize){for(const m in o)o.hasOwnProperty(m)&&(qu[c].omit.indexOf(m)>=0||(d[m]=_n(o[m],i)));o instanceof Error&&(d.message=o.message)}if(d.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(d.$name=c),d}throw new Error("can't serialize object of type "+typeof o)}function gi(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||In(o)||Tn(o)||ArrayBuffer.isView(o)||o instanceof je.ImageData)return o;if(Array.isArray(o))return o.map(gi);if("object"==typeof o){const i=o.$name||"Object",{klass:s}=qu[i];if(!s)throw new Error(`can't deserialize unregistered class ${i}`);if(s.deserialize)return s.deserialize(o);const c=Object.create(s.prototype);for(const d of Object.keys(o))"$name"!==d&&(c[d]=gi(o[d]));return c}throw new Error("can't deserialize object of type "+typeof o)}const pt={"Latin-1 Supplement":o=>o>=128&&o<=255,Arabic:o=>o>=1536&&o<=1791,"Arabic Supplement":o=>o>=1872&&o<=1919,"Arabic Extended-A":o=>o>=2208&&o<=2303,"Hangul Jamo":o=>o>=4352&&o<=4607,"Unified Canadian Aboriginal Syllabics":o=>o>=5120&&o<=5759,Khmer:o=>o>=6016&&o<=6143,"Unified Canadian Aboriginal Syllabics Extended":o=>o>=6320&&o<=6399,"General Punctuation":o=>o>=8192&&o<=8303,"Letterlike Symbols":o=>o>=8448&&o<=8527,"Number Forms":o=>o>=8528&&o<=8591,"Miscellaneous Technical":o=>o>=8960&&o<=9215,"Control Pictures":o=>o>=9216&&o<=9279,"Optical Character Recognition":o=>o>=9280&&o<=9311,"Enclosed Alphanumerics":o=>o>=9312&&o<=9471,"Geometric Shapes":o=>o>=9632&&o<=9727,"Miscellaneous Symbols":o=>o>=9728&&o<=9983,"Miscellaneous Symbols and Arrows":o=>o>=11008&&o<=11263,"CJK Radicals Supplement":o=>o>=11904&&o<=12031,"Kangxi Radicals":o=>o>=12032&&o<=12255,"Ideographic Description Characters":o=>o>=12272&&o<=12287,"CJK Symbols and Punctuation":o=>o>=12288&&o<=12351,Hiragana:o=>o>=12352&&o<=12447,Katakana:o=>o>=12448&&o<=12543,Bopomofo:o=>o>=12544&&o<=12591,"Hangul Compatibility Jamo":o=>o>=12592&&o<=12687,Kanbun:o=>o>=12688&&o<=12703,"Bopomofo Extended":o=>o>=12704&&o<=12735,"CJK Strokes":o=>o>=12736&&o<=12783,"Katakana Phonetic Extensions":o=>o>=12784&&o<=12799,"Enclosed CJK Letters and Months":o=>o>=12800&&o<=13055,"CJK Compatibility":o=>o>=13056&&o<=13311,"CJK Unified Ideographs Extension A":o=>o>=13312&&o<=19903,"Yijing Hexagram Symbols":o=>o>=19904&&o<=19967,"CJK Unified Ideographs":o=>o>=19968&&o<=40959,"Yi Syllables":o=>o>=40960&&o<=42127,"Yi Radicals":o=>o>=42128&&o<=42191,"Hangul Jamo Extended-A":o=>o>=43360&&o<=43391,"Hangul Syllables":o=>o>=44032&&o<=55215,"Hangul Jamo Extended-B":o=>o>=55216&&o<=55295,"Private Use Area":o=>o>=57344&&o<=63743,"CJK Compatibility Ideographs":o=>o>=63744&&o<=64255,"Arabic Presentation Forms-A":o=>o>=64336&&o<=65023,"Vertical Forms":o=>o>=65040&&o<=65055,"CJK Compatibility Forms":o=>o>=65072&&o<=65103,"Small Form Variants":o=>o>=65104&&o<=65135,"Arabic Presentation Forms-B":o=>o>=65136&&o<=65279,"Halfwidth and Fullwidth Forms":o=>o>=65280&&o<=65519};function Za(o){for(const i of o)if(Oc(i.charCodeAt(0)))return!0;return!1}function ps(o){for(const i of o)if(!Wu(i.charCodeAt(0)))return!1;return!0}function Wu(o){return!(pt.Arabic(o)||pt["Arabic Supplement"](o)||pt["Arabic Extended-A"](o)||pt["Arabic Presentation Forms-A"](o)||pt["Arabic Presentation Forms-B"](o))}function Oc(o){return!(746!==o&&747!==o&&(o<4352||!(pt["Bopomofo Extended"](o)||pt.Bopomofo(o)||pt["CJK Compatibility Forms"](o)&&!(o>=65097&&o<=65103)||pt["CJK Compatibility Ideographs"](o)||pt["CJK Compatibility"](o)||pt["CJK Radicals Supplement"](o)||pt["CJK Strokes"](o)||!(!pt["CJK Symbols and Punctuation"](o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||pt["CJK Unified Ideographs Extension A"](o)||pt["CJK Unified Ideographs"](o)||pt["Enclosed CJK Letters and Months"](o)||pt["Hangul Compatibility Jamo"](o)||pt["Hangul Jamo Extended-A"](o)||pt["Hangul Jamo Extended-B"](o)||pt["Hangul Jamo"](o)||pt["Hangul Syllables"](o)||pt.Hiragana(o)||pt["Ideographic Description Characters"](o)||pt.Kanbun(o)||pt["Kangxi Radicals"](o)||pt["Katakana Phonetic Extensions"](o)||pt.Katakana(o)&&12540!==o||!(!pt["Halfwidth and Fullwidth Forms"](o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!pt["Small Form Variants"](o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||pt["Unified Canadian Aboriginal Syllabics"](o)||pt["Unified Canadian Aboriginal Syllabics Extended"](o)||pt["Vertical Forms"](o)||pt["Yijing Hexagram Symbols"](o)||pt["Yi Syllables"](o)||pt["Yi Radicals"](o))))}function Pp(o){return!(Oc(o)||(i=o,pt["Latin-1 Supplement"](i)&&(167===i||169===i||174===i||177===i||188===i||189===i||190===i||215===i||247===i)||pt["General Punctuation"](i)&&(8214===i||8224===i||8225===i||8240===i||8241===i||8251===i||8252===i||8258===i||8263===i||8264===i||8265===i||8273===i)||pt["Letterlike Symbols"](i)||pt["Number Forms"](i)||pt["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||9003===i||i>=9085&&i<=9114||i>=9150&&i<=9165||9167===i||i>=9169&&i<=9179||i>=9186&&i<=9215)||pt["Control Pictures"](i)&&9251!==i||pt["Optical Character Recognition"](i)||pt["Enclosed Alphanumerics"](i)||pt["Geometric Shapes"](i)||pt["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||pt["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||pt["CJK Symbols and Punctuation"](i)||pt.Katakana(i)||pt["Private Use Area"](i)||pt["CJK Compatibility Forms"](i)||pt["Small Form Variants"](i)||pt["Halfwidth and Fullwidth Forms"](i)||8734===i||8756===i||8757===i||i>=9984&&i<=10087||i>=10102&&i<=10131||65532===i||65533===i));var i}function bm(o){return o>=1424&&o<=2303||pt["Arabic Presentation Forms-A"](o)||pt["Arabic Presentation Forms-B"](o)}function Rp(o,i){return!(!i&&bm(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||pt.Khmer(o))}function Nr(o){for(const i of o)if(bm(i.charCodeAt(0)))return!0;return!1}const jo="deferred",Zu="loading",ma="loaded";let Kr=null,f="unavailable",a=null;const h=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(f="error"),Kr&&Kr(o)};function _(){v.fire(new Va("pluginStateChange",{pluginStatus:f,pluginURL:a}))}const v=new mc,b=function(){return f},T=function(){if(f!==jo||!a)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");f=Zu,_(),a&&xl({url:a},o=>{o?h(o):(f=ma,_())})},M={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>f===ma||null!=M.applyArabicShaping,isLoading:()=>f===Zu,setState(o){f=o.pluginStatus,a=o.pluginURL},isParsed:()=>null!=M.applyArabicShaping&&null!=M.processBidirectionalText&&null!=M.processStyledBidirectionalText,getPluginURL:()=>a};class k{constructor(i,s){this.zoom=i,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(i){return function(s,c){for(const d of s)if(!Rp(d.charCodeAt(0),c))return!1;return!0}(i,M.isLoaded())}}class F{constructor(i,s){this.property=i,this.value=s,this.expression=function(c,d){if(Lr(c))return new ud(c,d);if(Dc(c)){const m=Bu(c,d);if("error"===m.result)throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=c;return"string"==typeof c&&"color"===d.type&&(m=Di.parse(c)),{kind:"constant",evaluate:()=>m}}}(void 0===s?i.specification.default:s,i.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(i,s,c){return this.property.possiblyEvaluate(this,i,s,c)}}class O{constructor(i){this.property=i,this.value=new F(i,void 0)}transitioned(i,s){return new $(this.property,this.value,s,Ii({},i.transition,this.transition),i.now)}untransitioned(){return new $(this.property,this.value,null,{},0)}}class z{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues)}getValue(i){return ho(this._values[i].value.value)}setValue(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new O(this._values[i].property)),this._values[i].value=new F(this._values[i].property,null===s?void 0:ho(s))}getTransition(i){return ho(this._values[i].transition)}setTransition(i,s){this._values.hasOwnProperty(i)||(this._values[i]=new O(this._values[i].property)),this._values[i].transition=ho(s)||void 0}serialize(){const i={};for(const s of Object.keys(this._values)){const c=this.getValue(s);void 0!==c&&(i[s]=c);const d=this.getTransition(s);void 0!==d&&(i[`${s}-transition`]=d)}return i}transitioned(i,s){const c=new Q(this._properties);for(const d of Object.keys(this._values))c._values[d]=this._values[d].transitioned(i,s._values[d]);return c}untransitioned(){const i=new Q(this._properties);for(const s of Object.keys(this._values))i._values[s]=this._values[s].untransitioned();return i}}class ${constructor(i,s,c,d,m){const y=d.delay||0,x=d.duration||0;m=m||0,this.property=i,this.value=s,this.begin=m+y,this.end=this.begin+x,i.specification.transition&&(d.delay||d.duration)&&(this.prior=c)}possiblyEvaluate(i,s,c){const d=i.now||0,m=this.value.possiblyEvaluate(i,s,c),y=this.prior;if(y){if(d>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(d<this.begin)return y.possiblyEvaluate(i,s,c);{const x=(d-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(i,s,c),m,_u(x))}}return m}}class Q{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,s,c){const d=new ee(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(i,s,c);return d}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class K{constructor(i){this._properties=i,this._values=Object.create(i.defaultPropertyValues)}getValue(i){return ho(this._values[i].value)}setValue(i,s){this._values[i]=new F(this._values[i].property,null===s?void 0:ho(s))}serialize(){const i={};for(const s of Object.keys(this._values)){const c=this.getValue(s);void 0!==c&&(i[s]=c)}return i}possiblyEvaluate(i,s,c){const d=new ee(this._properties);for(const m of Object.keys(this._values))d._values[m]=this._values[m].possiblyEvaluate(i,s,c);return d}}class X{constructor(i,s,c){this.property=i,this.value=s,this.parameters=c}isConstant(){return"constant"===this.value.kind}constantOr(i){return"constant"===this.value.kind?this.value.value:i}evaluate(i,s,c,d){return this.property.evaluate(this.value,this.parameters,i,s,c,d)}}class ee{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class V{constructor(i){this.specification=i}possiblyEvaluate(i,s){return i.expression.evaluate(s)}interpolate(i,s,c){const d=ro[this.specification.type];return d?d(i,s,c):i}}class W{constructor(i,s){this.specification=i,this.overrides=s}possiblyEvaluate(i,s,c,d){return new X(this,"constant"===i.expression.kind||"camera"===i.expression.kind?{kind:"constant",value:i.expression.evaluate(s,null,{},c,d)}:i.expression,s)}interpolate(i,s,c){if("constant"!==i.value.kind||"constant"!==s.value.kind)return i;if(void 0===i.value.value||void 0===s.value.value)return new X(this,{kind:"constant",value:void 0},i.parameters);const d=ro[this.specification.type];return d?new X(this,{kind:"constant",value:d(i.value.value,s.value.value,c)},i.parameters):i}evaluate(i,s,c,d,m,y){return"constant"===i.kind?i.value:i.evaluate(s,c,d,m,y)}}class ie{constructor(i){this.specification=i}possiblyEvaluate(i,s,c,d){return!!i.expression.evaluate(s,null,{},c,d)}interpolate(){return!1}}class te{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new k(0,{});for(const c in i){const d=i[c];d.specification.overridable&&this.overridableProperties.push(c);const m=this.defaultPropertyValues[c]=new F(d,void 0),y=this.defaultTransitionablePropertyValues[c]=new O(d);this.defaultTransitioningPropertyValues[c]=y.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=m.possiblyEvaluate(s)}}}function pe(o,i){return 256*(o=un(Math.floor(o),0,255))+un(Math.floor(i),0,255)}Ae(W,"DataDrivenProperty"),Ae(V,"DataConstantProperty"),Ae(ie,"ColorRampProperty");const me={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class fe{constructor(i,s){this._structArray=i,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class ve{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(i,s){return i._trim(),s&&(i.isTransferred=!0,s.push(i.arrayBuffer)),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const s=Object.create(this.prototype);return s.arrayBuffer=i.arrayBuffer,s.length=i.length,s.capacity=i.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function ye(o,i=1){let s=0,c=0;return{members:o.map(d=>{const m=me[d.type].BYTES_PER_ELEMENT,y=s=Me(s,Math.max(i,m)),x=d.components||1;return c=Math.max(c,m),s+=m*x,{name:d.name,type:d.type,components:x,offset:y}}),size:Me(s,Math.max(c,i)),alignment:i}}function Me(o,i){return Math.ceil(o/i)*i}class Ze extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s){const c=this.length;return this.resize(c+1),this.emplace(c,i,s)}emplace(i,s,c){const d=2*i;return this.int16[d+0]=s,this.int16[d+1]=c,i}}Ze.prototype.bytesPerElement=4,Ae(Ze,"StructArrayLayout2i4");class Ce extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,c)}emplace(i,s,c,d){const m=3*i;return this.int16[m+0]=s,this.int16[m+1]=c,this.int16[m+2]=d,i}}Ce.prototype.bytesPerElement=6,Ae(Ce,"StructArrayLayout3i6");class Be extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,c,d)}emplace(i,s,c,d,m){const y=4*i;return this.int16[y+0]=s,this.int16[y+1]=c,this.int16[y+2]=d,this.int16[y+3]=m,i}}Be.prototype.bytesPerElement=8,Ae(Be,"StructArrayLayout4i8");class Se extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,i,s,c,d,m,y,x)}emplace(i,s,c,d,m,y,x,E){const C=6*i,D=12*i,P=3*i;return this.int16[C+0]=s,this.int16[C+1]=c,this.uint8[D+4]=d,this.uint8[D+5]=m,this.uint8[D+6]=y,this.uint8[D+7]=x,this.float32[P+2]=E,i}}Se.prototype.bytesPerElement=12,Ae(Se,"StructArrayLayout2i4ub1f12");class Qe extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,c,d)}emplace(i,s,c,d,m){const y=4*i;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=d,this.float32[y+3]=m,i}}Qe.prototype.bytesPerElement=16,Ae(Qe,"StructArrayLayout4f16");class Te extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,i,s,c,d,m)}emplace(i,s,c,d,m,y){const x=6*i,E=3*i;return this.uint16[x+0]=s,this.uint16[x+1]=c,this.uint16[x+2]=d,this.uint16[x+3]=m,this.float32[E+2]=y,i}}Te.prototype.bytesPerElement=12,Ae(Te,"StructArrayLayout4ui1f12");class Le extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,c,d)}emplace(i,s,c,d,m){const y=4*i;return this.uint16[y+0]=s,this.uint16[y+1]=c,this.uint16[y+2]=d,this.uint16[y+3]=m,i}}Le.prototype.bytesPerElement=8,Ae(Le,"StructArrayLayout4ui8");class Xe extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,s,c,d,m,y)}emplace(i,s,c,d,m,y,x){const E=6*i;return this.int16[E+0]=s,this.int16[E+1]=c,this.int16[E+2]=d,this.int16[E+3]=m,this.int16[E+4]=y,this.int16[E+5]=x,i}}Xe.prototype.bytesPerElement=12,Ae(Xe,"StructArrayLayout6i12");class He extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x,E,C,D,P,R){const B=this.length;return this.resize(B+1),this.emplace(B,i,s,c,d,m,y,x,E,C,D,P,R)}emplace(i,s,c,d,m,y,x,E,C,D,P,R,B){const N=12*i;return this.int16[N+0]=s,this.int16[N+1]=c,this.int16[N+2]=d,this.int16[N+3]=m,this.uint16[N+4]=y,this.uint16[N+5]=x,this.uint16[N+6]=E,this.uint16[N+7]=C,this.int16[N+8]=D,this.int16[N+9]=P,this.int16[N+10]=R,this.int16[N+11]=B,i}}He.prototype.bytesPerElement=24,Ae(He,"StructArrayLayout4i4ui4i24");class nt extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y){const x=this.length;return this.resize(x+1),this.emplace(x,i,s,c,d,m,y)}emplace(i,s,c,d,m,y,x){const E=10*i,C=5*i;return this.int16[E+0]=s,this.int16[E+1]=c,this.int16[E+2]=d,this.float32[C+2]=m,this.float32[C+3]=y,this.float32[C+4]=x,i}}nt.prototype.bytesPerElement=20,Ae(nt,"StructArrayLayout3i3f20");class Ct extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint32[1*i+0]=s,i}}Ct.prototype.bytesPerElement=4,Ae(Ct,"StructArrayLayout1ul4");class zt extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x,E,C,D,P,R,B){const N=this.length;return this.resize(N+1),this.emplace(N,i,s,c,d,m,y,x,E,C,D,P,R,B)}emplace(i,s,c,d,m,y,x,E,C,D,P,R,B,N){const U=20*i,q=10*i;return this.int16[U+0]=s,this.int16[U+1]=c,this.int16[U+2]=d,this.int16[U+3]=m,this.int16[U+4]=y,this.float32[q+3]=x,this.float32[q+4]=E,this.float32[q+5]=C,this.float32[q+6]=D,this.int16[U+14]=P,this.uint32[q+8]=R,this.uint16[U+18]=B,this.uint16[U+19]=N,i}}zt.prototype.bytesPerElement=40,Ae(zt,"StructArrayLayout5i4f1i1ul2ui40");class vt extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x){const E=this.length;return this.resize(E+1),this.emplace(E,i,s,c,d,m,y,x)}emplace(i,s,c,d,m,y,x,E){const C=8*i;return this.int16[C+0]=s,this.int16[C+1]=c,this.int16[C+2]=d,this.int16[C+4]=m,this.int16[C+5]=y,this.int16[C+6]=x,this.int16[C+7]=E,i}}vt.prototype.bytesPerElement=16,Ae(vt,"StructArrayLayout3i2i2i16");class kt extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,i,s,c,d,m)}emplace(i,s,c,d,m,y){const x=4*i,E=8*i;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=d,this.int16[E+6]=m,this.int16[E+7]=y,i}}kt.prototype.bytesPerElement=16,Ae(kt,"StructArrayLayout2f1f2i16");class dn extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,c,d)}emplace(i,s,c,d,m){const y=12*i,x=3*i;return this.uint8[y+0]=s,this.uint8[y+1]=c,this.float32[x+1]=d,this.float32[x+2]=m,i}}dn.prototype.bytesPerElement=12,Ae(dn,"StructArrayLayout2ub2f12");class cn extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,c)}emplace(i,s,c,d){const m=3*i;return this.float32[m+0]=s,this.float32[m+1]=c,this.float32[m+2]=d,i}}cn.prototype.bytesPerElement=12,Ae(cn,"StructArrayLayout3f12");class Et extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,c){const d=this.length;return this.resize(d+1),this.emplace(d,i,s,c)}emplace(i,s,c,d){const m=3*i;return this.uint16[m+0]=s,this.uint16[m+1]=c,this.uint16[m+2]=d,i}}Et.prototype.bytesPerElement=6,Ae(Et,"StructArrayLayout3ui6");class Sn extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue){const ce=this.length;return this.resize(ce+1),this.emplace(ce,i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue)}emplace(i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue,ce){const xe=30*i,we=15*i,Oe=60*i;return this.int16[xe+0]=s,this.int16[xe+1]=c,this.int16[xe+2]=d,this.float32[we+2]=m,this.float32[we+3]=y,this.uint16[xe+8]=x,this.uint16[xe+9]=E,this.uint32[we+5]=C,this.uint32[we+6]=D,this.uint32[we+7]=P,this.uint16[xe+16]=R,this.uint16[xe+17]=B,this.uint16[xe+18]=N,this.float32[we+10]=U,this.float32[we+11]=q,this.uint8[Oe+48]=Y,this.uint8[Oe+49]=ae,this.uint8[Oe+50]=J,this.uint32[we+13]=oe,this.int16[xe+28]=ue,this.uint8[Oe+58]=ce,i}}Sn.prototype.bytesPerElement=60,Ae(Sn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Un extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue,ce,xe,we,Oe,We,De,ze,Ve,Ge){const Ye=this.length;return this.resize(Ye+1),this.emplace(Ye,i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue,ce,xe,we,Oe,We,De,ze,Ve,Ge)}emplace(i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q,Y,ae,J,oe,ue,ce,xe,we,Oe,We,De,ze,Ve,Ge,Ye){const Re=38*i,ut=19*i;return this.int16[Re+0]=s,this.int16[Re+1]=c,this.int16[Re+2]=d,this.float32[ut+2]=m,this.float32[ut+3]=y,this.int16[Re+8]=x,this.int16[Re+9]=E,this.int16[Re+10]=C,this.int16[Re+11]=D,this.int16[Re+12]=P,this.int16[Re+13]=R,this.uint16[Re+14]=B,this.uint16[Re+15]=N,this.uint16[Re+16]=U,this.uint16[Re+17]=q,this.uint16[Re+18]=Y,this.uint16[Re+19]=ae,this.uint16[Re+20]=J,this.uint16[Re+21]=oe,this.uint16[Re+22]=ue,this.uint16[Re+23]=ce,this.uint16[Re+24]=xe,this.uint16[Re+25]=we,this.uint16[Re+26]=Oe,this.uint16[Re+27]=We,this.uint16[Re+28]=De,this.uint32[ut+15]=ze,this.float32[ut+16]=Ve,this.float32[ut+17]=Ge,this.float32[ut+18]=Ye,i}}Un.prototype.bytesPerElement=76,Ae(Un,"StructArrayLayout3i2f6i15ui1ul3f76");class kn extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.float32[1*i+0]=s,i}}kn.prototype.bytesPerElement=4,Ae(kn,"StructArrayLayout1f4");class jn extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s,c,d,m){const y=this.length;return this.resize(y+1),this.emplace(y,i,s,c,d,m)}emplace(i,s,c,d,m,y){const x=5*i;return this.float32[x+0]=s,this.float32[x+1]=c,this.float32[x+2]=d,this.float32[x+3]=m,this.float32[x+4]=y,i}}jn.prototype.bytesPerElement=20,Ae(jn,"StructArrayLayout5f20");class ar extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s,c,d){const m=this.length;return this.resize(m+1),this.emplace(m,i,s,c,d)}emplace(i,s,c,d,m){const y=6*i;return this.uint32[3*i+0]=s,this.uint16[y+2]=c,this.uint16[y+3]=d,this.uint16[y+4]=m,i}}ar.prototype.bytesPerElement=12,Ae(ar,"StructArrayLayout1ul3ui12");class Si extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,s){const c=this.length;return this.resize(c+1),this.emplace(c,i,s)}emplace(i,s,c){const d=2*i;return this.uint16[d+0]=s,this.uint16[d+1]=c,i}}Si.prototype.bytesPerElement=4,Ae(Si,"StructArrayLayout2ui4");class yo extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const s=this.length;return this.resize(s+1),this.emplace(s,i)}emplace(i,s){return this.uint16[1*i+0]=s,i}}yo.prototype.bytesPerElement=2,Ae(yo,"StructArrayLayout1ui2");class oo extends ve{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,s){const c=this.length;return this.resize(c+1),this.emplace(c,i,s)}emplace(i,s,c){const d=2*i;return this.float32[d+0]=s,this.float32[d+1]=c,i}}oo.prototype.bytesPerElement=8,Ae(oo,"StructArrayLayout2f8");class Kn extends fe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}Kn.prototype.size=40;class Ln extends zt{get(i){return new Kn(this,i)}}Ae(Ln,"CollisionBoxArray");class Pn extends fe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}Pn.prototype.size=60;class wi extends Sn{get(i){return new Pn(this,i)}}Ae(wi,"PlacedSymbolArray");class Er extends fe{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(i){this._structArray.uint32[this._pos4+15]=i}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Er.prototype.size=76;class ni extends Un{get(i){return new Er(this,i)}}Ae(ni,"SymbolInstanceArray");class _i extends kn{getoffsetX(i){return this.float32[1*i+0]}}Ae(_i,"GlyphOffsetArray");class Qu extends Ze{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}Ae(Qu,"SymbolLineVertexArray");class fs extends fe{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}fs.prototype.size=12;class Qa extends ar{get(i){return new fs(this,i)}}Ae(Qa,"FeatureIndexArray");class ms extends Si{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}Ae(ms,"FillExtrusionCentroidArray");const gs=ye([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Bs=ye([{name:"a_dash",components:4,type:"Uint16"}]);var Xu={exports:{}},Em=function(o,i){var s,c,d,m,y,x,E,C;for(c=o.length-(s=3&o.length),d=i,y=3432918353,x=461845907,C=0;C<c;)E=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24,++C,d=27492+(65535&(m=5*(65535&(d=(d^=E=(65535&(E=(E=(65535&E)*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295)<<13|d>>>19))+((5*(d>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(E=0,s){case 3:E^=(255&o.charCodeAt(C+2))<<16;case 2:E^=(255&o.charCodeAt(C+1))<<8;case 1:d^=E=(65535&(E=(E=(65535&(E^=255&o.charCodeAt(C)))*y+(((E>>>16)*y&65535)<<16)&4294967295)<<15|E>>>17))*x+(((E>>>16)*x&65535)<<16)&4294967295}return d^=o.length,d=2246822507*(65535&(d^=d>>>16))+((2246822507*(d>>>16)&65535)<<16)&4294967295,d=3266489909*(65535&(d^=d>>>13))+((3266489909*(d>>>16)&65535)<<16)&4294967295,(d^=d>>>16)>>>0},_0=function(o,i){for(var s,c=o.length,d=i^c,m=0;c>=4;)s=1540483477*(65535&(s=255&o.charCodeAt(m)|(255&o.charCodeAt(++m))<<8|(255&o.charCodeAt(++m))<<16|(255&o.charCodeAt(++m))<<24))+((1540483477*(s>>>16)&65535)<<16),d=1540483477*(65535&d)+((1540483477*(d>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++m;switch(c){case 3:d^=(255&o.charCodeAt(m+2))<<16;case 2:d^=(255&o.charCodeAt(m+1))<<8;case 1:d=1540483477*(65535&(d^=255&o.charCodeAt(m)))+((1540483477*(d>>>16)&65535)<<16)}return d=1540483477*(65535&(d^=d>>>13))+((1540483477*(d>>>16)&65535)<<16),(d^=d>>>15)>>>0};Xu.exports=Em,Xu.exports.murmur3=Em,Xu.exports.murmur2=_0;var Ju=eo(Xu.exports);class ga{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(i,s,c,d){this.ids.push(iy(i)),this.positions.push(s,c,d)}getPositions(i){const s=iy(i);let c=0,d=this.ids.length-1;for(;c<d;){const y=c+d>>1;this.ids[y]>=s?d=y:c=y+1}const m=[];for(;this.ids[c]===s;)m.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return m}static serialize(i,s){const c=new Float64Array(i.ids),d=new Uint32Array(i.positions);return Op(c,d,0,c.length-1),s&&s.push(c.buffer,d.buffer),{ids:c,positions:d}}static deserialize(i){const s=new ga;return s.ids=i.ids,s.positions=i.positions,s.indexed=!0,s}}function iy(o){const i=+o;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Ju(String(o))}function Op(o,i,s,c){for(;s<c;){const d=o[s+c>>1];let m=s-1,y=c+1;for(;;){do{m++}while(o[m]<d);do{y--}while(o[y]>d);if(m>=y)break;yd(o,m,y),yd(i,3*m,3*y),yd(i,3*m+1,3*y+1),yd(i,3*m+2,3*y+2)}y-s<c-y?(Op(o,i,s,y),s=y+1):(Op(o,i,y+1,c),c=y)}}function yd(o,i,s){const c=o[i];o[i]=o[s],o[s]=c}Ae(ga,"FeaturePositionMap");class vo{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,s),this.initialized=!0),!!this.location}}class Fp extends vo{constructor(i){super(i),this.current=0}set(i,s,c){this.fetchUniformLocation(i,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class Cr extends vo{constructor(i){super(i),this.current=[0,0,0,0]}set(i,s,c){this.fetchUniformLocation(i,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Lp extends vo{constructor(i){super(i),this.current=Di.transparent}set(i,s,c){this.fetchUniformLocation(i,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const y0=new Float32Array(16),ry=new Float32Array(9),Bp=new Float32Array(4);function zl(o){return[pe(255*o.r,255*o.g),pe(255*o.b,255*o.a)]}class _a{constructor(i,s,c){this.value=i,this.uniformNames=s.map(d=>`u_${d}`),this.type=c}setUniform(i,s,c,d,m){s.set(i,m,d.constantOr(this.value))}getBinding(i,s){return"color"===this.type?new Lp(i):new Fp(i)}}class Ns{constructor(i,s){this.uniformNames=s.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(i){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br)}setUniform(i,s,c,d,m){const y="u_pattern"===m||"u_dash"===m?this.pattern:"u_pixel_ratio"===m?this.pixelRatio:null;y&&s.set(i,m,y)}getBinding(i,s){return"u_pattern"===s||"u_dash"===s?new Cr(i):new Fp(i)}}class ya{constructor(i,s,c,d){this.expression=i,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(m=>({name:`a_${m}`,type:"Float32",components:"color"===c?2:1,offset:0})),this.paintVertexArray=new d}populatePaintArray(i,s,c,d,m,y){const x=this.paintVertexArray.length,E=this.expression.evaluate(new k(0),s,{},m,d,y);this.paintVertexArray.resize(i),this._setPaintValue(x,i,E)}updatePaintArray(i,s,c,d,m){const y=this.expression.evaluate({zoom:0},c,d,void 0,m);this._setPaintValue(i,s,y)}_setPaintValue(i,s,c){if("color"===this.type){const d=zl(c);for(let m=i;m<s;m++)this.paintVertexArray.emplace(m,d[0],d[1])}else{for(let d=i;d<s;d++)this.paintVertexArray.emplace(d,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ho{constructor(i,s,c,d,m,y){this.expression=i,this.uniformNames=s.map(x=>`u_${x}_t`),this.type=c,this.useIntegerZoom=d,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=s.map(x=>({name:`a_${x}`,type:"Float32",components:"color"===c?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(i,s,c,d,m,y){const x=this.expression.evaluate(new k(this.zoom),s,{},m,d,y),E=this.expression.evaluate(new k(this.zoom+1),s,{},m,d,y),C=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(C,i,x,E)}updatePaintArray(i,s,c,d,m){const y=this.expression.evaluate({zoom:this.zoom},c,d,void 0,m),x=this.expression.evaluate({zoom:this.zoom+1},c,d,void 0,m);this._setPaintValue(i,s,y,x)}_setPaintValue(i,s,c,d){if("color"===this.type){const m=zl(c),y=zl(d);for(let x=i;x<s;x++)this.paintVertexArray.emplace(x,m[0],m[1],y[0],y[1])}else{for(let m=i;m<s;m++)this.paintVertexArray.emplace(m,c,d);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(d))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,s,c,d,m){const y=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,x=un(this.expression.interpolationFactor(y,this.zoom,this.zoom+1),0,1);s.set(i,m,x)}getBinding(i,s){return new Fp(i)}}class Go{constructor(i,s,c,d,m){this.expression=i,this.layerId=m,this.paintVertexAttributes=("array"===c?Bs:gs).members;for(let y=0;y<s.length;++y);this.paintVertexArray=new d}populatePaintArray(i,s,c){const d=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(d,i,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(i,s,c,d,m,y){this._setPaintValues(i,s,c.patterns&&c.patterns[this.layerId],y)}_setPaintValues(i,s,c,d){if(!d||!c)return;const m=d[c];if(!m)return;const{tl:y,br:x,pixelRatio:E}=m;for(let C=i;C<s;C++)this.paintVertexArray.emplace(C,y[0],y[1],x[0],x[1],E)}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Fc{constructor(i,s,c=(()=>!0)){this.binders={},this._buffers=[];const d=[];for(const m in i.paint._values){if(!c(m))continue;const y=i.paint.get(m);if(!(y instanceof X&&No(y.property.specification)))continue;const x=r1(m,i.type),E=y.value,C=y.property.specification.type,D=!!y.property.useIntegerZoom,P="line-dasharray"===m||m.endsWith("pattern"),R="line-dasharray"===m&&"constant"!==i.layout.get("line-cap").value.kind;if("constant"!==E.kind||R)if("source"===E.kind||R||P){const B=v0(m,C,"source");this.binders[m]=P?new Go(E,x,C,B,i.id):new ya(E,x,C,B),d.push(`/a_${m}`)}else{const B=v0(m,C,"composite");this.binders[m]=new Ho(E,x,C,D,s,B),d.push(`/z_${m}`)}else this.binders[m]=P?new Ns(E.value,x):new _a(E.value,x,C),d.push(`/u_${m}`)}this.cacheKey=d.sort().join("")}getMaxValue(i){const s=this.binders[i];return s instanceof ya||s instanceof Ho?s.maxValue:0}populatePaintArrays(i,s,c,d,m,y){for(const x in this.binders){const E=this.binders[x];(E instanceof ya||E instanceof Ho||E instanceof Go)&&E.populatePaintArray(i,s,c,d,m,y)}}setConstantPatternPositions(i){for(const s in this.binders){const c=this.binders[s];c instanceof Ns&&c.setConstantPatternPositions(i)}}updatePaintArrays(i,s,c,d,m,y){let x=!1;for(const E in i){const C=s.getPositions(E);for(const D of C){const P=c.feature(D.index);for(const R in this.binders){const B=this.binders[R];if((B instanceof ya||B instanceof Ho||B instanceof Go)&&!0===B.expression.isStateDependent){const N=d.paint.get(R);B.expression=N.value,B.updatePaintArray(D.start,D.end,P,i[E],m,y),x=!0}}}}return x}defines(){const i=[];for(const s in this.binders){const c=this.binders[s];(c instanceof _a||c instanceof Ns)&&i.push(...c.uniformNames.map(d=>`#define HAS_UNIFORM_${d}`))}return i}getBinderAttributes(){const i=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof ya||c instanceof Ho||c instanceof Go)for(let d=0;d<c.paintVertexAttributes.length;d++)i.push(c.paintVertexAttributes[d].name)}return i}getBinderUniforms(){const i=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof _a||c instanceof Ns||c instanceof Ho)for(const d of c.uniformNames)i.push(d)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const s=[];for(const c in this.binders){const d=this.binders[c];if(d instanceof _a||d instanceof Ns||d instanceof Ho)for(const m of d.uniformNames)s.push({name:m,property:c,binding:d.getBinding(i,m)})}return s}setUniforms(i,s,c,d,m){for(const{name:y,property:x,binding:E}of c)this.binders[x].setUniform(i,E,m,d.get(x),y)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const s=this.binders[i];(s instanceof ya||s instanceof Ho||s instanceof Go)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(i){for(const s in this.binders){const c=this.binders[s];(c instanceof ya||c instanceof Ho||c instanceof Go)&&c.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const s=this.binders[i];(s instanceof ya||s instanceof Ho||s instanceof Go)&&s.destroy()}}}class Lc{constructor(i,s,c=(()=>!0)){this.programConfigurations={};for(const d of i)this.programConfigurations[d.id]=new Fc(d,s,c);this.needsUpload=!1,this._featureMap=new ga,this._bufferOffset=0}populatePaintArrays(i,s,c,d,m,y,x){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(i,s,d,m,y,x);void 0!==s.id&&this._featureMap.add(s.id,c,this._bufferOffset,i),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,s,c,d,m){for(const y of c)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(i,this._featureMap,s,y,d,m)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const xt={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function r1(o,i){return xt[o]||[o.replace(`${i}-`,"").replace(/-/g,"_")]}const o1={"line-pattern":{source:Te,composite:Te},"fill-pattern":{source:Te,composite:Te},"fill-extrusion-pattern":{source:Te,composite:Te},"line-dasharray":{source:Le,composite:Le}},s1={color:{source:oo,composite:Qe},number:{source:kn,composite:oo}};function v0(o,i,s){const c=o1[o];return c&&c[s]||s1[i][s]}Ae(_a,"ConstantBinder"),Ae(Ns,"PatternConstantBinder"),Ae(ya,"SourceExpressionBinder"),Ae(Go,"PatternCompositeBinder"),Ae(Ho,"CompositeExpressionBinder"),Ae(Fc,"ProgramConfiguration",{omit:["_buffers"]}),Ae(Lc,"ProgramConfigurationSet");const A0="-transition";class va extends mc{constructor(i,s){if(super(),this.id=i.id,this.type=i.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==i.type&&(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,"background"!==i.type&&"sky"!==i.type&&(this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter),s.layout&&(this._unevaluatedLayout=new K(s.layout)),s.paint)){this._transitionablePaint=new z(s.paint);for(const c in i.paint)this.setPaintProperty(c,i.paint[c],{validate:!1});for(const c in i.layout)this.setLayoutProperty(c,i.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ee(s.paint)}}getLayoutProperty(i){return"visibility"===i?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,s,c={}){null!=s&&this._validate(Sp,`layers.${this.id}.layout.${i}`,i,s,c)||("visibility"!==i?this._unevaluatedLayout.setValue(i,s):this.visibility=s)}getPaintProperty(i){return _l(i,A0)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,s,c={}){if(null!=s&&this._validate(on,`layers.${this.id}.paint.${i}`,i,s,c))return!1;if(_l(i,A0))return this._transitionablePaint.setTransition(i.slice(0,-11),s||void 0),!1;{const d=this._transitionablePaint._values[i],m=d.value.isDataDriven(),y=d.value;this._transitionablePaint.setValue(i,s),this._handleSpecialPaintPropertyUpdate(i);const x=this._transitionablePaint._values[i].value,E=x.isDataDriven(),C=_l(i,"pattern")||"line-dasharray"===i;return E||m||C||this._handleOverridablePaintPropertyUpdate(i,y,x)}}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getProgramConfiguration(i){return null}_handleOverridablePaintPropertyUpdate(i,s,c){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||"none"===this.visibility}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,s)}serialize(){const i={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(i.layout=i.layout||{},i.layout.visibility=this.visibility),ia(i,(s,c)=>!(void 0===s||"layout"===c&&!Object.keys(s).length||"paint"===c&&!Object.keys(s).length))}_validate(i,s,c,d,m={}){return(!m||!1!==m.validate)&&kp(this,i.call($u,{key:s,layerType:this.type,objectKey:c,value:d,styleSpec:Fe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const i in this.paint._values){const s=this.paint.get(i);if(s instanceof X&&No(s.property.specification)&&("source"===s.value.kind||"composite"===s.value.kind)&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=pd(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const a1=ye([{name:"a_pos",components:2,type:"Int16"}],4),vd=ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Li{constructor(i=[]){this.segments=i}prepareSegment(i,s,c,d){let m=this.segments[this.segments.length-1];return i>Li.MAX_VERTEX_ARRAY_LENGTH&&ci(`Max vertices per segment is ${Li.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!m||m.vertexLength+i>Li.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==d)&&(m={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==d&&(m.sortKey=d),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const i of this.segments)for(const s in i.vaos)i.vaos[s].destroy()}static simpleSegment(i,s,c,d){return new Li([{vertexOffset:i,primitiveOffset:s,vertexLength:c,primitiveLength:d,vaos:{},sortKey:0}])}}Li.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ae(Li,"SegmentVector");var St=8192;class hi{constructor(i,s){i&&(s?this.setSouthWest(i).setNorthEast(s):4===i.length?this.setSouthWest([i[0],i[1]]).setNorthEast([i[2],i[3]]):this.setSouthWest(i[0]).setNorthEast(i[1]))}setNorthEast(i){return this._ne=i instanceof Rn?new Rn(i.lng,i.lat):Rn.convert(i),this}setSouthWest(i){return this._sw=i instanceof Rn?new Rn(i.lng,i.lat):Rn.convert(i),this}extend(i){const s=this._sw,c=this._ne;let d,m;if(i instanceof Rn)d=i,m=i;else{if(!(i instanceof hi))return Array.isArray(i)?4===i.length||i.every(Array.isArray)?this.extend(hi.convert(i)):this.extend(Rn.convert(i)):"object"==typeof i&&null!==i&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(Rn.convert(i)):this;if(d=i._sw,m=i._ne,!d||!m)return this}return s||c?(s.lng=Math.min(d.lng,s.lng),s.lat=Math.min(d.lat,s.lat),c.lng=Math.max(m.lng,c.lng),c.lat=Math.max(m.lat,c.lat)):(this._sw=new Rn(d.lng,d.lat),this._ne=new Rn(m.lng,m.lat)),this}getCenter(){return new Rn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new Rn(this.getWest(),this.getNorth())}getSouthEast(){return new Rn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:s,lat:c}=Rn.convert(i);let d=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(i){return!i||i instanceof hi?i:new hi(i)}}var Yu=1e-6,Ir=typeof Float32Array<"u"?Float32Array:Array;function oy(){var o=new Ir(9);return Ir!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function $o(o,i,s){var c=i[0],d=i[1],m=i[2],y=i[3],x=i[4],E=i[5],C=i[6],D=i[7],P=i[8],R=s[0],B=s[1],N=s[2],U=s[3],q=s[4],Y=s[5],ae=s[6],J=s[7],oe=s[8];return o[0]=R*c+B*y+N*C,o[1]=R*d+B*x+N*D,o[2]=R*m+B*E+N*P,o[3]=U*c+q*y+Y*C,o[4]=U*d+q*x+Y*D,o[5]=U*m+q*E+Y*P,o[6]=ae*c+J*y+oe*C,o[7]=ae*d+J*x+oe*D,o[8]=ae*m+J*E+oe*P,o}function zr(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Np(o,i){var s=i[0],c=i[1],d=i[2],m=i[3],y=i[4],x=i[5],E=i[6],C=i[7],D=i[8],P=i[9],R=i[10],B=i[11],N=i[12],U=i[13],q=i[14],Y=i[15],ae=s*x-c*y,J=s*E-d*y,oe=s*C-m*y,ue=c*E-d*x,ce=c*C-m*x,xe=d*C-m*E,we=D*U-P*N,Oe=D*q-R*N,We=D*Y-B*N,De=P*q-R*U,ze=P*Y-B*U,Ve=R*Y-B*q,Ge=ae*Ve-J*ze+oe*De+ue*We-ce*Oe+xe*we;return Ge?(o[0]=(x*Ve-E*ze+C*De)*(Ge=1/Ge),o[1]=(d*ze-c*Ve-m*De)*Ge,o[2]=(U*xe-q*ce+Y*ue)*Ge,o[3]=(R*ce-P*xe-B*ue)*Ge,o[4]=(E*We-y*Ve-C*Oe)*Ge,o[5]=(s*Ve-d*We+m*Oe)*Ge,o[6]=(q*oe-N*xe-Y*J)*Ge,o[7]=(D*xe-R*oe+B*J)*Ge,o[8]=(y*ze-x*We+C*we)*Ge,o[9]=(c*We-s*ze-m*we)*Ge,o[10]=(N*ce-U*oe+Y*ae)*Ge,o[11]=(P*oe-D*ce-B*ae)*Ge,o[12]=(x*Oe-y*De-E*we)*Ge,o[13]=(s*De-c*Oe+d*we)*Ge,o[14]=(U*J-N*ue-q*ae)*Ge,o[15]=(D*ue-P*J+R*ae)*Ge,o):null}function Aa(o,i,s){var c=i[0],d=i[1],m=i[2],y=i[3],x=i[4],E=i[5],C=i[6],D=i[7],P=i[8],R=i[9],B=i[10],N=i[11],U=i[12],q=i[13],Y=i[14],ae=i[15],J=s[0],oe=s[1],ue=s[2],ce=s[3];return o[0]=J*c+oe*x+ue*P+ce*U,o[1]=J*d+oe*E+ue*R+ce*q,o[2]=J*m+oe*C+ue*B+ce*Y,o[3]=J*y+oe*D+ue*N+ce*ae,o[4]=(J=s[4])*c+(oe=s[5])*x+(ue=s[6])*P+(ce=s[7])*U,o[5]=J*d+oe*E+ue*R+ce*q,o[6]=J*m+oe*C+ue*B+ce*Y,o[7]=J*y+oe*D+ue*N+ce*ae,o[8]=(J=s[8])*c+(oe=s[9])*x+(ue=s[10])*P+(ce=s[11])*U,o[9]=J*d+oe*E+ue*R+ce*q,o[10]=J*m+oe*C+ue*B+ce*Y,o[11]=J*y+oe*D+ue*N+ce*ae,o[12]=(J=s[12])*c+(oe=s[13])*x+(ue=s[14])*P+(ce=s[15])*U,o[13]=J*d+oe*E+ue*R+ce*q,o[14]=J*m+oe*C+ue*B+ce*Y,o[15]=J*y+oe*D+ue*N+ce*ae,o}function Xa(o,i,s){var c,d,m,y,x,E,C,D,P,R,B,N,U=s[0],q=s[1],Y=s[2];return i===o?(o[12]=i[0]*U+i[4]*q+i[8]*Y+i[12],o[13]=i[1]*U+i[5]*q+i[9]*Y+i[13],o[14]=i[2]*U+i[6]*q+i[10]*Y+i[14],o[15]=i[3]*U+i[7]*q+i[11]*Y+i[15]):(d=i[1],m=i[2],y=i[3],x=i[4],E=i[5],C=i[6],D=i[7],P=i[8],R=i[9],B=i[10],N=i[11],o[0]=c=i[0],o[1]=d,o[2]=m,o[3]=y,o[4]=x,o[5]=E,o[6]=C,o[7]=D,o[8]=P,o[9]=R,o[10]=B,o[11]=N,o[12]=c*U+x*q+P*Y+i[12],o[13]=d*U+E*q+R*Y+i[13],o[14]=m*U+C*q+B*Y+i[14],o[15]=y*U+D*q+N*Y+i[15]),o}function Bc(o,i,s){var c=s[0],d=s[1],m=s[2];return o[0]=i[0]*c,o[1]=i[1]*c,o[2]=i[2]*c,o[3]=i[3]*c,o[4]=i[4]*d,o[5]=i[5]*d,o[6]=i[6]*d,o[7]=i[7]*d,o[8]=i[8]*m,o[9]=i[9]*m,o[10]=i[10]*m,o[11]=i[11]*m,o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15],o}function sy(o,i,s){var c=Math.sin(s),d=Math.cos(s),m=i[4],y=i[5],x=i[6],E=i[7],C=i[8],D=i[9],P=i[10],R=i[11];return i!==o&&(o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[3],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[4]=m*d+C*c,o[5]=y*d+D*c,o[6]=x*d+P*c,o[7]=E*d+R*c,o[8]=C*d-m*c,o[9]=D*d-y*c,o[10]=P*d-x*c,o[11]=R*d-E*c,o}function zp(o,i,s){var c=Math.sin(s),d=Math.cos(s),m=i[0],y=i[1],x=i[2],E=i[3],C=i[8],D=i[9],P=i[10],R=i[11];return i!==o&&(o[4]=i[4],o[5]=i[5],o[6]=i[6],o[7]=i[7],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=m*d-C*c,o[1]=y*d-D*c,o[2]=x*d-P*c,o[3]=E*d-R*c,o[8]=m*c+C*d,o[9]=y*c+D*d,o[10]=x*c+P*d,o[11]=E*c+R*d,o}function x0(o,i){return o[0]=i[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=i[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=i[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function Ao(o,i,s){var c,d,m,y=s[0],x=s[1],E=s[2],C=Math.hypot(y,x,E);return C<Yu?null:(y*=C=1/C,x*=C,E*=C,c=Math.sin(i),d=Math.cos(i),o[0]=y*y*(m=1-d)+d,o[1]=x*y*m+E*c,o[2]=E*y*m-x*c,o[3]=0,o[4]=y*x*m-E*c,o[5]=x*x*m+d,o[6]=E*x*m+y*c,o[7]=0,o[8]=y*E*m+x*c,o[9]=x*E*m-y*c,o[10]=E*E*m+d,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o)}Math.hypot||(Math.hypot=function(){for(var o=0,i=arguments.length;i--;)o+=arguments[i]*arguments[i];return Math.sqrt(o)});var Cm=Aa;function Vl(){var o=new Ir(3);return Ir!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function b0(o){var i=new Ir(3);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i}function eh(o){return Math.hypot(o[0],o[1],o[2])}function th(o,i,s){var c=new Ir(3);return c[0]=o,c[1]=i,c[2]=s,c}function Ka(o,i,s){return o[0]=i[0]+s[0],o[1]=i[1]+s[1],o[2]=i[2]+s[2],o}function Im(o,i,s){return o[0]=i[0]-s[0],o[1]=i[1]-s[1],o[2]=i[2]-s[2],o}function ay(o,i,s){return o[0]=i[0]*s[0],o[1]=i[1]*s[1],o[2]=i[2]*s[2],o}function Ad(o,i,s){return o[0]=Math.min(i[0],s[0]),o[1]=Math.min(i[1],s[1]),o[2]=Math.min(i[2],s[2]),o}function xd(o,i,s){return o[0]=Math.max(i[0],s[0]),o[1]=Math.max(i[1],s[1]),o[2]=Math.max(i[2],s[2]),o}function so(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o}function Ul(o,i,s,c){return o[0]=i[0]+s[0]*c,o[1]=i[1]+s[1]*c,o[2]=i[2]+s[2]*c,o}function Tr(o,i){var s=i[0],c=i[1],d=i[2],m=s*s+c*c+d*d;return m>0&&(m=1/Math.sqrt(m)),o[0]=i[0]*m,o[1]=i[1]*m,o[2]=i[2]*m,o}function lr(o,i){return o[0]*i[0]+o[1]*i[1]+o[2]*i[2]}function Vp(o,i,s){var c=i[0],d=i[1],m=i[2],y=s[0],x=s[1],E=s[2];return o[0]=d*E-m*x,o[1]=m*y-c*E,o[2]=c*x-d*y,o}function ii(o,i,s){var c=i[0],d=i[1],m=i[2],y=s[3]*c+s[7]*d+s[11]*m+s[15];return o[0]=(s[0]*c+s[4]*d+s[8]*m+s[12])/(y=y||1),o[1]=(s[1]*c+s[5]*d+s[9]*m+s[13])/y,o[2]=(s[2]*c+s[6]*d+s[10]*m+s[14])/y,o}function ly(o,i,s){var c=s[0],d=s[1],m=s[2],y=i[0],x=i[1],E=i[2],C=d*E-m*x,D=m*y-c*E,P=c*x-d*y,R=d*P-m*D,B=m*C-c*P,N=c*D-d*C,U=2*s[3];return D*=U,P*=U,B*=2,N*=2,o[0]=y+(C*=U)+(R*=2),o[1]=x+D+B,o[2]=E+P+N,o}var nh,ao=Im,Up=ay,cy=eh;function uy(o,i,s){return o[0]=i[0]*s,o[1]=i[1]*s,o[2]=i[2]*s,o[3]=i[3]*s,o}function hy(o,i){var s=i[0],c=i[1],d=i[2],m=i[3],y=s*s+c*c+d*d+m*m;return y>0&&(y=1/Math.sqrt(y)),o[0]=s*y,o[1]=c*y,o[2]=d*y,o[3]=m*y,o}function _s(o,i,s){var c=i[0],d=i[1],m=i[2],y=i[3];return o[0]=s[0]*c+s[4]*d+s[8]*m+s[12]*y,o[1]=s[1]*c+s[5]*d+s[9]*m+s[13]*y,o[2]=s[2]*c+s[6]*d+s[10]*m+s[14]*y,o[3]=s[3]*c+s[7]*d+s[11]*m+s[15]*y,o}function ih(){var o=new Ir(4);return Ir!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function dy(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function w0(o,i,s){s*=.5;var c=i[0],d=i[1],m=i[2],y=i[3],x=Math.sin(s),E=Math.cos(s);return o[0]=c*E+y*x,o[1]=d*E+m*x,o[2]=m*E-d*x,o[3]=y*E-c*x,o}function Tm(o,i,s){s*=.5;var c=i[0],d=i[1],m=i[2],y=i[3],x=Math.sin(s),E=Math.cos(s);return o[0]=c*E-m*x,o[1]=d*E+y*x,o[2]=m*E+c*x,o[3]=y*E-d*x,o}Vl(),nh=new Ir(4),Ir!=Float32Array&&(nh[0]=0,nh[1]=0,nh[2]=0,nh[3]=0);var E0=hy;Vl(),th(1,0,0),th(0,1,0),ih(),ih(),oy();const l1=ye([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:py}=l1,fy=ye([{name:"a_pos_3",components:3,type:"Int16"}]);var bd=ye([{name:"a_pos",type:"Int16",components:2}]);class rh{constructor(i,s){this.pos=i,this.dir=s}intersectsPlane(i,s,c){const d=lr(s,this.dir);if(Math.abs(d)<1e-6)return!1;const m=((i[0]-this.pos[0])*s[0]+(i[1]-this.pos[1])*s[1]+(i[2]-this.pos[2])*s[2])/d;return c[0]=this.pos[0]+this.dir[0]*m,c[1]=this.pos[1]+this.dir[1]*m,c[2]=this.pos[2]+this.dir[2]*m,!0}closestPointOnSphere(i,s,c){if(U=(B=this.pos)[0],q=B[1],Y=B[2],ae=(N=i)[0],J=N[1],oe=N[2],Math.abs(U-ae)<=Yu*Math.max(1,Math.abs(U),Math.abs(ae))&&Math.abs(q-J)<=Yu*Math.max(1,Math.abs(q),Math.abs(J))&&Math.abs(Y-oe)<=Yu*Math.max(1,Math.abs(Y),Math.abs(oe))||0===s)return c[0]=c[1]=c[2]=0,!1;var B,N,U,q,Y,ae,J,oe;const[d,m,y]=this.dir,x=this.pos[0]-i[0],E=this.pos[1]-i[1],C=this.pos[2]-i[2],D=d*d+m*m+y*y,P=2*(x*d+E*m+C*y),R=P*P-4*D*(x*x+E*E+C*C-s*s);if(R<0){const B=Math.max(-P/2,0),N=x+d*B,U=E+m*B,q=C+y*B,Y=Math.hypot(N,U,q);return c[0]=N*s/Y,c[1]=U*s/Y,c[2]=q*s/Y,!1}{const B=(-P-Math.sqrt(R))/(2*D);if(B<0){const N=Math.hypot(x,E,C);return c[0]=x*s/N,c[1]=E*s/N,c[2]=C*s/N,!1}return c[0]=x+d*B,c[1]=E+m*B,c[2]=C+y*B,!0}}}class jp{constructor(i,s,c,d,m){this.TL=i,this.TR=s,this.BR=c,this.BL=d,this.horizon=m}static fromInvProjectionMatrix(i,s,c){const d=[-1,1,1],m=[1,1,1],y=[1,-1,1],x=[-1,-1,1],E=ii(d,d,i),C=ii(m,m,i),D=ii(y,y,i),P=ii(x,x,i);return new jp(E,C,D,P,s/c)}}class Mm{constructor(i,s){this.points=i,this.planes=s}static fromInvProjectionMatrix(i,s,c,d){const m=Math.pow(2,c),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const C=_s([],E,i),D=1/C[3]/s*m;return(P=C)[0]=(R=C)[0]*(B=[D,D,d?1/C[3]:D,D])[0],P[1]=R[1]*B[1],P[2]=R[2]*B[2],P[3]=R[3]*B[3],P;var P,R,B}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const C=Tr([],Vp([],ao([],y[E[0]],y[E[1]]),ao([],y[E[2]],y[E[1]]))),D=-lr(C,y[E[1]]);return C.concat(D)});return new Mm(y,x)}}class Vr{static fromPoints(i){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const d of i)Ad(s,s,d),xd(c,c,d);return new Vr(s,c)}static applyTransform(i,s){const c=i.getCorners();for(let d=0;d<c.length;++d)ii(c[d],c[d],s);return Vr.fromPoints(c)}constructor(i,s){this.min=i,this.max=s,this.center=so([],Ka([],this.min,this.max),.5)}quadrant(i){const s=[i%2==0,i<2],c=b0(this.min),d=b0(this.max);for(let m=0;m<s.length;m++)c[m]=s[m]?this.min[m]:this.center[m],d[m]=s[m]?this.center[m]:this.max[m];return d[2]=this.max[2],new Vr(c,d)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,s=this.max;return[[i[0],i[1],i[2]],[s[0],i[1],i[2]],[s[0],s[1],i[2]],[i[0],s[1],i[2]],[i[0],i[1],s[2]],[s[0],i[1],s[2]],[s[0],s[1],s[2]],[i[0],s[1],s[2]]]}intersects(i){const s=this.getCorners();let c=!0;for(let d=0;d<i.planes.length;d++){const m=i.planes[d];let y=0;for(let x=0;x<s.length;x++)y+=lr(m,s[x])+m[3]>=0;if(0===y)return 0;y!==s.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let x=0;x<i.points.length;x++){const E=i.points[x][d]-this.min[d];m=Math.min(m,E),y=Math.max(y,E)}if(y<0||m>this.max[d]-this.min[d])return 0}return 1}}const my=5,Dm=6,Ja=St/Math.PI/2,C0=16383,zc=[64,32,16],zs=-Ja,Vs=Ja,Sm=[new Vr([zs,zs,zs],[Vs,Vs,Vs]),new Vr([zs,zs,zs],[0,0,Vs]),new Vr([0,zs,zs],[Vs,0,Vs]),new Vr([zs,0,zs],[0,Vs,Vs]),new Vr([0,0,zs],[Vs,Vs,Vs])];function km(o){return o*Ja/ah}function I0(o,i,s,c=!0){const d=so([],o._camera.position,o.worldSize),m=[i,s,1,1];_s(m,m,o.pixelMatrixInverse),uy(m,m,1/m[3]);const y=Tr([],ao([],m,d)),x=o.globeMatrix,E=[x[12],x[13],x[14]],C=ao([],E,d),D=eh(C),P=Tr([],C),R=o.worldSize/(2*Math.PI),B=lr(P,y),N=Math.asin(R/D);if(N<Math.acos(B)){if(!c)return null;const We=[],De=[];so(We,y,D/B),Tr(De,ao(De,We,C)),Tr(y,Ka(y,C,so(y,De,Math.tan(N)*D)))}const U=[];new rh(d,y).closestPointOnSphere(E,R,U);const q=Tr([],oa(x,0)),Y=Tr([],oa(x,1)),ae=Tr([],oa(x,2)),J=lr(q,U),oe=lr(Y,U),ue=lr(ae,U),ce=qi(Math.asin(-oe/R));let xe=qi(Math.atan2(J,ue));xe=o.center.lng+function(We,De){const ze=(De-We+180)%360-180;return ze<-180?ze+360:ze}(o.center.lng,xe);const we=Us(xe),Oe=un(xa(ce),0,1);return new lh(we,Oe)}class c1{constructor(i,s,c){this.a=ao([],i,c),this.b=ao([],s,c),this.center=c;const d=Tr([],this.a),m=Tr([],this.b);this.angle=Math.acos(lr(d,m))}}function gy(o,i){if(0===o.angle)return null;let s;return s=0===o.a[i]?1/o.angle*.5*Math.PI:1/o.angle*Math.atan(o.b[i]/o.a[i]/Math.sin(o.angle)-1/Math.tan(o.angle)),s<0||s>1?null:function(c,d,m,y){const x=Math.sin(m);return c*(Math.sin((1-y)*m)/x)+d*(Math.sin(y*m)/x)}(o.a[i],o.b[i],o.angle,un(s,0,1))+o.center[i]}function Ya(o){if(o.z<=1)return Sm[o.z+2*o.y+o.x];const i=Gp(wd(o));return Vr.fromPoints(i)}function Vc(o,i,s){return so(o,o,1-s),Ul(o,o,i,s)}function Pm(o,i){const s=sh(i.zoom);if(0===s)return Ya(o);const c=wd(o),d=Gp(c),m=Us(c.getWest())*i.worldSize,y=Us(c.getEast())*i.worldSize,x=xa(c.getNorth())*i.worldSize,E=xa(c.getSouth())*i.worldSize,C=[m,x,0],D=[y,x,0],P=[m,E,0],R=[y,E,0],B=Np([],i.globeMatrix);return ii(C,C,B),ii(D,D,B),ii(P,P,B),ii(R,R,B),d[0]=Vc(d[0],P,s),d[1]=Vc(d[1],R,s),d[2]=Vc(d[2],D,s),d[3]=Vc(d[3],C,s),Vr.fromPoints(d)}function Hp(o,i,s){for(const c of o)ii(c,c,i),so(c,c,s)}function wd({x:o,y:i,z:s}){const c=1/(1<<s),d=new Rn(qo(o*c),ur((i+1)*c)),m=new Rn(qo((o+1)*c),ur(i*c));return new hi(d,m)}function Gp(o){const i=sn(o.getNorth()),s=sn(o.getSouth()),c=Math.cos(i),d=Math.cos(s),m=Math.sin(i),y=Math.sin(s),x=o.getWest(),E=o.getEast();return[cr(d,y,x),cr(d,y,E),cr(c,m,E),cr(c,m,x)]}function cr(o,i,s,c=Ja){return s=sn(s),[o*Math.sin(s)*c,-i*c,o*Math.cos(s)*c]}function oh(o,i,s){return cr(Math.cos(sn(o)),Math.sin(sn(o)),i,s)}function Ed(o,i,s,c){const d=1<<s.z,m=(o/St+s.x)/d;return oh(ur((i/St+s.y)/d),qo(m),c)}function $p({min:o,max:i}){return C0/Math.max(i[0]-o[0],i[1]-o[1],i[2]-o[2])}const Rm=new Float64Array(16);function Uc(o){const i=$p(o),s=x0(Rm,[i,i,i]);return Xa(s,s,((c=[])[0]=-(d=o.min)[0],c[1]=-d[1],c[2]=-d[2],c));var c,d}function Om(o){const i=(c=o.min,(s=Rm)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=c[0],s[13]=c[1],s[14]=c[2],s[15]=1,s);var s,c;const d=1/$p(o);return Bc(i,i,[d,d,d])}function yy(o,i,s,c,d){const m=function(E){const C=St/(2*Math.PI);return E/(2*Math.PI)/C}(s),y=[o,i,-s/(2*Math.PI)],x=zr(new Float64Array(16));return Xa(x,x,y),Bc(x,x,[m,m,m]),sy(x,x,sn(-d)),zp(x,x,sn(-c)),x}function sh(o){return Fa(my,Dm,o)}function Fm(o,i){const s=oh(i.lat,i.lng);return y=(d=Im([],function(N){const U=oh(N._center.lat,N._center.lng);let q=Vp([],th(0,1,0),U);const Y=Ao([],-N.angle,U);q=ii(q,q,Y),Ao(Y,-N._pitch,q);const ae=Tr([],U);return so(ae,ae,km(N.cameraToCenterDistance/N.pixelsPerMeter)),ii(ae,ae,Y),Ka([],U,ae)}(o),s))[0],x=d[1],E=d[2],C=(m=s)[0],D=m[1],P=m[2],B=(R=Math.sqrt(y*y+x*x+E*E)*Math.sqrt(C*C+D*D+P*P))&&lr(d,m)/R,Math.acos(Math.min(Math.max(B,-1),1));var d,m,y,x,E,C,D,P,R,B}function Lm(o,i){return Fm(o,i)>Math.PI/2*1.01}const vy=sn(85),xo=Math.cos(vy),Bm=Math.sin(vy),ah=6371008.8,qp=2*Math.PI*ah;class ki{constructor(i,s){if(isNaN(i)||isNaN(s))throw new Error(`Invalid LngLat object: (${i}, ${s})`);if(this.lng=+i,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ki(fn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const s=Math.PI/180,c=this.lat*s,d=i.lat*s,m=Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos((i.lng-this.lng)*s);return ah*Math.acos(Math.min(m,1))}toBounds(i=0){const s=360*i/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new hi(new ki(this.lng-c,this.lat-s),new ki(this.lng+c,this.lat+s))}toEcef(i){const s=km(i);return oh(this.lat,this.lng,Ja+s)}static convert(i){if(i instanceof ki)return i;if(Array.isArray(i)&&(2===i.length||3===i.length))return new ki(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&"object"==typeof i&&null!==i)return new ki(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var Rn=ki;function Wp(o){return qp*Math.cos(o*Math.PI/180)}function Us(o){return(180+o)/360}function xa(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function ys(o,i){return o/Wp(i)}function qo(o){return 360*o-180}function ur(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function Ay(o,i){return o*Wp(ur(i))}const hr=85.051129;function xy(o){return 1/Math.cos(o*Math.PI/180)}class lh{constructor(i,s,c=0){this.x=+i,this.y=+s,this.z=+c}static fromLngLat(i,s=0){const c=Rn.convert(i);return new lh(Us(c.lng),xa(c.lat),ys(s,c.lat))}toLngLat(){return new Rn(qo(this.x),ur(this.y))}toAltitude(){return Ay(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/qp*xy(ur(this.y))}}function Cd(o,i,s,c,d,m,y,x,E){const C=(i+c)/2,D=(s+d)/2,P=new lt(C,D);x(P),function(R,B,N,U,q,Y){const ae=N-q,J=U-Y;return Math.abs((U-B)*ae-(N-R)*J)/Math.hypot(ae,J)}(P.x,P.y,m.x,m.y,y.x,y.y)>=E?(Cd(o,i,s,C,D,m,P,x,E),Cd(o,C,D,c,d,P,y,x,E)):o.push(y)}function Zp(o,i,s){let c=o[0],d=c.x,m=c.y;i(c);const y=[c];for(let x=1;x<o.length;x++){const E=o[x],{x:C,y:D}=E;i(E),Cd(y,d,m,C,D,c,E,i,s),d=C,m=D,c=E}return y}function Nm(o,i,s,c){if(c(i,s)){const d=i.add(s)._mult(.5);Nm(o,i,d,c),Nm(o,d,s,c)}else o.push(s)}function Id(o,i){let s=o[0];const c=[s];for(let d=1;d<o.length;d++){const m=o[d];Nm(c,s,m,i),s=m}return c}const zm=Math.pow(2,14)-1,by=-zm-1;function Vm(o,i){const s=Math.round(o.x*i),c=Math.round(o.y*i);return o.x=un(s,by,zm),o.y=un(c,by,zm),(s<o.x||s>o.x+1||c<o.y||c>o.y+1)&&ci("Geometry exceeds allowed extent, reduce your vector tile buffer size"),o}function js(o,i,s){const c=o.loadGeometry(),d=o.extent,m=St/d;if(i&&s&&s.projection.isReprojectedInTileSpace){const y=1<<i.z,{scale:x,x:E,y:C,projection:D}=s,P=R=>{const B=qo((i.x+R.x/d)/y),N=ur((i.y+R.y/d)/y),U=D.project(B,N);R.x=(U.x*x-E)*d,R.y=(U.y*x-C)*d};for(let R=0;R<c.length;R++)if(1!==o.type)c[R]=Zp(c[R],P,1);else{const B=[];for(const N of c[R])N.x<0||N.x>=d||N.y<0||N.y>=d||(P(N),B.push(N));c[R]=B}}for(const y of c)for(const x of y)Vm(x,m);return c}function jl(o,i){return{type:o.type,id:o.id,properties:o.properties,geometry:i?js(o):[]}}function el(o,i,s,c,d){o.emplaceBack(2*i+(c+1)/2,2*s+(d+1)/2)}function ch(o,i,s){o.emplaceBack(i.x,i.y,i.z,16384*s[0],16384*s[1],16384*s[2])}class Qp{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new Ze,this.indexArray=new Et,this.segments=new Li,this.programConfigurations=new Lc(i.layers,i.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,c,d){const m=this.layers[0],y=[];let x=null;"circle"===m.type&&(x=m.layout.get("circle-sort-key"));for(const{feature:C,id:D,index:P,sourceLayerIndex:R}of i){const B=this.layers[0]._featureFilter.needGeometry,N=jl(C,B);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),N,c))continue;const U=x?x.evaluate(N,{},c):void 0,q={id:D,properties:C.properties,type:C.type,sourceLayerIndex:R,index:P,geometry:B?N.geometry:js(C,c,d),patterns:{},sortKey:U};y.push(q)}x&&y.sort((C,D)=>C.sortKey-D.sortKey);let E=null;"globe"===d.projection.name&&(this.globeExtVertexArray=new Xe,E=d.projection);for(const C of y){const{geometry:D,index:P,sourceLayerIndex:R}=C,B=i[P].feature;this.addFeature(C,D,P,s.availableImages,c,E),s.featureIndex.insert(B,D,P,R,this.index)}}update(i,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,a1.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,vd.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(i,s,c,d,m,y){for(const x of s)for(const E of x){const C=E.x,D=E.y;if(C<0||C>=St||D<0||D>=St)continue;if(y){const B=y.projectTilePoint(C,D,m),N=y.upVector(m,C,D),U=this.globeExtVertexArray;ch(U,B,N),ch(U,B,N),ch(U,B,N),ch(U,B,N)}const P=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),R=P.vertexLength;el(this.layoutVertexArray,C,D,-1,-1),el(this.layoutVertexArray,C,D,1,-1),el(this.layoutVertexArray,C,D,1,1),el(this.layoutVertexArray,C,D,-1,1),this.indexArray.emplaceBack(R,R+1,R+2),this.indexArray.emplaceBack(R,R+2,R+3),P.vertexLength+=4,P.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,{},d,m)}}function wy(o,i){for(let s=0;s<o.length;s++)if(tl(i,o[s]))return!0;for(let s=0;s<i.length;s++)if(tl(o,i[s]))return!0;return!!jm(o,i)}function Um(o,i,s){return!!tl(o,i)||!!Hm(i,o,s)}function Ey(o,i){if(1===o.length)return Gm(i,o[0]);for(let s=0;s<i.length;s++){const c=i[s];for(let d=0;d<c.length;d++)if(tl(o,c[d]))return!0}for(let s=0;s<o.length;s++)if(Gm(i,o[s]))return!0;for(let s=0;s<i.length;s++)if(jm(o,i[s]))return!0;return!1}function T0(o,i,s){if(o.length>1){if(jm(o,i))return!0;for(let c=0;c<i.length;c++)if(Hm(i[c],o,s))return!0}for(let c=0;c<o.length;c++)if(Hm(o[c],i,s))return!0;return!1}function jm(o,i){if(0===o.length||0===i.length)return!1;for(let s=0;s<o.length-1;s++){const c=o[s],d=o[s+1];for(let m=0;m<i.length-1;m++)if(M0(c,d,i[m],i[m+1]))return!0}return!1}function M0(o,i,s,c){return So(o,s,c)!==So(i,s,c)&&So(o,i,s)!==So(o,i,c)}function Hm(o,i,s){const c=s*s;if(1===i.length)return o.distSqr(i[0])<c;for(let d=1;d<i.length;d++)if(Cy(o,i[d-1],i[d])<c)return!0;return!1}function Cy(o,i,s){const c=i.distSqr(s);if(0===c)return o.distSqr(i);const d=((o.x-i.x)*(s.x-i.x)+(o.y-i.y)*(s.y-i.y))/c;return o.distSqr(d<0?i:d>1?s:s.sub(i)._mult(d)._add(i))}function Gm(o,i){let s,c,d,m=!1;for(let y=0;y<o.length;y++){s=o[y];for(let x=0,E=s.length-1;x<s.length;E=x++)c=s[x],d=s[E],c.y>i.y!=d.y>i.y&&i.x<(d.x-c.x)*(i.y-c.y)/(d.y-c.y)+c.x&&(m=!m)}return m}function tl(o,i){let s=!1;for(let c=0,d=o.length-1;c<o.length;d=c++){const m=o[c],y=o[d];m.y>i.y!=y.y>i.y&&i.x<(y.x-m.x)*(i.y-m.y)/(y.y-m.y)+m.x&&(s=!s)}return s}function $m(o,i,s,c,d){for(const y of o)if(i<=y.x&&s<=y.y&&c>=y.x&&d>=y.y)return!0;const m=[new lt(i,s),new lt(i,d),new lt(c,d),new lt(c,s)];if(o.length>2)for(const y of m)if(tl(o,y))return!0;for(let y=0;y<o.length-1;y++)if(qm(o[y],o[y+1],m))return!0;return!1}function qm(o,i,s){const c=s[0],d=s[2];if(o.x<c.x&&i.x<c.x||o.x>d.x&&i.x>d.x||o.y<c.y&&i.y<c.y||o.y>d.y&&i.y>d.y)return!1;const m=So(o,i,s[0]);return m!==So(o,i,s[1])||m!==So(o,i,s[2])||m!==So(o,i,s[3])}function uh(o,i,s){const c=i.paint.get(o).value;return"constant"===c.kind?c.value:s.programConfigurations.get(i.id).getMaxValue(o)}function Xp(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Wm(o,i,s,c,d){if(!i[0]&&!i[1])return o;const m=lt.convert(i)._mult(d);"viewport"===s&&m._rotate(-c);const y=[];for(let x=0;x<o.length;x++)y.push(o[x].sub(m));return y}function Zm(o,i,s,c){const d=lt.convert(o)._mult(c);return"viewport"===i&&d._rotate(-s),d}Ae(Qp,"CircleBucket",{omit:["layers"]});const jc=new te({"circle-sort-key":new W(Fe.layout_circle["circle-sort-key"])});var Iy={paint:new te({"circle-radius":new W(Fe.paint_circle["circle-radius"]),"circle-color":new W(Fe.paint_circle["circle-color"]),"circle-blur":new W(Fe.paint_circle["circle-blur"]),"circle-opacity":new W(Fe.paint_circle["circle-opacity"]),"circle-translate":new V(Fe.paint_circle["circle-translate"]),"circle-translate-anchor":new V(Fe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new V(Fe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new V(Fe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new W(Fe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new W(Fe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new W(Fe.paint_circle["circle-stroke-opacity"])}),layout:jc};function Qm(o,i,s,c,d,m,y,x,E){if(m&&o.queryGeometry.isAboveHorizon)return!1;m&&(E*=o.pixelToTileUnitsFactor);const C=o.tileID.canonical,D=s.projection.upVectorScale(C,s.center.lat,s.worldSize).metersToTile;for(const P of i)for(const R of P){const B=R.add(x),N=d&&s.elevation?s.elevation.exaggeration()*d.getElevationAt(B.x,B.y,!0):0,U=s.projection.projectTilePoint(B.x,B.y,C);if(N>0){const J=s.projection.upVector(C,B.x,B.y);U.x+=J[0]*D*N,U.y+=J[1]*D*N,U.z+=J[2]*D*N}const q=m?B:D0(U.x,U.y,U.z,c),Y=m?o.tilespaceRays.map(J=>k0(J,N)):o.queryGeometry.screenGeometry,ae=_s([],[U.x,U.y,U.z,1],c);if(!y&&m?E*=ae[3]/s.cameraToCenterDistance:y&&!m&&(E*=s.cameraToCenterDistance/ae[3]),m){const J=ur((R.y/St+C.y)/(1<<C.z));E/=s.projection.pixelsPerMeter(J,1)/ys(1,J)}if(Um(Y,q,E))return!0}return!1}function D0(o,i,s,c){const d=_s([],[o,i,s,1],c);return new lt(d[0]/d[3],d[1]/d[3])}const S0=th(0,0,0),Kp=th(0,0,1);function k0(o,i){const s=Vl();return S0[2]=i,o.intersectsPlane(S0,Kp,s),new lt(s[0],s[1])}class Xm extends Qp{}function Km(o,{width:i,height:s},c,d){if(d){if(d instanceof Uint8ClampedArray)d=new Uint8Array(d.buffer);else if(d.length!==i*s*c)throw new RangeError("mismatched image size")}else d=new Uint8Array(i*s*c);return o.width=i,o.height=s,o.data=d,o}function Jm(o,i,s){const{width:c,height:d}=i;c===o.width&&d===o.height||(Td(o,i,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,c),height:Math.min(o.height,d)},s),o.width=c,o.height=d,o.data=i.data)}function Td(o,i,s,c,d,m){if(0===d.width||0===d.height)return i;if(d.width>o.width||d.height>o.height||s.x>o.width-d.width||s.y>o.height-d.height)throw new RangeError("out of range source coordinates for image copy");if(d.width>i.width||d.height>i.height||c.x>i.width-d.width||c.y>i.height-d.height)throw new RangeError("out of range destination coordinates for image copy");const y=o.data,x=i.data;for(let E=0;E<d.height;E++){const C=((s.y+E)*o.width+s.x)*m,D=((c.y+E)*i.width+c.x)*m;for(let P=0;P<d.width*m;P++)x[D+P]=y[C+P]}return i}Ae(Xm,"HeatmapBucket",{omit:["layers"]});class ba{constructor(i,s){Km(this,i,1,s)}resize(i){Jm(this,new ba(i),1)}clone(){return new ba({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,c,d,m){Td(i,s,c,d,m,1)}}class Ur{constructor(i,s){Km(this,i,4,s)}resize(i){Jm(this,new Ur(i),4)}replace(i,s){s?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new Ur({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,s,c,d,m){Td(i,s,c,d,m,4)}}Ae(ba,"AlphaImage"),Ae(Ur,"RGBAImage");var Jp={paint:new te({"heatmap-radius":new W(Fe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new W(Fe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new V(Fe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ie(Fe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new V(Fe.paint_heatmap["heatmap-opacity"])})};function Yp(o){const i={},s=o.resolution||256,c=o.clips?o.clips.length:1,d=o.image||new Ur({width:s,height:c}),m=(y,x,E)=>{i[o.evaluationKey]=E;const C=o.expression.evaluate(i);d.data[y+x+0]=Math.floor(255*C.r/C.a),d.data[y+x+1]=Math.floor(255*C.g/C.a),d.data[y+x+2]=Math.floor(255*C.b/C.a),d.data[y+x+3]=Math.floor(255*C.a)};if(o.clips)for(let y=0,x=0;y<c;++y,x+=4*s)for(let E=0,C=0;E<s;E++,C+=4){const D=E/(s-1),{start:P,end:R}=o.clips[y];m(x,C,P*(1-D)+R*D)}else for(let y=0,x=0;y<s;y++,x+=4)m(0,x,y/(s-1));return d}var Ym={paint:new te({"hillshade-illumination-direction":new V(Fe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new V(Fe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new V(Fe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new V(Fe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new V(Fe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new V(Fe.paint_hillshade["hillshade-accent-color"])})};const eg=ye([{name:"a_pos",components:2,type:"Int16"}],4),{members:tg}=eg;var Hc={exports:{}};function ef(o,i,s){s=s||2;var c,d,m,y,x,E,C,D=i&&i.length,P=D?i[0]*s:o.length,R=ng(o,0,P,s,!0),B=[];if(!R||R.next===R.prev)return B;if(D&&(R=function(U,q,Y,ae){var J,oe,ue,ce=[];for(J=0,oe=q.length;J<oe;J++)(ue=ng(U,q[J]*ae,J<oe-1?q[J+1]*ae:U.length,ae,!1))===ue.next&&(ue.steiner=!0),ce.push(u1(ue));for(ce.sort(ig),J=0;J<ce.length;J++)Y=hh(ce[J],Y);return Y}(o,i,R,s)),o.length>80*s){c=m=o[0],d=y=o[1];for(var N=s;N<P;N+=s)(x=o[N])<c&&(c=x),(E=o[N+1])<d&&(d=E),x>m&&(m=x),E>y&&(y=E);C=0!==(C=Math.max(m-c,y-d))?32767/C:0}return Md(R,B,s,c,d,C,0),B}function ng(o,i,s,c,d){var m,y;if(d===lg(o,i,s,c)>0)for(m=i;m<s;m+=c)y=Hl(m,o[m],o[m+1],y);else for(m=s-c;m>=i;m-=c)y=Hl(m,o[m],o[m+1],y);return y&&Dd(y,y.next)&&(Pd(y),y=y.next),y}function Gc(o,i){if(!o)return o;i||(i=o);var s,c=o;do{if(s=!1,c.steiner||!Dd(c,c.next)&&0!==Pi(c.prev,c,c.next))c=c.next;else{if(Pd(c),(c=i=c.prev)===c.next)break;s=!0}}while(s||c!==i);return i}function Md(o,i,s,c,d,m,y){if(o){!y&&m&&function(D,P,R,B){var N=D;do{0===N.z&&(N.z=rg(N.x,N.y,P,R,B)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next}while(N!==D);N.prevZ.nextZ=null,N.prevZ=null,function(U){var q,Y,ae,J,oe,ue,ce,xe,we=1;do{for(Y=U,U=null,oe=null,ue=0;Y;){for(ue++,ae=Y,ce=0,q=0;q<we&&(ce++,ae=ae.nextZ);q++);for(xe=we;ce>0||xe>0&&ae;)0!==ce&&(0===xe||!ae||Y.z<=ae.z)?(J=Y,Y=Y.nextZ,ce--):(J=ae,ae=ae.nextZ,xe--),oe?oe.nextZ=J:U=J,J.prevZ=oe,oe=J;Y=ae}oe.nextZ=null,we*=2}while(ue>1)}(N)}(o,c,d,m);for(var x,E,C=o;o.prev!==o.next;)if(x=o.prev,E=o.next,m?Ty(o,c,d,m):P0(o))i.push(x.i/s|0),i.push(o.i/s|0),i.push(E.i/s|0),Pd(o),o=E.next,C=E.next;else if((o=E)===C){y?1===y?Md(o=My(Gc(o),i,s),i,s,c,d,m,2):2===y&&tf(o,i,s,c,d,m):Md(Gc(o),i,s,c,d,m,1);break}}}function P0(o){var i=o.prev,s=o,c=o.next;if(Pi(i,s,c)>=0)return!1;for(var d=i.x,m=s.x,y=c.x,x=i.y,E=s.y,C=c.y,D=d<m?d<y?d:y:m<y?m:y,P=x<E?x<C?x:C:E<C?E:C,R=d>m?d>y?d:y:m>y?m:y,B=x>E?x>C?x:C:E>C?E:C,N=c.next;N!==i;){if(N.x>=D&&N.x<=R&&N.y>=P&&N.y<=B&&dh(d,x,m,E,y,C,N.x,N.y)&&Pi(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function Ty(o,i,s,c){var d=o.prev,m=o,y=o.next;if(Pi(d,m,y)>=0)return!1;for(var x=d.x,E=m.x,C=y.x,D=d.y,P=m.y,R=y.y,B=x<E?x<C?x:C:E<C?E:C,N=D<P?D<R?D:R:P<R?P:R,U=x>E?x>C?x:C:E>C?E:C,q=D>P?D>R?D:R:P>R?P:R,Y=rg(B,N,i,s,c),ae=rg(U,q,i,s,c),J=o.prevZ,oe=o.nextZ;J&&J.z>=Y&&oe&&oe.z<=ae;){if(J.x>=B&&J.x<=U&&J.y>=N&&J.y<=q&&J!==d&&J!==y&&dh(x,D,E,P,C,R,J.x,J.y)&&Pi(J.prev,J,J.next)>=0||(J=J.prevZ,oe.x>=B&&oe.x<=U&&oe.y>=N&&oe.y<=q&&oe!==d&&oe!==y&&dh(x,D,E,P,C,R,oe.x,oe.y)&&Pi(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;J&&J.z>=Y;){if(J.x>=B&&J.x<=U&&J.y>=N&&J.y<=q&&J!==d&&J!==y&&dh(x,D,E,P,C,R,J.x,J.y)&&Pi(J.prev,J,J.next)>=0)return!1;J=J.prevZ}for(;oe&&oe.z<=ae;){if(oe.x>=B&&oe.x<=U&&oe.y>=N&&oe.y<=q&&oe!==d&&oe!==y&&dh(x,D,E,P,C,R,oe.x,oe.y)&&Pi(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function My(o,i,s){var c=o;do{var d=c.prev,m=c.next.next;!Dd(d,m)&&Sd(d,c,c.next,m)&&fh(d,m)&&fh(m,d)&&(i.push(d.i/s|0),i.push(c.i/s|0),i.push(m.i/s|0),Pd(c),Pd(c.next),c=o=m),c=c.next}while(c!==o);return Gc(c)}function tf(o,i,s,c,d,m){var y=o;do{for(var x=y.next.next;x!==y.prev;){if(y.i!==x.i&&og(y,x)){var E=sg(y,x);return y=Gc(y,y.next),E=Gc(E,E.next),Md(y,i,s,c,d,m,0),void Md(E,i,s,c,d,m,0)}x=x.next}y=y.next}while(y!==o)}function ig(o,i){return o.x-i.x}function hh(o,i){var s=function(d,m){var y,x=m,E=d.x,C=d.y,D=-1/0;do{if(C<=x.y&&C>=x.next.y&&x.next.y!==x.y){var P=x.x+(C-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(P<=E&&P>D&&(D=P,y=x.x<x.next.x?x:x.next,P===E))return y}x=x.next}while(x!==m);if(!y)return null;var R,B=y,N=y.x,U=y.y,q=1/0;x=y;do{E>=x.x&&x.x>=N&&E!==x.x&&dh(C<U?E:D,C,N,U,C<U?D:E,C,x.x,x.y)&&(R=Math.abs(C-x.y)/(E-x.x),fh(x,d)&&(R<q||R===q&&(x.x>y.x||x.x===y.x&&R0(y,x)))&&(y=x,q=R)),x=x.next}while(x!==B);return y}(o,i);if(!s)return i;var c=sg(s,o);return Gc(c,c.next),Gc(s,s.next)}function R0(o,i){return Pi(o.prev,o,i.prev)<0&&Pi(i.next,o,o.next)<0}function rg(o,i,s,c,d){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=(o-s)*d|0)|o<<8))|o<<4))|o<<2))|o<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-c)*d|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function u1(o){var i=o,s=o;do{(i.x<s.x||i.x===s.x&&i.y<s.y)&&(s=i),i=i.next}while(i!==o);return s}function dh(o,i,s,c,d,m,y,x){return(d-y)*(i-x)>=(o-y)*(m-x)&&(o-y)*(c-x)>=(s-y)*(i-x)&&(s-y)*(m-x)>=(d-y)*(c-x)}function og(o,i){return o.next.i!==i.i&&o.prev.i!==i.i&&!function(s,c){var d=s;do{if(d.i!==s.i&&d.next.i!==s.i&&d.i!==c.i&&d.next.i!==c.i&&Sd(d,d.next,s,c))return!0;d=d.next}while(d!==s);return!1}(o,i)&&(fh(o,i)&&fh(i,o)&&function(s,c){var d=s,m=!1,y=(s.x+c.x)/2,x=(s.y+c.y)/2;do{d.y>x!=d.next.y>x&&d.next.y!==d.y&&y<(d.next.x-d.x)*(x-d.y)/(d.next.y-d.y)+d.x&&(m=!m),d=d.next}while(d!==s);return m}(o,i)&&(Pi(o.prev,o,i.prev)||Pi(o,i.prev,i))||Dd(o,i)&&Pi(o.prev,o,o.next)>0&&Pi(i.prev,i,i.next)>0)}function Pi(o,i,s){return(i.y-o.y)*(s.x-i.x)-(i.x-o.x)*(s.y-i.y)}function Dd(o,i){return o.x===i.x&&o.y===i.y}function Sd(o,i,s,c){var d=kd(Pi(o,i,s)),m=kd(Pi(o,i,c)),y=kd(Pi(s,c,o)),x=kd(Pi(s,c,i));return d!==m&&y!==x||!(0!==d||!ph(o,s,i))||!(0!==m||!ph(o,c,i))||!(0!==y||!ph(s,o,c))||!(0!==x||!ph(s,i,c))}function ph(o,i,s){return i.x<=Math.max(o.x,s.x)&&i.x>=Math.min(o.x,s.x)&&i.y<=Math.max(o.y,s.y)&&i.y>=Math.min(o.y,s.y)}function kd(o){return o>0?1:o<0?-1:0}function fh(o,i){return Pi(o.prev,o,o.next)<0?Pi(o,i,o.next)>=0&&Pi(o,o.prev,i)>=0:Pi(o,i,o.prev)<0||Pi(o,o.next,i)<0}function sg(o,i){var s=new ag(o.i,o.x,o.y),c=new ag(i.i,i.x,i.y),d=o.next,m=i.prev;return o.next=i,i.prev=o,s.next=d,d.prev=s,c.next=s,s.prev=c,m.next=c,c.prev=m,c}function Hl(o,i,s,c){var d=new ag(o,i,s);return c?(d.next=c.next,d.prev=c,c.next.prev=d,c.next=d):(d.prev=d,d.next=d),d}function Pd(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function ag(o,i,s){this.i=o,this.x=i,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lg(o,i,s,c){for(var d=0,m=i,y=s-c;m<s;m+=c)d+=(o[y]-o[m])*(o[m+1]+o[y+1]),y=m;return d}Hc.exports=ef,Hc.exports.default=ef,ef.deviation=function(o,i,s,c){var d=i&&i.length,m=Math.abs(lg(o,0,d?i[0]*s:o.length,s));if(d)for(var y=0,x=i.length;y<x;y++)m-=Math.abs(lg(o,i[y]*s,y<x-1?i[y+1]*s:o.length,s));var E=0;for(y=0;y<c.length;y+=3){var C=c[y]*s,D=c[y+1]*s,P=c[y+2]*s;E+=Math.abs((o[C]-o[P])*(o[D+1]-o[C+1])-(o[C]-o[D])*(o[P+1]-o[C+1]))}return 0===m&&0===E?0:Math.abs((E-m)/m)},ef.flatten=function(o){for(var i=o[0][0].length,s={vertices:[],holes:[],dimensions:i},c=0,d=0;d<o.length;d++){for(var m=0;m<o[d].length;m++)for(var y=0;y<i;y++)s.vertices.push(o[d][m][y]);d>0&&s.holes.push(c+=o[d-1].length)}return s};var cg=eo(Hc.exports);function O0(o,i,s,c,d){bo(o,i,s||0,c||o.length-1,d||F0)}function bo(o,i,s,c,d){for(;c>s;){if(c-s>600){var m=c-s+1,y=i-s+1,x=Math.log(m),E=.5*Math.exp(2*x/3),C=.5*Math.sqrt(x*E*(m-E)/m)*(y-m/2<0?-1:1);bo(o,i,Math.max(s,Math.floor(i-y*E/m+C)),Math.min(c,Math.floor(i+(m-y)*E/m+C)),d)}var D=o[i],P=s,R=c;for(wo(o,s,i),d(o[c],D)>0&&wo(o,s,c);P<R;){for(wo(o,P,R),P++,R--;d(o[P],D)<0;)P++;for(;d(o[R],D)>0;)R--}0===d(o[s],D)?wo(o,s,R):wo(o,++R,c),R<=i&&(s=R+1),i<=R&&(c=R-1)}}function wo(o,i,s){var c=o[i];o[i]=o[s],o[s]=c}function F0(o,i){return o<i?-1:o>i?1:0}function ug(o,i){const s=o.length;if(s<=1)return[o];const c=[];let d,m;for(let y=0;y<s;y++){const x=Wh(o[y]);0!==x&&(o[y].area=Math.abs(x),void 0===m&&(m=x<0),m===x<0?(d&&c.push(d),d=[o[y]]):d.push(o[y]))}if(d&&c.push(d),i>1)for(let y=0;y<c.length;y++)c[y].length<=i||(O0(c[y],i,1,c[y].length-1,L0),c[y]=c[y].slice(0,i));return c}function L0(o,i){return i.area-o.area}function hg(o,i,s){const c=s.patternDependencies;let d=!1;for(const m of i){const y=m.paint.get(`${o}-pattern`);y.isConstant()||(d=!0);const x=y.constantOr(null);x&&(d=!0,c[x]=!0)}return d}function dg(o,i,s,c,d){const m=d.patternDependencies;for(const y of i){const x=y.paint.get(`${o}-pattern`).value;if("constant"!==x.kind){let E=x.evaluate({zoom:c},s,{},d.availableImages);E=E&&E.name?E.name:E,m[E]=!0,s.patterns[y.id]=E}}return s}class nf{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Ze,this.indexArray=new Et,this.indexArray2=new Si,this.programConfigurations=new Lc(i.layers,i.zoom),this.segments=new Li,this.segments2=new Li,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.projection=i.projection}populate(i,s,c,d){this.hasPattern=hg("fill",this.layers,s);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:x,id:E,index:C,sourceLayerIndex:D}of i){const P=this.layers[0]._featureFilter.needGeometry,R=jl(x,P);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),R,c))continue;const B=m?m.evaluate(R,{},c,s.availableImages):void 0,N={id:E,properties:x.properties,type:x.type,sourceLayerIndex:D,index:C,geometry:P?R.geometry:js(x,c,d),patterns:{},sortKey:B};y.push(N)}m&&y.sort((x,E)=>x.sortKey-E.sortKey);for(const x of y){const{geometry:E,index:C,sourceLayerIndex:D}=x;if(this.hasPattern){const P=dg("fill",this.layers,x,this.zoom,s);this.patternFeatures.push(P)}else this.addFeature(x,E,C,c,{},s.availableImages);s.featureIndex.insert(i[C].feature,E,C,D,this.index)}}update(i,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,c,d)}addFeatures(i,s,c,d,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,tg),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.indexBuffer2=i.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(i,s,c,d,m,y=[]){for(const x of ug(s,500)){let E=0;for(const N of x)E+=N.length;const C=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),D=C.vertexLength,P=[],R=[];for(const N of x){if(0===N.length)continue;N!==x[0]&&R.push(P.length/2);const U=this.segments2.prepareSegment(N.length,this.layoutVertexArray,this.indexArray2),q=U.vertexLength;this.layoutVertexArray.emplaceBack(N[0].x,N[0].y),this.indexArray2.emplaceBack(q+N.length-1,q),P.push(N[0].x),P.push(N[0].y);for(let Y=1;Y<N.length;Y++)this.layoutVertexArray.emplaceBack(N[Y].x,N[Y].y),this.indexArray2.emplaceBack(q+Y-1,q+Y),P.push(N[Y].x),P.push(N[Y].y);U.vertexLength+=N.length,U.primitiveLength+=N.length}const B=cg(P,R);for(let N=0;N<B.length;N+=3)this.indexArray.emplaceBack(D+B[N],D+B[N+1],D+B[N+2]);C.vertexLength+=E,C.primitiveLength+=B.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,d)}}Ae(nf,"FillBucket",{omit:["layers","patternFeatures"]});const Dy=new te({"fill-sort-key":new W(Fe.layout_fill["fill-sort-key"])});var B0={paint:new te({"fill-antialias":new V(Fe.paint_fill["fill-antialias"]),"fill-opacity":new W(Fe.paint_fill["fill-opacity"]),"fill-color":new W(Fe.paint_fill["fill-color"]),"fill-outline-color":new W(Fe.paint_fill["fill-outline-color"]),"fill-translate":new V(Fe.paint_fill["fill-translate"]),"fill-translate-anchor":new V(Fe.paint_fill["fill-translate-anchor"]),"fill-pattern":new W(Fe.paint_fill["fill-pattern"])}),layout:Dy};const N0=ye([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),z0=ye([{name:"a_centroid_pos",components:2,type:"Uint16"}]),V0=ye([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:rf}=N0;var vs={},Rd=Ms,pg=$c;function $c(o,i,s,c,d){this.properties={},this.extent=s,this.type=0,this._pbf=o,this._geometry=-1,this._keys=c,this._values=d,o.readFields(Sy,this,i)}function Sy(o,i,s){1==o?i.id=s.readVarint():2==o?function(c,d){for(var m=c.readVarint()+c.pos;c.pos<m;){var y=d._keys[c.readVarint()],x=d._values[c.readVarint()];d.properties[y]=x}}(s,i):3==o?i.type=s.readVarint():4==o&&(i._geometry=s.pos)}function h1(o){for(var i,s,c=0,d=0,m=o.length,y=m-1;d<m;y=d++)c+=((s=o[y]).x-(i=o[d]).x)*(i.y+s.y);return c}$c.types=["Unknown","Point","LineString","Polygon"],$c.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var i,s=o.readVarint()+o.pos,c=1,d=0,m=0,y=0,x=[];o.pos<s;){if(d<=0){var E=o.readVarint();c=7&E,d=E>>3}if(d--,1===c||2===c)m+=o.readSVarint(),y+=o.readSVarint(),1===c&&(i&&x.push(i),i=[]),i.push(new Rd(m,y));else{if(7!==c)throw new Error("unknown command "+c);i&&i.push(i[0].clone())}}return i&&x.push(i),x},$c.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var i=o.readVarint()+o.pos,s=1,c=0,d=0,m=0,y=1/0,x=-1/0,E=1/0,C=-1/0;o.pos<i;){if(c<=0){var D=o.readVarint();s=7&D,c=D>>3}if(c--,1===s||2===s)(d+=o.readSVarint())<y&&(y=d),d>x&&(x=d),(m+=o.readSVarint())<E&&(E=m),m>C&&(C=m);else if(7!==s)throw new Error("unknown command "+s)}return[y,E,x,C]},$c.prototype.toGeoJSON=function(o,i,s){var c,d,m=this.extent*Math.pow(2,s),y=this.extent*o,x=this.extent*i,E=this.loadGeometry(),C=$c.types[this.type];function D(B){for(var N=0;N<B.length;N++){var U=B[N];B[N]=[360*(U.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(U.y+x)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var P=[];for(c=0;c<E.length;c++)P[c]=E[c][0];D(E=P);break;case 2:for(c=0;c<E.length;c++)D(E[c]);break;case 3:for(E=function(B){var N=B.length;if(N<=1)return[B];for(var U,q,Y=[],ae=0;ae<N;ae++){var J=h1(B[ae]);0!==J&&(void 0===q&&(q=J<0),q===J<0?(U&&Y.push(U),U=[B[ae]]):U.push(B[ae]))}return U&&Y.push(U),Y}(E),c=0;c<E.length;c++)for(d=0;d<E[c].length;d++)D(E[c][d])}1===E.length?E=E[0]:C="Multi"+C;var R={type:"Feature",geometry:{type:C,coordinates:E},properties:this.properties};return"id"in this&&(R.id=this.id),R};var d1=pg,U0=sf;function sf(o,i){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(fg,this,i),this.length=this._features.length}function fg(o,i,s){15===o?i.version=s.readVarint():1===o?i.name=s.readString():5===o?i.extent=s.readVarint():2===o?i._features.push(s.pos):3===o?i._keys.push(s.readString()):4===o&&i._values.push(function(c){for(var d=null,m=c.readVarint()+c.pos;c.pos<m;){var y=c.readVarint()>>3;d=1===y?c.readString():2===y?c.readFloat():3===y?c.readDouble():4===y?c.readVarint64():5===y?c.readVarint():6===y?c.readSVarint():7===y?c.readBoolean():null}return d}(s))}sf.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var i=this._pbf.readVarint()+this._pbf.pos;return new d1(this._pbf,i,this.extent,this._keys,this._values)};var p1=U0;function f1(o,i,s){if(3===o){var c=new p1(s,s.readVarint()+s.pos);c.length&&(i[c.name]=c)}}var af=vs.VectorTile=function(o,i){this.layers=o.readFields(f1,{},i)},lf=vs.VectorTileFeature=pg;function cf(o,i,s,c){const d=[],m=0===c?(y,x,E,C,D,P)=>{y.push(new lt(P,E+(P-x)/(C-x)*(D-E)))}:(y,x,E,C,D,P)=>{y.push(new lt(x+(P-E)/(D-E)*(C-x),P))};for(const y of o){const x=[];for(const E of y){if(E.length<=2)continue;const C=[];for(let R=0;R<E.length-1;R++){const B=E[R].x,N=E[R].y,U=E[R+1].x,q=E[R+1].y,Y=0===c?B:N,ae=0===c?U:q;Y<i?ae>i&&m(C,B,N,U,q,i):Y>s?ae<s&&m(C,B,N,U,q,s):C.push(E[R]),ae<i&&Y>=i&&m(C,B,N,U,q,i),ae>s&&Y<=s&&m(C,B,N,U,q,s)}let D=E[E.length-1];const P=0===c?D.x:D.y;P>=i&&P<=s&&C.push(D),C.length&&(D=C[C.length-1],C[0].x===D.x&&C[0].y===D.y||C.push(C[0]),x.push(C))}x.length&&d.push(x)}return d}vs.VectorTileLayer=U0;const j0=lf.types,H0=Math.pow(2,13);function mh(o,i,s,c,d,m,y,x){o.emplaceBack((i<<1)+y,(s<<1)+m,(Math.floor(c*H0)<<1)+d,Math.round(x))}function Gl(o,i,s){o.emplaceBack(i.x,i.y,i.z,16384*s[0],16384*s[1],16384*s[2])}class mg{constructor(){this.acc=new lt(0,0),this.polyCount=[]}startRing(i){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new lt(i.x,i.y),this.max=new lt(i.x,i.y))}append(i,s){this.currentPolyCount.edges++,this.acc._add(i);const c=this.min,d=this.max;i.x<c.x?c.x=i.x:i.x>d.x&&(d.x=i.x),i.y<c.y?c.y=i.y:i.y>d.y&&(d.y=i.y),((0===i.x||i.x===St)&&i.x===s.x)!=((0===i.y||i.y===St)&&i.y===s.y)&&this.processBorderOverlap(i,s),s.x<0!=i.x<0&&this.addBorderIntersection(0,bn(s.y,i.y,(0-s.x)/(i.x-s.x))),s.x>St!=i.x>St&&this.addBorderIntersection(1,bn(s.y,i.y,(St-s.x)/(i.x-s.x))),s.y<0!=i.y<0&&this.addBorderIntersection(2,bn(s.x,i.x,(0-s.y)/(i.y-s.y))),s.y>St!=i.y>St&&this.addBorderIntersection(3,bn(s.x,i.x,(St-s.y)/(i.y-s.y)))}addBorderIntersection(i,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[i];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(i,s){if(i.x===s.x){if(i.y===s.y)return;const c=0===i.x?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,i.y)}else{const c=0===i.y?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,i.x)}}centroid(){const i=this.polyCount.reduce((s,c)=>s+c.edges,0);return 0!==i?this.acc.div(i)._round():new lt(0,0)}span(){return new lt(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((i,s)=>i+ +(s[0]!==Number.MAX_VALUE),0)}}class qc{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.layoutVertexArray=new Be,this.centroidVertexArray=new ms,this.indexArray=new Et,this.programConfigurations=new Lc(i.layers,i.zoom),this.segments=new Li,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=i.enableTerrain}populate(i,s,c,d){this.features=[],this.hasPattern=hg("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/St/(1<<m.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:m,id:y,index:x,sourceLayerIndex:E}of i){const C=this.layers[0]._featureFilter.needGeometry,D=jl(m,C);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),D,c))continue;const P={id:y,sourceLayerIndex:E,index:x,geometry:C?D.geometry:js(m,c,d),properties:m.properties,type:m.type,patterns:{}},R=this.layoutVertexArray.length;this.hasPattern?this.features.push(dg("fill-extrusion",this.layers,P,this.zoom,s)):this.addFeature(P,P.geometry,x,c,{},s.availableImages,d),s.featureIndex.insert(m,P.geometry,x,E,this.index,R)}this.sortBorders()}addFeatures(i,s,c,d,m){for(const y of this.features){const{geometry:x}=y;this.addFeature(y,x,y.index,s,c,d,m)}this.sortBorders()}update(i,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,rf),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,V0.members,!0))),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,z0.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,s,c,d,m,y,x){const E=[new lt(0,0),new lt(St,St)],C=x.projection,D="globe"===C.name,P=this.enableTerrain&&!D?new mg:null,R="Polygon"===j0[i.type];D&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Xe);const B=ug(s,500);for(let Y=B.length-1;Y>=0;Y--){const ae=B[Y];(0===ae.length||(N=ae[0]).every(J=>J.x<=0)||N.every(J=>J.x>=St)||N.every(J=>J.y<=0)||N.every(J=>J.y>=St))&&B.splice(Y,1)}var N;let U;if(D)U=Fy(B,E,d);else{U=[];for(const Y of B)U.push({polygon:Y,bounds:E})}const q=R?this.edgeRadius:0;for(const{polygon:Y,bounds:ae}of U){let J=0,oe=0;for(const ce of Y)R&&!ce[0].equals(ce[ce.length-1])&&ce.push(ce[0]),oe+=R?ce.length-1:ce.length;const ue=this.segments.prepareSegment((R?5:4)*oe,this.layoutVertexArray,this.indexArray);if(R){const ce=[],xe=[];J=ue.vertexLength;for(const Oe of Y){let We,De;Oe.length&&Oe!==Y[0]&&xe.push(ce.length/2),We=Oe[1].sub(Oe[0])._perp()._unit();for(let ze=1;ze<Oe.length;ze++){const Ve=Oe[ze],Ge=Oe[ze===Oe.length-1?1:ze+1];let{x:Ye,y:Re}=Ve;if(q){De=Ge.sub(Ve)._perp()._unit();const ut=We.add(De)._unit(),yt=q*Math.min(4,1/(We.x*ut.x+We.y*ut.y));Ye+=yt*ut.x,Re+=yt*ut.y,We=De}mh(this.layoutVertexArray,Ye,Re,0,0,1,1,0),ue.vertexLength++,ce.push(Ve.x,Ve.y),D&&Gl(this.layoutVertexExtArray,C.projectTilePoint(Ye,Re,d),C.upVector(d,Ye,Re))}}const we=cg(ce,xe);for(let Oe=0;Oe<we.length;Oe+=3)this.indexArray.emplaceBack(J+we[Oe],J+we[Oe+2],J+we[Oe+1]),ue.primitiveLength++}for(const ce of Y){P&&ce.length&&P.startRing(ce[0]);let xe,we,Oe,We=ce.length>4&&wa(ce[ce.length-2],ce[0],ce[1]),De=q?Qn(ce[ce.length-2],ce[0],ce[1],q):0;we=ce[1].sub(ce[0])._perp()._unit();let ze=!0;for(let Ve=1,Ge=0;Ve<ce.length;Ve++){let Ye=ce[Ve-1],Re=ce[Ve];const ut=ce[Ve===ce.length-1?1:Ve+1];if(P&&R&&P.currentPolyCount.top++,Ry(Re,Ye,ae)){q&&(we=ut.sub(Re)._perp()._unit(),ze=!ze);continue}P&&P.append(Re,Ye);const yt=Re.sub(Ye)._perp(),dt=yt.x/(Math.abs(yt.x)+Math.abs(yt.y)),Vt=yt.y>0?1:0,it=Ye.dist(Re);if(Ge+it>32768&&(Ge=0),q){Oe=ut.sub(Re)._perp()._unit();let jt=Py(Ye,Re,ut,ky(we,Oe),q);isNaN(jt)&&(jt=0);const Rt=Re.sub(Ye)._unit();Ye=Ye.add(Rt.mult(De))._round(),Re=Re.add(Rt.mult(-jt))._round(),De=jt,we=Oe}const Mt=ue.vertexLength,Ut=ce.length>4&&wa(Ye,Re,ut);let En=uf(Ge,We,ze);if(mh(this.layoutVertexArray,Ye.x,Ye.y,dt,Vt,0,0,En),mh(this.layoutVertexArray,Ye.x,Ye.y,dt,Vt,0,1,En),Ge+=it,En=uf(Ge,Ut,!ze),We=Ut,mh(this.layoutVertexArray,Re.x,Re.y,dt,Vt,0,0,En),mh(this.layoutVertexArray,Re.x,Re.y,dt,Vt,0,1,En),ue.vertexLength+=4,this.indexArray.emplaceBack(Mt+0,Mt+1,Mt+2),this.indexArray.emplaceBack(Mt+1,Mt+3,Mt+2),ue.primitiveLength+=2,q){const jt=J+(1===Ve?ce.length-2:Ve-2),Rt=1===Ve?J:jt+1;if(this.indexArray.emplaceBack(Mt+1,jt,Mt+3),this.indexArray.emplaceBack(jt,Rt,Mt+3),ue.primitiveLength+=2,void 0===xe&&(xe=Mt),!Ry(ut,ce[Ve],ae)){const Yn=Ve===ce.length-1?xe:ue.vertexLength;this.indexArray.emplaceBack(Mt+2,Mt+3,Yn),this.indexArray.emplaceBack(Mt+3,Yn+1,Yn),this.indexArray.emplaceBack(Mt+3,Rt,Yn+1),ue.primitiveLength+=3}ze=!ze}if(D){const jt=this.layoutVertexExtArray,Rt=C.projectTilePoint(Ye.x,Ye.y,d),Yn=C.projectTilePoint(Re.x,Re.y,d),At=C.upVector(d,Ye.x,Ye.y),Qt=C.upVector(d,Re.x,Re.y);Gl(jt,Rt,At),Gl(jt,Rt,At),Gl(jt,Yn,Qt),Gl(jt,Yn,Qt)}}R&&(J+=ce.length-1)}}if(P&&P.polyCount.length>0){if(P.borders){P.vertexArrayOffset=this.centroidVertexArray.length;const Y=P.borders,ae=this.featuresOnBorder.push(P)-1;for(let J=0;J<4;J++)Y[J][0]!==Number.MAX_VALUE&&this.borders[J].push(ae)}this.encodeCentroid(P.borders?void 0:P.centroid(),P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,d)}sortBorders(){for(let i=0;i<4;i++)this.borders[i].sort((s,c)=>this.featuresOnBorder[s].borders[i][0]-this.featuresOnBorder[c].borders[i][0])}encodeCentroid(i,s,c=!0){let d,m;if(i)if(0!==i.y){const x=s.span()._mult(this.tileToMeter);d=(Math.max(i.x,1)<<3)+Math.min(7,Math.round(x.x/10)),m=(Math.max(i.y,1)<<3)+Math.min(7,Math.round(x.y/10))}else d=Math.ceil(7*(i.x+450)),m=0;else d=0,m=+c;let y=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const x of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*x.edges+x.top);for(let E=0;E<x.top;E++)this.centroidVertexArray.emplace(y++,d,m);for(let E=0;E<2*x.edges;E++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,d,m)}}}function ky(o,i){const s=o.add(i)._unit();return o.x*s.x+o.y*s.y}function Qn(o,i,s,c){const d=i.sub(o)._perp()._unit(),m=s.sub(i)._perp()._unit();return Py(o,i,s,ky(d,m),c)}function Py(o,i,s,c,d){const m=Math.sqrt(1-c*c);return Math.min(o.dist(i)/3,i.dist(s)/3,d*m/c)}function Ry(o,i,s){return o.x<s[0].x&&i.x<s[0].x||o.x>s[1].x&&i.x>s[1].x||o.y<s[0].y&&i.y<s[0].y||o.y>s[1].y&&i.y>s[1].y}function wa(o,i,s){if(o.x<0||o.x>=St||i.x<0||i.x>=St||s.x<0||s.x>=St)return!1;const c=s.sub(i),d=c.perp(),m=o.sub(i);return(c.x*m.x+c.y*m.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(m.x*m.x+m.y*m.y))>-.866&&d.x*m.x+d.y*m.y<0}function uf(o,i,s){const c=i?2|o:-3&o;return s?1|c:-2&c}function Oy(){const o=Math.PI/32,i=Math.tan(o),s=ah;return s*Math.sqrt(1+2*i*i)-s}function Fy(o,i,s){const c=1<<s.z,d=qo(s.x/c),m=qo((s.x+1)/c),y=ur(s.y/c),x=ur((s.y+1)/c);return function(E,C,D,P,R=0,B){const N=[];if(!E.length||!D||!P)return N;const U=(ce,xe)=>{for(const we of ce)N.push({polygon:we,bounds:xe})},q=Math.ceil(Math.log2(D)),Y=Math.ceil(Math.log2(P)),ae=q-Y,J=[];for(let ce=0;ce<Math.abs(ae);ce++)J.push(ae>0?0:1);for(let ce=0;ce<Math.min(q,Y);ce++)J.push(0),J.push(1);let oe=E;if(oe=cf(oe,C[0].y-R,C[1].y+R,1),oe=cf(oe,C[0].x-R,C[1].x+R,0),!oe.length)return N;const ue=[];for(J.length?ue.push({polygons:oe,bounds:C,depth:0}):U(oe,C);ue.length;){const ce=ue.pop(),xe=ce.depth,we=J[xe],Oe=ce.bounds[0],We=ce.bounds[1],De=0===we?Oe.x:Oe.y,ze=0===we?We.x:We.y,Ve=B?B(we,De,ze):.5*(De+ze),Ge=cf(ce.polygons,De-R,Ve+R,we),Ye=cf(ce.polygons,Ve-R,ze+R,we);if(Ge.length){const Re=[Oe,new lt(0===we?Ve:We.x,1===we?Ve:We.y)];J.length>xe+1?ue.push({polygons:Ge,bounds:Re,depth:xe+1}):U(Ge,Re)}if(Ye.length){const Re=[new lt(0===we?Ve:Oe.x,1===we?Ve:Oe.y),We];J.length>xe+1?ue.push({polygons:Ye,bounds:Re,depth:xe+1}):U(Ye,Re)}}return N}(o,i,Math.ceil((m-d)/11.25),Math.ceil((y-x)/11.25),1,(E,C,D)=>{if(0===E)return.5*(C+D);{const P=ur((s.y+C/St)/c);return(xa(.5*(ur((s.y+D/St)/c)+P))*c-s.y)*St}})}Ae(qc,"FillExtrusionBucket",{omit:["layers","features"]}),Ae(mg,"PartMetadata");const G0=new te({"fill-extrusion-edge-radius":new V(Fe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var $0={paint:new te({"fill-extrusion-opacity":new V(Fe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new W(Fe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new V(Fe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new V(Fe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new W(Fe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new W(Fe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new W(Fe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new V(Fe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new V(Fe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new V(Fe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new V(Fe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:G0};function gg(o,i,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[o*c-2*Math.PI*6378137/2,i*c-2*Math.PI*6378137/2]}class _g{constructor(i,s,c){this.z=i,this.x=s,this.y=c,this.key=$l(0,i,i,s,c)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,s){const c=(y=this.y,x=this.z,E=gg(256*(m=this.x),256*(y=Math.pow(2,x)-y-1),x),C=gg(256*(m+1),256*(y+1),x),E[0]+","+E[1]+","+C[0]+","+C[1]),d=function(m,y,x){let E,C="";for(let D=m;D>0;D--)E=1<<D-1,C+=(y&E?1:0)+(x&E?2:0);return C}(this.z,this.x,this.y);var m,y,x,E,C;return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===s?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",d).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class q0{constructor(i,s){this.wrap=i,this.canonical=s,this.key=$l(i,s.z,s.z,s.x,s.y)}}class Ki{constructor(i,s,c,d,m){this.overscaledZ=i,this.wrap=s,this.canonical=new _g(c,+d,+m),this.key=0===s&&i===c?this.canonical.key:$l(s,i,c,d,m)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const s=this.canonical.z-i;return i>this.canonical.z?new Ki(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ki(i,this.wrap,i,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(i,s=!0){if(this.overscaledZ===i&&s)return this.key;if(i>this.canonical.z)return $l(this.wrap*+s,i,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-i;return $l(this.wrap*+s,i,i,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const s=this.canonical.z-i.canonical.z;return 0===i.overscaledZ||i.overscaledZ<this.overscaledZ&&i.canonical.x===this.canonical.x>>s&&i.canonical.y===this.canonical.y>>s}children(i){if(this.overscaledZ>=i)return[new Ki(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,d=2*this.canonical.y;return[new Ki(s,this.wrap,s,c,d),new Ki(s,this.wrap,s,c+1,d),new Ki(s,this.wrap,s,c,d+1),new Ki(s,this.wrap,s,c+1,d+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Ki(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Ki(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new q0(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function $l(o,i,s,c,d){const m=1<<Math.min(s,22);let y=m*(d%m)+c%m;return o&&s<22&&(y+=m*m*((o<0?-2*o-1:2*o)%(1<<2*(22-s)))),16*(32*y+s)+(i-s)}Ae(_g,"CanonicalTileID"),Ae(Ki,"OverscaledTileID",{omit:["projMatrix"]});class Wc extends lt{constructor(i,s,c){super(i,s),this.z=c}}function gh(o,i){return o.x*i.x+o.y*i.y}function yg(o,i){if(1===o.length){let s=0;const c=i[s++];let d;for(;!d||c.equals(d);)if(d=i[s++],!d)return 1/0;for(;s<i.length;s++){const m=i[s],y=o[0],x=d.sub(c),E=m.sub(c),C=y.sub(c),D=gh(x,x),P=gh(x,E),R=gh(E,E),B=gh(C,x),N=gh(C,E),U=D*R-P*P,q=(R*B-P*N)/U,Y=(D*N-P*B)/U,ae=c.z*(1-q-Y)+d.z*q+m.z*Y;if(isFinite(ae))return ae}return 1/0}{let s=1/0;for(const c of i)s=Math.min(s,c.z);return s}}function Ly(o,i,s,c,d,m,y,x){const E=y*d.getElevationAt(o,i,!0,!0),C=0!==m[0],D=C?0===m[1]?y*(m[0]/7-450):y*function(P,R,B){const N=Math.floor(R[0]/8),U=Math.floor(R[1]/8),q=10*(R[0]-8*N),Y=10*(R[1]-8*U),ae=P.getElevationAt(N,U,!0,!0),J=P.getMeterToDEM(B),oe=Math.floor(.5*(q*J-1)),ue=Math.floor(.5*(Y*J-1)),ce=P.tileCoordToPixel(N,U),xe=2*oe+1,we=2*ue+1,Oe=(yt=xe,dt=we,[(Ye=P).getElevationAtPixel(Re=ce.x-oe,ut=ce.y-ue,!0),Ye.getElevationAtPixel(Re+dt,ut,!0),Ye.getElevationAtPixel(Re,ut+dt,!0),Ye.getElevationAtPixel(Re+yt,ut+dt,!0)]),We=Math.abs(Oe[0]-Oe[1]),De=Math.abs(Oe[2]-Oe[3]),ze=Math.abs(Oe[0]-Oe[2])+Math.abs(Oe[1]-Oe[3]),Ve=Math.min(.25,.5*J*(We+De)/xe),Ge=Math.min(.25,.5*J*ze/we);var Ye,Re,ut,yt,dt;return ae+Math.max(Ve*q,Ge*Y)}(d,m,x):E;return{base:E+(0===s)?-1:s,top:C?Math.max(D+c,E+s+2):E+c}}const W0=ye([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:By}=W0,Ny=ye([{name:"a_packed",components:4,type:"Float32"}]),{members:vg}=Ny,m1=lf.types,Ag=Math.cos(Math.PI/180*37.5);class hf{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(s=>s.id),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new Se,this.layoutVertexArray2=new Qe,this.indexArray=new Et,this.programConfigurations=new Lc(i.layers,i.zoom),this.segments=new Li,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(i,s,c,d){this.hasPattern=hg("line",this.layers,s);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:D,id:P,index:R,sourceLayerIndex:B}of i){const N=this.layers[0]._featureFilter.needGeometry,U=jl(D,N);if(!this.layers[0]._featureFilter.filter(new k(this.zoom),U,c))continue;const q=m?m.evaluate(U,{},c):void 0,Y={id:P,properties:D.properties,type:D.type,sourceLayerIndex:B,index:R,geometry:N?U.geometry:js(D,c,d),patterns:{},sortKey:q};y.push(Y)}m&&y.sort((D,P)=>D.sortKey-P.sortKey);const{lineAtlas:x,featureIndex:E}=s,C=this.addConstantDashes(x);for(const D of y){const{geometry:P,index:R,sourceLayerIndex:B}=D;if(C&&this.addFeatureDashes(D,x),this.hasPattern){const N=dg("line",this.layers,D,this.zoom,s);this.patternFeatures.push(N)}else this.addFeature(D,P,R,c,x.positions,s.availableImages);E.insert(i[R].feature,P,R,B,this.index)}}addConstantDashes(i){let s=!1;for(const c of this.layers){const d=c.paint.get("line-dasharray").value,m=c.layout.get("line-cap").value;if("constant"!==d.kind||"constant"!==m.kind)s=!0;else{const y=m.value,x=d.value;if(!x)continue;i.addDash(x,y)}}return s}addFeatureDashes(i,s){const c=this.zoom;for(const d of this.layers){const m=d.paint.get("line-dasharray").value,y=d.layout.get("line-cap").value;if("constant"===m.kind&&"constant"===y.kind)continue;let x,E;if("constant"===m.kind){if(x=m.value,!x)continue}else x=m.evaluate({zoom:c},i);E="constant"===y.kind?y.value:y.evaluate({zoom:c},i),s.addDash(x,E),i.patterns[d.id]=s.getKey(x,E)}}update(i,s,c,d){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(i,s,this.stateDependentLayers,c,d)}addFeatures(i,s,c,d,m){for(const y of this.patternFeatures)this.addFeature(y,y.geometry,y.index,s,c,d)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,vg)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,By),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,s,c,d,m,y){const x=this.layers[0].layout,E=x.get("line-join").evaluate(i,{}),C=x.get("line-cap").evaluate(i,{}),D=x.get("line-miter-limit"),P=x.get("line-round-limit");this.lineClips=this.lineFeatureClips(i);for(const R of s)this.addLine(R,i,E,C,D,P);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,c,m,y,d)}addLine(i,s,c,d,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Y=0;Y<i.length-1;Y++)this.totalDistance+=i[Y].dist(i[Y+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const x="Polygon"===m1[s.type];let E=i.length;for(;E>=2&&i[E-1].equals(i[E-2]);)E--;let C=0;for(;C<E-1&&i[C].equals(i[C+1]);)C++;if(E<(x?3:2))return;"bevel"===c&&(m=1.05);const D=this.overscaling<=16?15*St/(512*this.overscaling):0,P=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let R,B,N,U,q;this.e1=this.e2=-1,x&&(R=i[E-2],q=i[C].sub(R)._unit()._perp());for(let Y=C;Y<E;Y++){if(N=Y===E-1?x?i[C+1]:void 0:i[Y+1],N&&i[Y].equals(N))continue;q&&(U=q),R&&(B=R),R=i[Y],q=N?N.sub(R)._unit()._perp():U,U=U||q;let ae=U.add(q);0===ae.x&&0===ae.y||ae._unit();const J=U.x*q.x+U.y*q.y,oe=ae.x*q.x+ae.y*q.y,ue=0!==oe?1/oe:1/0,ce=2*Math.sqrt(2-2*oe),xe=oe<Ag&&B&&N,we=U.x*q.y-U.y*q.x>0;if(xe&&Y>C){const De=R.dist(B);if(De>2*D){const ze=R.sub(R.sub(B)._mult(D/De)._round());this.updateDistance(B,ze),this.addCurrentVertex(ze,U,0,0,P),B=ze}}const Oe=B&&N;let We=Oe?c:x?"butt":d;if(Oe&&"round"===We&&(ue<y?We="miter":ue<=2&&(We="fakeround")),"miter"===We&&ue>m&&(We="bevel"),"bevel"===We&&(ue>2&&(We="flipbevel"),ue<m&&(We="miter")),B&&this.updateDistance(B,R),"miter"===We)ae._mult(ue),this.addCurrentVertex(R,ae,0,0,P);else if("flipbevel"===We){if(ue>100)ae=q.mult(-1);else{const De=ue*U.add(q).mag()/U.sub(q).mag();ae._perp()._mult(De*(we?-1:1))}this.addCurrentVertex(R,ae,0,0,P),this.addCurrentVertex(R,ae.mult(-1),0,0,P)}else if("bevel"===We||"fakeround"===We){const De=-Math.sqrt(ue*ue-1),ze=we?De:0,Ve=we?0:De;if(B&&this.addCurrentVertex(R,U,ze,Ve,P),"fakeround"===We){const Ge=Math.round(180*ce/Math.PI/20);for(let Ye=1;Ye<Ge;Ye++){let Re=Ye/Ge;if(.5!==Re){const yt=Re-.5;Re+=Re*yt*(Re-1)*((1.0904+J*(J*(3.55645-1.43519*J)-3.2452))*yt*yt+(.848013+J*(.215638*J-1.06021)))}const ut=q.sub(U)._mult(Re)._add(U)._unit()._mult(we?-1:1);this.addHalfVertex(R,ut.x,ut.y,!1,we,0,P)}}N&&this.addCurrentVertex(R,q,-ze,-Ve,P)}else if("butt"===We)this.addCurrentVertex(R,ae,0,0,P);else if("square"===We){const De=B?1:-1;B||this.addCurrentVertex(R,ae,De,De,P),this.addCurrentVertex(R,ae,0,0,P),B&&this.addCurrentVertex(R,ae,De,De,P)}else"round"===We&&(B&&(this.addCurrentVertex(R,U,0,0,P),this.addCurrentVertex(R,U,1,1,P,!0)),N&&(this.addCurrentVertex(R,q,-1,-1,P,!0),this.addCurrentVertex(R,q,0,0,P)));if(xe&&Y<E-1){const De=R.dist(N);if(De>2*D){const ze=R.add(N.sub(R)._mult(D/De)._round());this.updateDistance(R,ze),this.addCurrentVertex(ze,q,0,0,P),R=ze}}}}addCurrentVertex(i,s,c,d,m,y=!1){const x=s.y*d-s.x,E=-s.y-s.x*d;this.addHalfVertex(i,s.x+s.y*c,s.y-s.x*c,y,!1,c,m),this.addHalfVertex(i,x,E,y,!0,-d,m)}addHalfVertex({x:i,y:s},c,d,m,y,x,E){this.layoutVertexArray.emplaceBack((i<<1)+(m?1:0),(s<<1)+(y?1:0),Math.round(63*c)+128,Math.round(63*d)+128,1+(0===x?0:x<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const C=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),E.primitiveLength++),y?this.e2=C:this.e1=C}updateScaledDistance(){if(this.lineClips){const i=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=i*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(i,s){this.distance+=i.dist(s),this.updateScaledDistance()}}Ae(hf,"LineBucket",{omit:["layers","patternFeatures"]});const xg=new te({"line-cap":new W(Fe.layout_line["line-cap"]),"line-join":new W(Fe.layout_line["line-join"]),"line-miter-limit":new V(Fe.layout_line["line-miter-limit"]),"line-round-limit":new V(Fe.layout_line["line-round-limit"]),"line-sort-key":new W(Fe.layout_line["line-sort-key"])});var bg={paint:new te({"line-opacity":new W(Fe.paint_line["line-opacity"]),"line-color":new W(Fe.paint_line["line-color"]),"line-translate":new V(Fe.paint_line["line-translate"]),"line-translate-anchor":new V(Fe.paint_line["line-translate-anchor"]),"line-width":new W(Fe.paint_line["line-width"]),"line-gap-width":new W(Fe.paint_line["line-gap-width"]),"line-offset":new W(Fe.paint_line["line-offset"]),"line-blur":new W(Fe.paint_line["line-blur"]),"line-dasharray":new W(Fe.paint_line["line-dasharray"]),"line-pattern":new W(Fe.paint_line["line-pattern"]),"line-gradient":new ie(Fe.paint_line["line-gradient"]),"line-trim-offset":new V(Fe.paint_line["line-trim-offset"])}),layout:xg};const wg=new class extends W{possiblyEvaluate(o,i){return i=new k(Math.floor(i.zoom),{now:i.now,fadeDuration:i.fadeDuration,transition:i.transition}),super.possiblyEvaluate(o,i)}evaluate(o,i,s,c){return i=Ii({},i,{zoom:Math.floor(i.zoom)}),super.evaluate(o,i,s,c)}}(bg.paint.properties["line-width"].specification);function ql(o,i){return i>0?i+2*o:o}wg.useIntegerZoom=!0;const Z0=ye([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Eg=ye([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),df=ye([{name:"a_projected_pos",components:4,type:"Float32"}],4);ye([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Q0=ye([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Cg=ye([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Od=ye([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Ea=ye([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);ye([{name:"triangle",components:3,type:"Uint16"}]),ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),ye([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),ye([{type:"Float32",name:"offsetX"}]),ye([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Ji=24;const Wo=128;function Ig(o,i){const{expression:s}=i;if("constant"===s.kind)return{kind:"constant",layoutSize:s.evaluate(new k(o+1))};if("source"===s.kind)return{kind:"source"};{const{zoomStops:c,interpolationType:d}=s;let m=0;for(;m<c.length&&c[m]<=o;)m++;m=Math.max(0,m-1);let y=m;for(;y<c.length&&c[y]<o+1;)y++;y=Math.min(c.length-1,y);const x=c[m],E=c[y];return"composite"===s.kind?{kind:"composite",minZoom:x,maxZoom:E,interpolationType:d}:{kind:"camera",minZoom:x,maxZoom:E,minSize:s.evaluate(new k(x)),maxSize:s.evaluate(new k(E)),interpolationType:d}}}function pf(o,{uSize:i,uSizeT:s},{lowerSize:c,upperSize:d}){return"source"===o.kind?c/Wo:"composite"===o.kind?bn(c/Wo,d/Wo,s):i}function Zc(o,i){let s=0,c=0;if("constant"===o.kind)c=o.layoutSize;else if("source"!==o.kind){const{interpolationType:d,minZoom:m,maxZoom:y}=o,x=d?un(gn.interpolationFactor(d,i,m,y),0,1):0;"camera"===o.kind?c=bn(o.minSize,o.maxSize,x):s=x}return{uSizeT:s,uSize:c}}var _h=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Wo,evaluateSizeForFeature:pf,evaluateSizeForZoom:Zc,getSizeData:Ig});function X0(o,i,s){return o.sections.forEach(c=>{c.text=function(d,m,y){const x=m.layout.get("text-transform").evaluate(y,{});return"uppercase"===x?d=d.toLocaleUpperCase():"lowercase"===x&&(d=d.toLocaleLowerCase()),M.applyArabicShaping&&(d=M.applyArabicShaping(d)),d}(c.text,i,s)}),o}const Fd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function K0(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function Tg(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}var zy=Gn,Mg=function(o,i,s,c,d){var m,y,x=8*d-c-1,E=(1<<x)-1,C=E>>1,D=-7,P=s?d-1:0,R=s?-1:1,B=o[i+P];for(P+=R,m=B&(1<<-D)-1,B>>=-D,D+=x;D>0;m=256*m+o[i+P],P+=R,D-=8);for(y=m&(1<<-D)-1,m>>=-D,D+=c;D>0;y=256*y+o[i+P],P+=R,D-=8);if(0===m)m=1-C;else{if(m===E)return y?NaN:1/0*(B?-1:1);y+=Math.pow(2,c),m-=C}return(B?-1:1)*y*Math.pow(2,m-c)},Vy=function(o,i,s,c,d,m){var y,x,E,C=8*m-d-1,D=(1<<C)-1,P=D>>1,R=23===d?Math.pow(2,-24)-Math.pow(2,-77):0,B=c?0:m-1,N=c?1:-1,U=i<0||0===i&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(x=isNaN(i)?1:0,y=D):(y=Math.floor(Math.log(i)/Math.LN2),i*(E=Math.pow(2,-y))<1&&(y--,E*=2),(i+=y+P>=1?R/E:R*Math.pow(2,1-P))*E>=2&&(y++,E/=2),y+P>=D?(x=0,y=D):y+P>=1?(x=(i*E-1)*Math.pow(2,d),y+=P):(x=i*Math.pow(2,P-1)*Math.pow(2,d),y=0));d>=8;o[s+B]=255&x,B+=N,x/=256,d-=8);for(y=y<<d|x,C+=d;C>0;o[s+B]=255&y,B+=N,y/=256,C-=8);o[s+B-N]|=128*U};function Gn(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}Gn.Varint=0,Gn.Fixed64=1,Gn.Bytes=2,Gn.Fixed32=5;var Uy=4294967296,jy=1/Uy,yh=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function nl(o){return o.type===Gn.Bytes?o.readVarint()+o.pos:o.pos+1}function jr(o,i,s){var c=i<=16383?1:i<=2097151?2:i<=268435455?3:Math.floor(Math.log(i)/(7*Math.LN2));s.realloc(c);for(var d=s.pos-1;d>=o;d--)s.buf[d+c]=s.buf[d]}function J0(o,i){for(var s=0;s<o.length;s++)i.writeVarint(o[s])}function Hy(o,i){for(var s=0;s<o.length;s++)i.writeSVarint(o[s])}function il(o,i){for(var s=0;s<o.length;s++)i.writeFloat(o[s])}function Y0(o,i){for(var s=0;s<o.length;s++)i.writeDouble(o[s])}function ex(o,i){for(var s=0;s<o.length;s++)i.writeBoolean(o[s])}function Qc(o,i){for(var s=0;s<o.length;s++)i.writeFixed32(o[s])}function tx(o,i){for(var s=0;s<o.length;s++)i.writeSFixed32(o[s])}function Dg(o,i){for(var s=0;s<o.length;s++)i.writeFixed64(o[s])}function Sg(o,i){for(var s=0;s<o.length;s++)i.writeSFixed64(o[s])}function ff(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+16777216*o[i+3]}function Wl(o,i,s){o[s]=i,o[s+1]=i>>>8,o[s+2]=i>>>16,o[s+3]=i>>>24}function rl(o,i){return(o[i]|o[i+1]<<8|o[i+2]<<16)+(o[i+3]<<24)}Gn.prototype={destroy:function(){this.buf=null},readFields:function(o,i,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),d=c>>3,m=this.pos;this.type=7&c,o(d,i,this),this.pos===m&&this.skip(c)}return i},readMessage:function(o,i){return this.readFields(o,i,this.readVarint()+this.pos)},readFixed32:function(){var o=ff(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=rl(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=ff(this.buf,this.pos)+ff(this.buf,this.pos+4)*Uy;return this.pos+=8,o},readSFixed64:function(){var o=ff(this.buf,this.pos)+rl(this.buf,this.pos+4)*Uy;return this.pos+=8,o},readFloat:function(){var o=Mg(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=Mg(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var i,s,c=this.buf;return i=127&(s=c[this.pos++]),s<128?i:(i|=(127&(s=c[this.pos++]))<<7,s<128?i:(i|=(127&(s=c[this.pos++]))<<14,s<128?i:(i|=(127&(s=c[this.pos++]))<<21,s<128?i:function(d,m,y){var x,E,C=y.buf;if(x=(112&(E=C[y.pos++]))>>4,E<128||(x|=(127&(E=C[y.pos++]))<<3,E<128)||(x|=(127&(E=C[y.pos++]))<<10,E<128)||(x|=(127&(E=C[y.pos++]))<<17,E<128)||(x|=(127&(E=C[y.pos++]))<<24,E<128)||(x|=(1&(E=C[y.pos++]))<<31,E<128))return function Hs(o,i,s){return s?4294967296*i+(o>>>0):4294967296*(i>>>0)+(o>>>0)}(d,x,m);throw new Error("Expected varint not more than 10 bytes")}(i|=(15&(s=c[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,i=this.pos;return this.pos=o,o-i>=12&&yh?yh.decode(this.buf.subarray(i,o)):function(s,c,d){for(var m="",y=c;y<d;){var x,E,C,D=s[y],P=null,R=D>239?4:D>223?3:D>191?2:1;if(y+R>d)break;1===R?D<128&&(P=D):2===R?128==(192&(x=s[y+1]))&&(P=(31&D)<<6|63&x)<=127&&(P=null):3===R?(E=s[y+2],128==(192&(x=s[y+1]))&&128==(192&E)&&((P=(15&D)<<12|(63&x)<<6|63&E)<=2047||P>=55296&&P<=57343)&&(P=null)):4===R&&(E=s[y+2],C=s[y+3],128==(192&(x=s[y+1]))&&128==(192&E)&&128==(192&C)&&((P=(15&D)<<18|(63&x)<<12|(63&E)<<6|63&C)<=65535||P>=1114112)&&(P=null)),null===P?(P=65533,R=1):P>65535&&(P-=65536,m+=String.fromCharCode(P>>>10&1023|55296),P=56320|1023&P),m+=String.fromCharCode(P),y+=R}return m}(this.buf,i,o)},readBytes:function(){var o=this.readVarint()+this.pos,i=this.buf.subarray(this.pos,o);return this.pos=o,i},readPackedVarint:function(o,i){if(this.type!==Gn.Bytes)return o.push(this.readVarint(i));var s=nl(this);for(o=o||[];this.pos<s;)o.push(this.readVarint(i));return o},readPackedSVarint:function(o){if(this.type!==Gn.Bytes)return o.push(this.readSVarint());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==Gn.Bytes)return o.push(this.readBoolean());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==Gn.Bytes)return o.push(this.readFloat());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==Gn.Bytes)return o.push(this.readDouble());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==Gn.Bytes)return o.push(this.readFixed32());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==Gn.Bytes)return o.push(this.readSFixed32());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==Gn.Bytes)return o.push(this.readFixed64());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==Gn.Bytes)return o.push(this.readSFixed64());var i=nl(this);for(o=o||[];this.pos<i;)o.push(this.readSFixed64());return o},skip:function(o){var i=7&o;if(i===Gn.Varint)for(;this.buf[this.pos++]>127;);else if(i===Gn.Bytes)this.pos=this.readVarint()+this.pos;else if(i===Gn.Fixed32)this.pos+=4;else{if(i!==Gn.Fixed64)throw new Error("Unimplemented type: "+i);this.pos+=8}},writeTag:function(o,i){this.writeVarint(o<<3|i)},realloc:function(o){for(var i=this.length||16;i<this.pos+o;)i*=2;if(i!==this.length){var s=new Uint8Array(i);s.set(this.buf),this.buf=s,this.length=i}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Wl(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Wl(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Wl(this.buf,-1&o,this.pos),Wl(this.buf,Math.floor(o*jy),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Wl(this.buf,-1&o,this.pos),Wl(this.buf,Math.floor(o*jy),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(i,s){var c,d,m,x;if(i>=0?(c=i%4294967296|0,d=i/4294967296|0):(d=~(-i/4294967296),4294967295^(c=~(-i%4294967296))?c=c+1|0:(c=0,d=d+1|0)),i>=0x10000000000000000||i<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),m=c,(x=s).buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,m>>>=7,x.buf[x.pos++]=127&m|128,x.buf[x.pos]=127&(m>>>=7),function(m,y){var x=(7&m)<<4;y.buf[y.pos++]|=x|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(d,s)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var i=this.pos;this.pos=function(c,d,m){for(var y,x,E=0;E<d.length;E++){if((y=d.charCodeAt(E))>55295&&y<57344){if(!x){y>56319||E+1===d.length?(c[m++]=239,c[m++]=191,c[m++]=189):x=y;continue}if(y<56320){c[m++]=239,c[m++]=191,c[m++]=189,x=y;continue}y=x-55296<<10|y-56320|65536,x=null}else x&&(c[m++]=239,c[m++]=191,c[m++]=189,x=null);y<128?c[m++]=y:(y<2048?c[m++]=y>>6|192:(y<65536?c[m++]=y>>12|224:(c[m++]=y>>18|240,c[m++]=y>>12&63|128),c[m++]=y>>6&63|128),c[m++]=63&y|128)}return m}(this.buf,o,this.pos);var s=this.pos-i;s>=128&&jr(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeFloat:function(o){this.realloc(4),Vy(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),Vy(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var i=o.length;this.writeVarint(i),this.realloc(i);for(var s=0;s<i;s++)this.buf[this.pos++]=o[s]},writeRawMessage:function(o,i){this.pos++;var s=this.pos;o(i,this);var c=this.pos-s;c>=128&&jr(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(o,i,s){this.writeTag(o,Gn.Bytes),this.writeRawMessage(i,s)},writePackedVarint:function(o,i){i.length&&this.writeMessage(o,J0,i)},writePackedSVarint:function(o,i){i.length&&this.writeMessage(o,Hy,i)},writePackedBoolean:function(o,i){i.length&&this.writeMessage(o,ex,i)},writePackedFloat:function(o,i){i.length&&this.writeMessage(o,il,i)},writePackedDouble:function(o,i){i.length&&this.writeMessage(o,Y0,i)},writePackedFixed32:function(o,i){i.length&&this.writeMessage(o,Qc,i)},writePackedSFixed32:function(o,i){i.length&&this.writeMessage(o,tx,i)},writePackedFixed64:function(o,i){i.length&&this.writeMessage(o,Dg,i)},writePackedSFixed64:function(o,i){i.length&&this.writeMessage(o,Sg,i)},writeBytesField:function(o,i){this.writeTag(o,Gn.Bytes),this.writeBytes(i)},writeFixed32Field:function(o,i){this.writeTag(o,Gn.Fixed32),this.writeFixed32(i)},writeSFixed32Field:function(o,i){this.writeTag(o,Gn.Fixed32),this.writeSFixed32(i)},writeFixed64Field:function(o,i){this.writeTag(o,Gn.Fixed64),this.writeFixed64(i)},writeSFixed64Field:function(o,i){this.writeTag(o,Gn.Fixed64),this.writeSFixed64(i)},writeVarintField:function(o,i){this.writeTag(o,Gn.Varint),this.writeVarint(i)},writeSVarintField:function(o,i){this.writeTag(o,Gn.Varint),this.writeSVarint(i)},writeStringField:function(o,i){this.writeTag(o,Gn.Bytes),this.writeString(i)},writeFloatField:function(o,i){this.writeTag(o,Gn.Fixed32),this.writeFloat(i)},writeDoubleField:function(o,i){this.writeTag(o,Gn.Fixed64),this.writeDouble(i)},writeBooleanField:function(o,i){this.writeVarintField(o,Boolean(i))}};var mf=eo(zy);const kg=3;function nx(o,i,s){i.glyphs=[],1===o&&s.readMessage(ix,i)}function ix(o,i,s){if(3===o){const{id:c,bitmap:d,width:m,height:y,left:x,top:E,advance:C}=s.readMessage(Ld,{});i.glyphs.push({id:c,bitmap:new ba({width:m+2*kg,height:y+2*kg},d),metrics:{width:m,height:y,left:x,top:E,advance:C}})}else 4===o?i.ascender=s.readSVarint():5===o&&(i.descender=s.readSVarint())}function Ld(o,i,s){1===o?i.id=s.readVarint():2===o?i.bitmap=s.readBytes():3===o?i.width=s.readVarint():4===o?i.height=s.readVarint():5===o?i.left=s.readSVarint():6===o?i.top=s.readSVarint():7===o&&(i.advance=s.readVarint())}const gf=kg;function Pg(o){let i=0,s=0;for(const y of o)i+=y.w*y.h,s=Math.max(s,y.w);o.sort((y,x)=>x.h-y.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),s),h:1/0}];let d=0,m=0;for(const y of o)for(let x=c.length-1;x>=0;x--){const E=c[x];if(!(y.w>E.w||y.h>E.h)){if(y.x=E.x,y.y=E.y,m=Math.max(m,y.y+y.h),d=Math.max(d,y.x+y.w),y.w===E.w&&y.h===E.h){const C=c.pop();x<c.length&&(c[x]=C)}else y.h===E.h?(E.x+=y.w,E.w-=y.w):y.w===E.w?(E.y+=y.h,E.h-=y.h):(c.push({x:E.x+y.w,y:E.y,w:E.w-y.w,h:y.h}),E.y+=y.h,E.h-=y.h);break}}return{w:d,h:m,fill:i/(d*m)||0}}const Yi=1;class Gs{constructor(i,{pixelRatio:s,version:c,stretchX:d,stretchY:m,content:y}){this.paddedRect=i,this.pixelRatio=s,this.stretchX=d,this.stretchY=m,this.content=y,this.version=c}get tl(){return[this.paddedRect.x+Yi,this.paddedRect.y+Yi]}get br(){return[this.paddedRect.x+this.paddedRect.w-Yi,this.paddedRect.y+this.paddedRect.h-Yi]}get displaySize(){return[(this.paddedRect.w-2*Yi)/this.pixelRatio,(this.paddedRect.h-2*Yi)/this.pixelRatio]}}class Gy{constructor(i,s){const c={},d={};this.haveRenderCallbacks=[];const m=[];this.addImages(i,c,m),this.addImages(s,d,m);const{w:y,h:x}=Pg(m),E=new Ur({width:y||1,height:x||1});for(const C in i){const D=i[C],P=c[C].paddedRect;Ur.copy(D.data,E,{x:0,y:0},{x:P.x+Yi,y:P.y+Yi},D.data)}for(const C in s){const D=s[C],P=d[C].paddedRect,R=P.x+Yi,B=P.y+Yi,N=D.data.width,U=D.data.height;Ur.copy(D.data,E,{x:0,y:0},{x:R,y:B},D.data),Ur.copy(D.data,E,{x:0,y:U-1},{x:R,y:B-1},{width:N,height:1}),Ur.copy(D.data,E,{x:0,y:0},{x:R,y:B+U},{width:N,height:1}),Ur.copy(D.data,E,{x:N-1,y:0},{x:R-1,y:B},{width:1,height:U}),Ur.copy(D.data,E,{x:0,y:0},{x:R+N,y:B},{width:1,height:U})}this.image=E,this.iconPositions=c,this.patternPositions=d}addImages(i,s,c){for(const d in i){const m=i[d],y={x:0,y:0,w:m.data.width+2*Yi,h:m.data.height+2*Yi};c.push(y),s[d]=new Gs(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(d)}}patchUpdatedImages(i,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>i.hasImage(c)),i.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in i.updatedImages)this.patchUpdatedImage(this.iconPositions[c],i.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],i.getImage(c),s)}patchUpdatedImage(i,s,c){if(!i||!s||i.version===s.version)return;i.version=s.version;const[d,m]=i.tl;c.update(s.data,void 0,{x:d,y:m})}}Ae(Gs,"ImagePosition"),Ae(Gy,"ImageAtlas");const Zo={horizontal:1,vertical:2,horizontalOnly:3},rx=-17;class _f{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(i,s){const c=new _f;return c.scale=i||1,c.fontStack=s,c}static forImage(i){const s=new _f;return s.imageName=i,s}}class Xc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,s){const c=new Xc;for(let d=0;d<i.sections.length;d++){const m=i.sections[d];m.image?c.addImageSection(m):c.addTextSection(m,s)}return c}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCharCode(i){return this.text.charCodeAt(i)}verticalizePunctuation(i){this.text=function(s,c){let d="";for(let m=0;m<s.length;m++){const y=s.charCodeAt(m+1)||null,x=s.charCodeAt(m-1)||null;d+=!c&&(y&&Pp(y)&&!Fd[s[m+1]]||x&&Pp(x)&&!Fd[s[m-1]])||!Fd[s[m]]?s[m]:Fd[s[m]]}return d}(this.text,i)}trim(){let i=0;for(let c=0;c<this.text.length&&Bd[this.text.charCodeAt(c)];c++)i++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=i&&Bd[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(i,s),this.sectionIndex=this.sectionIndex.slice(i,s)}substring(i,s){const c=new Xc;return c.text=this.text.substring(i,s),c.sectionIndex=this.sectionIndex.slice(i,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,s)=>Math.max(i,this.sections[s].scale),0)}addTextSection(i,s){this.text+=i.text,this.sections.push(_f.forText(i.scale,i.fontStack||s));const c=this.sections.length-1;for(let d=0;d<i.text.length;++d)this.sectionIndex.push(c)}addImageSection(i){const s=i.image?i.image.name:"";if(0===s.length)return void ci("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(_f.forImage(s)),this.sectionIndex.push(this.sections.length-1)):ci("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $y(o,i,s,c,d,m,y,x,E,C,D,P,R,B,N){const U=Xc.fromFeature(o,d);P===Zo.vertical&&U.verticalizePunctuation(R);let q=[];const Y=function(ce,xe,we,Oe,We,De){if(!ce)return[];const ze=[],Ve=function(ut,yt,dt,Vt,it,Mt){let Ut=0;for(let En=0;En<ut.length();En++){const jt=ut.getSection(En);Ut+=Wy(ut.getCharCode(En),jt,Vt,it,yt,Mt)}return Ut/Math.max(1,Math.ceil(Ut/dt))}(ce,xe,we,Oe,We,De),Ge=ce.text.indexOf("\u200b")>=0;let Ye=0;for(let ut=0;ut<ce.length();ut++){const yt=ce.getSection(ut),dt=ce.getCharCode(ut);if(Bd[dt]||(Ye+=Wy(dt,yt,Oe,We,xe,De)),ut<ce.length()-1){const Vt=!((Re=dt)<11904||!(pt["Bopomofo Extended"](Re)||pt.Bopomofo(Re)||pt["CJK Compatibility Forms"](Re)||pt["CJK Compatibility Ideographs"](Re)||pt["CJK Compatibility"](Re)||pt["CJK Radicals Supplement"](Re)||pt["CJK Strokes"](Re)||pt["CJK Symbols and Punctuation"](Re)||pt["CJK Unified Ideographs Extension A"](Re)||pt["CJK Unified Ideographs"](Re)||pt["Enclosed CJK Letters and Months"](Re)||pt["Halfwidth and Fullwidth Forms"](Re)||pt.Hiragana(Re)||pt["Ideographic Description Characters"](Re)||pt["Kangxi Radicals"](Re)||pt["Katakana Phonetic Extensions"](Re)||pt.Katakana(Re)||pt["Vertical Forms"](Re)||pt["Yi Radicals"](Re)||pt["Yi Syllables"](Re)));(qy[dt]||Vt||yt.imageName)&&ze.push(Zy(ut+1,Ye,Ve,ze,ox(dt,ce.getCharCode(ut+1),Vt&&Ge),!1))}}var Re;return As(Zy(ce.length(),Ye,Ve,ze,0,!0))}(U,C,m,i,c,B),{processBidirectionalText:ae,processStyledBidirectionalText:J}=M;if(ae&&1===U.sections.length){const ce=ae(U.toString(),Y);for(const xe of ce){const we=new Xc;we.text=xe,we.sections=U.sections;for(let Oe=0;Oe<xe.length;Oe++)we.sectionIndex.push(0);q.push(we)}}else if(J){const ce=J(U.text,U.sectionIndex,Y);for(const xe of ce){const we=new Xc;we.text=xe[0],we.sectionIndex=xe[1],we.sections=U.sections,q.push(we)}}else q=function(ce,xe){const we=[],Oe=ce.text;let We=0;for(const De of xe)we.push(ce.substring(We,De)),We=De;return We<Oe.length&&we.push(ce.substring(We,Oe.length)),we}(U,Y);const oe=[],ue={positionedLines:oe,text:U.toString(),top:D[1],bottom:D[1],left:D[0],right:D[0],writingMode:P,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(ce,xe,we,Oe,We,De,ze,Ve,Ge,Ye,Re,ut){let yt=0,dt=0,Vt=0;const it="right"===Ve?1:"left"===Ve?0:.5;let Mt=!1;for(const At of We){const Qt=At.getSections();for(const zn of Qt){if(zn.imageName)continue;const ot=xe[zn.fontStack];if(ot&&(Mt=void 0!==ot.ascender&&void 0!==ot.descender,!Mt))break}if(!Mt)break}let Ut=0;for(const At of We){At.trim();const Qt=At.getMaxScale(),zn=(Qt-1)*Ji,ot={positionedGlyphs:[],lineOffset:0};ce.positionedLines[Ut]=ot;const Hn=ot.positionedGlyphs;let $n=0;if(!At.length()){dt+=De,++Ut;continue}let ke=0,Ne=0;for(let qn=0;qn<At.length();qn++){const Ei=At.getSection(qn),yi=At.getSectionIndex(qn),ai=At.getCharCode(qn);let Gt=Ei.scale,li=null,Wn=null,Mr=null,ft=Ji,er=0;const tr=!(Ge===Zo.horizontal||!Re&&!Oc(ai)||Re&&(Bd[ai]||(En=ai,pt.Arabic(En)||pt["Arabic Supplement"](En)||pt["Arabic Extended-A"](En)||pt["Arabic Presentation Forms-A"](En)||pt["Arabic Presentation Forms-B"](En))));if(Ei.imageName){const Hr=Oe[Ei.imageName];if(!Hr)continue;Mr=Ei.imageName,ce.iconsInText=ce.iconsInText||!0,Wn=Hr.paddedRect;const Gi=Hr.displaySize;Gt=Gt*Ji/ut,li={width:Gi[0],height:Gi[1],left:Yi,top:-gf,advance:tr?Gi[1]:Gi[0],localGlyph:!1},er=Mt?-li.height*Gt:rx+Qt*Ji-Gi[1]*Gt,ft=li.advance;const Es=(tr?Gi[0]:Gi[1])*Gt-Ji*Qt;Es>0&&Es>$n&&($n=Es)}else{const Hr=we[Ei.fontStack];if(!Hr)continue;Hr[ai]&&(Wn=Hr[ai]);const Gi=xe[Ei.fontStack];if(!Gi)continue;const Es=Gi.glyphs[ai];if(!Es)continue;if(li=Es.metrics,ft=8203!==ai?Ji:0,Mt){const Ft=void 0!==Gi.ascender?Math.abs(Gi.ascender):0,Qd=void 0!==Gi.descender?Math.abs(Gi.descender):0,Xd=(Ft+Qd)*Gt;ke<Xd&&(ke=Xd,Ne=(Ft-Qd)/2*Gt),er=-Ft*Gt}else er=rx+(Qt-Gt)*Ji}tr?(ce.verticalizable=!0,Hn.push({glyph:ai,imageName:Mr,x:yt,y:dt+er,vertical:tr,scale:Gt,localGlyph:li.localGlyph,fontStack:Ei.fontStack,sectionIndex:yi,metrics:li,rect:Wn}),yt+=ft*Gt+Ye):(Hn.push({glyph:ai,imageName:Mr,x:yt,y:dt+er,vertical:tr,scale:Gt,localGlyph:li.localGlyph,fontStack:Ei.fontStack,sectionIndex:yi,metrics:li,rect:Wn}),yt+=li.advance*Gt+Ye)}0!==Hn.length&&(Vt=Math.max(yt-Ye,Vt),Mt?Fg(Hn,it,$n,Ne,De*Qt/2):Fg(Hn,it,$n,0,De/2)),yt=0;const Dt=De*Qt+$n;ot.lineOffset=Math.max($n,zn),dt+=Dt,++Ut}var En;const jt=dt,{horizontalAlign:Rt,verticalAlign:Yn}=Og(ze);(function(At,Qt,zn,ot,Hn,$n){const ke=(Qt-zn)*Hn,Ne=-$n*ot;for(const Dt of At)for(const qn of Dt.positionedGlyphs)qn.x+=ke,qn.y+=Ne})(ce.positionedLines,it,Rt,Yn,Vt,jt),ce.top+=-Yn*jt,ce.bottom=ce.top+jt,ce.left+=-Rt*Vt,ce.right=ce.left+Vt,ce.hasBaseline=Mt}(ue,i,s,c,q,y,x,E,P,C,R,N),!function(ce){for(const xe of ce)if(0!==xe.positionedGlyphs.length)return!1;return!0}(oe)&&ue}const Bd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qy={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Wy(o,i,s,c,d,m){if(i.imageName){const y=c[i.imageName];return y?y.displaySize[0]*i.scale*Ji/m+d:0}{const y=s[i.fontStack],x=y&&y.glyphs[o];return x?x.metrics.advance*i.scale+d:0}}function Rg(o,i,s,c){const d=Math.pow(o-i,2);return c?o<i?d/2:2*d:d+Math.abs(s)*s}function ox(o,i,s){let c=0;return 10===o&&(c-=1e4),s&&(c+=150),40!==o&&65288!==o||(c+=50),41!==i&&65289!==i||(c+=50),c}function Zy(o,i,s,c,d,m){let y=null,x=Rg(i,s,d,m);for(const E of c){const C=Rg(i-E.x,s,d,m)+E.badness;C<=x&&(y=E,x=C)}return{index:o,x:i,priorBreak:y,badness:x}}function As(o){return o?As(o.priorBreak).concat(o.index):[]}function Og(o){let i=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:i,verticalAlign:s}}function Fg(o,i,s,c,d){if(!(i||s||c||d))return;const m=o.length-1,y=o[m],x=(y.x+y.metrics.advance*y.scale)*i;for(let E=0;E<=m;E++)o[E].x-=x,o[E].y+=s+c+d}function sx(o,i,s){const{horizontalAlign:c,verticalAlign:d}=Og(s),m=i[0]-o.displaySize[0]*c,y=i[1]-o.displaySize[1]*d;return{image:o,top:y,bottom:y+o.displaySize[1],left:m,right:m+o.displaySize[0]}}function Qy(o,i,s,c,d,m){const y=o.image;let x;if(y.content){const q=y.content,Y=y.pixelRatio||1;x=[q[0]/Y,q[1]/Y,y.displaySize[0]-q[2]/Y,y.displaySize[1]-q[3]/Y]}const E=i.left*m,C=i.right*m;let D,P,R,B;"width"===s||"both"===s?(B=d[0]+E-c[3],P=d[0]+C+c[1]):(B=d[0]+(E+C-y.displaySize[0])/2,P=B+y.displaySize[0]);const N=i.top*m,U=i.bottom*m;return"height"===s||"both"===s?(D=d[1]+N-c[0],R=d[1]+U+c[2]):(D=d[1]+(N+U-y.displaySize[1])/2,R=D+y.displaySize[1]),{image:y,top:D,right:P,bottom:R,left:B,collisionPadding:x}}class ol extends lt{constructor(i,s,c,d,m){super(i,s),this.angle=d,this.z=c,void 0!==m&&(this.segment=m)}clone(){return new ol(this.x,this.y,this.z,this.angle,this.segment)}}function Xy(o,i,s,c,d){if(void 0===i.segment)return!0;let m=i,y=i.segment+1,x=0;for(;x>-s/2;){if(y--,y<0)return!1;x-=o[y].dist(m),m=o[y]}x+=o[y].dist(o[y+1]),y++;const E=[];let C=0;for(;x<s/2;){const D=o[y],P=o[y+1];if(!P)return!1;let R=o[y-1].angleTo(D)-D.angleTo(P);for(R=Math.abs((R+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:x,angleDelta:R}),C+=R;x-E[0].distance>c;)C-=E.shift().angleDelta;if(C>d)return!1;y++,x+=D.dist(P)}return!0}function Lg(o){let i=0;for(let s=0;s<o.length-1;s++)i+=o[s].dist(o[s+1]);return i}function Ky(o,i,s){return o?.6*i*s:0}function Jy(o,i){return Math.max(o?o.right-o.left:0,i?i.right-i.left:0)}function ax(o,i,s,c,d,m){const y=Ky(s,d,m),x=Jy(s,c)*m;let E=0;const C=Lg(o)/2;for(let D=0;D<o.length-1;D++){const P=o[D],R=o[D+1],B=P.dist(R);if(E+B>C){const N=(C-E)/B,U=bn(P.x,R.x,N),q=bn(P.y,R.y,N),Y=new ol(U,q,0,R.angleTo(P),D);return!y||Xy(o,Y,x,y,i)?Y:void 0}E+=B}}function pn(o,i,s,c,d,m,y,x,E){const C=Ky(c,m,y),D=Jy(c,d),P=D*y,R=0===o[0].x||o[0].x===E||0===o[0].y||o[0].y===E;return i-P<i/4&&(i=P+i/4),ct(o,R?i/2*x%i:(D/2+2*m)*y*x%i,i,C,s,P,R,!1,E)}function ct(o,i,s,c,d,m,y,x,E){const C=m/2,D=Lg(o);let P=0,R=i-s,B=[];for(let N=0;N<o.length-1;N++){const U=o[N],q=o[N+1],Y=U.dist(q),ae=q.angleTo(U);for(;R+s<P+Y;){R+=s;const J=(R-P)/Y,oe=bn(U.x,q.x,J),ue=bn(U.y,q.y,J);if(oe>=0&&oe<E&&ue>=0&&ue<E&&R-C>=0&&R+C<=D){const ce=new ol(oe,ue,0,ae,N);ce._round(),c&&!Xy(o,ce,m,c,d)||B.push(ce)}}P+=Y}return x||B.length||y||(B=ct(o,P/2,s,c,d,m,y,!0,E)),B}function Bg(o,i,s,c,d){const m=[];for(let y=0;y<o.length;y++){const x=o[y];let E;for(let C=0;C<x.length-1;C++){let D=x[C],P=x[C+1];D.x<i&&P.x<i||(D.x<i?D=new lt(i,D.y+(i-D.x)/(P.x-D.x)*(P.y-D.y))._round():P.x<i&&(P=new lt(i,D.y+(i-D.x)/(P.x-D.x)*(P.y-D.y))._round()),D.y<s&&P.y<s||(D.y<s?D=new lt(D.x+(s-D.y)/(P.y-D.y)*(P.x-D.x),s)._round():P.y<s&&(P=new lt(D.x+(s-D.y)/(P.y-D.y)*(P.x-D.x),s)._round()),D.x>=c&&P.x>=c||(D.x>=c?D=new lt(c,D.y+(c-D.x)/(P.x-D.x)*(P.y-D.y))._round():P.x>=c&&(P=new lt(c,D.y+(c-D.x)/(P.x-D.x)*(P.y-D.y))._round()),D.y>=d&&P.y>=d||(D.y>=d?D=new lt(D.x+(d-D.y)/(P.y-D.y)*(P.x-D.x),d)._round():P.y>=d&&(P=new lt(D.x+(d-D.y)/(P.y-D.y)*(P.x-D.x),d)._round()),E&&D.equals(E[E.length-1])||(E=[D],m.push(E)),E.push(P)))))}}return m}Ae(ol,"Anchor");const vh=1e20;function Yy(o,i,s,c,d,m,y,x,E){for(let C=i;C<i+c;C++)ev(o,s*m+C,m,d,y,x,E);for(let C=s;C<s+d;C++)ev(o,C*m+i,1,c,y,x,E)}function ev(o,i,s,c,d,m,y){m[0]=0,y[0]=-vh,y[1]=vh,d[0]=o[i];for(let x=1,E=0,C=0;x<c;x++){d[x]=o[i+x*s];const D=x*x;do{const P=m[E];C=(d[x]-d[P]+D-P*P)/(x-P)/2}while(C<=y[E]&&--E>-1);E++,m[E]=x,y[E]=C,y[E+1]=vh}for(let x=0,E=0;x<c;x++){for(;y[E+1]<x;)E++;const C=m[E],D=x-C;o[i+x*s]=d[C]+D*D}}const xs=2,Ng={none:0,ideographs:1,all:2};class Kc{constructor(i,s,c){this.requestManager=i,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i){this.url=i}getGlyphs(i,s){const c=[];for(const d in i)for(const m of i[d])c.push({stack:d,id:m});zi(c,({stack:d,id:m},y)=>{let x=this.entries[d];x||(x=this.entries[d]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=x.glyphs[m];if(void 0!==E)return void y(null,{stack:d,id:m,glyph:E});if(E=this._tinySDF(x,d,m),E)return x.glyphs[m]=E,void y(null,{stack:d,id:m,glyph:E});const C=Math.floor(m/256);if(256*C>65535)return void y(new Error("glyphs > 65535 not supported"));if(x.ranges[C])return void y(null,{stack:d,id:m,glyph:E});let D=x.requests[C];D||(D=x.requests[C]=[],Kc.loadGlyphRange(d,C,this.url,this.requestManager,(P,R)=>{if(R){x.ascender=R.ascender,x.descender=R.descender;for(const B in R.glyphs)this._doesCharSupportLocalGlyph(+B)||(x.glyphs[+B]=R.glyphs[+B]);x.ranges[C]=!0}for(const B of D)B(P,R);delete x.requests[C]})),D.push((P,R)=>{P?y(P):R&&y(null,{stack:d,id:m,glyph:R.glyphs[m]||null})})},(d,m)=>{if(d)s(d);else if(m){const y={};for(const{stack:x,id:E,glyph:C}of m)void 0===y[x]&&(y[x]={}),void 0===y[x].glyphs&&(y[x].glyphs={}),y[x].glyphs[E]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},y[x].ascender=this.entries[x].ascender,y[x].descender=this.entries[x].descender;s(null,y)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==Ng.none&&(this.localGlyphMode===Ng.all?!!this.localFontFamily:!!this.localFontFamily&&(pt["CJK Unified Ideographs"](i)||pt["Hangul Syllables"](i)||pt.Hiragana(i)||pt.Katakana(i)||pt["CJK Symbols and Punctuation"](i)))}_tinySDF(i,s,c){const d=this.localFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let m=i.tinySDF;if(!m){let U="400";/bold/i.test(s)?U="900":/medium/i.test(s)?U="500":/light/i.test(s)&&(U="200"),m=i.tinySDF=new Kc.TinySDF({fontFamily:d,fontWeight:U,fontSize:24*xs,buffer:3*xs,radius:8*xs}),m.fontWeight=U}if(this.localGlyphs[m.fontWeight][c])return this.localGlyphs[m.fontWeight][c];const y=String.fromCharCode(c),{data:x,width:E,height:C,glyphWidth:D,glyphHeight:P,glyphLeft:R,glyphTop:B,glyphAdvance:N}=m.draw(y);return this.localGlyphs[m.fontWeight][c]={id:c,bitmap:new ba({width:E,height:C},x),metrics:{width:D/xs,height:P/xs,left:R/xs,top:B/xs-27,advance:N/xs,localGlyph:!0}}}}Kc.loadGlyphRange=function(o,i,s,c,d){const m=256*i,y=m+255,x=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",o).replace("{range}",`${m}-${y}`),La.Glyphs);xl(x,(E,C)=>{if(E)d(E);else if(C){const D={},P=new mf(C).readFields(nx,{});for(const R of P.glyphs)D[R.id]=R;d(null,{glyphs:D,ascender:P.ascender,descender:P.descender})}})},Kc.TinySDF=class{constructor({fontSize:o=24,buffer:i=3,radius:s=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}={}){this.buffer=i,this.cutoff=c,this.radius=s;const x=this.size=o+4*i,E=this._createCanvas(x),C=this.ctx=E.getContext("2d",{willReadFrequently:!0});C.font=`${y} ${m} ${o}px ${d}`,C.textBaseline="alphabetic",C.textAlign="left",C.fillStyle="black",this.gridOuter=new Float64Array(x*x),this.gridInner=new Float64Array(x*x),this.f=new Float64Array(x),this.z=new Float64Array(x+1),this.v=new Uint16Array(x)}_createCanvas(o){const i=document.createElement("canvas");return i.width=i.height=o,i}draw(o){const{width:i,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:m}=this.ctx.measureText(o),y=Math.ceil(s),x=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(m-d))),E=Math.min(this.size-this.buffer,y+Math.ceil(c)),C=x+2*this.buffer,D=E+2*this.buffer,P=Math.max(C*D,0),R=new Uint8ClampedArray(P),B={data:R,width:C,height:D,glyphWidth:x,glyphHeight:E,glyphTop:y,glyphLeft:0,glyphAdvance:i};if(0===x||0===E)return B;const{ctx:N,buffer:U,gridInner:q,gridOuter:Y}=this;N.clearRect(U,U,x,E),N.fillText(o,U,U+y);const ae=N.getImageData(U,U,x,E);Y.fill(vh,0,P),q.fill(0,0,P);for(let J=0;J<E;J++)for(let oe=0;oe<x;oe++){const ue=ae.data[4*(J*x+oe)+3]/255;if(0===ue)continue;const ce=(J+U)*C+oe+U;if(1===ue)Y[ce]=0,q[ce]=vh;else{const xe=.5-ue;Y[ce]=xe>0?xe*xe:0,q[ce]=xe<0?xe*xe:0}}Yy(Y,0,0,C,D,C,this.f,this.v,this.z),Yy(q,U,U,x,E,C,this.f,this.v,this.z);for(let J=0;J<P;J++){const oe=Math.sqrt(Y[J])-Math.sqrt(q[J]);R[J]=Math.round(255-255*(oe/this.radius+this.cutoff))}return B}};const Ah=Yi;function tv(o,i,s,c){const d=[],m=o.image,y=m.pixelRatio,x=m.paddedRect.w-2*Ah,E=m.paddedRect.h-2*Ah,C=o.right-o.left,D=o.bottom-o.top,P=m.stretchX||[[0,x]],R=m.stretchY||[[0,E]],B=(De,ze)=>De+ze[1]-ze[0],N=P.reduce(B,0),U=R.reduce(B,0),q=x-N,Y=E-U;let ae=0,J=N,oe=0,ue=U,ce=0,xe=q,we=0,Oe=Y;if(m.content&&c){const De=m.content;ae=zg(P,0,De[0]),oe=zg(R,0,De[1]),J=zg(P,De[0],De[2]),ue=zg(R,De[1],De[3]),ce=De[0]-ae,we=De[1]-oe,xe=De[2]-De[0]-J,Oe=De[3]-De[1]-ue}const We=(De,ze,Ve,Ge)=>{const Ye=Nd(De.stretch-ae,J,C,o.left),Re=Eo(De.fixed-ce,xe,De.stretch,N),ut=Nd(ze.stretch-oe,ue,D,o.top),yt=Eo(ze.fixed-we,Oe,ze.stretch,U),dt=Nd(Ve.stretch-ae,J,C,o.left),Vt=Eo(Ve.fixed-ce,xe,Ve.stretch,N),it=Nd(Ge.stretch-oe,ue,D,o.top),Mt=Eo(Ge.fixed-we,Oe,Ge.stretch,U),Ut=new lt(Ye,ut),En=new lt(dt,ut),jt=new lt(dt,it),Rt=new lt(Ye,it),Yn=new lt(Re/y,yt/y),At=new lt(Vt/y,Mt/y),Qt=i*Math.PI/180;if(Qt){const Hn=Math.sin(Qt),$n=Math.cos(Qt),ke=[$n,-Hn,Hn,$n];Ut._matMult(ke),En._matMult(ke),Rt._matMult(ke),jt._matMult(ke)}const zn=De.stretch+De.fixed,ot=ze.stretch+ze.fixed;return{tl:Ut,tr:En,bl:Rt,br:jt,tex:{x:m.paddedRect.x+Ah+zn,y:m.paddedRect.y+Ah+ot,w:Ve.stretch+Ve.fixed-zn,h:Ge.stretch+Ge.fixed-ot},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yn,pixelOffsetBR:At,minFontScaleX:xe/y/C,minFontScaleY:Oe/y/D,isSDF:s}};if(c&&(m.stretchX||m.stretchY)){const De=Vg(P,q,N),ze=Vg(R,Y,U);for(let Ve=0;Ve<De.length-1;Ve++){const Ge=De[Ve],Ye=De[Ve+1];for(let Re=0;Re<ze.length-1;Re++)d.push(We(Ge,ze[Re],Ye,ze[Re+1]))}}else d.push(We({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:x+1},{fixed:0,stretch:E+1}));return d}function zg(o,i,s){let c=0;for(const d of o)c+=Math.max(i,Math.min(s,d[1]))-Math.max(i,Math.min(s,d[0]));return c}function Vg(o,i,s){const c=[{fixed:-Ah,stretch:0}];for(const[d,m]of o){const y=c[c.length-1];c.push({fixed:d-y.stretch,stretch:y.stretch}),c.push({fixed:d-y.stretch,stretch:y.stretch+(m-d)})}return c.push({fixed:i+Ah,stretch:s}),c}function Nd(o,i,s,c){return o/i*s+c}function Eo(o,i,s,c){return o-i*s/c}function lx(o,i,s,c){const d=i+o.positionedLines[c].lineOffset;return 0===c?s+d/2:s+(d+(i+o.positionedLines[c-1].lineOffset))/2}class Ug{constructor(i=[],s=jg){if(this.data=i,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(i){this.data.push(i),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const i=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:s,compare:c}=this,d=s[i];for(;i>0;){const m=i-1>>1,y=s[m];if(c(d,y)>=0)break;s[i]=y,i=m}s[i]=d}_down(i){const{data:s,compare:c}=this,d=this.length>>1,m=s[i];for(;i<d;){let y=1+(i<<1),x=s[y];const E=y+1;if(E<this.length&&c(s[E],x)<0&&(y=E,x=s[E]),c(x,m)>=0)break;s[i]=x,i=y}s[i]=m}}function jg(o,i){return o<i?-1:o>i?1:0}function cx(o,i=1,s=!1){let c=1/0,d=1/0,m=-1/0,y=-1/0;const x=o[0];for(let B=0;B<x.length;B++){const N=x[B];(!B||N.x<c)&&(c=N.x),(!B||N.y<d)&&(d=N.y),(!B||N.x>m)&&(m=N.x),(!B||N.y>y)&&(y=N.y)}const E=Math.min(m-c,y-d);let C=E/2;const D=new Ug([],g1);if(0===E)return new lt(c,d);for(let B=c;B<m;B+=E)for(let N=d;N<y;N+=E)D.push(new zd(B+C,N+C,C,o));let P=function(B){let N=0,U=0,q=0;const Y=B[0];for(let ae=0,J=Y.length,oe=J-1;ae<J;oe=ae++){const ue=Y[ae],ce=Y[oe],xe=ue.x*ce.y-ce.x*ue.y;U+=(ue.x+ce.x)*xe,q+=(ue.y+ce.y)*xe,N+=3*xe}return new zd(U/N,q/N,0,B)}(o),R=D.length;for(;D.length;){const B=D.pop();(B.d>P.d||!P.d)&&(P=B,s&&console.log("found best %d after %d probes",Math.round(1e4*B.d)/1e4,R)),B.max-P.d<=i||(C=B.h/2,D.push(new zd(B.p.x-C,B.p.y-C,C,o)),D.push(new zd(B.p.x+C,B.p.y-C,C,o)),D.push(new zd(B.p.x-C,B.p.y+C,C,o)),D.push(new zd(B.p.x+C,B.p.y+C,C,o)),R+=4)}return s&&(console.log(`num probes: ${R}`),console.log(`best distance: ${P.d}`)),P.p}function g1(o,i){return i.max-o.max}class zd{constructor(i,s,c,d){this.p=new lt(i,s),this.h=c,this.d=function(m,y){let x=!1,E=1/0;for(let C=0;C<y.length;C++){const D=y[C];for(let P=0,R=D.length,B=R-1;P<R;B=P++){const N=D[P],U=D[B];N.y>m.y!=U.y>m.y&&m.x<(U.x-N.x)*(m.y-N.y)/(U.y-N.y)+N.x&&(x=!x),E=Math.min(E,Cy(m,N,U))}}return(x?1:-1)*Math.sqrt(E)}(this.p,d),this.max=this.d+this.h*Math.SQRT2}}const Vd=7,Hg=Number.POSITIVE_INFINITY,nv=Math.sqrt(2);function ux(o,[i,s]){let c=0,d=0;if(s===Hg){i<0&&(i=0);const m=i/nv;switch(o){case"top-right":case"top-left":d=m-Vd;break;case"bottom-right":case"bottom-left":d=-m+Vd;break;case"bottom":d=-i+Vd;break;case"top":d=i-Vd}switch(o){case"top-right":case"bottom-right":c=-m;break;case"top-left":case"bottom-left":c=m;break;case"left":c=i;break;case"right":c=-i}}else{switch(i=Math.abs(i),s=Math.abs(s),o){case"top-right":case"top-left":case"top":d=s-Vd;break;case"bottom-right":case"bottom-left":case"bottom":d=-s+Vd}switch(o){case"top-right":case"bottom-right":case"right":c=-i;break;case"top-left":case"bottom-left":case"left":c=i}}return[c,d]}function hx(o,i,s,c,d,m,y,x,E,C){o.createArrays(),o.tilePixelRatio=St/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const D=o.layers[0].layout,P=o.layers[0]._unevaluatedLayout._values,R={};if("composite"===o.textSizeData.kind){const{minZoom:U,maxZoom:q}=o.textSizeData;R.compositeTextSizes=[P["text-size"].possiblyEvaluate(new k(U),x),P["text-size"].possiblyEvaluate(new k(q),x)]}if("composite"===o.iconSizeData.kind){const{minZoom:U,maxZoom:q}=o.iconSizeData;R.compositeIconSizes=[P["icon-size"].possiblyEvaluate(new k(U),x),P["icon-size"].possiblyEvaluate(new k(q),x)]}R.layoutTextSize=P["text-size"].possiblyEvaluate(new k(E+1),x),R.layoutIconSize=P["icon-size"].possiblyEvaluate(new k(E+1),x),R.textMaxSize=P["text-size"].possiblyEvaluate(new k(18),x);const B="map"===D.get("text-rotation-alignment")&&"point"!==D.get("symbol-placement"),N=D.get("text-size");for(const U of o.features){const q=D.get("text-font").evaluate(U,{},x).join(","),Y=N.evaluate(U,{},x),ae=R.layoutTextSize.evaluate(U,{},x),J=(R.layoutIconSize.evaluate(U,{},x),{horizontal:{},vertical:void 0}),oe=U.text;let ue,ce=[0,0];if(oe){const Oe=oe.toString(),We=D.get("text-letter-spacing").evaluate(U,{},x)*Ji,De=D.get("text-line-height").evaluate(U,{},x)*Ji,ze=ps(Oe)?We:0,Ve=D.get("text-anchor").evaluate(U,{},x),Ge=D.get("text-variable-anchor");if(!Ge){const dt=D.get("text-radial-offset").evaluate(U,{},x);ce=dt?ux(Ve,[dt*Ji,Hg]):D.get("text-offset").evaluate(U,{},x).map(Vt=>Vt*Ji)}let Ye=B?"center":D.get("text-justify").evaluate(U,{},x);const Re="point"===D.get("symbol-placement"),ut=Re?D.get("text-max-width").evaluate(U,{},x)*Ji:1/0,yt=dt=>{o.allowVerticalPlacement&&Za(Oe)&&(J.vertical=$y(oe,i,s,d,q,ut,De,Ve,dt,ze,ce,Zo.vertical,!0,ae,Y))};if(!B&&Ge){const dt="auto"===Ye?Ge.map(it=>Zl(it)):[Ye];let Vt=!1;for(let it=0;it<dt.length;it++){const Mt=dt[it];if(!J.horizontal[Mt])if(Vt)J.horizontal[Mt]=J.horizontal[0];else{const Ut=$y(oe,i,s,d,q,ut,De,"center",Mt,ze,ce,Zo.horizontal,!1,ae,Y);Ut&&(J.horizontal[Mt]=Ut,Vt=1===Ut.positionedLines.length)}}yt("left")}else{if("auto"===Ye&&(Ye=Zl(Ve)),Re||D.get("text-writing-mode").indexOf("horizontal")>=0||!Za(Oe)){const dt=$y(oe,i,s,d,q,ut,De,Ve,Ye,ze,ce,Zo.horizontal,!1,ae,Y);dt&&(J.horizontal[Ye]=dt)}yt(Re?"left":Ye)}}let xe=!1;if(U.icon&&U.icon.name){const Oe=c[U.icon.name];Oe&&(ue=sx(d[U.icon.name],D.get("icon-offset").evaluate(U,{},x),D.get("icon-anchor").evaluate(U,{},x)),xe=Oe.sdf,void 0===o.sdfIcons?o.sdfIcons=Oe.sdf:o.sdfIcons!==Oe.sdf&&ci("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Oe.pixelRatio!==o.pixelRatio||0!==D.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const we=Gg(J.horizontal)||J.vertical;o.iconsInText||(o.iconsInText=!!we&&we.iconsInText),(we||ue)&&dx(o,U,J,ue,c,R,ae,0,ce,xe,y,x,C)}m&&o.generateCollisionDebugBuffers(E,o.collisionBoxArray)}function Zl(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function dx(o,i,s,c,d,m,y,x,E,C,D,P,R){let B=m.textMaxSize.evaluate(i,{},P);void 0===B&&(B=y);const N=o.layers[0].layout,U=N.get("icon-offset").evaluate(i,{},P),q=Gg(s.horizontal)||s.vertical,Y="globe"===R.name,ae=Ji,J=y/ae,oe=o.tilePixelRatio*B/ae,ue=(Ve=o.overscaling,o.zoom>18&&Ve>2&&(Ve>>=1),Math.max(St/(512*Ve),1)*N.get("symbol-spacing")),ce=N.get("text-padding")*o.tilePixelRatio,xe=N.get("icon-padding")*o.tilePixelRatio,we=sn(N.get("text-max-angle")),Oe="map"===N.get("text-rotation-alignment")&&"point"!==N.get("symbol-placement"),We="map"===N.get("icon-rotation-alignment")&&"point"!==N.get("symbol-placement"),De=N.get("symbol-placement"),ze=ue/2;var Ve;const Ge=N.get("icon-text-fit");let Ye;c&&"none"!==Ge&&(o.allowVerticalPlacement&&s.vertical&&(Ye=Qy(c,s.vertical,Ge,N.get("icon-text-fit-padding"),U,J)),q&&(c=Qy(c,q,Ge,N.get("icon-text-fit-padding"),U,J)));const Re=(ut,yt,dt)=>{if(yt.x<0||yt.x>=St||yt.y<0||yt.y>=St)return;let Vt=null;if(Y){const{x:it,y:Mt,z:Ut}=R.projectTilePoint(yt.x,yt.y,dt);Vt={anchor:new ol(it,Mt,Ut,0,void 0),up:R.upVector(dt,yt.x,yt.y)}}!function(it,Mt,Ut,En,jt,Rt,Yn,At,Qt,zn,ot,Hn,$n,ke,Ne,Dt,qn,Ei,yi,ai,Gt,li,Wn,Mr,ft){const er=it.addToLineVertexArray(Mt,En);let tr,Hr,Gi,Es,Ft,Qd,Xd,Sv=0,ru=0,Pf=0,r_=0,Rf=-1,Of=-1;const Xs={};let o_=Ju("");const Jl=Ut?Ut.anchor:Mt;let Ff=0,Lf=0;if(void 0===Qt._unevaluatedLayout.getValue("text-radial-offset")?[Ff,Lf]=Qt.layout.get("text-offset").evaluate(Gt,{},ft).map(Io=>Io*Ji):(Ff=Qt.layout.get("text-radial-offset").evaluate(Gt,{},ft)*Ji,Lf=Hg),it.allowVerticalPlacement&&jt.vertical){const Io=jt.vertical;if(Ne)Qd=$g(Io),At&&(Xd=$g(At));else{const Jr=Qt.layout.get("text-rotate").evaluate(Gt,{},ft)+90;Gi=yf(zn,Jl,Mt,ot,Hn,$n,Io,ke,Jr,Dt),At&&(Es=yf(zn,Jl,Mt,ot,Hn,$n,At,Ei,Jr))}}if(Rt){const Io=Qt.layout.get("icon-rotate").evaluate(Gt,{},ft),Jr="none"!==Qt.layout.get("icon-text-fit"),Js=tv(Rt,Io,Wn,Jr),Kd=At?tv(At,Io,Wn,Jr):void 0;Hr=yf(zn,Jl,Mt,ot,Hn,$n,Rt,Ei,Io),Sv=4*Js.length;const kv=it.iconSizeData;let al=null;"source"===kv.kind?(al=[Wo*Qt.layout.get("icon-size").evaluate(Gt,{},ft)],al[0]>$s&&ci(`${it.layerIds[0]}: Value for "icon-size" is >= ${xh}. Reduce your "icon-size".`)):"composite"===kv.kind&&(al=[Wo*li.compositeIconSizes[0].evaluate(Gt,{},ft),Wo*li.compositeIconSizes[1].evaluate(Gt,{},ft)],(al[0]>$s||al[1]>$s)&&ci(`${it.layerIds[0]}: Value for "icon-size" is >= ${xh}. Reduce your "icon-size".`)),it.addSymbols(it.icon,Js,al,ai,yi,Gt,!1,Ut,Mt,er.lineStartIndex,er.lineLength,-1,Mr,ft),Rf=it.icon.placedSymbolArray.length-1,Kd&&(ru=4*Kd.length,it.addSymbols(it.icon,Kd,al,ai,yi,Gt,Zo.vertical,Ut,Mt,er.lineStartIndex,er.lineLength,-1,Mr,ft),Of=it.icon.placedSymbolArray.length-1)}for(const Io in jt.horizontal){const Jr=jt.horizontal[Io];tr||(o_=Ju(Jr.text),Ne?Ft=$g(Jr):tr=yf(zn,Jl,Mt,ot,Hn,$n,Jr,ke,Qt.layout.get("text-rotate").evaluate(Gt,{},ft),Dt));const Js=1===Jr.positionedLines.length;if(Pf+=iv(it,Ut,Mt,Jr,Yn,Qt,Ne,Gt,Dt,er,jt.vertical?Zo.horizontal:Zo.horizontalOnly,Js?Object.keys(jt.horizontal):[Io],Xs,Rf,li,Mr,ft),Js)break}jt.vertical&&(r_+=iv(it,Ut,Mt,jt.vertical,Yn,Qt,Ne,Gt,Dt,er,Zo.vertical,["vertical"],Xs,Of,li,Mr,ft));let Ks=-1;const Ta=(Io,Jr)=>Io?Math.max(Io,Jr):Jr;Ks=Ta(Ft,Ks),Ks=Ta(Qd,Ks),Ks=Ta(Xd,Ks);const wx=Ks>-1?1:0;it.glyphOffsetArray.length>=sl.MAX_GLYPHS&&ci("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Gt.sortKey&&it.addToSortKeyRanges(it.symbolInstances.length,Gt.sortKey),it.symbolInstances.emplaceBack(Jl.x,Jl.y,Jl.z,Mt.x,Mt.y,Xs.right>=0?Xs.right:-1,Xs.center>=0?Xs.center:-1,Xs.left>=0?Xs.left:-1,Xs.vertical>=0?Xs.vertical:-1,Rf,Of,o_,void 0!==tr?tr:it.collisionBoxArray.length,void 0!==tr?tr+1:it.collisionBoxArray.length,void 0!==Gi?Gi:it.collisionBoxArray.length,void 0!==Gi?Gi+1:it.collisionBoxArray.length,void 0!==Hr?Hr:it.collisionBoxArray.length,void 0!==Hr?Hr+1:it.collisionBoxArray.length,Es||it.collisionBoxArray.length,Es?Es+1:it.collisionBoxArray.length,ot,Pf,r_,Sv,ru,wx,0,Ff,Lf,Ks)}(o,yt,Vt,ut,s,c,d,Ye,o.layers[0],o.collisionBoxArray,i.index,i.sourceLayerIndex,o.index,ce,Oe,E,0,xe,We,U,i,m,C,D,P)};if("line"===De)for(const ut of Bg(i.geometry,0,0,St,St)){const yt=pn(ut,ue,we,s.vertical||q,c,ae,oe,o.overscaling,St);for(const dt of yt)q&&px(o,q.text,ze,dt)||Re(ut,dt,P)}else if("line-center"===De){for(const ut of i.geometry)if(ut.length>1){const yt=ax(ut,we,s.vertical||q,c,ae,oe);yt&&Re(ut,yt,P)}}else if("Polygon"===i.type)for(const ut of ug(i.geometry,0)){const yt=cx(ut,16);Re(ut[0],new ol(yt.x,yt.y,0,0,void 0),P)}else if("LineString"===i.type)for(const ut of i.geometry)Re(ut,new ol(ut[0].x,ut[0].y,0,0,void 0),P);else if("Point"===i.type)for(const ut of i.geometry)for(const yt of ut)Re([yt],new ol(yt.x,yt.y,0,0,void 0),P)}const xh=255,$s=xh*Wo;function iv(o,i,s,c,d,m,y,x,E,C,D,P,R,B,N,U,q){const Y=function(oe,ue,ce,xe,we,Oe,We,De){const ze=[];if(0===ue.positionedLines.length)return ze;const Ve=xe.layout.get("text-rotate").evaluate(Oe,{})*Math.PI/180,Ge=function(dt){const Vt=dt[0],it=dt[1],Mt=Vt*it;return Mt>0?[Vt,-it]:Mt<0?[-Vt,it]:0===Vt?[it,Vt]:[it,-Vt]}(ce);let Ye=Math.abs(ue.top-ue.bottom);for(const dt of ue.positionedLines)Ye-=dt.lineOffset;const Re=ue.positionedLines.length,ut=Ye/Re;let yt=ue.top-ce[1];for(let dt=0;dt<Re;++dt){const Vt=ue.positionedLines[dt];yt=lx(ue,ut,yt,dt);for(const it of Vt.positionedGlyphs){if(!it.rect)continue;const Mt=it.rect||{};let Ut=gf+1,En=!0,jt=1,Rt=0;if(it.imageName){const Wn=We[it.imageName];if(!Wn)continue;if(Wn.sdf){ci("SDF images are not supported in formatted text and will be ignored.");continue}En=!1,jt=Wn.pixelRatio,Ut=Yi/jt}const Yn=(we||De)&&it.vertical,At=it.metrics.advance*it.scale/2,Qt=it.metrics,zn=it.rect;if(null===zn)continue;De&&ue.verticalizable&&(Rt=it.imageName?At-it.metrics.width*it.scale/2:0);const ot=we?[it.x+At,it.y]:[0,0];let Hn=[0,0],$n=[0,0],ke=!1;we||(Yn?($n=[it.x+At+Ge[0],it.y+Ge[1]-Rt],ke=!0):Hn=[it.x+At+ce[0],it.y+ce[1]-Rt]);const Ne=zn.w*it.scale/(jt*(it.localGlyph?xs:1)),Dt=zn.h*it.scale/(jt*(it.localGlyph?xs:1));let qn,Ei,yi,ai;if(Yn){const Wn=it.y-yt,Mr=new lt(-At,At-Wn),ft=-Math.PI/2,er=new lt(...$n);qn=new lt(-At+Hn[0],Hn[1]),qn._rotateAround(ft,Mr)._add(er),qn.x+=-Wn+At,qn.y-=(Qt.left-Ut)*it.scale;const tr=it.imageName?Qt.advance*it.scale:Ji*it.scale,Hr=String.fromCharCode(it.glyph);K0(Hr)?qn.x+=(1-Ut)*it.scale:Tg(Hr)?qn.x+=tr-Qt.height*it.scale+(-Ut-1)*it.scale:qn.x+=it.imageName||Qt.width+2*Ut===zn.w&&Qt.height+2*Ut===zn.h?(tr-Dt)/2:(tr-(Qt.height+2*Ut)*it.scale)/2,Ei=new lt(qn.x,qn.y-Ne),yi=new lt(qn.x+Dt,qn.y),ai=new lt(qn.x+Dt,qn.y-Ne)}else{const Wn=(Qt.left-Ut)*it.scale-At+Hn[0],Mr=(-Qt.top-Ut)*it.scale+Hn[1],ft=Wn+Ne,er=Mr+Dt;qn=new lt(Wn,Mr),Ei=new lt(ft,Mr),yi=new lt(Wn,er),ai=new lt(ft,er)}if(Ve){let Wn;Wn=we?new lt(0,0):ke?new lt(Ge[0],Ge[1]):new lt(ce[0],ce[1]),qn._rotateAround(Ve,Wn),Ei._rotateAround(Ve,Wn),yi._rotateAround(Ve,Wn),ai._rotateAround(Ve,Wn)}const Gt=new lt(0,0),li=new lt(0,0);ze.push({tl:qn,tr:Ei,bl:yi,br:ai,tex:Mt,writingMode:ue.writingMode,glyphOffset:ot,sectionIndex:it.sectionIndex,isSDF:En,pixelOffsetTL:Gt,pixelOffsetBR:li,minFontScaleX:0,minFontScaleY:0})}}return ze}(0,c,E,m,y,x,d,o.allowVerticalPlacement),ae=o.textSizeData;let J=null;"source"===ae.kind?(J=[Wo*m.layout.get("text-size").evaluate(x,{},q)],J[0]>$s&&ci(`${o.layerIds[0]}: Value for "text-size" is >= ${xh}. Reduce your "text-size".`)):"composite"===ae.kind&&(J=[Wo*N.compositeTextSizes[0].evaluate(x,{},q),Wo*N.compositeTextSizes[1].evaluate(x,{},q)],(J[0]>$s||J[1]>$s)&&ci(`${o.layerIds[0]}: Value for "text-size" is >= ${xh}. Reduce your "text-size".`)),o.addSymbols(o.text,Y,J,E,y,x,D,i,s,C.lineStartIndex,C.lineLength,B,U,q);for(const oe of P)R[oe]=o.text.placedSymbolArray.length-1;return 4*Y.length}function Gg(o){for(const i in o)return o[i];return null}function yf(o,i,s,c,d,m,y,x,E,C){let D=y.top,P=y.bottom,R=y.left,B=y.right;const N=y.collisionPadding;if(N&&(R-=N[0],D-=N[1],B+=N[2],P+=N[3]),E){const U=new lt(R,D),q=new lt(B,D),Y=new lt(R,P),ae=new lt(B,P),J=sn(E);let oe=new lt(0,0);C&&(oe=new lt(C[0],C[1])),U._rotateAround(J,oe),q._rotateAround(J,oe),Y._rotateAround(J,oe),ae._rotateAround(J,oe),R=Math.min(U.x,q.x,Y.x,ae.x),B=Math.max(U.x,q.x,Y.x,ae.x),D=Math.min(U.y,q.y,Y.y,ae.y),P=Math.max(U.y,q.y,Y.y,ae.y)}return o.emplaceBack(i.x,i.y,i.z,s.x,s.y,R,D,B,P,x,c,d,m),o.length-1}function $g(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const i=o.bottom-o.top;return i>0?Math.max(10,i):null}function px(o,i,s,c){const d=o.compareText;if(i in d){const m=d[i];for(let y=m.length-1;y>=0;y--)if(c.dist(m[y])<s)return!0}else d[i]=[];return d[i].push(c),!1}function rv(o,i){const s=o.fovAboveCenter,c=o.elevation?o.elevation.getMinElevationBelowMSL()*i:0,d=(o._camera.position[2]*o.worldSize-c)/Math.cos(o._pitch),m=Math.sin(s)*d/Math.sin(Math.max(Math.PI/2-o._pitch-s,.01)),y=Math.sin(o._pitch)*m+d;return Math.min(1.01*y,d*(1/o._horizonShift))}function Jc(o,i){if(!i.isReprojectedInTileSpace)return{scale:1<<o.z,x:o.x,y:o.y,x2:o.x+1,y2:o.y+1,projection:i};const s=Math.pow(2,-o.z),c=o.x*s,d=(o.x+1)*s,m=o.y*s,y=(o.y+1)*s,x=qo(c),E=qo(d),C=ur(m),D=ur(y),P=i.project(x,C),R=i.project(E,C),B=i.project(E,D),N=i.project(x,D);let U=Math.min(P.x,R.x,B.x,N.x),q=Math.min(P.y,R.y,B.y,N.y),Y=Math.max(P.x,R.x,B.x,N.x),ae=Math.max(P.y,R.y,B.y,N.y);const J=s/16;function oe(ce,xe,we,Oe,We,De){const ze=(we+We)/2,Ve=(Oe+De)/2,Ge=i.project(qo(ze),ur(Ve)),Ye=Math.max(0,U-Ge.x,q-Ge.y,Ge.x-Y,Ge.y-ae);U=Math.min(U,Ge.x),Y=Math.max(Y,Ge.x),q=Math.min(q,Ge.y),ae=Math.max(ae,Ge.y),Ye>J&&(oe(ce,Ge,we,Oe,ze,Ve),oe(Ge,xe,ze,Ve,We,De))}oe(P,R,c,m,d,m),oe(R,B,d,m,d,y),oe(B,N,d,y,c,y),oe(N,P,c,y,c,m),U-=J,q-=J,Y+=J,ae+=J;const ue=1/Math.max(Y-U,ae-q);return{scale:ue,x:U*ue,y:q*ue,x2:Y*ue,y2:ae*ue,projection:i}}const ov=zr(new Float32Array(16));class Ql{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,s){return{x:0,y:0,z:0}}unproject(i,s){return new Rn(0,0)}projectTilePoint(i,s,c){return{x:i,y:s,z:0}}locationPoint(i,s,c=!0){return i._coordinatePoint(i.locationCoordinate(s),c)}pixelsPerMeter(i,s){return ys(1,i)*s}pixelSpaceConversion(i,s,c){return 1}farthestPixelDistance(i){return rv(i,i.pixelsPerMeter)}pointCoordinate(i,s,c,d){const m=i.horizonLineFromTop(!1),y=new lt(s,Math.max(m,c));return i.rayIntersectionCoordinate(i.pointRayIntersection(y,d))}pointCoordinate3D(i,s,c){const d=new lt(s,c);if(i.elevation)return i.elevation.pointCoordinate(d);{const m=this.pointCoordinate(i,d.x,d.y,0);return[m.x,m.y,m.z]}}isPointAboveHorizon(i,s){if(i.elevation)return!this.pointCoordinate3D(i,s.x,s.y);const c=i.horizonLineFromTop();return s.y<c}createInversionMatrix(i,s){return ov}createTileMatrix(i,s,c){let d,m,y;const x=c.canonical,E=zr(new Float64Array(16));if(this.isReprojectedInTileSpace){const C=Jc(x,this);d=1,m=C.x+c.wrap*C.scale,y=C.y,Bc(E,E,[d/C.scale,d/C.scale,i.pixelsPerMeter/s])}else d=s/i.zoomScale(x.z),m=(x.x+Math.pow(2,x.z)*c.wrap)*d,y=x.y*d;return Xa(E,E,[m,y,0]),Bc(E,E,[d/St,d/St,1]),E}upVector(i,s,c){return[0,0,1]}upVectorScale(i,s,c){return{metersToTile:1}}}class sv extends Ql{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[s,c]=this.parallels=i.parallels||[29.5,45.5],d=Math.sin(sn(s));this.n=(d+Math.sin(sn(c)))/2,this.c=1+d*(2*this.n-d),this.r0=Math.sqrt(this.c)/this.n}project(i,s){const{n:c,c:d,r0:m}=this,y=sn(i-this.center[0]),x=sn(s),E=Math.sqrt(d-2*c*Math.sin(x))/c;return{x:E*Math.sin(y*c),y:E*Math.cos(y*c)-m,z:0}}unproject(i,s){const{n:c,c:d,r0:m}=this,y=m+s;let x=Math.atan2(i,Math.abs(y))*Math.sign(y);y*c<0&&(x-=Math.PI*Math.sign(i)*Math.sign(y));const E=sn(this.center[0])*c;x=fn(x,-Math.PI-E,Math.PI-E);const C=un(qi(x/c)+this.center[0],-180,180),D=Math.asin(un((d-(i*i+y*y)*c*c)/(2*c),-1,1)),P=un(qi(D),-hr,hr);return new Rn(C,P)}}const bh=1.340264,Yc=-.081106,vf=893e-6,eu=.003796,Af=Math.sqrt(3)/2;class _1 extends Ql{project(i,s){s=s/180*Math.PI,i=i/180*Math.PI;const c=Math.asin(Af*Math.sin(s)),d=c*c,m=d*d*d;return{x:.5*(i*Math.cos(c)/(Af*(bh+3*Yc*d+m*(7*vf+9*eu*d)))/Math.PI+.5),y:1-.5*(c*(bh+Yc*d+m*(vf+eu*d))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,d=c*c,m=d*d*d;for(let D,P,R,B=0;B<12&&(P=c*(bh+Yc*d+m*(vf+eu*d))-s,R=bh+3*Yc*d+m*(7*vf+9*eu*d),D=P/R,c=un(c-D,-Math.PI/3,Math.PI/3),d=c*c,m=d*d*d,!(Math.abs(D)<1e-12));++B);const y=Af*i*(bh+3*Yc*d+m*(7*vf+9*eu*d))/Math.cos(c),x=Math.asin(Math.sin(c)/Af),E=un(180*y/Math.PI,-180,180),C=un(180*x/Math.PI,-hr,hr);return new Rn(E,C)}}class qe extends Ql{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){return{x:.5+i/360,y:.5-s/360,z:0}}unproject(i,s){const c=360*(i-.5),d=un(360*(.5-s),-hr,hr);return new Rn(c,d)}}const tu=Math.PI/2;function xf(o){return Math.tan((tu+o)/2)}class av extends Ql{constructor(i){super(i),this.center=i.center||[0,30];const[s,c]=this.parallels=i.parallels||[30,30];let d=sn(s),m=sn(c);this.southernCenter=d+m<0,this.southernCenter&&(d=-d,m=-m);const y=Math.cos(d),x=xf(d);this.n=d===m?Math.sin(d):Math.log(y/Math.cos(m))/Math.log(xf(m)/x),this.f=y*Math.pow(xf(d),this.n)/this.n}project(i,s){s=sn(s),this.southernCenter&&(s=-s),i=sn(i-this.center[0]);const c=1e-6,{n:d,f:m}=this;m>0?s<-tu+c&&(s=-tu+c):s>tu-c&&(s=tu-c);const y=m/Math.pow(xf(s),d);let x=y*Math.sin(d*i),E=m-y*Math.cos(d*i);return x=.5*(x/Math.PI+.5),E=.5*(E/Math.PI+.5),{x,y:this.southernCenter?E:1-E,z:0}}unproject(i,s){i=(2*i-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f:d}=this,m=d-s,y=Math.sign(m),x=Math.sign(c)*Math.sqrt(i*i+m*m);let E=Math.atan2(i,Math.abs(m))*y;m*c<0&&(E-=Math.PI*Math.sign(i)*y);const C=un(qi(E/c)+this.center[0],-180,180),D=un(qi(2*Math.atan(Math.pow(d/x,1/c))-tu),-hr,hr);return new Rn(C,this.southernCenter?-D:D)}}class lv extends Ql{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,s){return{x:Us(i),y:xa(s),z:0}}unproject(i,s){const c=qo(i),d=ur(s);return new Rn(c,d)}}const cv=sn(hr);class bf extends Ql{project(i,s){const c=(s=sn(s))*s,d=c*c;return{x:.5*((i=sn(i))*(.8707-.131979*c+d*(d*(.003971*c-.001529*d)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+d*(.028874*c-.044475-.005916*d)))/Math.PI+1),z:0}}unproject(i,s){i=(2*i-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,d=25,m=0,y=c*c;do{y=c*c;const C=y*y;m=(c*(1.007226+y*(.015085+C*(.028874*y-.044475-.005916*C)))-s)/(1.007226+y*(.045255+C*(.259866*y-.311325-.005916*11*C))),c=un(c-m,-cv,cv)}while(Math.abs(m)>1e-6&&--d>0);y=c*c;const x=un(qi(i/(.8707+y*(y*(y*y*y*(.003971-.001529*y)-.013791)-.131979))),-180,180),E=qi(c);return new Rn(x,E)}}const nu=sn(hr);class qg extends Ql{project(i,s){s=sn(s),i=sn(i);const c=Math.cos(s),d=2/Math.PI,m=Math.acos(c*Math.cos(i/2)),y=Math.sin(m)/m,x=.5*(i*d+2*c*Math.sin(i/2)/y)||0,E=.5*(s+Math.sin(s)/y)||0;return{x:.5*(x/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(i,s){let c=i=(2*i-.5)*Math.PI,d=s=(2*(1-s)-1)*Math.PI,m=25;const y=1e-6;let x=0,E=0;do{const C=Math.cos(d),D=Math.sin(d),P=2*D*C,R=D*D,B=C*C,N=Math.cos(c/2),U=Math.sin(c/2),q=2*N*U,Y=U*U,ae=1-B*N*N,J=ae?1/ae:0,oe=ae?Math.acos(C*N)*Math.sqrt(1/ae):0,ue=.5*(2*oe*C*U+2*c/Math.PI)-i,ce=.5*(oe*D+d)-s,xe=.5*J*(B*Y+oe*C*N*R)+1/Math.PI,we=J*(q*P/4-oe*D*U),Oe=.125*J*(P*U-oe*D*B*q),We=.5*J*(R*N+oe*Y*C)+.5,De=we*Oe-We*xe;x=(ce*we-ue*We)/De,E=(ue*Oe-ce*xe)/De,c=un(c-x,-Math.PI,Math.PI),d=un(d-E,-nu,nu)}while((Math.abs(x)>y||Math.abs(E)>y)&&--m>0);return new Rn(qi(c),qi(d))}}class wh extends Ql{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(sn(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,s){const{scale:c,cosPhi:d}=this;return{x:sn(i)*d*c+.5,y:-Math.sin(sn(s))/d*c+.5,z:0}}unproject(i,s){const{scale:c,cosPhi:d}=this,m=-(s-.5)/c,y=un(qi((i-.5)/c)/d,-180,180),x=Math.asin(un(m*d,-1,1)),E=un(qi(x),-hr,hr);return new Rn(y,E)}}class Wg extends lv{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,s,c){const d=Ed(i,s,c);return ii(d,d,Uc(Ya(c))),{x:d[0],y:d[1],z:d[2]}}locationPoint(i,s){const c=oh(s.lat,s.lng),d=Tr([],c),m=i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(s),i._centerAltitude):i._centerAltitude;Ul(c,c,d,ys(1,0)*St*m);const y=zr(new Float64Array(16));return Aa(y,i.pixelMatrix,i.globeMatrix),ii(c,c,y),new lt(c[0],c[1])}pixelsPerMeter(i,s){return ys(1,0)*s}pixelSpaceConversion(i,s,c){const d=ys(1,i)*s,m=bn(ys(1,45)*s,d,c);return this.pixelsPerMeter(i,s)/m}createTileMatrix(i,s,c){const d=Om(Ya(c.canonical));return Aa(new Float64Array(16),i.globeMatrix,d)}createInversionMatrix(i,s){const{center:c}=i,d=Uc(Ya(s));return zp(d,d,sn(c.lng)),sy(d,d,sn(c.lat)),Bc(d,d,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(d)}pointCoordinate(i,s,c,d){return I0(i,s,c,!0)||new lh(0,0)}pointCoordinate3D(i,s,c){const d=this.pointCoordinate(i,s,c,0);return[d.x,d.y,d.z]}isPointAboveHorizon(i,s){return!I0(i,s.x,s.y,!1)}farthestPixelDistance(i){const s=function(d,m){const y=d.cameraToCenterDistance,x=d._centerAltitude*m,E=d._camera,C=d._camera.forward(),D=Ka([],so([],C,-y),[0,0,x]),P=d.worldSize/(2*Math.PI),R=[0,0,-P],B=d.width/d.height,N=Math.tan(d.fovAboveCenter),U=so([],E.up(),N),q=so([],E.right(),N*B),Y=Tr([],Ka([],Ka([],C,U),q)),ae=[];let J;if(new rh(D,Y).closestPointOnSphere(R,P,ae)){const oe=Ka([],ae,R),ue=ao([],oe,D);J=Math.cos(d.fovAboveCenter)*eh(ue)}else{const oe=ao([],D,R),ue=ao([],R,D);Tr(ue,ue);const ce=eh(oe)-P;J=Math.sqrt(ce*(ce+2*P));const xe=Math.acos(J/(P+ce))-Math.acos(lr(C,ue));J*=Math.cos(xe)}return 1.01*J}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),c=sh(i.zoom);if(c>0){const d=rv(i,ys(1,i.center.lat)*i.worldSize),m=i.worldSize/(2*Math.PI),y=Math.max(i.width,i.height)/i.worldSize*Math.PI;return bn(s,d+m*(1-Math.cos(y)),Math.pow(c,10))}return s}upVector(i,s,c){return Ed(s,c,i,1)}upVectorScale(i){return{metersToTile:km($p(Ya(i)))}}}function Ud(o){const i=o.parallels,s=!!i&&Math.abs(i[0]+i[1])<.01;switch(o.name){case"mercator":return new lv(o);case"equirectangular":return new qe(o);case"naturalEarth":return new bf(o);case"equalEarth":return new _1(o);case"winkelTripel":return new qg(o);case"albers":return s?new wh(o):new sv(o);case"lambertConformalConic":return s?new wh(o):new av(o);case"globe":return new Wg(o)}throw new Error(`Invalid projection name: ${o.name}`)}const uv=lf.types,Zg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Eh(o,i,s,c,d,m,y,x,E,C,D,P,R){const B=x?Math.min($s,Math.round(x[0])):0,N=x?Math.min($s,Math.round(x[1])):0;o.emplaceBack(i,s,Math.round(32*c),Math.round(32*d),m,y,(B<<1)+(E?1:0),N,16*C,16*D,256*P,256*R)}function Ch(o,i,s,c,d,m,y){o.emplaceBack(i,s,c,d,m,y)}function jd(o,i,s,c,d){o.emplaceBack(i,s,c,d),o.emplaceBack(i,s,c,d),o.emplaceBack(i,s,c,d),o.emplaceBack(i,s,c,d)}function Qg(o){for(const i of o.sections)if(Nr(i.text))return!0;return!1}class Xg{constructor(i){this.layoutVertexArray=new He,this.indexArray=new Et,this.programConfigurations=i,this.segments=new Li,this.dynamicLayoutVertexArray=new Qe,this.opacityVertexArray=new Ct,this.placedSymbolArray=new wi,this.globeExtVertexArray=new nt}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(i,s,c,d){this.isEmpty()||(c&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Z0.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,df.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Zg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Eg.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||d)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ae(Xg,"SymbolBuffers");class Kg{constructor(i,s,c){this.layoutVertexArray=new i,this.layoutAttributes=s,this.indexArray=new c,this.segments=new Li,this.collisionVertexArray=new dn,this.collisionVertexArrayExt=new cn}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,Q0.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,Cg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ae(Kg,"CollisionBuffers");class sl{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(y=>y.id),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=zr([]),this.placementViewportMatrix=zr([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ig(this.zoom,s["text-size"]),this.iconSizeData=Ig(this.zoom,s["icon-size"]);const c=this.layers[0].layout,d=c.get("symbol-sort-key"),m=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==m&&void 0!==d.constantOr(1),this.sortFeaturesByY=("viewport-y"===m||"auto"===m&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(y=>Zo[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=i.sourceID,this.projection=i.projection}createArrays(){this.text=new Xg(new Lc(this.layers,this.zoom,i=>/^text/.test(i))),this.icon=new Xg(new Lc(this.layers,this.zoom,i=>/^icon/.test(i))),this.glyphOffsetArray=new _i,this.lineVertexArray=new Qu,this.symbolInstances=new ni}calculateGlyphDependencies(i,s,c,d,m){for(let y=0;y<i.length;y++)if(s[i.charCodeAt(y)]=!0,d&&m){const x=Fd[i.charAt(y)];x&&(s[x.charCodeAt(0)]=!0)}}populate(i,s,c,d){const m=this.layers[0],y=m.layout,x="globe"===this.projection.name,E=y.get("text-font"),C=y.get("text-field"),D=y.get("icon-image"),P=("constant"!==C.value.kind||C.value.value instanceof no&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),R="constant"!==D.value.kind||!!D.value.value||Object.keys(D.parameters).length>0,B=y.get("symbol-sort-key");if(this.features=[],!P&&!R)return;const N=s.iconDependencies,U=s.glyphDependencies,q=s.availableImages,Y=new k(this.zoom);for(const{feature:ae,id:J,index:oe,sourceLayerIndex:ue}of i){const ce=m._featureFilter.needGeometry,xe=jl(ae,ce);if(!m._featureFilter.filter(Y,xe,c))continue;if(ce||(xe.geometry=js(ae,c,d)),x&&1!==ae.type&&c.z<=5){const De=xe.geometry,ze=.98078528056,Ve=(Ge,Ye)=>lr(Ed(Ge.x,Ge.y,c,1),Ed(Ye.x,Ye.y,c,1))<ze;for(let Ge=0;Ge<De.length;Ge++)De[Ge]=Id(De[Ge],Ve)}let we,Oe;if(P){const De=m.getValueAndResolveTokens("text-field",xe,c,q),ze=no.factory(De);Qg(ze)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===b()||this.hasRTLText&&M.isParsed())&&(we=X0(ze,m,xe))}if(R){const De=m.getValueAndResolveTokens("icon-image",xe,c,q);Oe=De instanceof fo?De:fo.fromString(De)}if(!we&&!Oe)continue;const We=this.sortFeaturesByKey?B.evaluate(xe,{},c):void 0;if(this.features.push({id:J,text:we,icon:Oe,index:oe,sourceLayerIndex:ue,geometry:xe.geometry,properties:ae.properties,type:uv[ae.type],sortKey:We}),Oe&&(N[Oe.name]=!0),we){const De=E.evaluate(xe,{},c).join(","),ze="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Zo.vertical)>=0;for(const Ve of we.sections)if(Ve.image)N[Ve.image.name]=!0;else{const Ge=Za(we.toString()),Ye=Ve.fontStack||De,Re=U[Ye]=U[Ye]||{};this.calculateGlyphDependencies(Ve.text,Re,ze,this.allowVerticalPlacement,Ge)}}}"line"===y.get("symbol-placement")&&(this.features=function(ae){const J={},oe={},ue=[];let ce=0;function xe(De){ue.push(ae[De]),ce++}function we(De,ze,Ve){const Ge=oe[De];return delete oe[De],oe[ze]=Ge,ue[Ge].geometry[0].pop(),ue[Ge].geometry[0]=ue[Ge].geometry[0].concat(Ve[0]),Ge}function Oe(De,ze,Ve){const Ge=J[ze];return delete J[ze],J[De]=Ge,ue[Ge].geometry[0].shift(),ue[Ge].geometry[0]=Ve[0].concat(ue[Ge].geometry[0]),Ge}function We(De,ze,Ve){const Ge=Ve?ze[0][ze[0].length-1]:ze[0][0];return`${De}:${Ge.x}:${Ge.y}`}for(let De=0;De<ae.length;De++){const ze=ae[De],Ve=ze.geometry,Ge=ze.text?ze.text.toString():null;if(!Ge){xe(De);continue}const Ye=We(Ge,Ve),Re=We(Ge,Ve,!0);if(Ye in oe&&Re in J&&oe[Ye]!==J[Re]){const ut=Oe(Ye,Re,Ve),yt=we(Ye,Re,ue[ut].geometry);delete J[Ye],delete oe[Re],oe[We(Ge,ue[yt].geometry,!0)]=yt,ue[ut].geometry=null}else Ye in oe?we(Ye,Re,Ve):Re in J?Oe(Ye,Re,Ve):(xe(De),J[Ye]=ce-1,oe[Re]=ce-1)}return ue.filter(De=>De.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((ae,J)=>ae.sortKey-J.sortKey)}update(i,s,c,d){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(i,s,this.layers,c,d),this.icon.programConfigurations.updatePaintArrays(i,s,this.layers,c,d))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Ud(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,s){const c=this.lineVertexArray.length;if(void 0!==i.segment)for(const{x:d,y:m}of s)this.lineVertexArray.emplaceBack(d,m);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(i,s,c,d,m,y,x,E,C,D,P,R,B,N){const U=i.indexArray,q=i.layoutVertexArray,Y=i.globeExtVertexArray,ae=i.segments.prepareSegment(4*s.length,q,U,this.canOverlap?y.sortKey:void 0),J=this.glyphOffsetArray.length,oe=ae.vertexLength,ue=this.allowVerticalPlacement&&x===Zo.vertical?Math.PI/2:0,ce=y.text&&y.text.sections;for(let we=0;we<s.length;we++){const{tl:Oe,tr:We,bl:De,br:ze,tex:Ve,pixelOffsetTL:Ge,pixelOffsetBR:Ye,minFontScaleX:Re,minFontScaleY:ut,glyphOffset:yt,isSDF:dt,sectionIndex:Vt}=s[we],it=ae.vertexLength,Mt=yt[1];if(Eh(q,C.x,C.y,Oe.x,Mt+Oe.y,Ve.x,Ve.y,c,dt,Ge.x,Ge.y,Re,ut),Eh(q,C.x,C.y,We.x,Mt+We.y,Ve.x+Ve.w,Ve.y,c,dt,Ye.x,Ge.y,Re,ut),Eh(q,C.x,C.y,De.x,Mt+De.y,Ve.x,Ve.y+Ve.h,c,dt,Ge.x,Ye.y,Re,ut),Eh(q,C.x,C.y,ze.x,Mt+ze.y,Ve.x+Ve.w,Ve.y+Ve.h,c,dt,Ye.x,Ye.y,Re,ut),E){const{x:Ut,y:En,z:jt}=E.anchor,[Rt,Yn,At]=E.up;Ch(Y,Ut,En,jt,Rt,Yn,At),Ch(Y,Ut,En,jt,Rt,Yn,At),Ch(Y,Ut,En,jt,Rt,Yn,At),Ch(Y,Ut,En,jt,Rt,Yn,At),jd(i.dynamicLayoutVertexArray,Ut,En,jt,ue)}else jd(i.dynamicLayoutVertexArray,C.x,C.y,C.z,ue);U.emplaceBack(it,it+1,it+2),U.emplaceBack(it+1,it+2,it+3),ae.vertexLength+=4,ae.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yt[0]),we!==s.length-1&&Vt===s[we+1].sectionIndex||i.programConfigurations.populatePaintArrays(q.length,y,y.index,{},B,N,ce&&ce[Vt])}const xe=E?E.anchor:C;i.placedSymbolArray.emplaceBack(xe.x,xe.y,xe.z,C.x,C.y,J,this.glyphOffsetArray.length-J,oe,D,P,C.segment,c?c[0]:0,c?c[1]:0,d[0],d[1],x,0,!1,0,R,0)}_commitLayoutVertex(i,s,c,d,m,y,x){i.emplaceBack(s,c,d,m,y,Math.round(x.x),Math.round(x.y))}_addCollisionDebugVertices(i,s,c,d,m,y,x){const E=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),C=E.vertexLength,D=x.tileAnchorX,P=x.tileAnchorY;for(let B=0;B<4;B++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-i.padding,-i.padding),c.collisionVertexArrayExt.emplaceBack(s,i.padding,-i.padding),c.collisionVertexArrayExt.emplaceBack(s,i.padding,i.padding),c.collisionVertexArrayExt.emplaceBack(s,-i.padding,i.padding),this._commitLayoutVertex(c.layoutVertexArray,d,m,y,D,P,new lt(i.x1,i.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,m,y,D,P,new lt(i.x2,i.y1)),this._commitLayoutVertex(c.layoutVertexArray,d,m,y,D,P,new lt(i.x2,i.y2)),this._commitLayoutVertex(c.layoutVertexArray,d,m,y,D,P,new lt(i.x1,i.y2)),E.vertexLength+=4;const R=c.indexArray;R.emplaceBack(C,C+1),R.emplaceBack(C+1,C+2),R.emplaceBack(C+2,C+3),R.emplaceBack(C+3,C),E.primitiveLength+=4}_addTextDebugCollisionBoxes(i,s,c,d,m,y){for(let x=d;x<m;x++){const E=c.get(x),C=this.getSymbolInstanceTextSize(i,y,s,x);this._addCollisionDebugVertices(E,C,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(i,s,c,d,m,y){for(let x=d;x<m;x++){const E=c.get(x),C=this.getSymbolInstanceIconSize(i,s,y.placedIconSymbolIndex);this._addCollisionDebugVertices(E,C,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,y)}}generateCollisionDebugBuffers(i,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Kg(vt,Od.members,Si),this.iconCollisionBox=new Kg(vt,Od.members,Si);const c=Zc(this.iconSizeData,i),d=Zc(this.textSizeData,i);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(d,i,s,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(d,i,s,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,i,s,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(c,i,s,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(i,s,c,d){const m=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:d),y=pf(this.textSizeData,i,m)/Ji;return this.tilePixelRatio*y}getSymbolInstanceIconSize(i,s,c){const d=this.icon.placedSymbolArray.get(c),m=pf(this.iconSizeData,i,d);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(i,s,c){i.emplaceBack(s,-c,-c),i.emplaceBack(s,c,-c),i.emplaceBack(s,c,c),i.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(i,s,c,d,m,y){for(let x=d;x<m;x++){const E=c.get(x),C=this.getSymbolInstanceTextSize(i,y,s,x);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,C,E.padding)}}_updateIconDebugCollisionBoxes(i,s,c,d,m,y){for(let x=d;x<m;x++){const E=c.get(x),C=this.getSymbolInstanceIconSize(i,s,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,E.padding)}}updateCollisionDebugBuffers(i,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Zc(this.iconSizeData,i),d=Zc(this.textSizeData,i);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(d,i,s,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(d,i,s,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(c,i,s,y.iconBoxStartIndex,y.iconBoxEndIndex,y.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,i,s,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,s,c,d,m,y,x,E,C){const D={};if(s<c){const{x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe,featureIndex:ue}=i.get(s);D.textBox={x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe},D.textFeatureIndex=ue}if(d<m){const{x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe,featureIndex:ue}=i.get(d);D.verticalTextBox={x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe},D.verticalTextFeatureIndex=ue}if(y<x){const{x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe,featureIndex:ue}=i.get(y);D.iconBox={x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe},D.iconFeatureIndex=ue}if(E<C){const{x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe,featureIndex:ue}=i.get(E);D.verticalIconBox={x1:P,y1:R,x2:B,y2:N,padding:U,projectedAnchorX:q,projectedAnchorY:Y,projectedAnchorZ:ae,tileAnchorX:J,tileAnchorY:oe},D.verticalIconFeatureIndex=ue}return D}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(i,s){const c=i.placedSymbolArray.get(s),d=c.vertexStartIndex+4*c.numGlyphs;for(let m=c.vertexStartIndex;m<d;m+=4)i.indexArray.emplaceBack(m,m+1,m+2),i.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const s=Math.sin(i),c=Math.cos(i),d=[],m=[],y=[];for(let x=0;x<this.symbolInstances.length;++x){y.push(x);const E=this.symbolInstances.get(x);d.push(0|Math.round(s*E.tileAnchorX+c*E.tileAnchorY)),m.push(E.featureIndex)}return y.sort((x,E)=>d[x]-d[E]||m[E]-m[x]),y}addToSortKeyRanges(i,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:d,centerJustifiedTextSymbolIndex:m,leftJustifiedTextSymbolIndex:y,verticalPlacedTextSymbolIndex:x,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:C}=c;d>=0&&this.addIndicesForPlacedSymbol(this.text,d),m>=0&&m!==d&&this.addIndicesForPlacedSymbol(this.text,m),y>=0&&y!==m&&y!==d&&this.addIndicesForPlacedSymbol(this.text,y),x>=0&&this.addIndicesForPlacedSymbol(this.text,x),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),C>=0&&this.addIndicesForPlacedSymbol(this.icon,C)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ae(sl,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),sl.MAX_GLYPHS=65535,sl.addDynamicAttributes=jd;const fx=new te({"symbol-placement":new V(Fe.layout_symbol["symbol-placement"]),"symbol-spacing":new V(Fe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new V(Fe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new W(Fe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new V(Fe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new V(Fe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new V(Fe.layout_symbol["icon-ignore-placement"]),"icon-optional":new V(Fe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new V(Fe.layout_symbol["icon-rotation-alignment"]),"icon-size":new W(Fe.layout_symbol["icon-size"]),"icon-text-fit":new V(Fe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new V(Fe.layout_symbol["icon-text-fit-padding"]),"icon-image":new W(Fe.layout_symbol["icon-image"]),"icon-rotate":new W(Fe.layout_symbol["icon-rotate"]),"icon-padding":new V(Fe.layout_symbol["icon-padding"]),"icon-keep-upright":new V(Fe.layout_symbol["icon-keep-upright"]),"icon-offset":new W(Fe.layout_symbol["icon-offset"]),"icon-anchor":new W(Fe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new V(Fe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new V(Fe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new V(Fe.layout_symbol["text-rotation-alignment"]),"text-field":new W(Fe.layout_symbol["text-field"]),"text-font":new W(Fe.layout_symbol["text-font"]),"text-size":new W(Fe.layout_symbol["text-size"]),"text-max-width":new W(Fe.layout_symbol["text-max-width"]),"text-line-height":new W(Fe.layout_symbol["text-line-height"]),"text-letter-spacing":new W(Fe.layout_symbol["text-letter-spacing"]),"text-justify":new W(Fe.layout_symbol["text-justify"]),"text-radial-offset":new W(Fe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new V(Fe.layout_symbol["text-variable-anchor"]),"text-anchor":new W(Fe.layout_symbol["text-anchor"]),"text-max-angle":new V(Fe.layout_symbol["text-max-angle"]),"text-writing-mode":new V(Fe.layout_symbol["text-writing-mode"]),"text-rotate":new W(Fe.layout_symbol["text-rotate"]),"text-padding":new V(Fe.layout_symbol["text-padding"]),"text-keep-upright":new V(Fe.layout_symbol["text-keep-upright"]),"text-transform":new W(Fe.layout_symbol["text-transform"]),"text-offset":new W(Fe.layout_symbol["text-offset"]),"text-allow-overlap":new V(Fe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new V(Fe.layout_symbol["text-ignore-placement"]),"text-optional":new V(Fe.layout_symbol["text-optional"])});var wf={paint:new te({"icon-opacity":new W(Fe.paint_symbol["icon-opacity"]),"icon-color":new W(Fe.paint_symbol["icon-color"]),"icon-halo-color":new W(Fe.paint_symbol["icon-halo-color"]),"icon-halo-width":new W(Fe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new W(Fe.paint_symbol["icon-halo-blur"]),"icon-translate":new V(Fe.paint_symbol["icon-translate"]),"icon-translate-anchor":new V(Fe.paint_symbol["icon-translate-anchor"]),"text-opacity":new W(Fe.paint_symbol["text-opacity"]),"text-color":new W(Fe.paint_symbol["text-color"],{runtimeType:vn,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new W(Fe.paint_symbol["text-halo-color"]),"text-halo-width":new W(Fe.paint_symbol["text-halo-width"]),"text-halo-blur":new W(Fe.paint_symbol["text-halo-blur"]),"text-translate":new V(Fe.paint_symbol["text-translate"]),"text-translate-anchor":new V(Fe.paint_symbol["text-translate-anchor"])}),layout:fx};class Jg{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:la,this.defaultValue=i}evaluate(i){if(i.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(i.formattedSection))return s.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ae(Jg,"FormatSectionOverride",{omit:["defaultValue"]});class Ef extends va{constructor(i){super(i,wf)}recalculate(i,s){super.recalculate(i,s),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const d=[];for(const m of c)d.indexOf(m)<0&&d.push(m);this.layout._values["text-writing-mode"]=d}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(i,s,c,d){const m=this.layout.get(i).evaluate(s,{},c,d),y=this._unevaluatedLayout._values[i];return y.isDataDriven()||Dc(y.value)||!m?m:(x=s.properties,m.replace(/{([^{}]+)}/g,(C,D)=>D in x?String(x[D]):""));var x}createBucket(i){return new sl(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of wf.paint.overridableProperties){if(!Ef.hasPaintOverride(this.layout,i))continue;const s=this.paint.get(i),c=new Jg(s),d=new Fu(c,s.property.specification);let m=null;m="constant"===s.value.kind||"source"===s.value.kind?new Ep("source",d):new Lu("composite",d,s.value.zoomStops,s.value._interpolationType),this.paint._values[i]=new X(s.property,m,s.parameters)}}_handleOverridablePaintPropertyUpdate(i,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Ef.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,s){const c=i.get("text-field"),d=wf.paint.properties[s];let m=!1;const y=x=>{for(const E of x)if(d.overrides&&d.overrides.hasOverride(E))return void(m=!0)};if("constant"===c.value.kind&&c.value.value instanceof no)y(c.value.value.sections);else if("source"===c.value.kind){const x=C=>{m||(C instanceof bl&&xi(C.value)===wu?y(C.value.sections):C instanceof fi?y(C.sections):C.eachChild(x))},E=c.value;E._styleExpression&&x(E._styleExpression.expression)}return m}getProgramConfiguration(i){return new Fc(this,i)}}var mx={paint:new te({"background-color":new V(Fe.paint_background["background-color"]),"background-pattern":new V(Fe.paint_background["background-pattern"]),"background-opacity":new V(Fe.paint_background["background-opacity"])})},Qo={paint:new te({"raster-opacity":new V(Fe.paint_raster["raster-opacity"]),"raster-hue-rotate":new V(Fe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new V(Fe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new V(Fe.paint_raster["raster-brightness-max"]),"raster-saturation":new V(Fe.paint_raster["raster-saturation"]),"raster-contrast":new V(Fe.paint_raster["raster-contrast"]),"raster-resampling":new V(Fe.paint_raster["raster-resampling"]),"raster-fade-duration":new V(Fe.paint_raster["raster-fade-duration"])})};class gx extends va{constructor(i){super(i,{}),this.implementation=i}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}var _x={paint:new te({"sky-type":new V(Fe.paint_sky["sky-type"]),"sky-atmosphere-sun":new V(Fe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new V(Fe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new V(Fe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new V(Fe.paint_sky["sky-gradient-radius"]),"sky-gradient":new ie(Fe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new V(Fe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new V(Fe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new V(Fe.paint_sky["sky-opacity"])})};function hv(o,i,s){const c=[0,0,1],d=dy([]);return Tm(d,d,s?-sn(o)+Math.PI:sn(o)),w0(d,d,-sn(i)),ly(c,c,d),Tr(c,c)}const Yg={circle:class extends va{constructor(o){super(o,Iy)}createBucket(o){return new Qp(o)}queryRadius(o){const i=o;return uh("circle-radius",this,i)+uh("circle-stroke-width",this,i)+Xp(this.paint.get("circle-translate"))}queryIntersectsFeature(o,i,s,c,d,m,y,x){const E=Zm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,o.pixelToTileUnitsFactor),C=this.paint.get("circle-radius").evaluate(i,s)+this.paint.get("circle-stroke-width").evaluate(i,s);return Qm(o,c,m,y,x,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,C)}getProgramIds(){return["circle"]}getProgramConfiguration(o){return new Fc(this,o)}},heatmap:class extends va{createBucket(o){return new Xm(o)}constructor(o){super(o,Jp),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Yp({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return uh("heatmap-radius",this,o)}queryIntersectsFeature(o,i,s,c,d,m,y,x){const E=this.paint.get("heatmap-radius").evaluate(i,s);return Qm(o,c,m,y,x,!0,!0,new lt(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(o){return new Fc(this,o)}},hillshade:class extends va{constructor(o){super(o,Ym)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends va{constructor(o){super(o,B0)}getProgramIds(){const o=this.paint.get("fill-pattern"),i=o&&o.constantOr(1),s=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(o){return new Fc(this,o)}recalculate(o,i){super.recalculate(o,i);const s=this.paint._values["fill-outline-color"];"constant"===s.value.kind&&void 0===s.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new nf(o)}queryRadius(){return Xp(this.paint.get("fill-translate"))}queryIntersectsFeature(o,i,s,c,d,m){return!o.queryGeometry.isAboveHorizon&&Ey(Wm(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,o.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends va{constructor(o){super(o,$0)}createBucket(o){return new qc(o)}queryRadius(){return Xp(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(o){return new Fc(this,o)}queryIntersectsFeature(o,i,s,c,d,m,y,x,E){const C=Zm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,o.pixelToTileUnitsFactor),D=this.paint.get("fill-extrusion-height").evaluate(i,s),P=this.paint.get("fill-extrusion-base").evaluate(i,s),R=[0,0],B=x&&m.elevation,N=m.elevation?m.elevation.exaggeration():1,U=o.tile.getBucket(this);if(B&&U instanceof qc){const oe=U.centroidVertexArray,ue=E+1;ue<oe.length&&(R[0]=oe.geta_centroid_pos0(ue),R[1]=oe.geta_centroid_pos1(ue))}if(0===R[0]&&1===R[1])return!1;"globe"===m.projection.name&&(c=Fy([c],[new lt(0,0),new lt(St,St)],o.tileID.canonical).map(oe=>oe.polygon).flat());const q=B?x:null,[Y,ae]=(ue=c,ce=P,xe=D,we=C,Oe=y,We=q,De=R,ze=N,Ve=m.center.lat,"globe"===(oe=m).projection.name?function(Ye,Re,ut,yt,dt,Vt,it,Mt,Ut,En,jt){const Rt=[],Yn=[],At=Ye.projection.upVectorScale(jt,Ye.center.lat,Ye.worldSize).metersToTile,Qt=[0,0,0,1],zn=[0,0,0,1],ot=($n,ke,Ne,Dt)=>{$n[0]=ke,$n[1]=Ne,$n[2]=Dt,$n[3]=1},Hn=Oy();ut>0&&(ut+=Hn),yt+=Hn;for(const $n of Re){const ke=[],Ne=[];for(const Dt of $n){const qn=Dt.x+dt.x,Ei=Dt.y+dt.y,yi=Ye.projection.projectTilePoint(qn,Ei,jt),ai=Ye.projection.upVector(jt,Dt.x,Dt.y);let Gt=ut,li=yt;if(it){const Wn=Ly(qn,Ei,ut,yt,it,Mt,Ut,En);Gt+=Wn.base,li+=Wn.top}0!==ut?ot(Qt,yi.x+ai[0]*At*Gt,yi.y+ai[1]*At*Gt,yi.z+ai[2]*At*Gt):ot(Qt,yi.x,yi.y,yi.z),ot(zn,yi.x+ai[0]*At*li,yi.y+ai[1]*At*li,yi.z+ai[2]*At*li),ii(Qt,Qt,Vt),ii(zn,zn,Vt),ke.push(new Wc(Qt[0],Qt[1],Qt[2])),Ne.push(new Wc(zn[0],zn[1],zn[2]))}Rt.push(ke),Yn.push(Ne)}return[Rt,Yn]}(oe,ue,ce,xe,we,Oe,We,De,ze,Ve,o.tileID.canonical):We?function(Ye,Re,ut,yt,dt,Vt,it,Mt,Ut){const En=[],jt=[],Rt=[0,0,0,1];for(const Yn of Ye){const At=[],Qt=[];for(const zn of Yn){const ot=zn.x+yt.x,Hn=zn.y+yt.y,$n=Ly(ot,Hn,Re,ut,Vt,it,Mt,Ut);Rt[0]=ot,Rt[1]=Hn,Rt[2]=$n.base,Rt[3]=1,_s(Rt,Rt,dt),Rt[3]=Math.max(Rt[3],1e-5);const ke=new Wc(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);Rt[0]=ot,Rt[1]=Hn,Rt[2]=$n.top,Rt[3]=1,_s(Rt,Rt,dt),Rt[3]=Math.max(Rt[3],1e-5);const Ne=new Wc(Rt[0]/Rt[3],Rt[1]/Rt[3],Rt[2]/Rt[3]);At.push(ke),Qt.push(Ne)}En.push(At),jt.push(Qt)}return[En,jt]}(ue,ce,xe,we,Oe,We,De,ze,Ve):function(Ye,Re,ut,yt,dt){const Vt=[],it=[],Mt=dt[8]*Re,Ut=dt[9]*Re,En=dt[10]*Re,jt=dt[11]*Re,Rt=dt[8]*ut,Yn=dt[9]*ut,At=dt[10]*ut,Qt=dt[11]*ut;for(const zn of Ye){const ot=[],Hn=[];for(const $n of zn){const ke=$n.x+yt.x,Ne=$n.y+yt.y,Dt=dt[0]*ke+dt[4]*Ne+dt[12],qn=dt[1]*ke+dt[5]*Ne+dt[13],Ei=dt[2]*ke+dt[6]*Ne+dt[14],yi=dt[3]*ke+dt[7]*Ne+dt[15],ai=Dt+Mt,Gt=qn+Ut,li=Ei+En,Wn=Math.max(yi+jt,1e-5),Mr=Dt+Rt,ft=qn+Yn,er=Ei+At,tr=Math.max(yi+Qt,1e-5);ot.push(new Wc(ai/Wn,Gt/Wn,li/Wn)),Hn.push(new Wc(Mr/tr,ft/tr,er/tr))}Vt.push(ot),it.push(Hn)}return[Vt,it]}(ue,ce,xe,we,Oe)),J=o.queryGeometry;var oe,ue,ce,xe,we,Oe,We,De,ze,Ve;return function(oe,ue,ce){let xe=1/0;Ey(ce,ue)&&(xe=yg(ce,ue[0]));for(let we=0;we<ue.length;we++){const Oe=ue[we],We=oe[we];for(let De=0;De<Oe.length-1;De++){const ze=Oe[De],Ve=[ze,Oe[De+1],We[De+1],We[De],ze];wy(ce,Ve)&&(xe=Math.min(xe,yg(ce,Ve)))}}return xe!==1/0&&xe}(Y,ae,J.isPointQuery()?J.screenBounds:J.screenGeometry)}},line:class extends va{constructor(o){super(o,bg),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof td,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(o,i){super.recalculate(o,i),this.paint._values["line-floorwidth"]=wg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new hf(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(o){return new Fc(this,o)}queryRadius(o){const i=o,s=ql(uh("line-width",this,i),uh("line-gap-width",this,i)),c=uh("line-offset",this,i);return s/2+Math.abs(c)+Xp(this.paint.get("line-translate"))}queryIntersectsFeature(o,i,s,c,d,m){if(o.queryGeometry.isAboveHorizon)return!1;const y=Wm(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,o.pixelToTileUnitsFactor),x=o.pixelToTileUnitsFactor/2*ql(this.paint.get("line-width").evaluate(i,s),this.paint.get("line-gap-width").evaluate(i,s)),E=this.paint.get("line-offset").evaluate(i,s);return E&&(c=function(C,D){const P=[],R=new lt(0,0);for(let B=0;B<C.length;B++){const N=C[B],U=[];for(let q=0;q<N.length;q++){const Y=N[q],ae=N[q+1],J=0===q?R:Y.sub(N[q-1])._unit()._perp(),oe=q===N.length-1?R:ae.sub(Y)._unit()._perp(),ue=J._add(oe)._unit();ue._mult(1/(ue.x*oe.x+ue.y*oe.y)),U.push(ue._mult(D)._add(Y))}P.push(U)}return P}(c,E*o.pixelToTileUnitsFactor)),function(C,D,P){for(let R=0;R<D.length;R++){const B=D[R];if(C.length>=3)for(let N=0;N<B.length;N++)if(tl(C,B[N]))return!0;if(T0(C,B,P))return!0}return!1}(y,c,x)}isTileClipped(){return!0}},symbol:Ef,background:class extends va{constructor(o){super(o,mx)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends va{constructor(o){super(o,Qo)}getProgramIds(){return["raster"]}},sky:class extends va{constructor(o){super(o,_x),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Yp({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(o,i){if("atmosphere"===this.paint.get("sky-type")){const c=this.paint.get("sky-atmosphere-sun"),d=!c,m=o.style.light,y=m.properties.get("position");return d&&"viewport"===m.properties.get("anchor")&&ci("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),d?hv(y.azimuthal,90-y.polar,i):hv(c[0],90-c[1],i)}const s=this.paint.get("sky-gradient-center");return hv(s[0],90-s[1],i)}is3D(){return!1}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}}};class Ih{constructor(i,s,c,d){this.context=i,this.format=c,this.texture=i.gl.createTexture(),this.update(s,d)}update(i,s,c){const{width:d,height:m}=i,{context:y}=this,{gl:x}=y,{HTMLImageElement:E,HTMLCanvasElement:C,HTMLVideoElement:D,ImageData:P,ImageBitmap:R}=je;if(x.bindTexture(x.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA&&(!s||!1!==s.premultiply)),c||this.size&&this.size[0]===d&&this.size[1]===m){const{x:B,y:N}=c||{x:0,y:0};i instanceof E||i instanceof C||i instanceof D||i instanceof P||R&&i instanceof R?x.texSubImage2D(x.TEXTURE_2D,0,B,N,x.RGBA,x.UNSIGNED_BYTE,i):x.texSubImage2D(x.TEXTURE_2D,0,B,N,d,m,x.RGBA,x.UNSIGNED_BYTE,i.data)}else this.size=[d,m],i instanceof E||i instanceof C||i instanceof D||i instanceof P||R&&i instanceof R?x.texImage2D(x.TEXTURE_2D,0,this.format,this.format,x.UNSIGNED_BYTE,i):x.texImage2D(x.TEXTURE_2D,0,this.format,d,m,0,this.format,x.UNSIGNED_BYTE,i.data);this.useMipmap=Boolean(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(i,s){const{context:c}=this,{gl:d}=c;d.bindTexture(d.TEXTURE_2D,this.texture),i!==this.filter&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,i),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,this.useMipmap?i===d.NEAREST?d.NEAREST_MIPMAP_NEAREST:d.LINEAR_MIPMAP_NEAREST:i),this.filter=i),s!==this.wrap&&(d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,s),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class yx{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class vx{constructor(){this.tasks={},this.taskQueue=[],ei(["process"],this),this.invoker=new yx(this.process),this.nextId=0}add(i,s){const c=this.nextId++,d=function({type:m,isSymbolTile:y,zoom:x}){return x=x||0,"message"===m?0:"maybePrepare"!==m||y?"parseTile"!==m||y?"parseTile"===m&&y?300-x:"maybePrepare"===m&&y?400-x:500:200-x:100-x}(s);if(0===d){ra();try{i()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:i,metadata:s,priority:d,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){ra();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const i=this.pick();if(null===i)return;const s=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let i=null,s=1/0;for(let d=0;d<this.taskQueue.length;d++){const m=this.tasks[this.taskQueue[d]];m.priority<s&&(s=m.priority,i=d)}if(null===i)return null;const c=this.taskQueue[i];return this.taskQueue.splice(i,1),c}remove(){this.invoker.remove()}}class dv{constructor(i){this._stringToNumber={},this._numberToString=[];for(let s=0;s<i.length;s++){const c=i[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const pv=["tile","layer","source","sourceLayer","state"];class fv{constructor(i,s,c,d,m){this.type="Feature",this._vectorTileFeature=i,this._z=s,this._x=c,this._y=d,this.properties=i.properties,this.id=m}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(i.id=this.id);for(const s of pv)void 0!==this[s]&&(i[s]=this[s]);return i}}const bs=32,ws=33,Xl=new Uint16Array(8184);for(let o=0;o<2046;o++){let i=o+2,s=0,c=0,d=0,m=0,y=0,x=0;for(1&i?d=m=y=bs:s=c=x=bs;(i>>=1)>1;){const C=s+d>>1,D=c+m>>1;1&i?(d=s,m=c,s=y,c=x):(s=d,c=m,d=y,m=x),y=C,x=D}const E=4*o;Xl[E+0]=s,Xl[E+1]=c,Xl[E+2]=d,Xl[E+3]=m}const Ca=new Uint16Array(2178),Kl=new Uint8Array(1089),Cf=new Uint16Array(1089);function mv(o){return 0===o?-.03125:32===o?.03125:0}var qs=ye([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const If={type:2,extent:St,loadGeometry:()=>[[new lt(0,0),new lt(St+1,0),new lt(St+1,St+1),new lt(0,St+1),new lt(0,0)]]};class e_{constructor(i,s,c,d,m){this.tileID=i,this.uid=rr(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",d&&d.transform&&(this.projection=d.transform.projection)}registerFadeDuration(i){const s=i+this.timeAdded;s<rs.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Jc(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(i,s,c){if(this.unloadVectorData(),this.state="loaded",i){i.featureIndex&&(this.latestFeatureIndex=i.featureIndex,i.rawTileData?(this.latestRawTileData=i.rawTileData,this.latestFeatureIndex.rawTileData=i.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=i.collisionBoxArray,this.buckets=function(d,m){const y={};if(!m)return y;for(const x of d){const E=x.layerIds.map(C=>m.getLayer(C)).filter(Boolean);if(0!==E.length){x.layers=E,x.stateDependentLayerIds&&(x.stateDependentLayers=x.stateDependentLayerIds.map(C=>E.filter(D=>D.id===C)[0]));for(const C of E)y[C.id]=x}}return y}(i.buckets,s.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const m=this.buckets[d];if(m instanceof sl){if(this.hasSymbolBuckets=!0,!c)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const m=this.buckets[d];if(m instanceof sl&&m.hasRTLText){this.hasRTLText=!0,M.isLoading()||M.isLoaded()||"deferred"!==b()||T();break}}this.queryPadding=0;for(const d in this.buckets){const m=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(d).queryRadius(m))}i.imageAtlas&&(this.imageAtlas=i.imageAtlas),i.glyphAtlasImage&&(this.glyphAtlasImage=i.glyphAtlasImage),i.lineAtlas&&(this.lineAtlas=i.lineAtlas)}else this.collisionBoxArray=new Ln}unloadVectorData(){if(this.hasData()){for(const i in this.buckets)this.buckets[i].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(i){return this.buckets[i.id]}upload(i){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(i)}const s=i.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Ih(i,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Ih(i,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Ih(i,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(i){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(i,this.imageAtlasTexture)}queryRenderedFeatures(i,s,c,d,m,y,x,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:d,pixelPosMatrix:x,transform:y,params:m,tileTransform:this.tileTransform},i,s,c):{}}querySourceFeatures(i,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),m=s?s.sourceLayer:"",y=d._geojsonTileLayer||d[m];if(!y)return;const x=pd(s&&s.filter),{z:E,x:C,y:D}=this.tileID.canonical,P={z:E,x:C,y:D};for(let R=0;R<y.length;R++){const B=y.feature(R);if(x.needGeometry){const q=jl(B,!0);if(!x.filter(new k(this.tileID.overscaledZ),q,this.tileID.canonical))continue}else if(!x.filter(new k(this.tileID.overscaledZ),B))continue;const N=c.getId(B,m),U=new fv(B,E,C,D,N);U.tile=P,i.push(U)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(i){const s=this.expirationTime;if(i.cacheControl){const c=po(i.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else i.expires&&(this.expirationTime=new Date(i.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(s)if(this.expirationTime<s)d=!0;else{const m=this.expirationTime-s;m?this.expirationTime=c+Math.max(m,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(i,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(i).length||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),d=s.style.listImages();for(const m in this.buckets){if(!s.style.hasLayer(m))continue;const y=this.buckets[m],x=y.layers[0].sourceLayer||"_geojsonTileLayer",E=c[x],C=i[x];if(!E||!C||0===Object.keys(C).length)continue;if(y.update(C,E,d,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof hf||y instanceof nf){const P=s.style._getSourceCache(y.layers[0].source);s._terrain&&s._terrain.enabled&&P&&y.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(P.id,this.tileID)}const D=s&&s.style&&s.style.getLayer(m);D&&(this.queryPadding=Math.max(this.queryPadding,D.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<rs.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(i){this.symbolFadeHoldUntil=rs.now()+i}setTexture(i,s){const c=s.context,d=c.gl;this.texture=this.texture||s.getTileTexture(i.width),this.texture?this.texture.update(i,{useMipmap:!0}):(this.texture=new Ih(c,i,d.RGBA,{useMipmap:!0}),this.texture.bind(d.LINEAR,d.CLAMP_TO_EDGE))}setDependencies(i,s){const c={};for(const d of s)c[d]=!0;this.dependencies[i]=c}hasDependency(i,s){for(const c of i){const d=this.dependencies[c];if(d)for(const m of s)if(d[m])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(i,s){if(!s||"mercator"===s.name||this._tileDebugBuffer)return;const c=js(If,this.tileID.canonical,this.tileTransform)[0],d=new Ze,m=new yo;for(let y=0;y<c.length;y++){const{x,y:E}=c[y];d.emplaceBack(x,E),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=i.createIndexBuffer(m),this._tileDebugBuffer=i.createVertexBuffer(d,bd.members),this._tileDebugSegments=Li.simpleSegment(0,0,d.length,m.length)}_makeTileBoundsBuffers(i,s){if(this._tileBoundsBuffer||!s||"mercator"===s.name)return;const c=js(If,this.tileID.canonical,this.tileTransform)[0];let d,m;if(this.isRaster){const y=function(x,E){const C=Jc(x,E),D=Math.pow(2,x.z);for(let q=0;q<ws;q++)for(let Y=0;Y<ws;Y++){const ae=qo((x.x+(Y+mv(Y))/bs)/D),J=ur((x.y+(q+mv(q))/bs)/D),oe=E.project(ae,J),ue=q*ws+Y;Ca[2*ue+0]=Math.round((oe.x*C.scale-C.x)*St),Ca[2*ue+1]=Math.round((oe.y*C.scale-C.y)*St)}Kl.fill(0),Cf.fill(0);for(let q=2045;q>=0;q--){const Y=4*q,ae=Xl[Y+0],J=Xl[Y+1],oe=Xl[Y+2],ue=Xl[Y+3],ce=ae+oe>>1,xe=J+ue>>1,we=ce+xe-J,Oe=xe+ae-ce,We=J*ws+ae,De=ue*ws+oe,ze=xe*ws+ce,Ve=Math.hypot((Ca[2*We+0]+Ca[2*De+0])/2-Ca[2*ze+0],(Ca[2*We+1]+Ca[2*De+1])/2-Ca[2*ze+1])>=16;Kl[ze]=Kl[ze]||(Ve?1:0),q<1022&&(Kl[ze]=Kl[ze]||Kl[(J+Oe>>1)*ws+(ae+we>>1)]||Kl[(ue+Oe>>1)*ws+(oe+we>>1)])}const P=new Be,R=new Et;let B=0;function N(q,Y){const ae=Y*ws+q;return 0===Cf[ae]&&(P.emplaceBack(Ca[2*ae+0],Ca[2*ae+1],q*St/bs,Y*St/bs),Cf[ae]=++B),Cf[ae]-1}function U(q,Y,ae,J,oe,ue){const ce=q+ae>>1,xe=Y+J>>1;if(Math.abs(q-oe)+Math.abs(Y-ue)>1&&Kl[xe*ws+ce])U(oe,ue,q,Y,ce,xe),U(ae,J,oe,ue,ce,xe);else{const we=N(q,Y),Oe=N(ae,J),We=N(oe,ue);R.emplaceBack(we,Oe,We)}}return U(0,0,bs,bs,bs,0),U(bs,bs,0,0,0,bs),{vertices:P,indices:R}}(this.tileID.canonical,s);d=y.vertices,m=y.indices}else{d=new Be,m=new Et;for(const{x,y:E}of c)d.emplaceBack(x,E,0,0);const y=cg(d.int16,void 0,4);for(let x=0;x<y.length;x+=3)m.emplaceBack(y[x],y[x+1],y[x+2])}this._tileBoundsBuffer=i.createVertexBuffer(d,qs.members),this._tileBoundsIndexBuffer=i.createIndexBuffer(m),this._tileBoundsSegments=Li.simpleSegment(0,0,d.length,m.length)}_makeGlobeTileDebugBuffers(i,s){const c=s.projection;if(!c||"globe"!==c.name||s.freezeTileCoverage)return;const d=this.tileID.canonical,m=Uc(Pm(d,s)),y=sh(s.zoom);let x;y>0&&(x=Np(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(i,d,s,m,x,y),this._makeGlobeTileDebugTextBuffer(i,d,s,m,x,y)}_globePoint(i,s,c,d,m,y,x){let E=Ed(i,s,c);if(y){const C=1<<c.z,D=Us(d.center.lng),P=xa(d.center.lat),R=(c.x+.5)/C-D;let B=0;R>.5?B=-1:R<-.5&&(B=1);let N=(i/St+c.x)/C+B,U=(s/St+c.y)/C;N=(N-D)*d._pixelsPerMercatorPixel+D,U=(U-P)*d._pixelsPerMercatorPixel+P;const q=[N*d.worldSize,U*d.worldSize,0];ii(q,q,y),E=Vc(E,q,x)}return ii(E,E,m)}_makeGlobeTileDebugBorderBuffer(i,s,c,d,m,y){const x=new Ze,E=new yo,C=new Ce,D=(R,B,N,U,q)=>{const Y=(N-R)/(q-1),ae=(U-B)/(q-1),J=x.length;for(let oe=0;oe<q;oe++){const ue=R+oe*Y,ce=B+oe*ae;x.emplaceBack(ue,ce);const xe=this._globePoint(ue,ce,s,c,d,m,y);C.emplaceBack(xe[0],xe[1],xe[2]),E.emplaceBack(J+oe)}},P=St;D(0,0,P,0,16),D(P,0,P,P,16),D(P,P,0,P,16),D(0,P,0,0,16),this._tileDebugIndexBuffer=i.createIndexBuffer(E),this._tileDebugBuffer=i.createVertexBuffer(x,bd.members),this._globeTileDebugBorderBuffer=i.createVertexBuffer(C,fy.members),this._tileDebugSegments=Li.simpleSegment(0,0,x.length,E.length)}_makeGlobeTileDebugTextBuffer(i,s,c,d,m,y){const x=St/4,E=new Ze,C=new Et,D=new Ce,P=25;C.reserve(32),E.reserve(P),D.reserve(P);const R=(B,N)=>P*B+N;for(let B=0;B<P;B++){const N=B*x;for(let U=0;U<P;U++){const q=U*x;E.emplaceBack(q,N);const Y=this._globePoint(q,N,s,c,d,m,y);D.emplaceBack(Y[0],Y[1],Y[2])}}for(let B=0;B<4;B++)for(let N=0;N<4;N++){const U=R(B,N),q=R(B,N+1),Y=R(B+1,N),ae=R(B+1,N+1);C.emplaceBack(U,q,Y),C.emplaceBack(Y,q,ae)}this._tileDebugTextIndexBuffer=i.createIndexBuffer(C),this._tileDebugTextBuffer=i.createVertexBuffer(E,bd.members),this._globeTileDebugTextBuffer=i.createVertexBuffer(D,fy.members),this._tileDebugTextSegments=Li.simpleSegment(0,0,P,32)}}class Ax{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(i,s,c){const d=String(s);if(this.stateChanges[i]=this.stateChanges[i]||{},this.stateChanges[i][d]=this.stateChanges[i][d]||{},Ii(this.stateChanges[i][d],c),null===this.deletedStates[i]){this.deletedStates[i]={};for(const m in this.state[i])m!==d&&(this.deletedStates[i][m]=null)}else if(this.deletedStates[i]&&null===this.deletedStates[i][d]){this.deletedStates[i][d]={};for(const m in this.state[i][d])c[m]||(this.deletedStates[i][d][m]=null)}else for(const m in c)this.deletedStates[i]&&this.deletedStates[i][d]&&null===this.deletedStates[i][d][m]&&delete this.deletedStates[i][d][m]}removeFeatureState(i,s,c){if(null===this.deletedStates[i])return;const d=String(s);if(this.deletedStates[i]=this.deletedStates[i]||{},c&&void 0!==s)null!==this.deletedStates[i][d]&&(this.deletedStates[i][d]=this.deletedStates[i][d]||{},this.deletedStates[i][d][c]=null);else if(void 0!==s)if(this.stateChanges[i]&&this.stateChanges[i][d])for(c in this.deletedStates[i][d]={},this.stateChanges[i][d])this.deletedStates[i][d][c]=null;else this.deletedStates[i][d]=null;else this.deletedStates[i]=null}getState(i,s){const c=String(s),d=Ii({},(this.state[i]||{})[c],(this.stateChanges[i]||{})[c]);if(null===this.deletedStates[i])return{};if(this.deletedStates[i]){const m=this.deletedStates[i][s];if(null===m)return{};for(const y in m)delete d[y]}return d}initializeTileState(i,s){i.setFeatureState(this.state,s)}coalesceChanges(i,s){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const m={};for(const y in this.stateChanges[d])this.state[d][y]||(this.state[d][y]={}),Ii(this.state[d][y],this.stateChanges[d][y]),m[y]=this.state[d][y];c[d]=m}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const m={};if(null===this.deletedStates[d])for(const y in this.state[d])m[y]={},this.state[d][y]={};else for(const y in this.deletedStates[d]){if(null===this.deletedStates[d][y])this.state[d][y]={};else if(this.state[d][y])for(const x of Object.keys(this.deletedStates[d][y]))delete this.state[d][y][x];m[y]=this.state[d][y]}c[d]=c[d]||{},Ii(c[d],m)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(const d in i)i[d].setFeatureState(c,s)}}class t_{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,s){const c=this.toIdx(i,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(i,s){return this.leaves[this.toIdx(i,s)]}toIdx(i,s){return s*this.size+i}}function gv(o,i,s,c){let d=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(c[y])<1e-15){if(s[y]<o[y]||s[y]>i[y])return null}else{const x=1/c[y];let E=(o[y]-s[y])*x,C=(i[y]-s[y])*x;if(E>C){const D=E;E=C,C=D}if(E>d&&(d=E),C<m&&(m=C),d>m)return null}return d}function _v(o,i,s,c,d,m,y,x,E,C,D){const P=c-o,R=d-i,B=m-s,N=y-o,U=x-i,q=E-s,Y=D[1]*q-D[2]*U,ae=D[2]*N-D[0]*q,J=D[0]*U-D[1]*N,oe=P*Y+R*ae+B*J;if(Math.abs(oe)<1e-15)return null;const ue=1/oe,ce=C[0]-o,xe=C[1]-i,we=C[2]-s,Oe=(ce*Y+xe*ae+we*J)*ue;if(Oe<0||Oe>1)return null;const We=xe*B-we*R,De=we*P-ce*B,ze=ce*R-xe*P,Ve=(D[0]*We+D[1]*De+D[2]*ze)*ue;return Ve<0||Oe+Ve>1?null:(N*We+U*De+q*ze)*ue}function yv(o,i,s){return(o-i)/(s-i)}function Tf(o,i,s,c,d,m,y,x,E){const C=1<<s,D=m-c,P=y-d,R=(o+1)/C*D+c,B=(i+0)/C*P+d,N=(i+1)/C*P+d;x[0]=(o+0)/C*D+c,x[1]=B,E[0]=R,E[1]=N}class vv{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(m){const y=Math.ceil(Math.log2(m.dim/8)),x=[];let E=Math.ceil(Math.pow(2,y));const C=1/E,D=(B,N,U,q,Y)=>{const ae=q?1:0,J=(B+1)*U-ae,oe=N*U,ue=(N+1)*U-ae;Y[0]=B*U,Y[1]=oe,Y[2]=J,Y[3]=ue};let P=new t_(E);const R=[];for(let B=0;B<E*E;B++){D(B%E,Math.floor(B/E),C,!1,R);const N=Ws(R[0],R[1],m),U=Ws(R[2],R[1],m),q=Ws(R[2],R[3],m),Y=Ws(R[0],R[3],m);P.minimums.push(Math.min(N,U,q,Y)),P.maximums.push(Math.max(N,U,q,Y)),P.leaves.push(1)}for(x.push(P),E/=2;E>=1;E/=2){const B=x[x.length-1];P=new t_(E);for(let N=0;N<E*E;N++){D(N%E,Math.floor(N/E),2,!0,R);const U=B.getElevation(R[0],R[1]),q=B.getElevation(R[2],R[1]),Y=B.getElevation(R[2],R[3]),ae=B.getElevation(R[0],R[3]),J=B.isLeaf(R[0],R[1]),oe=B.isLeaf(R[2],R[1]),ue=B.isLeaf(R[2],R[3]),ce=B.isLeaf(R[0],R[3]),xe=Math.min(U.min,q.min,Y.min,ae.min),we=Math.max(U.max,q.max,Y.max,ae.max),Oe=J&&oe&&ue&&ce;P.maximums.push(we),P.minimums.push(xe),P.leaves.push(we-xe<=5&&Oe?1:0)}x.push(P)}return x}(this.dem),c=s.length-1,d=s[c];this._addNode(d.minimums[0],d.maximums[0],d.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(i,s,c,d,m,y,x=1){return gv([i,s,-100],[c,d,this.maximums[0]*x],m,y)}raycast(i,s,c,d,m,y,x=1){if(!this.nodeCount)return null;const E=this.raycastRoot(i,s,c,d,m,y,x);if(null==E)return null;const C=[],D=[],P=[],R=[],B=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;B.length>0;){const{idx:N,t:U,nodex:q,nodey:Y,depth:ae}=B.pop();if(this.leaves[N]){Tf(q,Y,ae,i,s,c,d,P,R);const oe=1<<ae,ue=(q+0)/oe,ce=(q+1)/oe,xe=(Y+0)/oe,we=(Y+1)/oe,Oe=Ws(ue,xe,this.dem)*x,We=Ws(ce,xe,this.dem)*x,De=Ws(ce,we,this.dem)*x,ze=Ws(ue,we,this.dem)*x,Ve=_v(P[0],P[1],Oe,R[0],P[1],We,R[0],R[1],De,m,y),Ge=_v(R[0],R[1],De,P[0],R[1],ze,P[0],P[1],Oe,m,y),Ye=Math.min(null!==Ve?Ve:Number.MAX_VALUE,null!==Ge?Ge:Number.MAX_VALUE);if(Ye!==Number.MAX_VALUE)return Ye;{const Re=Ul([],m,y,U);if(Av(Oe,We,ze,De,yv(Re[0],P[0],R[0]),yv(Re[1],P[1],R[1]))>=Re[2])return U}continue}let J=0;for(let oe=0;oe<this._siblingOffset.length;oe++){Tf((q<<1)+this._siblingOffset[oe][0],(Y<<1)+this._siblingOffset[oe][1],ae+1,i,s,c,d,P,R),P[2]=-100,R[2]=this.maximums[this.childOffsets[N]+oe]*x;const ue=gv(P,R,m,y);if(null!=ue){const ce=ue;C[oe]=ce;let xe=!1;for(let we=0;we<J&&!xe;we++)ce>=C[D[we]]&&(D.splice(we,0,oe),xe=!0);xe||(D[J]=oe),J++}}for(let oe=0;oe<J;oe++){const ue=D[oe];B.push({idx:this.childOffsets[N]+ue,t:C[ue],nodex:(q<<1)+this._siblingOffset[ue][0],nodey:(Y<<1)+this._siblingOffset[ue][1],depth:ae+1})}}return null}_addNode(i,s,c){return this.minimums.push(i),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(i,s,c,d,m){if(1===i[d].isLeaf(s,c))return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=d-1,x=i[y];let E=0,C=0;for(let D=0;D<this._siblingOffset.length;D++){const P=2*s+this._siblingOffset[D][0],R=2*c+this._siblingOffset[D][1],B=x.getElevation(P,R),N=x.isLeaf(P,R),U=this._addNode(B.min,B.max,N);N&&(E|=1<<D),C||(C=U)}for(let D=0;D<this._siblingOffset.length;D++)E&1<<D||this._construct(i,2*s+this._siblingOffset[D][0],2*c+this._siblingOffset[D][1],y,C+D)}}function Av(o,i,s,c,d,m){return bn(bn(o,s,m),bn(i,c,m),d)}function Ws(o,i,s){const c=s.dim,d=un(o*c-.5,0,c-1),m=un(i*c-.5,0,c-1),y=Math.floor(d),x=Math.floor(m),E=Math.min(y+1,c-1),C=Math.min(x+1,c-1);return Av(s.get(y,x),s.get(E,x),s.get(y,C),s.get(E,C),d-y,m-x)}const Hd={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function Mf(o,i,s){return(256*o*256+256*i+s)/10-1e4}function y1(o,i,s){return 256*o+i+s/256-32768}class Th{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,s,c,d=!1,m=!1){if(this.uid=i,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return ci(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const y=this.dim=s.height-2,x=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=d,!d){for(let E=0;E<y;E++)x[this._idx(-1,E)]=x[this._idx(0,E)],x[this._idx(y,E)]=x[this._idx(y-1,E)],x[this._idx(E,-1)]=x[this._idx(E,0)],x[this._idx(E,y)]=x[this._idx(E,y-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(y,-1)]=x[this._idx(y-1,0)],x[this._idx(-1,y)]=x[this._idx(0,y-1)],x[this._idx(y,y)]=x[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new vv(this)}get(i,s,c=!1){c&&(i=un(i,-1,this.dim),s=un(s,-1,this.dim));const d=4*this._idx(i,s);return("terrarium"===this.encoding?y1:Mf)(this.pixels[d],this.pixels[d+1],this.pixels[d+2])}static getUnpackVector(i){return Hd[i]}get unpackVector(){return Hd[this.encoding]}_idx(i,s){if(i<-1||i>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(i+1)}static pack(i,s){const c=[0,0,0,0],d=Th.getUnpackVector(s);let m=Math.floor((i+d[3])/d[2]);return c[2]=m%256,m=Math.floor(m/256),c[1]=m%256,m=Math.floor(m/256),c[0]=m,c}getPixels(){return new Ur({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,s,c){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let d=s*this.dim,m=s*this.dim+this.dim,y=c*this.dim,x=c*this.dim+this.dim;switch(s){case-1:d=m-1;break;case 1:m=d+1}switch(c){case-1:y=x-1;break;case 1:x=y+1}const E=-s*this.dim,C=-c*this.dim;for(let D=y;D<x;D++)for(let P=d;P<m;P++){const R=4*this._idx(P,D),B=4*this._idx(P+E,D+C);this.pixels[R+0]=i.pixels[B+0],this.pixels[R+1]=i.pixels[B+1],this.pixels[R+2]=i.pixels[B+2],this.pixels[R+3]=i.pixels[B+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ae(Th,"DEMData"),Ae(vv,"DemMinMaxQuadTree",{omit:["dem"]});class v1{constructor(i,s){this.max=i,this.onRemove=s,this.reset()}reset(){for(const i in this.data)for(const s of this.data[i])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(i,s,c){const d=i.wrapped().key;void 0===this.data[d]&&(this.data[d]=[]);const m={value:s,timeout:void 0};if(void 0!==c&&(m.timeout=setTimeout(()=>{this.remove(i,m)},c)),this.data[d].push(m),this.order.push(d),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(i){return i.wrapped().key in this.data}getAndRemove(i){return this.has(i)?this._getAndRemoveByKey(i.wrapped().key):null}_getAndRemoveByKey(i){const s=this.data[i].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[i].length&&delete this.data[i],this.order.splice(this.order.indexOf(i),1),s.value}getByKey(i){const s=this.data[i];return s?s[0].value:null}get(i){return this.has(i)?this.data[i.wrapped().key][0].value:null}remove(i,s){if(!this.has(i))return this;const c=i.wrapped().key,d=void 0===s?0:this.data[c].indexOf(s),m=this.data[c][d];return this.data[c].splice(d,1),m.timeout&&clearTimeout(m.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(m.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(i){for(this.max=i;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(i){const s=[];for(const c in this.data)for(const d of this.data[c])i(d.value)||s.push(d);for(const c of s)this.remove(c.value.tileID,c)}}class iu{constructor(i,s,c){this.func=i,this.mask=s,this.range=c}}iu.ReadOnly=!1,iu.ReadWrite=!0,iu.disabled=new iu(519,iu.ReadOnly,[0,1]);class Sf{constructor(i,s,c,d,m,y){this.test=i,this.ref=s,this.mask=c,this.fail=d,this.depthFail=m,this.pass=y}}Sf.disabled=new Sf({func:519,mask:0},0,0,7680,7680,7680);class Zs{constructor(i,s,c){this.blendFunction=i,this.blendColor=s,this.mask=c}}Zs.Replace=[1,0],Zs.disabled=new Zs(Zs.Replace,Di.transparent,[!1,!1,!1,!1]),Zs.unblended=new Zs(Zs.Replace,Di.transparent,[!0,!0,!0,!0]),Zs.alphaBlended=new Zs([1,771],Di.transparent,[!0,!0,!0,!0]);class Co{constructor(i,s,c){this.enable=i,this.mode=s,this.frontFace=c}}Co.disabled=new Co(!1,1029,2305),Co.backCCW=new Co(!0,1029,2305),Co.backCW=new Co(!0,1029,2304),Co.frontCW=new Co(!0,1028,2304),Co.frontCCW=new Co(!0,1028,2305);class Ia extends mc{constructor(i,s,c){super(),this.id=i,this._onlySymbols=c,s.on("data",d=>{"source"===d.dataType&&"metadata"===d.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===d.dataType&&"content"===d.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new v1(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ax,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(i){this.map=i,this._minTileCacheSize=void 0===this._minTileCacheSize&&i?i._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&i?i._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const i in this._tiles){const s=this._tiles[i];if("loaded"!==s.state&&"errored"!==s.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const i=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,i&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(i,s){return i.isSymbolTile=this._onlySymbols,this._source.loadTile(i,s)}_unloadTile(i){if(this._source.unloadTile)return this._source.unloadTile(i,()=>{})}_abortTile(i){if(this._source.abortTile)return this._source.abortTile(i,()=>{})}serialize(){return this._source.serialize()}prepare(i){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(i),c.prepare(this.map.style.imageManager)}}getIds(){return ta(this._tiles).map(i=>i.tileID).sort(Mh).map(i=>i.key)}getRenderableIds(i){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,i)&&s.push(this._tiles[c]);return i?s.sort((c,d)=>{const m=c.tileID,y=d.tileID,x=new lt(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),E=new lt(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||E.y-x.y||E.x-x.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(Mh).map(c=>c.key)}hasRenderableParent(i){const s=this.findLoadedParent(i,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(i,s){return this._tiles[i]&&this._tiles[i].hasData()&&!this._coveredTiles[i]&&(s||!this._tiles[i].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const i in this._tiles)"errored"!==this._tiles[i].state&&this._reloadTile(+i,"reloading")}}_reloadTile(i,s){const c=this._tiles[i];c&&("loading"!==c.state&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,i,s)))}_tileLoaded(i,s,c,d){if(d)if(i.state="errored",404!==d.status)this._source.fire(new Ss(d,{tile:i}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else i.timeAdded=rs.now(),"expired"===c&&(i.refreshedUponExpiration=!0),this._setTileReloadTimer(s,i),"raster-dem"===this._source.type&&i.dem&&this._backfillDEM(i),this._state.initializeTileState(i,this.map?this.map.painter:null),this._source.fire(new Va("data",{dataType:"source",tile:i,coord:i.tileID,sourceCacheId:this.id}))}_backfillDEM(i){const s=this.getRenderableIds();for(let d=0;d<s.length;d++){const m=s[d];if(i.neighboringTiles&&i.neighboringTiles[m]){const y=this.getTileByID(m);c(i,y),c(y,i)}}function c(d,m){if(!d.dem||d.dem.borderReady)return;d.needsHillshadePrepare=!0,d.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-d.tileID.canonical.x;const x=m.tileID.canonical.y-d.tileID.canonical.y,E=Math.pow(2,d.tileID.canonical.z),C=m.tileID.key;0===y&&0===x||Math.abs(x)>1||(Math.abs(y)>1&&(1===Math.abs(y+E)?y+=E:1===Math.abs(y-E)&&(y-=E)),m.dem&&d.dem&&(d.dem.backfillBorder(m.dem,y,x),d.neighboringTiles&&d.neighboringTiles[C]&&(d.neighboringTiles[C].backfilled=!0)))}}getTile(i){return this.getTileByID(i.key)}getTileByID(i){return this._tiles[i]}_retainLoadedChildren(i,s,c,d){for(const m in this._tiles){let y=this._tiles[m];if(d[m]||!y.hasData()||y.tileID.overscaledZ<=s||y.tileID.overscaledZ>c)continue;let x=y.tileID;for(;y&&y.tileID.overscaledZ>s+1;){const C=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[C.key],y&&y.hasData()&&(x=C)}let E=x;for(;E.overscaledZ>s;)if(E=E.scaledTo(E.overscaledZ-1),i[E.key]){d[x.key]=x;break}}}findLoadedParent(i,s){if(i.key in this._loadedParentTiles){const c=this._loadedParentTiles[i.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=i.overscaledZ-1;c>=s;c--){const d=i.scaledTo(c),m=this._getLoadedTile(d);if(m)return m}}_getLoadedTile(i){const s=this._tiles[i.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?i.wrapped().key:i.canonical.key)}updateCacheSize(i,s){s=s||this._source.tileSize;const c=Math.ceil(i.width/s)+1,d=Math.ceil(i.height/s)+1,m=Math.floor(c*d*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,m):m,x="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(x)}handleWrapJump(i){const s=Math.round((i-(void 0===this._prevLng?i:this._prevLng))/360);if(this._prevLng=i,s){const c={};for(const d in this._tiles){const m=this._tiles[d];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+s),c[m.tileID.key]=m}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(+d,this._tiles[d])}}update(i,s,c){if(this.transform=i,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let d;this.updateCacheSize(i,s),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?d=i.getVisibleUnwrappedCoordinates(this._source.tileID).map(x=>new Ki(x.canonical.z,x.wrap,x.canonical.z,x.canonical.x,x.canonical.y)):(d=i.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(d=d.filter(x=>this._source.hasTile(x)))):d=[];const m=this._updateRetainedTiles(d);if(xv(this._source.type)&&0!==d.length){const x={},E={},C=Object.keys(m);for(const P of C){const R=m[P],B=this._tiles[P];if(!B||B.fadeEndTime&&B.fadeEndTime<=rs.now())continue;const N=this.findLoadedParent(R,Math.max(R.overscaledZ-Ia.maxOverzooming,this._source.minzoom));N&&(this._addTile(N.tileID),x[N.tileID.key]=N.tileID),E[P]=R}const D=d[d.length-1].overscaledZ;for(const P in this._tiles){const R=this._tiles[P];if(m[P]||!R.hasData())continue;let B=R.tileID;for(;B.overscaledZ>D;){B=B.scaledTo(B.overscaledZ-1);const N=this._tiles[B.key];if(N&&N.hasData()&&E[B.key]){m[P]=R.tileID;break}}}for(const P in x)m[P]||(this._coveredTiles[P]=!0,m[P]=x[P])}for(const x in m)this._tiles[x].clearFadeHold();const y=function(x,E){const C=[];for(const D in x)D in E||C.push(D);return C}(this._tiles,m);for(const x of y){const E=this._tiles[x];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+x)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const i in this._tiles)this._tiles[i].holdingForFade()&&this._removeTile(+i)}_updateRetainedTiles(i){const s={};if(0===i.length)return s;const c={},d=i.reduce((C,D)=>Math.min(C,D.overscaledZ),1/0),m=i[0].overscaledZ,y=Math.max(m-Ia.maxOverzooming,this._source.minzoom),x=Math.max(m+Ia.maxUnderzooming,this._source.minzoom),E={};for(const C of i){const D=this._addTile(C);s[C.key]=C,D.hasData()||d<this._source.maxzoom&&(E[C.key]=C)}this._retainLoadedChildren(E,d,x,s);for(const C of i){let D=this._tiles[C.key];if(D.hasData())continue;if(C.canonical.z>=this._source.maxzoom){const R=C.children(this._source.maxzoom)[0],B=this.getTile(R);if(B&&B.hasData()){s[R.key]=R;continue}}else{const R=C.children(this._source.maxzoom);if(s[R[0].key]&&s[R[1].key]&&s[R[2].key]&&s[R[3].key])continue}let P=D.wasRequested();for(let R=C.overscaledZ-1;R>=y;--R){const B=C.scaledTo(R);if(c[B.key]||(c[B.key]=!0,D=this.getTile(B),!D&&P&&(D=this._addTile(B)),D&&(s[B.key]=B,P=D.wasRequested(),D.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const i in this._tiles){const s=[];let c,d=this._tiles[i].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}s.push(d.key);const m=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(m),c)break;d=m}for(const m of s)this._loadedParentTiles[m]=c}}_addTile(i){let s=this._tiles[i.key];if(s)return s;s=this._cache.getAndRemove(i),s&&(this._setTileReloadTimer(i.key,s),s.tileID=i,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[i.key]&&(clearTimeout(this._cacheTimers[i.key]),delete this._cacheTimers[i.key],this._setTileReloadTimer(i.key,s)));const c=Boolean(s);if(!c){const d=this.map?this.map.painter:null;s=new e_(i,this._source.tileSize*i.overscaleFactor(),this.transform.tileZoom,d,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,i.key,s.state))}return s?(s.uses++,this._tiles[i.key]=s,c||this._source.fire(new Va("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(i,s){i in this._timers&&(clearTimeout(this._timers[i]),delete this._timers[i]);const c=s.getExpiryTimeout();c&&(this._timers[i]=setTimeout(()=>{this._reloadTile(i,"expired"),delete this._timers[i]},c))}_removeTile(i){const s=this._tiles[i];s&&(s.uses--,delete this._tiles[i],this._timers[i]&&(clearTimeout(this._timers[i]),delete this._timers[i]),s.uses>0||(s.hasData()&&"reloading"!==s.state?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const i in this._tiles)this._removeTile(+i);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(i,s,c){const d=[],m=this.transform;if(!m)return d;const y="globe"===m.projection.name,x=Us(m.center.lng);for(const E in this._tiles){const C=this._tiles[E];if(c&&C.clearQueryDebugViz(),C.holdingForFade())continue;let D;if(y){const P=C.tileID.canonical;if(0===P.z){const R=[Math.abs(un(x,...Dh(P,-1))-x),Math.abs(un(x,...Dh(P,1))-x)];D=[0,2*R.indexOf(Math.min(...R))-1]}else{const R=[Math.abs(un(x,...Dh(P,-1))-x),Math.abs(un(x,...Dh(P,0))-x),Math.abs(un(x,...Dh(P,1))-x)];D=[R.indexOf(Math.min(...R))-1]}}else D=[0];for(const P of D){const R=i.containsTile(C,m,s,P);R&&d.push(R)}}return d}getVisibleCoordinates(i){const s=this.getRenderableIds(i).map(c=>this._tiles[c].tileID);for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(xv(this._source.type))for(const i in this._tiles){const s=this._tiles[i];if(void 0!==s.fadeEndTime&&s.fadeEndTime>=rs.now())return!0}return!1}setFeatureState(i,s,c){this._state.updateState(i=i||"_geojsonTileLayer",s,c)}removeFeatureState(i,s,c){this._state.removeFeatureState(i=i||"_geojsonTileLayer",s,c)}getFeatureState(i,s){return this._state.getState(i=i||"_geojsonTileLayer",s)}setDependencies(i,s,c){const d=this._tiles[i];d&&d.setDependencies(s,c)}reloadTilesForDependencies(i,s){for(const c in this._tiles)this._tiles[c].hasDependency(i,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(i,s))}_preloadTiles(i,s){if(!this._sourceLoaded){const x=()=>{this._sourceLoaded&&(this._source.off("data",x),this._preloadTiles(i,s))};return void this._source.on("data",x)}const c=new Map,d=Array.isArray(i)?i:[i],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const x of d){const E=x.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const C of E)c.set(C.key,C);this.usedForTerrain&&x.updateElevation(!1)}zi(Array.from(c.values()),(x,E)=>{const C=new e_(x,this._source.tileSize*x.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(C,D=>{"raster-dem"===this._source.type&&C.dem&&this._backfillDEM(C),E(D,C)})},s)}}function Mh(o,i){const s=Math.abs(2*o.wrap)-+(o.wrap<0),c=Math.abs(2*i.wrap)-+(i.wrap<0);return o.overscaledZ-i.overscaledZ||c-s||i.canonical.y-o.canonical.y||i.canonical.x-o.canonical.x}function xv(o){return"raster"===o||"image"===o||"video"===o||"custom"===o}function Dh(o,i){const s=1<<o.z;return[o.x/s+i,(o.x+1)/s+i]}Ia.maxOverzooming=10,Ia.maxUnderzooming=3;class $d{constructor(i,s,c){this._demTile=i,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(i,s,c){const d=c||i.findDEMTileFor(s);if(!d||!d.dem)return;const m=d.dem,y=d.tileID,x=1<<s.canonical.z-y.canonical.z;return new $d(d,d.tileSize/St/x,[(s.canonical.x/x-y.canonical.x)*m.dim,(s.canonical.y/x-y.canonical.y)*m.dim])}tileCoordToPixel(i,s){const c=s*this._scale+this._offset[1],d=Math.floor(i*this._scale+this._offset[0]),m=Math.floor(c);return new lt(d,m)}getElevationAt(i,s,c,d){const m=i*this._scale+this._offset[0],y=s*this._scale+this._offset[1],x=Math.floor(m),E=Math.floor(y),C=this._dem;return d=!!d,c?bn(bn(C.get(x,E,d),C.get(x,E+1,d),y-E),bn(C.get(x+1,E,d),C.get(x+1,E+1,d),y-E),m-x):C.get(x,E,d)}getElevationAtPixel(i,s,c){return this._dem.get(i,s,!!c)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*ys(1,i)*this._dem.stride}}class bv{constructor(i,s){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Wa(St,16,0),this.featureIndexArray=new Qa,this.promoteId=s}insert(i,s,c,d,m,y=0){const x=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,d,m,y);const E=this.grid;for(let C=0;C<s.length;C++){const D=s[C],P=[1/0,1/0,-1/0,-1/0];for(let R=0;R<D.length;R++){const B=D[R];P[0]=Math.min(P[0],B.x),P[1]=Math.min(P[1],B.y),P[2]=Math.max(P[2],B.x),P[3]=Math.max(P[3],B.y)}P[0]<St&&P[1]<St&&P[2]>=0&&P[3]>=0&&E.insert(x,P[0],P[1],P[2],P[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new af(new mf(this.rawTileData)).layers,this.sourceLayerCoder=new dv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,s,c,d){this.loadVTLayers();const m=i.params||{},y=pd(m.filter),x=i.tileResult,E=i.transform,C=x.bufferedTilespaceBounds,D=this.grid.query(C.min.x,C.min.y,C.max.x,C.max.y,(N,U,q,Y)=>$m(x.bufferedTilespaceGeometry,N,U,q,Y));D.sort(qd);let P=null;E.elevation&&D.length>0&&(P=$d.create(E.elevation,this.tileID));const R={};let B;for(let N=0;N<D.length;N++){const U=D[N];if(U===B)continue;B=U;const q=this.featureIndexArray.get(U);let Y=null;this.loadMatchingFeature(R,q,y,m.layers,m.availableImages,s,c,d,(ae,J,oe,ue=0)=>(Y||(Y=js(ae,this.tileID.canonical,i.tileTransform)),J.queryIntersectsFeature(x,ae,oe,Y,this.z,i.transform,i.pixelPosMatrix,P,ue)))}return R}loadMatchingFeature(i,s,c,d,m,y,x,E,C){const{featureIndex:D,bucketIndex:P,sourceLayerIndex:R,layoutVertexArrayOffset:B}=s,N=this.bucketLayerIDs[P];if(d&&!function(ae,J){for(let oe=0;oe<ae.length;oe++)if(J.indexOf(ae[oe])>=0)return!0;return!1}(d,N))return;const U=this.sourceLayerCoder.decode(R),q=this.vtLayers[U].feature(D);if(c.needGeometry){const ae=jl(q,!0);if(!c.filter(new k(this.tileID.overscaledZ),ae,this.tileID.canonical))return}else if(!c.filter(new k(this.tileID.overscaledZ),q))return;const Y=this.getId(q,U);for(let ae=0;ae<N.length;ae++){const J=N[ae];if(d&&d.indexOf(J)<0)continue;const oe=y[J];if(!oe)continue;let ue={};void 0!==Y&&E&&(ue=E.getState(oe.sourceLayer||"_geojsonTileLayer",Y));const ce=Ii({},x[J]);ce.paint=wv(ce.paint,oe.paint,q,ue,m),ce.layout=wv(ce.layout,oe.layout,q,ue,m);const xe=!C||C(q,oe,ue,B);if(!xe)continue;const we=new fv(q,this.z,this.x,this.y,Y);we.layer=ce;let Oe=i[J];void 0===Oe&&(Oe=i[J]=[]),Oe.push({featureIndex:D,feature:we,intersectionZ:xe})}}lookupSymbolFeatures(i,s,c,d,m,y,x,E){const C={};this.loadVTLayers();const D=pd(m);for(const P of i)this.loadMatchingFeature(C,{bucketIndex:c,sourceLayerIndex:d,featureIndex:P,layoutVertexArrayOffset:0},D,y,x,E,s);return C}loadFeature(i){const{featureIndex:s,sourceLayerIndex:c}=i;this.loadVTLayers();const d=this.sourceLayerCoder.decode(c),m=this.vtFeatures[d];if(m[s])return m[s];const y=this.vtLayers[d].feature(s);return m[s]=y,y}hasLayer(i){for(const s of this.bucketLayerIDs)for(const c of s)if(i===c)return!0;return!1}getId(i,s){let c=i.id;if(this.promoteId){const d="string"==typeof this.promoteId?this.promoteId:this.promoteId[s];null!=d&&(c=i.properties[d]),"boolean"==typeof c&&(c=Number(c))}return c}}function wv(o,i,s,c,d){return ht(o,(m,y)=>{const x=i instanceof ee?i.get(y):null;return x&&x.evaluate?x.evaluate(s,c,d):x})}function qd(o,i){return i-o}Ae(bv,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Ev{constructor(i,s){this.width=i,this.height=s,this.nextRow=0,this.image=new ba({width:i,height:s}),this.positions={},this.uploaded=!1}getDash(i,s){const c=this.getKey(i,s);return this.positions[c]}trim(){const i=this.width,s=this.height=ts(this.nextRow);this.image.resize({width:i,height:s})}getKey(i,s){return i.join(",")+s}getDashRanges(i,s,c){const d=[];let m=i.length%2==1?-i[i.length-1]*c:0,y=i[0]*c,x=!0;d.push({left:m,right:y,isDash:x,zeroLength:0===i[0]});let E=i[0];for(let C=1;C<i.length;C++){x=!x;const D=i[C];m=E*c,E+=D,y=E*c,d.push({left:m,right:y,isDash:x,zeroLength:0===D})}return d}addRoundDash(i,s,c){const d=s/2;for(let m=-c;m<=c;m++){const y=this.width*(this.nextRow+c+m);let x=0,E=i[x];for(let C=0;C<this.width;C++){C/E.right>1&&(E=i[++x]);const D=Math.abs(C-E.left),P=Math.abs(C-E.right),R=Math.min(D,P);let B;const N=m/c*(d+1);if(E.isDash){const U=d-Math.abs(N);B=Math.sqrt(R*R+U*U)}else B=d-Math.sqrt(R*R+N*N);this.image.data[y+C]=Math.max(0,Math.min(255,B+128))}}}addRegularDash(i,s){for(let E=i.length-1;E>=0;--E){const C=i[E],D=i[E+1];C.zeroLength?i.splice(E,1):D&&D.isDash===C.isDash&&(D.left=C.left,i.splice(E,1))}const c=i[0],d=i[i.length-1];c.isDash===d.isDash&&(c.left=d.left-this.width,d.right=c.right+this.width);const m=this.width*this.nextRow;let y=0,x=i[y];for(let E=0;E<this.width;E++){E/x.right>1&&(x=i[++y]);const C=Math.abs(E-x.left),D=Math.abs(E-x.right),P=Math.min(C,D);this.image.data[m+E]=Math.max(0,Math.min(255,(x.isDash?P:-P)+s+128))}}addDash(i,s){const c=this.getKey(i,s);if(this.positions[c])return this.positions[c];const d="round"===s,m=d?7:0,y=2*m+1;if(this.nextRow+y>this.height)return ci("LineAtlas out of space"),null;0===i.length&&i.push(1);let x=0;for(let D=0;D<i.length;D++)i[D]<0&&(ci("Negative value is found in line dasharray, replacing values with 0"),i[D]=0),x+=i[D];if(0!==x){const D=this.width/x,P=this.getDashRanges(i,this.width,D);d?this.addRoundDash(P,D,m):this.addRegularDash(P,"square"===s?.5*D:0)}const E=this.nextRow+m;this.nextRow+=y;const C={tl:[E,m],br:[x,0]};return this.positions[c]=C,C}}Ae(Ev,"LineAtlas");const xx=1*xs;class Cv{constructor(i){const s={},c=[];for(const x in i){const E=i[x],C=s[x]={};for(const D in E.glyphs){const P=E.glyphs[+D];if(!P||0===P.bitmap.width||0===P.bitmap.height)continue;const R=P.metrics.localGlyph?xx:1,B={x:0,y:0,w:P.bitmap.width+2*R,h:P.bitmap.height+2*R};c.push(B),C[D]=B}}const{w:d,h:m}=Pg(c),y=new ba({width:d||1,height:m||1});for(const x in i){const E=i[x];for(const C in E.glyphs){const D=E.glyphs[+C];if(!D||0===D.bitmap.width||0===D.bitmap.height)continue;const P=s[x][C],R=D.metrics.localGlyph?xx:1;ba.copy(D.bitmap,y,{x:0,y:0},{x:P.x+R,y:P.y+R},D.bitmap)}}this.image=y,this.positions=s}}Ae(Cv,"GlyphAtlas");class bx{constructor(i){this.tileID=new Ki(i.tileID.overscaledZ,i.tileID.wrap,i.tileID.canonical.z,i.tileID.canonical.x,i.tileID.canonical.y),this.tileZoom=i.tileZoom,this.uid=i.uid,this.zoom=i.zoom,this.canonical=i.tileID.canonical,this.pixelRatio=i.pixelRatio,this.tileSize=i.tileSize,this.source=i.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=i.showCollisionBoxes,this.collectResourceTiming=!!i.collectResourceTiming,this.returnDependencies=!!i.returnDependencies,this.promoteId=i.promoteId,this.enableTerrain=!!i.enableTerrain,this.isSymbolTile=i.isSymbolTile,this.tileTransform=Jc(i.tileID.canonical,i.projection),this.projection=i.projection}parse(i,s,c,d,m){this.status="parsing",this.data=i,this.collisionBoxArray=new Ln;const y=new dv(Object.keys(i.layers).sort()),x=new bv(this.tileID,this.promoteId);x.bucketLayerIDs=[];const E={},C=new Ev(256,256),D={featureIndex:x,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:C,availableImages:c},P=s.familiesBySource[this.source];for(const ue in P){const ce=i.layers[ue];if(!ce)continue;let xe=!1,we=!1;for(const De of P[ue])"symbol"===De[0].type?xe=!0:we=!0;if(!0===this.isSymbolTile&&!xe||!1===this.isSymbolTile&&!we)continue;1===ce.version&&ci(`Vector tile source "${this.source}" layer "${ue}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Oe=y.encode(ue),We=[];for(let De=0;De<ce.length;De++){const ze=ce.feature(De),Ve=x.getId(ze,ue);We.push({feature:ze,id:Ve,index:De,sourceLayerIndex:Oe})}for(const De of P[ue]){const ze=De[0];void 0!==this.isSymbolTile&&"symbol"===ze.type!==this.isSymbolTile||ze.minzoom&&this.zoom<Math.floor(ze.minzoom)||ze.maxzoom&&this.zoom>=ze.maxzoom||"none"!==ze.visibility&&(n_(De,this.zoom,c),(E[ze.id]=ze.createBucket({index:x.bucketLayerIDs.length,layers:De,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Oe,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(We,D,this.tileID.canonical,this.tileTransform),x.bucketLayerIDs.push(De.map(Ve=>Ve.id)))}}let R,B,N,U;C.trim();const q={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Y=()=>{if(R)return m(R);if(B&&N&&U){const ue=new Cv(B),ce=new Gy(N,U);for(const xe in E){const we=E[xe];we instanceof sl?(n_(we.layers,this.zoom,c),hx(we,B,ue.positions,N,ce.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):we.hasPattern&&(we instanceof hf||we instanceof nf||we instanceof qc)&&(n_(we.layers,this.zoom,c),we.addFeatures(D,this.tileID.canonical,ce.patternPositions,c,this.tileTransform))}this.status="done",m(null,{buckets:ta(E).filter(xe=>!xe.isEmpty()),featureIndex:x,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:ue.image,lineAtlas:C,imageAtlas:ce,glyphMap:this.returnDependencies?B:null,iconMap:this.returnDependencies?N:null,glyphPositions:this.returnDependencies?ue.positions:null})}},ae=ht(D.glyphDependencies,ue=>Object.keys(ue).map(Number));Object.keys(ae).length?d.send("getGlyphs",{uid:this.uid,stacks:ae},(ue,ce)=>{R||(R=ue,B=ce,Y())},void 0,!1,q):B={};const J=Object.keys(D.iconDependencies);J.length?d.send("getImages",{icons:J,source:this.source,tileID:this.tileID,type:"icons"},(ue,ce)=>{R||(R=ue,N=ce,Y())},void 0,!1,q):N={};const oe=Object.keys(D.patternDependencies);oe.length?d.send("getImages",{icons:oe,source:this.source,tileID:this.tileID,type:"patterns"},(ue,ce)=>{R||(R=ue,U=ce,Y())},void 0,!1,q):U={},Y()}}function n_(o,i,s){const c=new k(i);for(const d of o)d.recalculate(c,s)}class Iv{constructor(i){this.entries={},this.scheduler=i}request(i,s,c,d){const m=this.entries[i]=this.entries[i]||{callbacks:[]};if(m.result){const[y,x]=m.result;return this.scheduler?this.scheduler.add(()=>{d(y,x)},s):d(y,x),()=>{}}return m.callbacks.push(d),m.cancel||(m.cancel=c((y,x)=>{m.result=[y,x];for(const E of m.callbacks)this.scheduler?this.scheduler.add(()=>{E(y,x)},s):E(y,x);setTimeout(()=>delete this.entries[i],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==d),m.callbacks.length||(m.cancel(),delete this.entries[i]))}}}function Tv(o,i,s){const c=JSON.stringify(o.request);return o.data&&(this.deduped.entries[c]={result:[null,o.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},d=>{const m=xl(o.request,(y,x,E,C)=>{y?d(y):x&&d(null,{vectorTile:s?void 0:new af(new mf(x)),rawData:x,cacheControl:E,expires:C})});return()=>{m.cancel(),d()}},i)}const Mv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class i_{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(i,0,2);if(219!==s)throw new Error("Data does not appear to be in a KDBush format.");const d=c>>4;if(1!==d)throw new Error(`Got v${d} data when expected v1.`);const m=Mv[15&c];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(i,2,1),[x]=new Uint32Array(i,4,1);return new i_(x,y,m,i)}constructor(i,s=64,c=Float64Array,d){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const m=Mv.indexOf(this.ArrayType),y=2*i*this.ArrayType.BYTES_PER_ELEMENT,x=i*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-x%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${c}.`);d&&d instanceof ArrayBuffer?(this.data=d,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+x+E,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+y+x+E),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+x+E,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=i)}add(i,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=i,this.coords[this._pos++]=s,c}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return kf(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,s,c,d){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:x}=this,E=[0,m.length-1,0],C=[];for(;E.length;){const D=E.pop()||0,P=E.pop()||0,R=E.pop()||0;if(P-R<=x){for(let q=R;q<=P;q++){const Y=y[2*q],ae=y[2*q+1];Y>=i&&Y<=c&&ae>=s&&ae<=d&&C.push(m[q])}continue}const B=R+P>>1,N=y[2*B],U=y[2*B+1];N>=i&&N<=c&&U>=s&&U<=d&&C.push(m[B]),(0===D?i<=N:s<=U)&&(E.push(R),E.push(B-1),E.push(1-D)),(0===D?c>=N:d>=U)&&(E.push(B+1),E.push(P),E.push(1-D))}return C}within(i,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:d,coords:m,nodeSize:y}=this,x=[0,d.length-1,0],E=[],C=c*c;for(;x.length;){const D=x.pop()||0,P=x.pop()||0,R=x.pop()||0;if(P-R<=y){for(let q=R;q<=P;q++)Dv(m[2*q],m[2*q+1],i,s)<=C&&E.push(d[q]);continue}const B=R+P>>1,N=m[2*B],U=m[2*B+1];Dv(N,U,i,s)<=C&&E.push(d[B]),(0===D?i-c<=N:s-c<=U)&&(x.push(R),x.push(B-1),x.push(1-D)),(0===D?i+c>=N:s+c>=U)&&(x.push(B+1),x.push(P),x.push(1-D))}return E}}function kf(o,i,s,c,d,m){if(d-c<=s)return;const y=c+d>>1;Jn(o,i,y,c,d,m),kf(o,i,s,c,y-1,1-m),kf(o,i,s,y+1,d,1-m)}function Jn(o,i,s,c,d,m){for(;d>c;){if(d-c>600){const C=d-c+1,D=s-c+1,P=Math.log(C),R=.5*Math.exp(2*P/3),B=.5*Math.sqrt(P*R*(C-R)/C)*(D-C/2<0?-1:1);Jn(o,i,s,Math.max(c,Math.floor(s-D*R/C+B)),Math.min(d,Math.floor(s+(C-D)*R/C+B)),m)}const y=i[2*s+m];let x=c,E=d;for(Wd(o,i,c,s),i[2*d+m]>y&&Wd(o,i,c,d);x<E;){for(Wd(o,i,x,E),x++,E--;i[2*x+m]<y;)x++;for(;i[2*E+m]>y;)E--}i[2*c+m]===y?Wd(o,i,c,E):(E++,Wd(o,i,E,d)),E<=s&&(c=E+1),s<=E&&(d=E-1)}}function Wd(o,i,s,c){Zd(o,s,c),Zd(i,2*s,2*c),Zd(i,2*s+1,2*c+1)}function Zd(o,i,s){const c=o[i];o[i]=o[s],o[s]=c}function Dv(o,i,s,c){const d=o-s,m=i-c;return d*d+m*m}p.ARRAY_TYPE=Ir,p.AUTH_ERR_MSG=de,p.Aabb=Vr,p.Actor=class{constructor(o,i,s){this.target=o,this.parent=i,this.mapId=s,this.callbacks={},this.cancelCallbacks={},ei(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ra()?o:je,this.scheduler=new vx}send(o,i,s,c,d=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=m,this.callbacks[y]=s);const x=hc(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:o,hasCallback:!!s,targetMapId:c,mustQueue:d,sourceMapId:this.mapId,data:_n(i,x)},x),{cancel:()=>{s&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(o){const i=o.data,s=i.id;if(s&&(!i.targetMapId||this.mapId===i.targetMapId))if("<cancel>"===i.type){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(i.mustQueue||ra()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,i),c&&c.metadata||{type:"message"})}else this.processTask(s,i)}processTask(o,i){if("<response>"===i.type){const s=this.callbacks[o];delete this.callbacks[o],s&&(i.error?s(gi(i.error)):s(null,gi(i.data)))}else{const s=hc(this.globalScope)?void 0:[],c=i.hasCallback?(m,y)=>{delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:m?_n(m):null,data:_n(y,s)},s)}:m=>{},d=gi(i.data);if(this.parent[i.type])this.parent[i.type](i.sourceMapId,d,c);else if(this.parent.getWorkerSource){const m=i.type.split(".");this.parent.getWorkerSource(i.sourceMapId,m[0],d.source)[m[1]](d,c)}else c(new Error(`Could not find function ${i.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},p.CanonicalTileID=_g,p.Color=Di,p.ColorMode=Zs,p.CullFaceMode=Co,p.DEMData=Th,p.DataConstantProperty=V,p.DedupedRequest=Iv,p.DepthMode=iu,p.EXTENT=St,p.Elevation=class{isDataAvailableAtPoint(o){const i=this._source();if(this.isUsingMockSource()||!i||o.y<0||o.y>1)return!1;const s=i.getSource().maxzoom,c=1<<s,d=Math.floor(o.x),m=Math.floor((o.x-d)*c),y=Math.floor(o.y*c),x=this.findDEMTileFor(new Ki(s,d,s,m,y));return!(!x||!x.dem)}getAtPointOrZero(o,i=0){return this.getAtPoint(o,i)||0}getAtPoint(o,i,s=!0){if(this.isUsingMockSource())return null;null==i&&(i=null);const c=this._source();if(!c||o.y<0||o.y>1)return i;const d=c.getSource().maxzoom,m=1<<d,y=Math.floor(o.x),x=o.x-y,E=new Ki(d,y,d,Math.floor(x*m),Math.floor(o.y*m)),C=this.findDEMTileFor(E);if(!C||!C.dem)return i;const D=C.dem,P=1<<C.tileID.canonical.z,R=(x*P-C.tileID.canonical.x)*D.dim,B=(o.y*P-C.tileID.canonical.y)*D.dim,N=Math.floor(R),U=Math.floor(B);return(s?this.exaggeration():1)*bn(bn(D.get(N,U),D.get(N,U+1),B-U),bn(D.get(N+1,U),D.get(N+1,U+1),B-U),R-N)}getAtTileOffset(o,i,s){const c=1<<o.canonical.z;return this.getAtPointOrZero(new lh(o.wrap+(o.canonical.x+i/St)/c,(o.canonical.y+s/St)/c))}getAtTileOffsetFunc(o,i,s,c){return d=>{const m=this.getAtTileOffset(o,d.x,d.y),y=c.upVector(o.canonical,d.x,d.y);return so(y,y,m*c.upVectorScale(o.canonical,i,s).metersToTile),y}}getForTilePoints(o,i,s,c){if(this.isUsingMockSource())return!1;const d=$d.create(this,o,c);return!!d&&(i.forEach(m=>{m[2]=this.exaggeration()*d.getElevationAt(m[0],m[1],s)}),!0)}getMinMaxForTile(o){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(o);if(!i||!i.dem)return null;const s=i.dem.tree,c=i.tileID,d=1<<o.canonical.z-c.canonical.z;let m=o.canonical.x/d-c.canonical.x,y=o.canonical.y/d-c.canonical.y,x=0;for(let E=0;E<o.canonical.z-c.canonical.z&&!s.leaves[x];E++){m*=2,y*=2;const C=2*Math.floor(y)+Math.floor(m);x=s.childOffsets[x]+C,m%=1,y%=1}return{min:this.exaggeration()*s.minimums[x],max:this.exaggeration()*s.maximums[x]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,i,s){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},p.ErrorEvent=Ss,p.EvaluationParameters=k,p.Event=Va,p.Evented=mc,p.FillExtrusionBucket=qc,p.Frustum=Mm,p.FrustumCorners=jp,p.GLOBE_RADIUS=Ja,p.GLOBE_SCALE_MATCH_LATITUDE=45,p.GLOBE_ZOOM_THRESHOLD_MAX=Dm,p.GLOBE_ZOOM_THRESHOLD_MIN=my,p.GlobeSharedBuffers=class{constructor(o){this._createGrid(o),this._createPoles(o)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const o of this._poleSegments)o.destroy();for(const o of this._gridSegments)o.withSkirts.destroy(),o.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const o of this._wireframeSegments)o.destroy()}}_fillGridMeshWithLods(o,i){const s=new Ze,c=new Et,d=[],m=o+1+2,y=i[0]+1,x=i[0]+1+(1+i.length),E=(C,D,P)=>{let R=C===m-1?C-2:0===C?C:C-1;return R+=P?24575:0,[R,D]};for(let C=0;C<m;++C)s.emplaceBack(...E(C,0,!0));for(let C=0;C<y;++C)for(let D=0;D<m;++D)s.emplaceBack(...E(D,C,(0===D||D===m-1)&&!0));for(let C=0;C<i.length;++C){const D=i[C];for(let P=0;P<m;++P)s.emplaceBack(...E(P,D,!0))}for(let C=0;C<i.length;++C){const D=c.length,P=i[C]+1+2,R=new Et;for(let U=0;U<P-1;U++){const q=U===P-2,Y=q?m*(x-i.length+C-U):m;for(let ae=0;ae<m-1;ae++){const J=U*m+ae;0===U||q||0===ae||ae===m-2?(R.emplaceBack(J+1,J,J+Y),R.emplaceBack(J+Y,J+Y+1,J+1)):(c.emplaceBack(J+1,J,J+Y),c.emplaceBack(J+Y,J+Y+1,J+1))}}const B=Li.simpleSegment(0,D,s.length,c.length-D);for(let U=0;U<R.uint16.length;U+=3)c.emplaceBack(R.uint16[U],R.uint16[U+1],R.uint16[U+2]);const N=Li.simpleSegment(0,D,s.length,c.length-D);d.push({withoutSkirts:B,withSkirts:N})}return{vertices:s,indices:c,segments:d}}_createGrid(o){const i=this._fillGridMeshWithLods(64,zc);this._gridSegments=i.segments,this._gridBuffer=o.createVertexBuffer(i.vertices,bd.members),this._gridIndexBuffer=o.createIndexBuffer(i.indices,!0)}_createPoles(o){const i=new Et;for(let d=0;d<=64;d++)i.emplaceBack(0,d+1,d+2);this._poleIndexBuffer=o.createIndexBuffer(i,!0);const s=new jn,c=new jn;this._poleSegments=[];for(let d=0,m=0;d<my;d++){const y=360/(1<<d);s.emplaceBack(0,-Ja,0,.5,0),c.emplaceBack(0,-Ja,0,.5,1);for(let x=0;x<=64;x++){const E=x/64,C=bn(0,y,E),[D,P,R]=cr(xo,Bm,C,Ja);s.emplaceBack(D,P,R,E,0),c.emplaceBack(D,P,R,E,1)}this._poleSegments.push(Li.simpleSegment(m,0,66,64)),m+=66}this._poleNorthVertexBuffer=o.createVertexBuffer(s,py,!1),this._poleSouthVertexBuffer=o.createVertexBuffer(c,py,!1)}getGridBuffers(o,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[o].withSkirts:this._gridSegments[o].withoutSkirts]}getPoleBuffers(o){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[o]]}getWirefameBuffers(o,i){if(!this._wireframeSegments){const s=new Si,c=64,d=c+1+2,m=1;this._wireframeSegments=[];for(let y=0,x=0;y<zc.length;y++){const E=zc[y];for(let D=m;D<E+m;D++)for(let P=m;P<c+m;P++){const R=D*d+P;s.emplaceBack(R,R+1),s.emplaceBack(R,R+d),s.emplaceBack(R,R+d+1)}const C=E*c*3;this._wireframeSegments.push(Li.simpleSegment(0,x,(E+1)*d,C)),x+=C}this._wireframeIndexBuffer=o.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[i]]}},p.GlyphManager=Kc,p.ImagePosition=Gs,p.KDBush=i_,p.LivePerformanceUtils=ns,p.LngLat=Rn,p.LngLatBounds=hi,p.LocalGlyphMode=Ng,p.MAX_MERCATOR_LATITUDE=hr,p.MercatorCoordinate=lh,p.ONE_EM=Ji,p.OverscaledTileID=Ki,p.PerformanceMarkers=Po,p.Point=lt,p.Properties=te,p.RGBAImage=Ur,p.Ray=rh,p.RequestManager=class{constructor(o,i,s){this._transformRequestFn=o,this._customAccessToken=i,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const o=function(){let i="";for(let s=0;s<10;s++)i+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",gl,i].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,i){return this._transformRequestFn&&this._transformRequestFn(o,i)||{url:o}}normalizeStyleURL(o,i){if(!_e(o))return o;const s=at(o);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||i)}normalizeGlyphsURL(o,i){if(!_e(o))return o;const s=at(o);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||i)}normalizeSourceURL(o,i,s,c){if(!_e(o))return o;const d=at(o);return d.path=`/v4/${d.authority}.json`,d.params.push("secure"),s&&d.params.push(`language=${s}`),c&&d.params.push(`worldview=${c}`),this._makeAPIURL(d,this._customAccessToken||i)}normalizeSpriteURL(o,i,s,c){const d=at(o);return _e(o)?(d.path=`/styles/v1${d.path}/sprite${i}${s}`,this._makeAPIURL(d,this._customAccessToken||c)):(d.path+=`${i}${s}`,tt(d))}normalizeTileURL(o,i,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!_e(o))return o;const c=at(o);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${i||s&&"raster"!==c.authority&&512===s?"@2x":""}${Xt.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${Jt.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${Jt.TILE_URL_VERSION}${c.path}`);const d=this._customAccessToken||function(m){for(const y of m){const x=y.match(/^access_token=(.*)$/);if(x)return x[1]}return null}(c.params)||Jt.ACCESS_TOKEN;return Jt.REQUIRE_ACCESS_TOKEN&&d&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,d)}canonicalizeTileURL(o,i){const s=at(o);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return o;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${Jt.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${Jt.TILE_URL_VERSION}/`,"")}`;let d=s.params;return i&&(d=d.filter(m=>!m.match(/^access_token=/))),d.length&&(c+=`?${d.join("&")}`),c}canonicalizeTileset(o,i){const s=!!i&&_e(i),c=[];for(const d of o.tiles||[])Ee(d)?c.push(this.canonicalizeTileURL(d,s)):c.push(d);return c}_makeAPIURL(o,i){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=at(Jt.API_URL);if(o.protocol=c.protocol,o.authority=c.authority,"http"===o.protocol){const d=o.params.indexOf("secure");d>=0&&o.params.splice(d,1)}if("/"!==c.path&&(o.path=`${c.path}${o.path}`),!Jt.REQUIRE_ACCESS_TOKEN)return tt(o);if(i=i||Jt.ACCESS_TOKEN,!this._silenceAuthErrors){if(!i)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if("s"===i[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return o.params=o.params.filter(d=>-1===d.indexOf("access_token")),o.params.push(`access_token=${i||""}`),tt(o)}},p.ResourceType=La,p.SegmentVector=Li,p.SourceCache=Ia,p.StencilMode=Sf,p.StructArrayLayout1ui2=yo,p.StructArrayLayout2f1f2i16=kt,p.StructArrayLayout2i4=Ze,p.StructArrayLayout2ui4=Si,p.StructArrayLayout3f12=cn,p.StructArrayLayout3ui6=Et,p.StructArrayLayout4i8=Be,p.StructArrayLayout5f20=jn,p.Texture=Ih,p.Tile=e_,p.Transitionable=z,p.Uniform1f=Fp,p.Uniform1i=class extends vo{constructor(o){super(o),this.current=0}set(o,i,s){this.fetchUniformLocation(o,i)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},p.Uniform2f=class extends vo{constructor(o){super(o),this.current=[0,0]}set(o,i,s){this.fetchUniformLocation(o,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},p.Uniform3f=class extends vo{constructor(o){super(o),this.current=[0,0,0]}set(o,i,s){this.fetchUniformLocation(o,i)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},p.Uniform4f=Cr,p.UniformColor=Lp,p.UniformMatrix2f=class extends vo{constructor(o){super(o),this.current=Bp}set(o,i,s){if(this.fetchUniformLocation(o,i))for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}},p.UniformMatrix3f=class extends vo{constructor(o){super(o),this.current=ry}set(o,i,s){if(this.fetchUniformLocation(o,i))for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}},p.UniformMatrix4f=class extends vo{constructor(o){super(o),this.current=y0}set(o,i,s){if(this.fetchUniformLocation(o,i)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},p.UnwrappedTileID=q0,p.ValidationError=mt,p.VectorTileFeature=lf,p.VectorTileWorkerSource=class extends mc{constructor(o,i,s,c,d){super(),this.actor=o,this.layerIndex=i,this.availableImages=s,this.loadVectorData=d||Tv,this.loading={},this.loaded={},this.deduped=new Iv(o.scheduler),this.isSpriteLoaded=c,this.scheduler=o.scheduler}loadTile(o,i){const s=o.uid,c=o&&o.request,d=c&&c.collectResourceTiming,m=this.loading[s]=new bx(o);m.abort=this.loadVectorData(o,(y,x)=>{const E=!this.loading[s];if(delete this.loading[s],E||y||!x)return m.status="done",E||(this.loaded[s]=m),i(y);const C=x.rawData,D={};x.expires&&(D.expires=x.expires),x.cacheControl&&(D.cacheControl=x.cacheControl),m.vectorTile=x.vectorTile||new af(new mf(C));const P=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(R,B)=>{if(R||!B)return i(R);const N={};if(d){const U=Xh(c);U.length>0&&(N.resourceTiming=JSON.parse(JSON.stringify(U)))}i(null,Ii({rawTileData:C.slice(0)},B,D,N))})};this.isSpriteLoaded?P():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(P,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):P()}),this.loaded=this.loaded||{},this.loaded[s]=m})}reloadTile(o,i){const s=this.loaded,c=o.uid,d=this;if(s&&s[c]){const m=s[c];m.showCollisionBoxes=o.showCollisionBoxes,m.enableTerrain=!!o.enableTerrain,m.projection=o.projection,m.tileTransform=Jc(o.tileID.canonical,o.projection);const y=(x,E)=>{const C=m.reloadCallback;C&&(delete m.reloadCallback,m.parse(m.vectorTile,d.layerIndex,this.availableImages,d.actor,C)),i(x,E)};"parsing"===m.status?m.reloadCallback=y:"done"===m.status&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(o,i){const s=o.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),i()}removeTile(o,i){const s=this.loaded,c=o.uid;s&&s[c]&&delete s[c],i()}},p.WritingMode=Zo,p.ZoomDependentExpression=Lu,p.add=Ka,p.addDynamicAttributes=jd,p.adjoint=function(o,i){var s=i[0],c=i[1],d=i[2],m=i[3],y=i[4],x=i[5],E=i[6],C=i[7],D=i[8];return o[0]=y*D-x*C,o[1]=d*C-c*D,o[2]=c*x-d*y,o[3]=x*E-m*D,o[4]=s*D-d*E,o[5]=d*m-s*x,o[6]=m*C-y*E,o[7]=c*E-s*C,o[8]=s*y-c*m,o},p.asyncAll=zi,p.bezier=Oa,p.bindAll=ei,p.boundsAttributes=qs,p.bufferConvexPolygon=function(o,i){const s=[];for(let c=0;c<o.length;c++){const d=fn(c-1,-1,o.length-1),m=fn(c+1,-1,o.length-1),y=o[c],x=o[m],E=o[d].sub(y).unit(),C=x.sub(y).unit(),D=C.angleWithSep(E.x,E.y),P=E.add(C).unit().mult(-1*i/Math.sin(D/2));s.push(y.add(P))}return s},p.cacheEntryPossiblyAdded=function(o){ko++,ko>Zh&&(o.getActor().send("enforceCacheSizeLimit",pc),ko=0)},p.calculateGlobeLabelMatrix=function(o,i){const{x:s,y:c}=o.point,d=yy(s,c,o.worldSize/o._pixelsPerMercatorPixel,0,0);return Aa(d,d,Om(Ya(i)))},p.calculateGlobeMatrix=function(o){const{x:i,y:s}=o.point,{lng:c,lat:d}=o._center;return yy(i,s,o.worldSize,c,d)},p.calculateGlobeMercatorMatrix=function(o){const i=o.pixelsPerMeter,s=i/ys(1,o.center.lat),c=zr(new Float64Array(16));return Xa(c,c,[o.point.x,o.point.y,0]),Bc(c,c,[s,s,i]),Float32Array.from(c)},p.circumferenceAtLatitude=Wp,p.clamp=un,p.clearTileCache=function(o){if(!Au())return;const i=je.caches.delete(dc);o&&i.catch(o).then(()=>o())},p.clipLine=Bg,p.clone=function(o){var i=new Ir(16);return i[0]=o[0],i[1]=o[1],i[2]=o[2],i[3]=o[3],i[4]=o[4],i[5]=o[5],i[6]=o[6],i[7]=o[7],i[8]=o[8],i[9]=o[9],i[10]=o[10],i[11]=o[11],i[12]=o[12],i[13]=o[13],i[14]=o[14],i[15]=o[15],i},p.clone$1=ho,p.collisionCircleLayout=Ea,p.config=Jt,p.conjugate=function(o,i){return o[0]=-i[0],o[1]=-i[1],o[2]=-i[2],o[3]=i[3],o},p.create=function(){var o=new Ir(16);return Ir!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},p.create$1=oy,p.createExpression=Sc,p.createLayout=ye,p.createStyleLayer=function(o){return"custom"===o.type?new gx(o):new Yg[o.type](o)},p.cross=Vp,p.degToRad=sn,p.distance=function(o,i){return Math.hypot(i[0]-o[0],i[1]-o[1],i[2]-o[2])},p.div=function(o,i,s){return o[0]=i[0]/s[0],o[1]=i[1]/s[1],o[2]=i[2]/s[2],o},p.dot=lr,p.earthRadius=ah,p.ease=es,p.easeCubicInOut=_u,p.ecefToLatLng=function([o,i,s]){const c=Math.hypot(o,i,s),d=Math.atan2(o,s),m=.5*Math.PI-Math.acos(-i/c);return new Rn(qi(d),qi(m))},p.emitValidationErrors=kp,p.endsWith=_l,p.enforceCacheSizeLimit=function(o){vl(),to&&to.then(i=>{i.keys().then(s=>{for(let c=0;c<s.length-o;c++)i.delete(s[c])})})},p.evaluateSizeForFeature=pf,p.evaluateSizeForZoom=Zc,p.evaluateVariableOffset=ux,p.evented=v,p.exactEquals=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]&&o[3]===i[3]},p.exactEquals$1=function(o,i){return o[0]===i[0]&&o[1]===i[1]&&o[2]===i[2]},p.exported=rs,p.exported$1=Xt,p.extend=Ii,p.extend$1=ks,p.fillExtrusionHeightLift=Oy,p.filterObject=ia,p.fromMat4=function(o,i){return o[0]=i[0],o[1]=i[1],o[2]=i[2],o[3]=i[4],o[4]=i[5],o[5]=i[6],o[6]=i[8],o[7]=i[9],o[8]=i[10],o},p.fromQuat=function(o,i){var s=i[0],c=i[1],d=i[2],m=i[3],y=s+s,x=c+c,E=d+d,C=s*y,D=c*y,P=c*x,R=d*y,B=d*x,N=d*E,U=m*y,q=m*x,Y=m*E;return o[0]=1-P-N,o[1]=D+Y,o[2]=R-q,o[3]=0,o[4]=D-Y,o[5]=1-C-N,o[6]=B+U,o[7]=0,o[8]=R+q,o[9]=B-U,o[10]=1-C-P,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},p.fromRotation=function(o,i){var s=Math.sin(i),c=Math.cos(i);return o[0]=c,o[1]=s,o[2]=0,o[3]=-s,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},p.fromScaling=x0,p.furthestTileCorner=function(o){const i=Math.round((o+45+360)%360/90)%4;return uc[i]},p.getAABBPointSquareDist=function(o,i,s){let c=0;for(let d=0;d<2;++d){const m=s?s[d]:0;o[d]>m&&(c+=(o[d]-m)*(o[d]-m)),i[d]<m&&(c+=(m-i[d])*(m-i[d]))}return c},p.getAnchorAlignment=Og,p.getAnchorJustification=Zl,p.getBounds=function(o){let i=1/0,s=1/0,c=-1/0,d=-1/0;for(const m of o)i=Math.min(i,m.x),s=Math.min(s,m.y),c=Math.max(c,m.x),d=Math.max(d,m.y);return{min:new lt(i,s),max:new lt(c,d)}},p.getColumn=oa,p.getDefaultExportFromCjs=eo,p.getGridMatrix=function(o,i,s,c){const d=i.getNorth(),m=i.getSouth(),y=i.getWest(),x=i.getEast(),E=1<<o.z,C=x-y,D=d-m,P=C/64,R=-D/zc[s],B=[0,P,0,R,0,0,d,y,0];if(o.z>0){const N=180/c;$o(B,B,[N/C+1,0,0,0,N/D+1,0,-.5*N/P,.5*N/R,1])}return B[2]=E,B[5]=o.x,B[8]=o.y,B},p.getImage=re,p.getJSON=function(o,i){return Al(Ii(o,{type:"json"}),i)},p.getLatitudinalLod=function(o){const i=hr-5;o=un(o,-i,i)/i*90;const s=Math.pow(Math.abs(Math.sin(sn(o))),3);return Math.round(s*(zc.length-1))},p.getMapSessionAPI=Zi,p.getPerformanceMeasurement=Xh,p.getProjection=Ud,p.getRTLTextPluginStatus=b,p.getReferrer=Na,p.getTilePoint=function(o,{x:i,y:s},c=0){return new lt(((i-c)*o.scale-o.x)*St,(s*o.scale-o.y)*St)},p.getTileVec3=function(o,i,s=0){return th(((i.x-s)*o.scale-o.x)*St,(i.y*o.scale-o.y)*St,Ay(i.z,i.y))},p.getVideo=function(o,i){const s=je.document.createElement("video");s.muted=!0,s.onloadstart=function(){i(null,s)};for(let c=0;c<o.length;c++){const d=je.document.createElement("source");Qh(o[c])||(s.crossOrigin="Anonymous"),d.src=o[c],s.appendChild(d)}return{cancel:()=>{}}},p.globeCenterToScreenPoint=function(o){const i=[0,0,0],s=zr(new Float64Array(16));return Aa(s,o.pixelMatrix,o.globeMatrix),ii(i,i,s),new lt(i[0],i[1])},p.globeDenormalizeECEF=Om,p.globeECEFOrigin=function(o,i){const s=[0,0,0];return ii(s,s,Uc(Ya(i.canonical))),ii(s,s,o),s},p.globeMetersToEcef=km,p.globeNormalizeECEF=Uc,p.globePixelsToTileUnits=function(o,i){return St/(512*Math.pow(2,o))*$p(Ya(i))},p.globePoleMatrixForTile=function(o,i,s){const c=zr(new Float64Array(16)),d=(i/(1<<o)-.5)*Math.PI*2;return zp(c,s.globeMatrix,d),Float32Array.from(c)},p.globeTileBounds=Ya,p.globeTiltAtLngLat=Fm,p.globeToMercatorTransition=sh,p.globeUseCustomAntiAliasing=function(o,i,s){const c=sh(s.zoom),d=o.style.map._antialias,m=!!i.extStandardDerivatives,y=i.extStandardDerivativesForceOff||o.terrain&&o.terrain.exaggeration()>0;return 0===c&&!d&&!y&&m},p.identity=zr,p.identity$1=dy,p.invert=Np,p.isFullscreen=function(){return!!je.document.fullscreenElement||!!je.document.webkitFullscreenElement},p.isLngLatBehindGlobe=Lm,p.isMapAuthenticated=function(o){return Vn.has(o)},p.isMapboxURL=_e,p.isSafariWithAntialiasingBug=function(o){const i=o.navigator?o.navigator.userAgent:null;return!!hc(o)&&i&&(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},p.latFromMercatorY=ur,p.latLngToECEF=oh,p.len=cy,p.length=eh,p.length$1=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},p.lngFromMercatorX=qo,p.loadVectorTile=Tv,p.makeRequest=Al,p.mapValue=function(o,i,s,c,d){return un((o-i)/(s-i)*(d-c)+c,c,d)},p.mercatorScale=xy,p.mercatorXfromLng=Us,p.mercatorYfromLat=xa,p.mercatorZfromAltitude=ys,p.mul=Cm,p.mul$1=Up,p.multiply=Aa,p.multiply$1=$o,p.multiply$2=ay,p.nextPowerOfTwo=ts,p.normalize=Tr,p.normalize$1=E0,p.normalize$2=hy,p.number=bn,p.ortho=function(o,i,s,c,d,m,y){var x=1/(i-s),E=1/(c-d),C=1/(m-y);return o[0]=-2*x,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*E,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*C,o[11]=0,o[12]=(i+s)*x,o[13]=(d+c)*E,o[14]=(y+m)*C,o[15]=1,o},p.pbf=zy,p.perspective=function(o,i,s,c,d){var m,y=1/Math.tan(i/2);return o[0]=y/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=y,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=d&&d!==1/0?(o[10]=(d+c)*(m=1/(c-d)),o[14]=2*d*c*m):(o[10]=-1,o[14]=-2*c),o},p.pick=function(o,i){const s={};for(let c=0;c<i.length;c++){const d=i[c];d in o&&(s[d]=o[d])}return s},p.plugin=M,p.pointGeometry=Ms,p.polesInViewport=function(o){const i=zr(new Float64Array(16));Aa(i,o.pixelMatrix,o.globeMatrix);const s=[0,zs,0],c=[0,Vs,0];return ii(s,s,i),ii(c,c,i),[s[0]>0&&s[0]<=o.width&&s[1]>0&&s[1]<=o.height&&!Lm(o,new Rn(o.center.lat,90)),c[0]>0&&c[0]<=o.width&&c[1]>0&&c[1]<=o.height&&!Lm(o,new Rn(o.center.lat,-90))]},p.polygonContainsPoint=tl,p.polygonIntersectsBox=$m,p.polygonIntersectsPolygon=wy,p.polygonizeBounds=function(o,i,s=0,c=!0){const d=new lt(s,s),m=o.sub(d),y=i.add(d),x=[m,new lt(y.x,m.y),y,new lt(m.x,y.y)];return c&&x.push(m.clone()),x},p.posAttributes=bd,p.postMapLoadEvent=Ai,p.postPerformanceEvent=Oi,p.postTurnstileEvent=mn,p.potpack=Pg,p.prevPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},p.radToDeg=qi,p.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],p.registerForPluginStateChange=function(o){return o({pluginStatus:f,pluginURL:a}),v.on("pluginStateChange",o),o},p.removeAuthState=function(o){Vn.delete(o)},p.renderColorRamp=Yp,p.resample=Zp,p.rotateX=sy,p.rotateX$1=w0,p.rotateY=zp,p.rotateY$1=Tm,p.rotateZ=function(o,i,s){var c=Math.sin(s),d=Math.cos(s),m=i[0],y=i[1],x=i[2],E=i[3],C=i[4],D=i[5],P=i[6],R=i[7];return i!==o&&(o[8]=i[8],o[9]=i[9],o[10]=i[10],o[11]=i[11],o[12]=i[12],o[13]=i[13],o[14]=i[14],o[15]=i[15]),o[0]=m*d+C*c,o[1]=y*d+D*c,o[2]=x*d+P*c,o[3]=E*d+R*c,o[4]=C*d-m*c,o[5]=D*d-y*c,o[6]=P*d-x*c,o[7]=R*d-E*c,o},p.rotateZ$1=function(o,i,s){s*=.5;var c=i[0],d=i[1],m=i[2],y=i[3],x=Math.sin(s),E=Math.cos(s);return o[0]=c*E+d*x,o[1]=d*E-c*x,o[2]=m*E+y*x,o[3]=y*E-m*x,o},p.scale=Bc,p.scale$1=uy,p.scale$2=so,p.scaleAndAdd=Ul,p.set=function(o,i,s,c){return o[0]=i,o[1]=s,o[2]=c,o},p.setCacheLimits=function(o,i){pc=o,Zh=i},p.setColumn=function(o,i,s){o[4*i+0]=s[0],o[4*i+1]=s[1],o[4*i+2]=s[2],o[4*i+3]=s[3]},p.setRTLTextPlugin=function(o,i,s=!1){if(f===jo||f===Zu||f===ma)throw new Error("setRTLTextPlugin cannot be called multiple times.");a=rs.resolveURL(o),f=jo,Kr=i,_(),s||T()},p.smoothstep=Fa,p.spec=Fe,p.squaredLength=function(o){var i=o[0],s=o[1],c=o[2];return i*i+s*s+c*c},p.storeAuthState=function(o,i){i?Vn.add(o):Vn.delete(o)},p.sub=ao,p.subtract=Im,p.symbolSize=_h,p.tileAABB=function(o,i,s,c,d,m,y,x,E){if("globe"===E.name)return function _y(o,i,s){const c=i/o.worldSize,d=o.globeMatrix;if(s.z<=1){const we=Ya(s).getCorners();return Hp(we,d,c),Vr.fromPoints(we)}const m=wd(s),y=Gp(m);Hp(y,d,c);const x=Number.MAX_VALUE,E=[-x,-x,-x],C=[x,x,x];if(m.contains(o.center)){for(const We of y)Ad(C,C,We),xd(E,E,We);E[2]=0;const we=o.point,Oe=[we.x*c,we.y*c,0];return Ad(C,C,Oe),xd(E,E,Oe),new Vr(C,E)}const D=[d[12]*c,d[13]*c,d[14]*c],P=m.getCenter(),R=un(o.center.lat,-hr,hr),B=un(P.lat,-hr,hr),N=Us(o.center.lng),U=xa(R);let q=N-Us(P.lng);const Y=U-xa(B);q>.5?q-=1:q<-.5&&(q+=1);let ae=0;Math.abs(q)>Math.abs(Y)?ae=q>=0?1:3:(ae=Y>=0?0:2,Ul(D,D,[d[4]*c,d[5]*c,d[6]*c],-Math.sin(sn(Y>=0?m.getSouth():m.getNorth()))*Ja));const J=y[ae],oe=y[(ae+1)%4],ue=new c1(J,oe,D),ce=[gy(ue,0)||J[0],gy(ue,1)||J[1],gy(ue,2)||J[2]],xe=sh(o.zoom);if(xe>0){const we=function({x:We,y:De,z:ze},Ve,Ge,Ye,Re){const ut=1/(1<<ze);let yt=We*ut,dt=yt+ut,Vt=De*ut,it=Vt+ut,Mt=0;const Ut=(yt+dt)/2-Ye;return Ut>.5?Mt=-1:Ut<-.5&&(Mt=1),yt=((yt+Mt)*Ve-(Ye*=Ve))*Ge+Ye,dt=((dt+Mt)*Ve-Ye)*Ge+Ye,Vt=(Vt*Ve-(Re*=Ve))*Ge+Re,it=(it*Ve-Re)*Ge+Re,[[yt,it,0],[dt,it,0],[dt,Vt,0],[yt,Vt,0]]}(s,i,o._pixelsPerMercatorPixel,N,U);for(let We=0;We<y.length;We++)Vc(y[We],we[We],xe);const Oe=Ka([],we[ae],we[(ae+1)%4]);so(Oe,Oe,.5),Vc(ce,Oe,xe)}for(const we of y)Ad(C,C,we),xd(E,E,we);return C[2]=Math.min(J[2],oe[2]),Ad(C,C,ce),xd(E,E,ce),new Vr(C,E)}(o,i,new _g(s,c,d));const C=Jc({z:s,x:c,y:d},E);return new Vr([(m+C.x/C.scale)*i,i*(C.y/C.scale),y],[(m+C.x2/C.scale)*i,i*(C.y2/C.scale),x])},p.tileCornersToBounds=wd,p.tileTransform=Jc,p.transformMat3=function(o,i,s){var c=i[0],d=i[1],m=i[2];return o[0]=c*s[0]+d*s[3]+m*s[6],o[1]=c*s[1]+d*s[4]+m*s[7],o[2]=c*s[2]+d*s[5]+m*s[8],o},p.transformMat4=ii,p.transformMat4$1=_s,p.transformQuat=ly,p.transitionTileAABBinECEF=Pm,p.translate=Xa,p.transpose=function(o,i){if(o===i){var s=i[1],c=i[2],d=i[5];o[1]=i[3],o[2]=i[6],o[3]=s,o[5]=i[7],o[6]=c,o[7]=d}else o[0]=i[0],o[1]=i[3],o[2]=i[6],o[3]=i[1],o[4]=i[4],o[5]=i[7],o[6]=i[2],o[7]=i[5],o[8]=i[8];return o},p.triggerPluginCompletionEvent=h,p.uniqueId=rr,p.updateGlobeVertexNormal=function(o,i,s,c,d){const m=5*i+2;o.float32[m+0]=s,o.float32[m+1]=c,o.float32[m+2]=d},p.validateCustomStyleLayer=function(o){const i=[],s=o.id;return void 0===s&&i.push({message:`layers.${s}: missing required property "id"`}),void 0===o.render&&i.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&i.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),i},p.validateFilter=o=>zo(wr(o)),p.validateFog=o=>zo(Rc(o)),p.validateLayer=o=>zo(Pc(o)),p.validateLight=o=>zo(Br(o)),p.validateSource=o=>zo(gd(o)),p.validateStyle=$u,p.validateTerrain=o=>zo(_d(o)),p.values=ta,p.vectorTile=vs,p.version=Yo,p.warnOnce=ci,p.window=je,p.wrap=fn}),$h(0,function(p){function je(le){if("number"==typeof le||"boolean"==typeof le||"string"==typeof le||null==le)return JSON.stringify(le);if(Array.isArray(le)){let G="[";for(const re of le)G+=`${je(re)},`;return`${G}]`}let H="{";for(const G of Object.keys(le).sort())H+=`${G}:${je(le[G])},`;return`${H}}`}function Yo(le){let H="";for(const G of p.refProperties)H+=`/${je(le[G])}`;return H}class co{constructor(H){this.keyCache={},H&&this.replace(H)}replace(H){this._layerConfigs={},this._layers={},this.update(H,[])}update(H,G){for(const de of H)this._layerConfigs[de.id]=de,(this._layers[de.id]=p.createStyleLayer(de)).compileFilter(),this.keyCache[de.id]&&delete this.keyCache[de.id];for(const de of G)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const re=function(de,_e){const Ee={};for(let ge=0;ge<de.length;ge++){const Pe=_e&&_e[de[ge].id]||Yo(de[ge]);_e&&(_e[de[ge].id]=Pe);let rt=Ee[Pe];rt||(rt=Ee[Pe]=[]),rt.push(de[ge])}const be=[];for(const ge in Ee)be.push(Ee[ge]);return be}(p.values(this._layerConfigs),this.keyCache);for(const de of re){const _e=de.map(at=>this._layers[at.id]),Ee=_e[0];if("none"===Ee.visibility)continue;const be=Ee.source||"";let ge=this.familiesBySource[be];ge||(ge=this.familiesBySource[be]={});const Pe=Ee.sourceLayer||"_geojsonTileLayer";let rt=ge[Pe];rt||(rt=ge[Pe]=[]),rt.push(_e)}}}class Jt{loadTile(H,G){const{uid:re,encoding:de,rawImageData:_e,padding:Ee,buildQuadTree:be}=H,ge=p.window.ImageBitmap&&_e instanceof p.window.ImageBitmap?this.getImageData(_e,Ee):_e;G(null,new p.DEMData(re,ge,de,Ee<1,be))}getImageData(H,G){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(H.width,H.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=H.width,this.offscreenCanvas.height=H.height,this.offscreenCanvasContext.drawImage(H,0,0,H.width,H.height);const re=this.offscreenCanvasContext.getImageData(-G,-G,H.width+2*G,H.height+2*G);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}function Xt(le,H){if(0!==le.length){Ni(le[0],H);for(var G=1;G<le.length;G++)Ni(le[G],!H)}}function Ni(le,H){for(var G=0,re=0,de=0,_e=le.length,Ee=_e-1;de<_e;Ee=de++){var be=(le[de][0]-le[Ee][0])*(le[Ee][1]+le[de][1]),ge=G+be;re+=Math.abs(G)>=Math.abs(be)?G-ge+be:be-ge+G,G=ge}G+re>=0!=!!H&&le.reverse()}var Rr=p.getDefaultExportFromCjs(function le(H,G){var re,de=H&&H.type;if("FeatureCollection"===de)for(re=0;re<H.features.length;re++)le(H.features[re],G);else if("GeometryCollection"===de)for(re=0;re<H.geometries.length;re++)le(H.geometries[re],G);else if("Feature"===de)le(H.geometry,G);else if("Polygon"===de)Xt(H.coordinates,G);else if("MultiPolygon"===de)for(re=0;re<H.coordinates.length;re++)Xt(H.coordinates[re],G);return H});const Mo=p.VectorTileFeature.prototype.toGeoJSON;var Ts={exports:{}},cc=p.pointGeometry,gl=p.vectorTile.VectorTileFeature,eo=uo;function uo(le,H){this.options=H||{},this.features=le,this.length=le.length}function Wr(le,H){this.id="number"==typeof le.id?le.id:void 0,this.type=le.type,this.rawGeometry=1===le.type?[le.geometry]:le.geometry,this.properties=le.tags,this.extent=H||4096}uo.prototype.feature=function(le){return new Wr(this.features[le],this.options.extent)},Wr.prototype.loadGeometry=function(){var le=this.rawGeometry;this.geometry=[];for(var H=0;H<le.length;H++){for(var G=le[H],re=[],de=0;de<G.length;de++)re.push(new cc(G[de][0],G[de][1]));this.geometry.push(re)}return this.geometry},Wr.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var le=this.geometry,H=1/0,G=-1/0,re=1/0,de=-1/0,_e=0;_e<le.length;_e++)for(var Ee=le[_e],be=0;be<Ee.length;be++){var ge=Ee[be];H=Math.min(H,ge.x),G=Math.max(G,ge.x),re=Math.min(re,ge.y),de=Math.max(de,ge.y)}return[H,re,G,de]},Wr.prototype.toGeoJSON=gl.prototype.toGeoJSON;var Pa=p.pbf,Ms=eo;function Do(le){var H=new Pa;return function(G,re){for(var de in G.layers)re.writeMessage(3,lt,G.layers[de])}(le,H),H.finish()}function lt(le,H){var G;H.writeVarintField(15,le.version||1),H.writeStringField(1,le.name||""),H.writeVarintField(5,le.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(G=0;G<le.length;G++)re.feature=le.feature(G),H.writeMessage(2,qh,re);var de=re.keys;for(G=0;G<de.length;G++)H.writeStringField(3,de[G]);var _e=re.values;for(G=0;G<_e.length;G++)H.writeMessage(4,_u,_e[G])}function qh(le,H){var G=le.feature;void 0!==G.id&&H.writeVarintField(1,G.id),H.writeMessage(2,Ra,le),H.writeVarintField(3,G.type),H.writeMessage(4,uc,G)}function Ra(le,H){var G=le.feature,re=le.keys,de=le.values,_e=le.keycache,Ee=le.valuecache;for(var be in G.properties){var ge=G.properties[be],Pe=_e[be];if(null!==ge){void 0===Pe&&(re.push(be),_e[be]=Pe=re.length-1),H.writeVarint(Pe);var rt=typeof ge;"string"!==rt&&"boolean"!==rt&&"number"!==rt&&(ge=JSON.stringify(ge));var at=rt+":"+ge,tt=Ee[at];void 0===tt&&(de.push(ge),Ee[at]=tt=de.length-1),H.writeVarint(tt)}}}function sn(le,H){return(H<<3)+(7&le)}function qi(le){return le<<1^le>>31}function uc(le,H){for(var G=le.loadGeometry(),re=le.type,de=0,_e=0,Ee=G.length,be=0;be<Ee;be++){var ge=G[be],Pe=1;1===re&&(Pe=ge.length),H.writeVarint(sn(1,Pe));for(var rt=3===re?ge.length-1:ge.length,at=0;at<rt;at++){1===at&&1!==re&&H.writeVarint(sn(2,rt-1));var tt=ge[at].x-de,Ht=ge[at].y-_e;H.writeVarint(qi(tt)),H.writeVarint(qi(Ht)),de+=tt,_e+=Ht}3===re&&H.writeVarint(sn(7,1))}}function _u(le,H){var G=typeof le;"string"===G?H.writeStringField(1,le):"boolean"===G?H.writeBooleanField(7,le):"number"===G&&(le%1!=0?H.writeDoubleField(3,le):le<0?H.writeSVarintField(6,le):H.writeVarintField(5,le))}Ts.exports=Do,Ts.exports.fromVectorTileJs=Do,Ts.exports.fromGeojsonVt=function(le,H){H=H||{};var G={};for(var re in le)G[re]=new Ms(le[re].features,H),G[re].name=re,G[re].version=H.version,G[re].extent=H.extent;return Do({layers:G})},Ts.exports.GeoJSONWrapper=Ms;var Oa=p.getDefaultExportFromCjs(Ts.exports);const es={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:le=>le},un=Math.fround||(Fa=new Float32Array(1),le=>(Fa[0]=+le,Fa[0]));var Fa;const fn=3,zi=5,ta=6;class Ii{constructor(H){this.options=Object.assign(Object.create(es),H),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(H){const{log:G,minZoom:re,maxZoom:de}=this.options;G&&console.time("total time");const _e=`prepare ${H.length} points`;G&&console.time(_e),this.points=H;const Ee=[];for(let ge=0;ge<H.length;ge++){const Pe=H[ge];if(!Pe.geometry)continue;const[rt,at]=Pe.geometry.coordinates,tt=un(Ds(rt)),Ht=un(ts(at));Ee.push(tt,Ht,1/0,ge,-1,1),this.options.reduce&&Ee.push(0)}let be=this.trees[de+1]=this._createTree(Ee);G&&console.timeEnd(_e);for(let ge=de;ge>=re;ge--){const Pe=+Date.now();be=this.trees[ge]=this._createTree(this._cluster(be,ge)),G&&console.log("z%d: %d clusters in %dms",ge,be.numItems,+Date.now()-Pe)}return G&&console.timeEnd("total time"),this}getClusters(H,G){let re=((H[0]+180)%360+360)%360-180;const de=Math.max(-90,Math.min(90,H[1]));let _e=180===H[2]?180:((H[2]+180)%360+360)%360-180;const Ee=Math.max(-90,Math.min(90,H[3]));if(H[2]-H[0]>=360)re=-180,_e=180;else if(re>_e){const at=this.getClusters([re,de,180,Ee],G),tt=this.getClusters([-180,de,_e,Ee],G);return at.concat(tt)}const be=this.trees[this._limitZoom(G)],ge=be.range(Ds(re),ts(Ee),Ds(_e),ts(de)),Pe=be.data,rt=[];for(const at of ge){const tt=this.stride*at;rt.push(Pe[tt+zi]>1?na(Pe,tt,this.clusterProps):this.points[Pe[tt+fn]])}return rt}getChildren(H){const G=this._getOriginId(H),re=this._getOriginZoom(H),de="No cluster with the specified id.",_e=this.trees[re];if(!_e)throw new Error(de);const Ee=_e.data;if(G*this.stride>=Ee.length)throw new Error(de);const be=this.options.radius/(this.options.extent*Math.pow(2,re-1)),ge=_e.within(Ee[G*this.stride],Ee[G*this.stride+1],be),Pe=[];for(const rt of ge){const at=rt*this.stride;Ee[at+4]===H&&Pe.push(Ee[at+zi]>1?na(Ee,at,this.clusterProps):this.points[Ee[at+fn]])}if(0===Pe.length)throw new Error(de);return Pe}getLeaves(H,G,re){const de=[];return this._appendLeaves(de,H,G=G||10,re=re||0,0),de}getTile(H,G,re){const de=this.trees[this._limitZoom(H)],_e=Math.pow(2,H),{extent:Ee,radius:be}=this.options,ge=be/Ee,Pe=(re-ge)/_e,rt=(re+1+ge)/_e,at={features:[]};return this._addTileFeatures(de.range((G-ge)/_e,Pe,(G+1+ge)/_e,rt),de.data,G,re,_e,at),0===G&&this._addTileFeatures(de.range(1-ge/_e,Pe,1,rt),de.data,_e,re,_e,at),G===_e-1&&this._addTileFeatures(de.range(0,Pe,ge/_e,rt),de.data,-1,re,_e,at),at.features.length?at:null}getClusterExpansionZoom(H){let G=this._getOriginZoom(H)-1;for(;G<=this.options.maxZoom;){const re=this.getChildren(H);if(G++,1!==re.length)break;H=re[0].properties.cluster_id}return G}_appendLeaves(H,G,re,de,_e){const Ee=this.getChildren(G);for(const be of Ee){const ge=be.properties;if(ge&&ge.cluster?_e+ge.point_count<=de?_e+=ge.point_count:_e=this._appendLeaves(H,ge.cluster_id,re,de,_e):_e<de?_e++:H.push(be),H.length===re)break}return _e}_createTree(H){const G=new p.KDBush(H.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<H.length;re+=this.stride)G.add(H[re],H[re+1]);return G.finish(),G.data=H,G}_addTileFeatures(H,G,re,de,_e,Ee){for(const be of H){const ge=be*this.stride,Pe=G[ge+zi]>1;let rt,at,tt;if(Pe)rt=rr(G,ge,this.clusterProps),at=G[ge],tt=G[ge+1];else{const qt=this.points[G[ge+fn]];rt=qt.properties;const[rn,mn]=qt.geometry.coordinates;at=Ds(rn),tt=ts(mn)}const Ht={type:1,geometry:[[Math.round(this.options.extent*(at*_e-re)),Math.round(this.options.extent*(tt*_e-de))]],tags:rt};let Ot;Ot=Pe||this.options.generateId?G[ge+fn]:this.points[G[ge+fn]].id,void 0!==Ot&&(Ht.id=Ot),Ee.features.push(Ht)}}_limitZoom(H){return Math.max(this.options.minZoom,Math.min(Math.floor(+H),this.options.maxZoom+1))}_cluster(H,G){const{radius:re,extent:de,reduce:_e,minPoints:Ee}=this.options,be=re/(de*Math.pow(2,G)),ge=H.data,Pe=[],rt=this.stride;for(let at=0;at<ge.length;at+=rt){if(ge[at+2]<=G)continue;ge[at+2]=G;const tt=ge[at],Ht=ge[at+1],Ot=H.within(ge[at],ge[at+1],be),qt=ge[at+zi];let rn=qt;for(const mn of Ot){const si=mn*rt;ge[si+2]>G&&(rn+=ge[si+zi])}if(rn>qt&&rn>=Ee){let mn,si=tt*qt,Ai=Ht*qt,gr=-1;const Oi=((at/rt|0)<<5)+(G+1)+this.points.length;for(const Wi of Ot){const Zi=Wi*rt;if(ge[Zi+2]<=G)continue;ge[Zi+2]=G;const Vn=ge[Zi+zi];si+=ge[Zi]*Vn,Ai+=ge[Zi+1]*Vn,ge[Zi+4]=Oi,_e&&(mn||(mn=this._map(ge,at,!0),gr=this.clusterProps.length,this.clusterProps.push(mn)),_e(mn,this._map(ge,Zi)))}ge[at+4]=Oi,Pe.push(si/rn,Ai/rn,1/0,Oi,-1,rn),_e&&Pe.push(gr)}else{for(let mn=0;mn<rt;mn++)Pe.push(ge[at+mn]);if(rn>1)for(const mn of Ot){const si=mn*rt;if(!(ge[si+2]<=G)){ge[si+2]=G;for(let Ai=0;Ai<rt;Ai++)Pe.push(ge[si+Ai])}}}}return Pe}_getOriginId(H){return H-this.points.length>>5}_getOriginZoom(H){return(H-this.points.length)%32}_map(H,G,re){if(H[G+zi]>1){const Ee=this.clusterProps[H[G+ta]];return re?Object.assign({},Ee):Ee}const de=this.points[H[G+fn]].properties,_e=this.options.map(de);return re&&_e===de?Object.assign({},_e):_e}}function na(le,H,G){return{type:"Feature",id:le[H+fn],properties:rr(le,H,G),geometry:{type:"Point",coordinates:[(re=le[H],360*(re-.5)),pi(le[H+1])]}};var re}function rr(le,H,G){const re=le[H+zi],de=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,_e=le[H+ta],Ee=-1===_e?{}:Object.assign({},G[_e]);return Object.assign(Ee,{cluster:!0,cluster_id:le[H+fn],point_count:re,point_count_abbreviated:de})}function Ds(le){return le/360+.5}function ts(le){const H=Math.sin(le*Math.PI/180),G=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return G<0?0:G>1?1:G}function pi(le){const H=(180-360*le)*Math.PI/180;return 360*Math.atan(Math.exp(H))/Math.PI-90}function ei(le,H,G,re){for(var de,_e=re,Ee=G-H>>1,be=G-H,ge=le[H],Pe=le[H+1],rt=le[G],at=le[G+1],tt=H+3;tt<G;tt+=3){var Ht=_l(le[tt],le[tt+1],ge,Pe,rt,at);if(Ht>_e)de=tt,_e=Ht;else if(Ht===_e){var Ot=Math.abs(tt-Ee);Ot<be&&(de=tt,be=Ot)}}_e>re&&(de-H>3&&ei(le,H,de,re),le[de+2]=_e,G-de>3&&ei(le,de,G,re))}function _l(le,H,G,re,de,_e){var Ee=de-G,be=_e-re;if(0!==Ee||0!==be){var ge=((le-G)*Ee+(H-re)*be)/(Ee*Ee+be*be);ge>1?(G=de,re=_e):ge>0&&(G+=Ee*ge,re+=be*ge)}return(Ee=le-G)*Ee+(be=H-re)*be}function ht(le,H,G,re){var de={id:void 0===le?null:le,type:H,geometry:G,tags:re,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(_e){var Ee=_e.geometry,be=_e.type;if("Point"===be||"MultiPoint"===be||"LineString"===be)ia(_e,Ee);else if("Polygon"===be||"MultiLineString"===be)for(var ge=0;ge<Ee.length;ge++)ia(_e,Ee[ge]);else if("MultiPolygon"===be)for(ge=0;ge<Ee.length;ge++)for(var Pe=0;Pe<Ee[ge].length;Pe++)ia(_e,Ee[ge][Pe])}(de),de}function ia(le,H){for(var G=0;G<H.length;G+=3)le.minX=Math.min(le.minX,H[G]),le.minY=Math.min(le.minY,H[G+1]),le.maxX=Math.max(le.maxX,H[G]),le.maxY=Math.max(le.maxY,H[G+1])}function ho(le,H,G,re){if(H.geometry){var de=H.geometry.coordinates,_e=H.geometry.type,Ee=Math.pow(G.tolerance/((1<<G.maxZoom)*G.extent),2),be=[],ge=H.id;if(G.promoteId?ge=H.properties[G.promoteId]:G.generateId&&(ge=re||0),"Point"===_e)yl(de,be);else if("MultiPoint"===_e)for(var Pe=0;Pe<de.length;Pe++)yl(de[Pe],be);else if("LineString"===_e)ci(de,be,Ee,!1);else if("MultiLineString"===_e){if(G.lineMetrics){for(Pe=0;Pe<de.length;Pe++)ci(de[Pe],be=[],Ee,!1),le.push(ht(ge,"LineString",be,H.properties));return}So(de,be,Ee,!1)}else if("Polygon"===_e)So(de,be,Ee,!0);else{if("MultiPolygon"!==_e){if("GeometryCollection"===_e){for(Pe=0;Pe<H.geometry.geometries.length;Pe++)ho(le,{id:ge,geometry:H.geometry.geometries[Pe],properties:H.properties},G,re);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Pe=0;Pe<de.length;Pe++){var rt=[];So(de[Pe],rt,Ee,!0),be.push(rt)}}le.push(ht(ge,_e,be,H.properties))}}function yl(le,H){H.push(Wh(le[0])),H.push(ra(le[1])),H.push(0)}function ci(le,H,G,re){for(var de,_e,Ee=0,be=0;be<le.length;be++){var ge=Wh(le[be][0]),Pe=ra(le[be][1]);H.push(ge),H.push(Pe),H.push(0),be>0&&(Ee+=re?(de*Pe-ge*_e)/2:Math.sqrt(Math.pow(ge-de,2)+Math.pow(Pe-_e,2))),de=ge,_e=Pe}var rt=H.length-3;H[2]=1,ei(H,0,rt,G),H[rt+2]=1,H.size=Math.abs(Ee),H.start=0,H.end=H.size}function So(le,H,G,re){for(var de=0;de<le.length;de++){var _e=[];ci(le[de],_e,G,re),H.push(_e)}}function Wh(le){return le/360+.5}function ra(le){var H=Math.sin(le*Math.PI/180),G=.5-.25*Math.log((1+H)/(1-H))/Math.PI;return G<0?0:G>1?1:G}function po(le,H,G,re,de,_e,Ee,be){if(re/=H,_e>=(G/=H)&&Ee<re)return le;if(Ee<G||_e>=re)return null;for(var ge=[],Pe=0;Pe<le.length;Pe++){var rt=le[Pe],at=rt.geometry,tt=rt.type,Ht=0===de?rt.minX:rt.minY,Ot=0===de?rt.maxX:rt.maxY;if(Ht>=G&&Ot<re)ge.push(rt);else if(!(Ot<G||Ht>=re)){var qt=[];if("Point"===tt||"MultiPoint"===tt)yu(at,qt,G,re,de);else if("LineString"===tt)hc(at,qt,G,re,de,!1,be.lineMetrics);else if("MultiLineString"===tt)oa(at,qt,G,re,de,!1);else if("Polygon"===tt)oa(at,qt,G,re,de,!0);else if("MultiPolygon"===tt)for(var rn=0;rn<at.length;rn++){var mn=[];oa(at[rn],mn,G,re,de,!0),mn.length&&qt.push(mn)}if(qt.length){if(be.lineMetrics&&"LineString"===tt){for(rn=0;rn<qt.length;rn++)ge.push(ht(rt.id,tt,qt[rn],rt.tags));continue}"LineString"!==tt&&"MultiLineString"!==tt||(1===qt.length?(tt="LineString",qt=qt[0]):tt="MultiLineString"),"Point"!==tt&&"MultiPoint"!==tt||(tt=3===qt.length?"Point":"MultiPoint"),ge.push(ht(rt.id,tt,qt,rt.tags))}}}return ge.length?ge:null}function yu(le,H,G,re,de){for(var _e=0;_e<le.length;_e+=3){var Ee=le[_e+de];Ee>=G&&Ee<=re&&(H.push(le[_e]),H.push(le[_e+1]),H.push(le[_e+2]))}}function hc(le,H,G,re,de,_e,Ee){for(var be,ge,Pe=vu(le),rt=0===de?pc:Zh,at=le.start,tt=0;tt<le.length-3;tt+=3){var Ht=le[tt],Ot=le[tt+1],qt=le[tt+2],rn=le[tt+3],mn=le[tt+4],si=0===de?Ht:Ot,Ai=0===de?rn:mn,gr=!1;Ee&&(be=Math.sqrt(Math.pow(Ht-rn,2)+Math.pow(Ot-mn,2))),si<G?Ai>G&&(ge=rt(Pe,Ht,Ot,rn,mn,G),Ee&&(Pe.start=at+be*ge)):si>re?Ai<re&&(ge=rt(Pe,Ht,Ot,rn,mn,re),Ee&&(Pe.start=at+be*ge)):dc(Pe,Ht,Ot,qt),Ai<G&&si>=G&&(ge=rt(Pe,Ht,Ot,rn,mn,G),gr=!0),Ai>re&&si<=re&&(ge=rt(Pe,Ht,Ot,rn,mn,re),gr=!0),!_e&&gr&&(Ee&&(Pe.end=at+be*ge),H.push(Pe),Pe=vu(le)),Ee&&(at+=be)}var Oi=le.length-3;Ht=le[Oi],Ot=le[Oi+1],qt=le[Oi+2],(si=0===de?Ht:Ot)>=G&&si<=re&&dc(Pe,Ht,Ot,qt),Oi=Pe.length-3,_e&&Oi>=3&&(Pe[Oi]!==Pe[0]||Pe[Oi+1]!==Pe[1])&&dc(Pe,Pe[0],Pe[1],Pe[2]),Pe.length&&H.push(Pe)}function vu(le){var H=[];return H.size=le.size,H.start=le.start,H.end=le.end,H}function oa(le,H,G,re,de,_e){for(var Ee=0;Ee<le.length;Ee++)hc(le[Ee],H,G,re,de,_e,!1)}function dc(le,H,G,re){le.push(H),le.push(G),le.push(re)}function pc(le,H,G,re,de,_e){var Ee=(_e-H)/(re-H);return le.push(_e),le.push(G+(de-G)*Ee),le.push(1),Ee}function Zh(le,H,G,re,de,_e){var Ee=(_e-G)/(de-G);return le.push(H+(re-H)*Ee),le.push(_e),le.push(1),Ee}function to(le,H){for(var G=[],re=0;re<le.length;re++){var de,_e=le[re],Ee=_e.type;if("Point"===Ee||"MultiPoint"===Ee||"LineString"===Ee)de=sa(_e.geometry,H);else if("MultiLineString"===Ee||"Polygon"===Ee){de=[];for(var be=0;be<_e.geometry.length;be++)de.push(sa(_e.geometry[be],H))}else if("MultiPolygon"===Ee)for(de=[],be=0;be<_e.geometry.length;be++){for(var ge=[],Pe=0;Pe<_e.geometry[be].length;Pe++)ge.push(sa(_e.geometry[be][Pe],H));de.push(ge)}G.push(ht(_e.id,Ee,de,_e.tags))}return G}function sa(le,H){var G=[];G.size=le.size,void 0!==le.start&&(G.start=le.start,G.end=le.end);for(var re=0;re<le.length;re+=3)G.push(le[re]+H,le[re+1],le[re+2]);return G}function Au(le,H){if(le.transformed)return le;var G,re,de,_e=1<<le.z,Ee=le.x,be=le.y;for(G=0;G<le.features.length;G++){var ge=le.features[G],Pe=ge.geometry,rt=ge.type;if(ge.geometry=[],1===rt)for(re=0;re<Pe.length;re+=2)ge.geometry.push(vl(Pe[re],Pe[re+1],H,_e,Ee,be));else for(re=0;re<Pe.length;re++){var at=[];for(de=0;de<Pe[re].length;de+=2)at.push(vl(Pe[re][de],Pe[re][de+1],H,_e,Ee,be));ge.geometry.push(at)}}return le.transformed=!0,le}function vl(le,H,G,re,de,_e){return[Math.round(G*(le*re-de)),Math.round(G*(H*re-_e))]}function fc(le,H,G,re,de){for(var _e=H===de.maxZoom?0:de.tolerance/((1<<H)*de.extent),Ee={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:G,y:re,z:H,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},be=0;be<le.length;be++){Ee.numFeatures++,ko(Ee,le[be],_e,de);var ge=le[be].minX,Pe=le[be].minY,rt=le[be].maxX,at=le[be].maxY;ge<Ee.minX&&(Ee.minX=ge),Pe<Ee.minY&&(Ee.minY=Pe),rt>Ee.maxX&&(Ee.maxX=rt),at>Ee.maxY&&(Ee.maxY=at)}return Ee}function ko(le,H,G,re){var de=H.geometry,_e=H.type,Ee=[];if("Point"===_e||"MultiPoint"===_e)for(var be=0;be<de.length;be+=3)Ee.push(de[be]),Ee.push(de[be+1]),le.numPoints++,le.numSimplified++;else if("LineString"===_e)La(Ee,de,le,G,!1,!1);else if("MultiLineString"===_e||"Polygon"===_e)for(be=0;be<de.length;be++)La(Ee,de[be],le,G,"Polygon"===_e,0===be);else if("MultiPolygon"===_e)for(var ge=0;ge<de.length;ge++){var Pe=de[ge];for(be=0;be<Pe.length;be++)La(Ee,Pe[be],le,G,!0,0===be)}if(Ee.length){var rt=H.tags||null;if("LineString"===_e&&re.lineMetrics){for(var at in rt={},H.tags)rt[at]=H.tags[at];rt.mapbox_clip_start=de.start/de.size,rt.mapbox_clip_end=de.end/de.size}var tt={geometry:Ee,type:"Polygon"===_e||"MultiPolygon"===_e?3:"LineString"===_e||"MultiLineString"===_e?2:1,tags:rt};null!==H.id&&(tt.id=H.id),le.features.push(tt)}}function La(le,H,G,re,de,_e){var Ee=re*re;if(re>0&&H.size<(de?Ee:re))G.numPoints+=H.length/3;else{for(var be=[],ge=0;ge<H.length;ge+=3)(0===re||H[ge+2]>Ee)&&(G.numSimplified++,be.push(H[ge]),be.push(H[ge+1])),G.numPoints++;de&&function(Pe,rt){for(var at=0,tt=0,Ht=Pe.length,Ot=Ht-2;tt<Ht;Ot=tt,tt+=2)at+=(Pe[tt]-Pe[Ot])*(Pe[tt+1]+Pe[Ot+1]);if(at>0===rt)for(tt=0,Ht=Pe.length;tt<Ht/2;tt+=2){var qt=Pe[tt],rn=Pe[tt+1];Pe[tt]=Pe[Ht-2-tt],Pe[tt+1]=Pe[Ht-1-tt],Pe[Ht-2-tt]=qt,Pe[Ht-1-tt]=rn}}(be,_e),le.push(be)}}function Ba(le,H){var G=(H=this.options=function(de,_e){for(var Ee in _e)de[Ee]=_e[Ee];return de}(Object.create(this.options),H)).debug;if(G&&console.time("preprocess data"),H.maxZoom<0||H.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(H.promoteId&&H.generateId)throw new Error("promoteId and generateId cannot be used together.");var de,_e,Ee,be,ge,Pe,re=function(de,_e){var Ee=[];if("FeatureCollection"===de.type)for(var be=0;be<de.features.length;be++)ho(Ee,de.features[be],_e,be);else ho(Ee,"Feature"===de.type?de:{geometry:de},_e);return Ee}(le,H);this.tiles={},this.tileCoords=[],G&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",H.indexMaxZoom,H.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),be=de=re,ge=po(de,1,-1-(Ee=(_e=H).buffer/_e.extent),Ee,0,-1,2,_e),Pe=po(de,1,1-Ee,2+Ee,0,-1,2,_e),(ge||Pe)&&(be=po(de,1,-Ee,1+Ee,0,-1,2,_e)||[],ge&&(be=to(ge,1).concat(be)),Pe&&(be=be.concat(to(Pe,-1)))),(re=be).length&&this.splitTile(re,0,0,0),G&&(re.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Na(le,H,G){return 32*((1<<le)*G+H)+le}function Al(le,H){const G=le.tileID.canonical;if(!this._geoJSONIndex)return H(null,null);const re=this._geoJSONIndex.getTile(G.z,G.x,G.y);if(!re)return H(null,null);const de=new class{constructor(Ee){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=p.EXTENT,this.length=Ee.length,this._features=Ee}feature(Ee){return new class{constructor(be){this._feature=be,this.extent=p.EXTENT,this.type=be.type,this.properties=be.tags,"id"in be&&!isNaN(be.id)&&(this.id=parseInt(be.id,10))}loadGeometry(){if(1===this._feature.type){const be=[];for(const ge of this._feature.geometry)be.push([new p.Point(ge[0],ge[1])]);return be}{const be=[];for(const ge of this._feature.geometry){const Pe=[];for(const rt of ge)Pe.push(new p.Point(rt[0],rt[1]));be.push(Pe)}return be}}toGeoJSON(be,ge,Pe){return Mo.call(this,be,ge,Pe)}}(this._features[Ee])}}(re.features);let _e=Oa(de);0===_e.byteOffset&&_e.byteLength===_e.buffer.byteLength||(_e=new Uint8Array(_e)),H(null,{vectorTile:de,rawData:_e.buffer})}Ba.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ba.prototype.splitTile=function(le,H,G,re,de,_e,Ee){for(var be=[le,H,G,re],ge=this.options,Pe=ge.debug;be.length;){re=be.pop(),G=be.pop(),H=be.pop(),le=be.pop();var rt=1<<H,at=Na(H,G,re),tt=this.tiles[at];if(!tt&&(Pe>1&&console.time("creation"),tt=this.tiles[at]=fc(le,H,G,re,ge),this.tileCoords.push({z:H,x:G,y:re}),Pe)){Pe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",H,G,re,tt.numFeatures,tt.numPoints,tt.numSimplified),console.timeEnd("creation"));var Ht="z"+H;this.stats[Ht]=(this.stats[Ht]||0)+1,this.total++}if(tt.source=le,de){if(H===ge.maxZoom||H===de)continue;var Ot=1<<de-H;if(G!==Math.floor(_e/Ot)||re!==Math.floor(Ee/Ot))continue}else if(H===ge.indexMaxZoom||tt.numPoints<=ge.indexMaxPoints)continue;if(tt.source=null,0!==le.length){Pe>1&&console.time("clipping");var qt,rn,mn,si,Ai,gr,Oi=.5*ge.buffer/ge.extent,Wi=.5-Oi,Zi=.5+Oi,Vn=1+Oi;qt=rn=mn=si=null,Ai=po(le,rt,G-Oi,G+Zi,0,tt.minX,tt.maxX,ge),gr=po(le,rt,G+Wi,G+Vn,0,tt.minX,tt.maxX,ge),le=null,Ai&&(qt=po(Ai,rt,re-Oi,re+Zi,1,tt.minY,tt.maxY,ge),rn=po(Ai,rt,re+Wi,re+Vn,1,tt.minY,tt.maxY,ge),Ai=null),gr&&(mn=po(gr,rt,re-Oi,re+Zi,1,tt.minY,tt.maxY,ge),si=po(gr,rt,re+Wi,re+Vn,1,tt.minY,tt.maxY,ge),gr=null),Pe>1&&console.timeEnd("clipping"),be.push(qt||[],H+1,2*G,2*re),be.push(rn||[],H+1,2*G,2*re+1),be.push(mn||[],H+1,2*G+1,2*re),be.push(si||[],H+1,2*G+1,2*re+1)}}},Ba.prototype.getTile=function(le,H,G){var re=this.options,de=re.extent,_e=re.debug;if(le<0||le>24)return null;var Ee=1<<le,be=Na(le,H=(H%Ee+Ee)%Ee,G);if(this.tiles[be])return Au(this.tiles[be],de);_e>1&&console.log("drilling down to z%d-%d-%d",le,H,G);for(var ge,Pe=le,rt=H,at=G;!ge&&Pe>0;)Pe--,rt=Math.floor(rt/2),at=Math.floor(at/2),ge=this.tiles[Na(Pe,rt,at)];return ge&&ge.source?(_e>1&&console.log("found parent tile z%d-%d-%d",Pe,rt,at),_e>1&&console.time("drilling down"),this.splitTile(ge.source,Pe,rt,at,le,H,G),_e>1&&console.timeEnd("drilling down"),this.tiles[be]?Au(this.tiles[be],de):null):null};class xl extends p.VectorTileWorkerSource{constructor(H,G,re,de,_e){super(H,G,re,de,Al),_e&&(this.loadGeoJSON=_e)}loadData(H,G){const re=H&&H.request,de=re&&re.collectResourceTiming;this.loadGeoJSON(H,(_e,Ee)=>{if(_e||!Ee)return G(_e);if("object"!=typeof Ee)return G(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));{Rr(Ee,!0);try{if(H.filter){const ge=p.createExpression(H.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ge.result)throw new Error(ge.value.map(rt=>`${rt.key}: ${rt.message}`).join(", "));Ee={type:"FeatureCollection",features:Ee.features.filter(rt=>ge.value.evaluate({zoom:0},rt))}}this._geoJSONIndex=H.cluster?new Ii(function({superclusterOptions:ge,clusterProperties:Pe}){if(!Pe||!ge)return ge;const rt={},at={},tt={accumulated:null,zoom:0},Ht={properties:null},Ot=Object.keys(Pe);for(const qt of Ot){const[rn,mn]=Pe[qt],si=p.createExpression(mn),Ai=p.createExpression("string"==typeof rn?[rn,["accumulated"],["get",qt]]:rn);rt[qt]=si.value,at[qt]=Ai.value}return ge.map=qt=>{Ht.properties=qt;const rn={};for(const mn of Ot)rn[mn]=rt[mn].evaluate(tt,Ht);return rn},ge.reduce=(qt,rn)=>{Ht.properties=rn;for(const mn of Ot)tt.accumulated=qt[mn],qt[mn]=at[mn].evaluate(tt,Ht)},ge}(H)).load(Ee.features):new Ba(ge=Ee,H.geojsonVtOptions)}catch(ge){return G(ge)}this.loaded={};const be={};if(de){const ge=p.getPerformanceMeasurement(re);ge&&(be.resourceTiming={},be.resourceTiming[H.source]=JSON.parse(JSON.stringify(ge)))}G(null,be)}var ge})}reloadTile(H,G){const re=this.loaded;return re&&re[H.uid]?super.reloadTile(H,G):this.loadTile(H,G)}loadGeoJSON(H,G){if(H.request)p.getJSON(H.request,G);else{if("string"!=typeof H.data)return G(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`));try{return G(null,JSON.parse(H.data))}catch{return G(new Error(`Input data given to '${H.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(H,G){try{G(null,this._geoJSONIndex.getClusterExpansionZoom(H.clusterId))}catch(re){G(re)}}getClusterChildren(H,G){try{G(null,this._geoJSONIndex.getChildren(H.clusterId))}catch(re){G(re)}}getClusterLeaves(H,G){try{G(null,this._geoJSONIndex.getLeaves(H.clusterId,H.limit,H.offset))}catch(re){G(re)}}}class Qh{constructor(H){this.self=H,this.actor=new p.Actor(H,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=p.getProjection({name:"mercator"}),this.workerSourceTypes={vector:p.VectorTileWorkerSource,geojson:xl},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(G,re)=>{if(this.workerSourceTypes[G])throw new Error(`Worker source with name "${G}" already registered.`);this.workerSourceTypes[G]=re},this.self.registerRTLTextPlugin=G=>{if(p.plugin.isParsed())throw new Error("RTL text plugin already registered.");p.plugin.applyArabicShaping=G.applyArabicShaping,p.plugin.processBidirectionalText=G.processBidirectionalText,p.plugin.processStyledBidirectionalText=G.processStyledBidirectionalText}}clearCaches(H,G,re){delete this.layerIndexes[H],delete this.availableImages[H],delete this.workerSources[H],delete this.demWorkerSources[H],re()}checkIfReady(H,G,re){re()}setReferrer(H,G){this.referrer=G}spriteLoaded(H,G){this.isSpriteLoaded[H]=G;for(const re in this.workerSources[H]){const de=this.workerSources[H][re];for(const _e in de)de[_e]instanceof p.VectorTileWorkerSource&&(de[_e].isSpriteLoaded=G,de[_e].fire(new p.Event("isSpriteLoaded")))}}setImages(H,G,re){this.availableImages[H]=G;for(const de in this.workerSources[H]){const _e=this.workerSources[H][de];for(const Ee in _e)_e[Ee].availableImages=G}re()}enableTerrain(H,G,re){this.terrain=G,re()}setProjection(H,G){this.projections[H]=p.getProjection(G)}setLayers(H,G,re){this.getLayerIndex(H).replace(G),re()}updateLayers(H,G,re){this.getLayerIndex(H).update(G.layers,G.removedIds),re()}loadTile(H,G,re){const de=this.enableTerrain?p.extend({enableTerrain:this.terrain},G):G;de.projection=this.projections[H]||this.defaultProjection,this.getWorkerSource(H,G.type,G.source).loadTile(de,re)}loadDEMTile(H,G,re){const de=this.enableTerrain?p.extend({buildQuadTree:this.terrain},G):G;this.getDEMWorkerSource(H,G.source).loadTile(de,re)}reloadTile(H,G,re){const de=this.enableTerrain?p.extend({enableTerrain:this.terrain},G):G;de.projection=this.projections[H]||this.defaultProjection,this.getWorkerSource(H,G.type,G.source).reloadTile(de,re)}abortTile(H,G,re){this.getWorkerSource(H,G.type,G.source).abortTile(G,re)}removeTile(H,G,re){this.getWorkerSource(H,G.type,G.source).removeTile(G,re)}removeSource(H,G,re){if(!this.workerSources[H]||!this.workerSources[H][G.type]||!this.workerSources[H][G.type][G.source])return;const de=this.workerSources[H][G.type][G.source];delete this.workerSources[H][G.type][G.source],void 0!==de.removeSource?de.removeSource(G,re):re()}loadWorkerSource(H,G,re){try{this.self.importScripts(G.url),re()}catch(de){re(de.toString())}}syncRTLPluginState(H,G,re){try{p.plugin.setState(G);const de=p.plugin.getPluginURL();if(p.plugin.isLoaded()&&!p.plugin.isParsed()&&null!=de){this.self.importScripts(de);const _e=p.plugin.isParsed();re(_e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${de}`),_e)}}catch(de){re(de.toString())}}getAvailableImages(H){let G=this.availableImages[H];return G||(G=[]),G}getLayerIndex(H){let G=this.layerIndexes[H];return G||(G=this.layerIndexes[H]=new co),G}getWorkerSource(H,G,re){return this.workerSources[H]||(this.workerSources[H]={}),this.workerSources[H][G]||(this.workerSources[H][G]={}),this.workerSources[H][G][re]||(this.workerSources[H][G][re]=new this.workerSourceTypes[G]({send:(_e,Ee,be,ge,Pe,rt)=>{this.actor.send(_e,Ee,be,H,Pe,rt)},scheduler:this.actor.scheduler},this.getLayerIndex(H),this.getAvailableImages(H),this.isSpriteLoaded[H])),this.workerSources[H][G][re]}getDEMWorkerSource(H,G){return this.demWorkerSources[H]||(this.demWorkerSources[H]={}),this.demWorkerSources[H][G]||(this.demWorkerSources[H][G]=new Jt),this.demWorkerSources[H][G]}enforceCacheSizeLimit(H,G){p.enforceCacheSizeLimit(G)}getWorkerPerformanceMetrics(H,G,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Qh(self)),Qh}),$h(0,function(p){function je(f,a){if(Array.isArray(f)){if(!Array.isArray(a)||f.length!==a.length)return!1;for(let h=0;h<f.length;h++)if(!je(f[h],a[h]))return!1;return!0}if("object"==typeof f&&null!==f&&null!==a){if("object"!=typeof a||Object.keys(f).length!==Object.keys(a).length)return!1;for(const h in f)if(!je(f[h],a[h]))return!1;return!0}return f===a}var Yo=co;function co(f){return a=f,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,v,b=new Blob([""],{type:"text/javascript"}),T=URL.createObjectURL(b);try{v=new Worker(T),_=!0}catch{_=!1}return v&&v.terminate(),URL.revokeObjectURL(T),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var v=_.getContext("2d");if(!v)return!1;var b=v.getImageData(0,0,1,1);return b&&b.width===_.width}()||(void 0===Jt[h=a&&a.failIfMajorPerformanceCaveat]&&(Jt[h]=function(_){var v,T,M,k,b=(T=_,M=document.createElement("canvas"),(k=Object.create(co.webGLContextAttributes)).failIfMajorPerformanceCaveat=T,M.getContext("webgl",k)||M.getContext("experimental-webgl",k));if(!b)return!1;try{v=b.createShader(b.VERTEX_SHADER)}catch{return!1}return!(!v||b.isContextLost())&&(b.shaderSource(v,"void main() {}"),b.compileShader(v),!0===b.getShaderParameter(v,b.COMPILE_STATUS))}(h)),!Jt[h]||document.documentMode));var a,h}var Jt={};function Xt(f,a,h){const _=p.window.document.createElement(f);return void 0!==a&&(_.className=a),h&&h.appendChild(_),_}function Ni(f,a,h){const _=p.window.document.createElementNS("http://www.w3.org/2000/svg",f);for(const v of Object.keys(a))_.setAttributeNS(null,v,a[v]);return h&&h.appendChild(_),_}co.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Rr=p.window.document&&p.window.document.documentElement.style,Mo=Rr&&void 0!==Rr.userSelect?"userSelect":"WebkitUserSelect";let Ts;function cc(){Rr&&Mo&&(Ts=Rr[Mo],Rr[Mo]="none")}function gl(){Rr&&Mo&&(Rr[Mo]=Ts)}function eo(f){f.preventDefault(),f.stopPropagation(),p.window.removeEventListener("click",eo,!0)}function uo(){p.window.addEventListener("click",eo,!0),p.window.setTimeout(()=>{p.window.removeEventListener("click",eo,!0)},0)}function Wr(f,a){const h=f.getBoundingClientRect();return Do(f,h,a)}function Pa(f,a){const h=f.getBoundingClientRect(),_=[];for(let v=0;v<a.length;v++)_.push(Do(f,h,a[v]));return _}function Ms(f){return void 0!==p.window.InstallTrigger&&2===f.button&&f.ctrlKey&&p.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Do(f,a,h){const _=f.offsetWidth===a.width?1:f.offsetWidth/a.width;return new p.Point((h.clientX-a.left)*_,(h.clientY-a.top)*_)}function lt(f,a){var h=a[0],_=a[1],v=a[2],b=a[3],T=h*b-v*_;return T?(f[0]=b*(T=1/T),f[1]=-_*T,f[2]=-v*T,f[3]=h*T,f):null}function qh(f){const{userImage:a}=f;return!!(a&&a.render&&a.render())&&(f.data.replace(new Uint8Array(a.data.buffer)),!0)}class Ra extends p.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new p.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(a){if(this.loaded!==a&&(this.loaded=a,a)){for(const{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(a){return!!this.getImage(a)}getImage(a){return this.images[a]}addImage(a,h){this._validate(a,h)&&(this.images[a]=h)}_validate(a,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new p.ErrorEvent(new Error(`Image "${a}" has invalid "content" value`))),_=!1),_}_validateStretch(a,h){if(!a)return!0;let _=0;for(const v of a){if(v[0]<_||v[1]<v[0]||h<v[1])return!1;_=v[1]}return!0}_validateContent(a,h){return!(a&&(4!==a.length||a[0]<0||h.data.width<a[0]||a[1]<0||h.data.height<a[1]||a[2]<0||h.data.width<a[2]||a[3]<0||h.data.height<a[3]||a[2]<a[0]||a[3]<a[1]))}updateImage(a,h){h.version=this.images[a].version+1,this.images[a]=h,this.updatedImages[a]=!0}removeImage(a){const h=this.images[a];delete this.images[a],delete this.patterns[a],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(a,h){let _=!0;if(!this.isLoaded())for(const v of a)this.images[v]||(_=!1);this.isLoaded()||_?this._notify(a,h):this.requestors.push({ids:a,callback:h})}_notify(a,h){const _={};for(const v of a){this.images[v]||this.fire(new p.Event("styleimagemissing",{id:v}));const b=this.images[v];b?_[v]={data:b.data.clone(),pixelRatio:b.pixelRatio,sdf:b.sdf,version:b.version,stretchX:b.stretchX,stretchY:b.stretchY,content:b.content,hasRenderCallback:Boolean(b.userImage&&b.userImage.render)}:p.warnOnce(`Image "${v}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){const{width:a,height:h}=this.atlasImage;return{width:a,height:h}}getPattern(a){const h=this.patterns[a],_=this.getImage(a);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{const v={w:_.data.width+2,h:_.data.height+2,x:0,y:0},b=new p.ImagePosition(v,_);this.patterns[a]={bin:v,position:b}}return this._updatePatternAtlas(),this.patterns[a].position}bind(a){const h=a.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new p.Texture(a,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const a=[];for(const b in this.patterns)a.push(this.patterns[b].bin);const{w:h,h:_}=p.potpack(a),v=this.atlasImage;v.resize({width:h||1,height:_||1});for(const b in this.patterns){const{bin:T}=this.patterns[b],M=T.x+1,k=T.y+1,F=this.images[b].data,O=F.width,z=F.height;p.RGBAImage.copy(F,v,{x:0,y:0},{x:M,y:k},{width:O,height:z}),p.RGBAImage.copy(F,v,{x:0,y:z-1},{x:M,y:k-1},{width:O,height:1}),p.RGBAImage.copy(F,v,{x:0,y:0},{x:M,y:k+z},{width:O,height:1}),p.RGBAImage.copy(F,v,{x:O-1,y:0},{x:M-1,y:k},{width:1,height:z}),p.RGBAImage.copy(F,v,{x:0,y:0},{x:M+O,y:k},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(a){for(const h of a){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const _=this.images[h];qh(_)&&this.updateImage(h,_)}}}const sn=new p.Properties({anchor:new p.DataConstantProperty(p.spec.light.anchor),position:new class{constructor(){this.specification=p.spec.light.position}possiblyEvaluate(f,a){return function([h,_,v]){const b=p.degToRad(_+90),T=p.degToRad(v);return{x:h*Math.cos(b)*Math.sin(T),y:h*Math.sin(b)*Math.sin(T),z:h*Math.cos(T),azimuthal:_,polar:v}}(f.expression.evaluate(a))}interpolate(f,a,h){return{x:p.number(f.x,a.x,h),y:p.number(f.y,a.y,h),z:p.number(f.z,a.z,h),azimuthal:p.number(f.azimuthal,a.azimuthal,h),polar:p.number(f.polar,a.polar,h)}}},color:new p.DataConstantProperty(p.spec.light.color),intensity:new p.DataConstantProperty(p.spec.light.intensity)});class qi extends p.Evented{constructor(a){super(),this._transitionable=new p.Transitionable(sn),this.setLight(a),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(a,h={}){if(!this._validate(p.validateLight,a,h))for(const _ in a){const v=a[_];p.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),v):this._transitionable.setValue(_,v)}}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,h,_){return(!_||!1!==_.validate)&&p.emitValidationErrors(this,a.call(p.validateStyle,p.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}const uc=new p.Properties({source:new p.DataConstantProperty(p.spec.terrain.source),exaggeration:new p.DataConstantProperty(p.spec.terrain.exaggeration)});let _u=class extends p.Evented{constructor(f,a){super(),this._transitionable=new p.Transitionable(uc),this.set(f),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=a}get(){return this._transitionable.serialize()}set(f){for(const a in f){const h=f[a];p.endsWith(a,"-transition")?this._transitionable.setTransition(a.slice(0,-11),h):this._transitionable.setValue(a,h)}}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}};function Oa(f,a,h,_){const v=p.smoothstep(45,65,h),[b,T]=es(f,_),M=p.length(a);let k=1-Math.min(1,Math.exp((M-b)/(T-b)*-6));return k*=k*k,k=Math.min(1,1.00747*k),k*v*f.alpha}function es(f,a){const h=.5/Math.tan(.5*a);return[f.range[0]+h,f.range[1]+h]}const un=new p.Properties({range:new p.DataConstantProperty(p.spec.fog.range),color:new p.DataConstantProperty(p.spec.fog.color),"high-color":new p.DataConstantProperty(p.spec.fog["high-color"]),"space-color":new p.DataConstantProperty(p.spec.fog["space-color"]),"horizon-blend":new p.DataConstantProperty(p.spec.fog["horizon-blend"]),"star-intensity":new p.DataConstantProperty(p.spec.fog["star-intensity"])});class Fa extends p.Evented{constructor(a,h){super(),this._transitionable=new p.Transitionable(un),this.set(a),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const a=this._transform,h="globe"===a.projection.name,_=p.globeToMercatorTransition(a.zoom),v=this.properties.get("range"),b=[.5,3];return{range:h?[p.number(b[0],v[0],_),p.number(b[1],v[1],_)]:v,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(a,h={}){if(!this._validate(p.validateFog,a,h)){for(const _ of Object.keys(p.spec.fog))a&&void 0===a[_]&&(a[_]=p.spec.fog[_].default);for(const _ in a){const v=a[_];p.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),v):this._transitionable.setValue(_,v)}}}getOpacity(a){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:p.smoothstep(45,65,a))*h.a}getOpacityAtLatLng(a,h){return this._transform.projection.supportsFog?function(_,v,b){const T=p.MercatorCoordinate.fromLngLat(v),M=b.elevation?b.elevation.getAtPointOrZero(T):0,k=[T.x,T.y,M];return p.transformMat4(k,k,b.mercatorFogMatrix),Oa(_,k,b.pitch,b._fov)}(this.state,a,h):0}getFovAdjustedRange(a){return this._transform.projection.supportsFog?es(this.state,a):[0,1]}updateTransitions(a){this._transitioning=this._transitionable.transitioned(a,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(a){this.properties=this._transitioning.possiblyEvaluate(a)}_validate(a,h,_){return(!_||!1!==_.validate)&&p.emitValidationErrors(this,a.call(p.validateStyle,p.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:p.spec})))}}class fn{constructor(a,h){this.workerPool=a,this.actors=[],this.currentActor=0,this.id=p.uniqueId();const _=this.workerPool.acquire(this.id);for(let v=0;v<_.length;v++){const b=new fn.Actor(_[v],h,this.id);b.name=`Worker ${v}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(a,h,_){p.asyncAll(this.actors,(v,b)=>{v.send(a,h,b)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(a=>{a.remove()}),this.actors=[],this.workerPool.release(this.id)}}function zi(f,a,h){return a*(p.EXTENT/(f.tileSize*Math.pow(2,h-f.tileID.overscaledZ)))}fn.Actor=p.Actor;class ta{constructor(a,h,_,v){this.screenBounds=a,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,v)}static createFromScreenPoints(a,h){let _,v;if(a instanceof p.Point||"number"==typeof a[0]){const b=p.Point.convert(a);_=[b],v=h.isPointAboveHorizon(b)}else{const b=p.Point.convert(a[0]),T=p.Point.convert(a[1]);_=[b,T],v=p.polygonizeBounds(b,T).every(M=>h.isPointAboveHorizon(M))}return new ta(_,h.getCameraPoint(),v,h)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(a){return p.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],a)}bufferedCameraGeometry(a){const h=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new p.Point(1,1)):this.screenBounds[1],v=p.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?v.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?v[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(v[3]=this.cameraPoint)),p.bufferConvexPolygon(v,a)}bufferedCameraGeometryGlobe(a){const h=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new p.Point(1,1)):this.screenBounds[1],v=p.polygonizeBounds(h,_,a),b=this.cameraPoint.clone();switch(3*((b.y>h.y)+(b.y>_.y))+((b.x>h.x)+(b.x>_.x))){case 0:v[0]=b,v[4]=b.clone();break;case 1:v.splice(1,0,b);break;case 2:v[1]=b;break;case 3:v.splice(4,0,b);break;case 5:v.splice(2,0,b);break;case 6:v[3]=b;break;case 7:v.splice(3,0,b);break;case 8:v[2]=b}return v}containsTile(a,h,_,v=0){const b=a.queryPadding/h._pixelsPerMercatorPixel+1,T=_?this._bufferedCameraMercator(b,h):this._bufferedScreenMercator(b,h);let M=a.tileID.wrap+(T.unwrapped?v:0);const k=T.polygon.map(ee=>p.getTilePoint(a.tileTransform,ee,M));if(!p.polygonIntersectsBox(k,0,0,p.EXTENT,p.EXTENT))return;M=a.tileID.wrap+(this.screenGeometryMercator.unwrapped?v:0);const F=this.screenGeometryMercator.polygon.map(ee=>p.getTileVec3(a.tileTransform,ee,M)),O=F.map(ee=>new p.Point(ee[0],ee[1])),z=h.getFreeCameraOptions().position||new p.MercatorCoordinate(0,0,0),$=p.getTileVec3(a.tileTransform,z,M),Q=F.map(ee=>{const V=p.sub(ee,ee,$);return p.normalize(V,V),new p.Ray($,V)}),K=zi(a,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:Q,bufferedTilespaceGeometry:k,bufferedTilespaceBounds:(X=p.getBounds(k),X.min.x=p.clamp(X.min.x,0,p.EXTENT),X.min.y=p.clamp(X.min.y,0,p.EXTENT),X.max.x=p.clamp(X.max.x,0,p.EXTENT),X.max.y=p.clamp(X.max.y,0,p.EXTENT),X),tile:a,tileID:a.tileID,pixelToTileUnitsFactor:K};var X}_bufferedScreenMercator(a,h){const _=rr(a);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let v;return v="globe"===h.projection.name?this._projectAndResample(this.bufferedScreenGeometry(a),h):{polygon:this.bufferedScreenGeometry(a).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._screenRaycastCache[_]=v,v}}_bufferedCameraMercator(a,h){const _=rr(a);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let v;return v="globe"===h.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(a),h):{polygon:this.bufferedCameraGeometry(a).map(b=>h.pointCoordinate3D(b)),unwrapped:!0},this._cameraRaycastCache[_]=v,v}}_projectAndResample(a,h){const _=function(b,T){const M=p.multiply([],T.pixelMatrix,T.globeMatrix),k=[0,-p.GLOBE_RADIUS,0,1],F=[0,p.GLOBE_RADIUS,0,1],O=[0,0,0,1];p.transformMat4$1(k,k,M),p.transformMat4$1(F,F,M),p.transformMat4$1(O,O,M);const z=new p.Point(k[0]/k[3],k[1]/k[3]),$=new p.Point(F[0]/F[3],F[1]/F[3]),Q=p.polygonContainsPoint(b,z)&&k[3]<O[3],K=p.polygonContainsPoint(b,$)&&F[3]<O[3];if(!Q&&!K)return null;const X=function(fe,ve,ye){for(let Me=1;Me<fe.length;Me++){const Ze=na(ve.pointCoordinate3D(fe[Me-1]).x),Ce=na(ve.pointCoordinate3D(fe[Me]).x);if(ye<0){if(Ze<Ce)return{idx:Me,t:-Ze/(Ce-1-Ze)}}else if(Ce<Ze)return{idx:Me,t:(1-Ze)/(Ce+1-Ze)}}return null}(b,T,Q?-1:1);if(!X)return null;const{idx:ee,t:V}=X;let W=ee>1?Ii(b.slice(0,ee),T):[],ie=ee<b.length?Ii(b.slice(ee),T):[];W=W.map(fe=>new p.Point(na(fe.x),fe.y)),ie=ie.map(fe=>new p.Point(na(fe.x),fe.y));const te=[...W];0===te.length&&te.push(ie[ie.length-1]);const pe=p.number(te[te.length-1].y,(0===ie.length?W[0]:ie[0]).y,V);let me;return me=Q?[new p.Point(0,pe),new p.Point(0,0),new p.Point(1,0),new p.Point(1,pe)]:[new p.Point(1,pe),new p.Point(1,1),new p.Point(0,1),new p.Point(0,pe)],te.push(...me),0===ie.length?te.push(W[0]):te.push(...ie),{polygon:te.map(fe=>new p.MercatorCoordinate(fe.x,fe.y)),unwrapped:!1}}(a,h);if(_)return _;const v=function(b,T){let M=!1,k=-1/0,F=0;for(let z=0;z<b.length-1;z++)b[z].x>k&&(k=b[z].x,F=z);for(let z=0;z<b.length-1;z++){const $=(F+z)%(b.length-1),Q=b[$],K=b[$+1];Math.abs(Q.x-K.x)>.5&&(Q.x<K.x?(Q.x+=1,0===$&&(b[b.length-1].x+=1)):(K.x+=1,$+1===b.length-1&&(b[0].x+=1)),M=!0)}const O=p.mercatorXfromLng(T.center.lng);return M&&O<Math.abs(O-1)&&b.forEach(z=>{z.x-=1}),{polygon:b,unwrapped:M}}(Ii(a,h).map(b=>new p.Point(na(b.x),b.y)),h);return{polygon:v.polygon.map(b=>new p.MercatorCoordinate(b.x,b.y)),unwrapped:v.unwrapped}}}function Ii(f,a){return p.resample(f,h=>{const _=a.pointCoordinate3D(h);h.x=_.x,h.y=_.y},1/256)}function na(f){return f<0?1+f%1:f%1}function rr(f){return 100*f|0}function Ds(f,a,h,_,v){const b=function(T,M){if(T)return v(T);if(M){f.url&&M.tiles&&f.tiles&&delete f.tiles;const k=p.pick(p.extend(M,f),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);M.vector_layers&&(k.vectorLayers=M.vector_layers,k.vectorLayerIds=k.vectorLayers.map(F=>F.id)),k.tiles=a.canonicalizeTileset(k,f.url),v(null,k)}};return f.url?p.getJSON(a.transformRequest(a.normalizeSourceURL(f.url,null,h,_),p.ResourceType.Source),b):p.exported.frame(()=>b(null,f))}class ts{constructor(a,h,_){this.bounds=p.LngLatBounds.convert(this.validateBounds(a)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(a){return Array.isArray(a)&&4===a.length?[Math.max(-180,a[0]),Math.max(-90,a[1]),Math.min(180,a[2]),Math.min(90,a[3])]:[-180,-90,180,90]}contains(a){const h=Math.pow(2,a.z),_=Math.floor(p.mercatorXfromLng(this.bounds.getWest())*h),v=Math.floor(p.mercatorYfromLat(this.bounds.getNorth())*h),b=Math.ceil(p.mercatorXfromLng(this.bounds.getEast())*h),T=Math.ceil(p.mercatorYfromLat(this.bounds.getSouth())*h);return a.x>=_&&a.x<b&&a.y>=v&&a.y<T}}class pi{constructor(a,h,_){this.context=a;const v=a.gl;this.buffer=v.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),a.bindElementBuffer.set(this.buffer),v.bufferData(v.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?v.DYNAMIC_DRAW:v.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(a){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,a.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ei={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class _l{constructor(a,h,_,v){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=v,this.context=a;const b=a.gl;this.buffer=b.createBuffer(),a.bindVertexBuffer.set(this.buffer),b.bufferData(b.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(a){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,a.arrayBuffer)}enableAttributes(a,h){for(let _=0;_<this.attributes.length;_++){const v=h.attributes[this.attributes[_].name];void 0!==v&&a.enableVertexAttribArray(v)}}setVertexAttribPointers(a,h,_){for(let v=0;v<this.attributes.length;v++){const b=this.attributes[v],T=h.attributes[b.name];void 0!==T&&a.vertexAttribPointer(T,b.components,a[ei[b.type]],!1,this.itemSize,b.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class ht{constructor(a){this.gl=a.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(a){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ia extends ht{getDefault(){return p.Color.transparent}set(a){const h=this.current;(a.r!==h.r||a.g!==h.g||a.b!==h.b||a.a!==h.a||this.dirty)&&(this.gl.clearColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class ho extends ht{getDefault(){return 1}set(a){(a!==this.current||this.dirty)&&(this.gl.clearDepth(a),this.current=a,this.dirty=!1)}}class yl extends ht{getDefault(){return 0}set(a){(a!==this.current||this.dirty)&&(this.gl.clearStencil(a),this.current=a,this.dirty=!1)}}class ci extends ht{getDefault(){return[!0,!0,!0,!0]}set(a){const h=this.current;(a[0]!==h[0]||a[1]!==h[1]||a[2]!==h[2]||a[3]!==h[3]||this.dirty)&&(this.gl.colorMask(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class So extends ht{getDefault(){return!0}set(a){(a!==this.current||this.dirty)&&(this.gl.depthMask(a),this.current=a,this.dirty=!1)}}class Wh extends ht{getDefault(){return 255}set(a){(a!==this.current||this.dirty)&&(this.gl.stencilMask(a),this.current=a,this.dirty=!1)}}class ra extends ht{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(a){const h=this.current;(a.func!==h.func||a.ref!==h.ref||a.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(a.func,a.ref,a.mask),this.current=a,this.dirty=!1)}}class po extends ht{getDefault(){const a=this.gl;return[a.KEEP,a.KEEP,a.KEEP]}set(a){const h=this.current;(a[0]!==h[0]||a[1]!==h[1]||a[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(a[0],a[1],a[2]),this.current=a,this.dirty=!1)}}class yu extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;a?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=a,this.dirty=!1}}class hc extends ht{getDefault(){return[0,1]}set(a){const h=this.current;(a[0]!==h[0]||a[1]!==h[1]||this.dirty)&&(this.gl.depthRange(a[0],a[1]),this.current=a,this.dirty=!1)}}class vu extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;a?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=a,this.dirty=!1}}class oa extends ht{getDefault(){return this.gl.LESS}set(a){(a!==this.current||this.dirty)&&(this.gl.depthFunc(a),this.current=a,this.dirty=!1)}}class dc extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;a?h.enable(h.BLEND):h.disable(h.BLEND),this.current=a,this.dirty=!1}}class pc extends ht{getDefault(){const a=this.gl;return[a.ONE,a.ZERO]}set(a){const h=this.current;(a[0]!==h[0]||a[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(a[0],a[1]),this.current=a,this.dirty=!1)}}class Zh extends ht{getDefault(){return p.Color.transparent}set(a){const h=this.current;(a.r!==h.r||a.g!==h.g||a.b!==h.b||a.a!==h.a||this.dirty)&&(this.gl.blendColor(a.r,a.g,a.b,a.a),this.current=a,this.dirty=!1)}}class to extends ht{getDefault(){return this.gl.FUNC_ADD}set(a){(a!==this.current||this.dirty)&&(this.gl.blendEquation(a),this.current=a,this.dirty=!1)}}class sa extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;a?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=a,this.dirty=!1}}class Au extends ht{getDefault(){return this.gl.BACK}set(a){(a!==this.current||this.dirty)&&(this.gl.cullFace(a),this.current=a,this.dirty=!1)}}class vl extends ht{getDefault(){return this.gl.CCW}set(a){(a!==this.current||this.dirty)&&(this.gl.frontFace(a),this.current=a,this.dirty=!1)}}let fc,ko=class extends ht{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class La extends ht{getDefault(){return this.gl.TEXTURE0}set(a){(a!==this.current||this.dirty)&&(this.gl.activeTexture(a),this.current=a,this.dirty=!1)}}class Ba extends ht{getDefault(){const a=this.gl;return[0,0,a.drawingBufferWidth,a.drawingBufferHeight]}set(a){const h=this.current;(a[0]!==h[0]||a[1]!==h[1]||a[2]!==h[2]||a[3]!==h[3]||this.dirty)&&(this.gl.viewport(a[0],a[1],a[2],a[3]),this.current=a,this.dirty=!1)}}class Na extends ht{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,a),this.current=a,this.dirty=!1}}class Al extends ht{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class xl extends ht{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,a),this.current=a,this.dirty=!1}}class Qh extends ht{getDefault(){return null}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class le extends ht{getDefault(){return null}set(a){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,a),this.current=a,this.dirty=!1}}class H extends ht{constructor(a){super(a),this.vao=a.extVertexArrayObject}getDefault(){return null}set(a){this.vao&&(a!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(a),this.current=a,this.dirty=!1)}}class G extends ht{getDefault(){return 4}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,a),this.current=a,this.dirty=!1}}class re extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a),this.current=a,this.dirty=!1}}class de extends ht{getDefault(){return!1}set(a){if(a===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,a),this.current=a,this.dirty=!1}}class _e extends ht{constructor(a,h){super(a),this.context=a,this.parent=h}getDefault(){return null}}class Ee extends _e{setDirty(){this.dirty=!0}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,a,0),this.current=a,this.dirty=!1}}class be extends _e{attachment(){return this.gl.DEPTH_ATTACHMENT}set(a){if(a===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,a),this.current=a,this.dirty=!1}}class ge extends be{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Pe{constructor(a,h,_,v){this.context=a,this.width=h,this.height=_;const b=this.framebuffer=a.gl.createFramebuffer();this.colorAttachment=new Ee(a,b),v&&(this.depthAttachment=new be(a,b))}destroy(){const a=this.context.gl,h=this.colorAttachment.get();if(h&&a.deleteTexture(h),this.depthAttachment){const _=this.depthAttachment.get();_&&a.deleteRenderbuffer(_)}a.deleteFramebuffer(this.framebuffer)}}class rt{constructor(a,h=!1){if(this.gl=a,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const _=a;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(a),deleteVertexArrayOES:_.deleteVertexArray.bind(a),bindVertexArrayOES:_.bindVertexArray.bind(a)}}this.clearColor=new ia(this),this.clearDepth=new ho(this),this.clearStencil=new yl(this),this.colorMask=new ci(this),this.depthMask=new So(this),this.stencilMask=new Wh(this),this.stencilFunc=new ra(this),this.stencilOp=new po(this),this.stencilTest=new yu(this),this.depthRange=new hc(this),this.depthTest=new vu(this),this.depthFunc=new oa(this),this.blend=new dc(this),this.blendFunc=new pc(this),this.blendColor=new Zh(this),this.blendEquation=new to(this),this.cullFace=new sa(this),this.cullFaceSide=new Au(this),this.frontFace=new vl(this),this.program=new ko(this),this.activeTexture=new La(this),this.viewport=new Ba(this),this.bindFramebuffer=new Na(this),this.bindRenderbuffer=new Al(this),this.bindTexture=new xl(this),this.bindVertexBuffer=new Qh(this),this.bindElementBuffer=new le(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new H(this),this.pixelStoreUnpack=new G(this),this.pixelStoreUnpackPremultiplyAlpha=new re(this),this.pixelStoreUnpackFlipY=new de(this),this.extTextureFilterAnisotropic=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=a.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=a.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=a.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=a.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=a.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&a.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=a.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||a.getExtension("OES_standard_derivatives"),this.extTimerQuery=a.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=a.getParameter(a.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(a,h){return new pi(this,a,h)}createVertexBuffer(a,h,_){return new _l(this,a,h,_)}createRenderbuffer(a,h,_){const v=this.gl,b=v.createRenderbuffer();return this.bindRenderbuffer.set(b),v.renderbufferStorage(v.RENDERBUFFER,a,h,_),this.bindRenderbuffer.set(null),b}createFramebuffer(a,h,_){return new Pe(this,a,h,_)}clear({color:a,depth:h,stencil:_}){const v=this.gl;let b=0;a&&(b|=v.COLOR_BUFFER_BIT,this.clearColor.set(a),this.colorMask.set([!0,!0,!0,!0])),void 0!==h&&(b|=v.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),void 0!==_&&(b|=v.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),v.clear(b)}setCullFace(a){!1===a.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(a.mode),this.frontFace.set(a.frontFace))}setDepthMode(a){a.func!==this.gl.ALWAYS||a.mask?(this.depthTest.set(!0),this.depthFunc.set(a.func),this.depthMask.set(a.mask),this.depthRange.set(a.range)):this.depthTest.set(!1)}setStencilMode(a){a.test.func!==this.gl.ALWAYS||a.mask?(this.stencilTest.set(!0),this.stencilMask.set(a.mask),this.stencilOp.set([a.fail,a.depthFail,a.pass]),this.stencilFunc.set({func:a.test.func,ref:a.ref,mask:a.test.mask})):this.stencilTest.set(!1)}setColorMode(a){je(a.blendFunction,p.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(a.blendFunction),this.blendColor.set(a.blendColor)),this.colorMask.set(a.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class at extends p.Evented{constructor(a,h,_,v){if(super(),this.id=a,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,p.extend(this,p.pick(h,["url","scheme","tileSize","promoteId"])),this._options=p.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(v),this._tileWorkers={},this._deduped=new p.DedupedRequest}load(a){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=Ds(this._options,this.map._requestManager,h,_,(v,b)=>{this._tileJSONRequest=null,this._loaded=!0,v?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&2!==_.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new p.ErrorEvent(v))):b&&(p.extend(this,b),b.bounds&&(this.tileBounds=new ts(b.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(b.tiles,this.map._requestManager._customAccessToken),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))),a&&a(v)})}loaded(){return this._loaded}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return p.extend({},this._options)}loadTile(a,h){const _=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme)),v={request:this.map._requestManager.transformRequest(_,p.ResourceType.Tile),data:void 0,uid:a.uid,tileID:a.tileID,tileZoom:a.tileZoom,zoom:a.tileID.overscaledZ,tileSize:this.tileSize*a.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:a.isSymbolTile};if(v.request.collectResourceTiming=this._collectResourceTiming,a.actor&&"expired"!==a.state)"loading"===a.state?a.reloadCallback=h:a.request=a.actor.send("reloadTile",v,b.bind(this));else if(a.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)a.request=a.actor.send("loadTile",v,b.bind(this),void 0,!0);else{const T=p.loadVectorTile.call({deduped:this._deduped},v,(M,k)=>{M||!k?b.call(this,M):(v.data={cacheControl:k.cacheControl,expires:k.expires,rawData:k.rawData.slice(0)},a.actor&&a.actor.send("loadTile",v,b.bind(this),void 0,!0))},!0);a.request={cancel:T}}function b(T,M){return delete a.request,a.aborted?h(null):T&&404!==T.status?h(T):(M&&M.resourceTiming&&(a.resourceTiming=M.resourceTiming),this.map._refreshExpiredTiles&&M&&a.setExpiryData(M),a.loadVectorData(M,this.map.painter),p.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(a.reloadCallback&&(this.loadTile(a,a.reloadCallback),a.reloadCallback=null)))}}abortTile(a){a.request&&(a.request.cancel(),delete a.request),a.actor&&a.actor.send("abortTile",{uid:a.uid,type:this.type,source:this.id})}unloadTile(a){a.unloadVectorData(),a.actor&&a.actor.send("removeTile",{uid:a.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class tt extends p.Evented{constructor(a,h,_,v){super(),this.id=a,this.dispatcher=_,this.setEventedParent(v),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=p.extend({type:"raster"},h),p.extend(this,p.pick(h,["url","scheme","tileSize"]))}load(a){this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Ds(this._options,this.map._requestManager,null,null,(h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new p.ErrorEvent(h)):_&&(p.extend(this,_),_.bounds&&(this.tileBounds=new ts(_.bounds,this.minzoom,this.maxzoom)),p.postTurnstileEvent(_.tiles),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))),a&&a(h)})}loaded(){return this._loaded}onAdd(a){this.map=a,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(a){return this._options.tiles=a,this.reload(),this}setUrl(a){return this.url=a,this._options.url=a,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return p.extend({},this._options)}hasTile(a){return!this.tileBounds||this.tileBounds.contains(a.canonical)}loadTile(a,h){const _=p.exported.devicePixelRatio>=2,v=this.map._requestManager.normalizeTileURL(a.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);a.request=p.getImage(this.map._requestManager.transformRequest(v,p.ResourceType.Tile),(b,T,M,k)=>(delete a.request,a.aborted?(a.state="unloaded",h(null)):b?(a.state="errored",h(b)):T?(this.map._refreshExpiredTiles&&a.setExpiryData({cacheControl:M,expires:k}),a.setTexture(T,this.map.painter),a.state="loaded",p.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null)))}static loadTileData(a,h,_){a.setTexture(h,_)}static unloadTileData(a,h){a.texture&&h.saveTileTexture(a.texture)}abortTile(a,h){a.request&&(a.request.cancel(),delete a.request),h()}unloadTile(a,h){a.texture&&this.map.painter.saveTileTexture(a.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Ht(f,a,h,_,v,b,T,M){const k=[f,h,v,a,_,b,1,1,1],F=[T,M,1],O=p.adjoint([],k),[z,$,Q]=p.transformMat3(F,F,p.transpose(O,O));return p.multiply$1(k,[z,0,0,0,$,0,0,0,Q],k)}class Ot extends p.Evented{constructor(a,h,_,v){super(),this.id=a,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(v),this.options=h,this._dirty=!1}load(a,h){this._loaded=h||!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=p.getImage(this.map._requestManager.transformRequest(this.url,p.ResourceType.Image),(_,v)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new p.ErrorEvent(_));else if(v){const{HTMLImageElement:b}=p.window;this.image=v instanceof b?p.exported.getImageData(v):v,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,a&&(this.coordinates=a),this._finishLoading()}})}loaded(){return this._loaded}updateImage(a){return this.image&&a.url?(this._imageRequest&&a.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=a.url,this.load(a.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(a){this.map=a,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(a){this.coordinates=a,this._boundsArray=void 0;const h=a.map(p.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let v=1/0,b=1/0,T=-1/0,M=-1/0;for(const z of _)v=Math.min(v,z.x),b=Math.min(b,z.y),T=Math.max(T,z.x),M=Math.max(M,z.y);const k=Math.max(T-v,M-b),F=Math.max(0,Math.floor(-Math.log(k)/Math.LN2)),O=Math.pow(2,F);return new p.CanonicalTileID(F,Math.floor((v+T)/2*O),Math.floor((b+M)/2*O))}(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(a){for(const k in this.tiles){const F=this.tiles[k];"loaded"!==F.state&&(F.state="loaded",F.texture=this.texture)}if(this._boundsArray)return;const h=p.tileTransform(this.tileID,this.map.transform.projection),[_,v,b,T]=this.coordinates.map(k=>{const F=h.projection.project(k[0],k[1]);return p.getTilePoint(h,F)._round()});this.perspectiveTransform=function(k,F,O,z,$,Q,K,X,ee,V){const W=Ht(0,0,k,0,0,F,k,F),ie=Ht(O,z,$,Q,K,X,ee,V);return p.multiply$1(ie,p.adjoint(W,W),ie),[ie[6]/ie[8]*k/p.EXTENT,ie[7]/ie[8]*F/p.EXTENT]}(this.width,this.height,_.x,_.y,v.x,v.y,T.x,T.y,b.x,b.y);const M=this._boundsArray=new p.StructArrayLayout4i8;M.emplaceBack(_.x,_.y,0,0),M.emplaceBack(v.x,v.y,p.EXTENT,0),M.emplaceBack(T.x,T.y,0,p.EXTENT),M.emplaceBack(b.x,b.y,p.EXTENT,p.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=a.createVertexBuffer(M,p.boundsAttributes.members),this.boundsSegments=p.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const a=this.map.painter.context,h=a.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new p.Texture(a,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(a)}loadTile(a,h){this.tileID&&this.tileID.equals(a.tileID.canonical)?(this.tiles[String(a.tileID.wrap)]=a,a.buckets={},h(null)):(a.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const qt={vector:at,raster:tt,"raster-dem":class extends tt{constructor(f,a,h,_){super(f,a,h,_),this.type="raster-dem",this.maxzoom=22,this._options=p.extend({type:"raster-dem"},a),this.encoding=a.encoding||"mapbox"}loadTile(f,a){const h=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(v,b){v&&(f.state="errored",a(v)),b&&(f.dem=b,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",a(null))}f.request=p.getImage(this.map._requestManager.transformRequest(h,p.ResourceType.Tile),function(v,b,T,M){if(delete f.request,f.aborted)f.state="unloaded",a(null);else if(v)f.state="errored",a(v);else if(b){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:T,expires:M});const k=p.window.ImageBitmap&&b instanceof p.window.ImageBitmap&&(null==fc&&(fc=p.window.OffscreenCanvas&&new p.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof p.window.createImageBitmap),fc),F=1-(b.width-p.prevPowerOfTwo(b.width))/2;F<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const O=k?b:p.exported.getImageData(b,F),z={uid:f.uid,coord:f.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:F};f.actor&&"expired"!==f.state||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",z,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(f){const a=f.canonical,h=Math.pow(2,a.z),_=(a.x-1+h)%h,v=0===a.x?f.wrap-1:f.wrap,b=(a.x+1+h)%h,T=a.x+1===h?f.wrap+1:f.wrap,M={};return M[new p.OverscaledTileID(f.overscaledZ,v,a.z,_,a.y).key]={backfilled:!1},M[new p.OverscaledTileID(f.overscaledZ,T,a.z,b,a.y).key]={backfilled:!1},a.y>0&&(M[new p.OverscaledTileID(f.overscaledZ,v,a.z,_,a.y-1).key]={backfilled:!1},M[new p.OverscaledTileID(f.overscaledZ,f.wrap,a.z,a.x,a.y-1).key]={backfilled:!1},M[new p.OverscaledTileID(f.overscaledZ,T,a.z,b,a.y-1).key]={backfilled:!1}),a.y+1<h&&(M[new p.OverscaledTileID(f.overscaledZ,v,a.z,_,a.y+1).key]={backfilled:!1},M[new p.OverscaledTileID(f.overscaledZ,f.wrap,a.z,a.x,a.y+1).key]={backfilled:!1},M[new p.OverscaledTileID(f.overscaledZ,T,a.z,b,a.y+1).key]={backfilled:!1}),M}unloadTile(f){f.demTexture&&this.map.painter.saveTileTexture(f.demTexture),f.fbo&&(f.fbo.destroy(),delete f.fbo),f.dem&&delete f.dem,delete f.neighboringTiles,f.state="unloaded"}},geojson:class extends p.Evented{constructor(f,a,h,_){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=a.data,this._options=p.extend({},a),this._collectResourceTiming=a.collectResourceTiming,void 0!==a.maxzoom&&(this.maxzoom=a.maxzoom),a.type&&(this.type=a.type),a.attribution&&(this.attribution=a.attribution),this.promoteId=a.promoteId;const v=p.EXTENT/this.tileSize;this.workerOptions=p.extend({source:this.id,cluster:a.cluster||!1,geojsonVtOptions:{buffer:(void 0!==a.buffer?a.buffer:128)*v,tolerance:(void 0!==a.tolerance?a.tolerance:.375)*v,extent:p.EXTENT,maxZoom:this.maxzoom,lineMetrics:a.lineMetrics||!1,generateId:a.generateId||!1},superclusterOptions:{maxZoom:void 0!==a.clusterMaxZoom?a.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,a.clusterMinPoints||2),extent:p.EXTENT,radius:(void 0!==a.clusterRadius?a.clusterRadius:50)*v,log:!1,generateId:a.generateId||!1},clusterProperties:a.clusterProperties,filter:a.filter},a.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}getClusterExpansionZoom(f,a){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id},a),this}getClusterChildren(f,a){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id},a),this}getClusterLeaves(f,a,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:f,limit:a,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new p.Event("dataloading",{dataType:"source"})),this._loaded=!1;const f=p.extend({},this.workerOptions),a=this._data;"string"==typeof a?(f.request=this.map._requestManager.transformRequest(p.exported.resolveURL(a),p.ResourceType.Source),f.request.collectResourceTiming=this._collectResourceTiming):f.data=JSON.stringify(a),this._pendingLoad=this.actor.send(`${this.type}.loadData`,f,(h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new p.ErrorEvent(h));else{const v={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(v.resourceTiming=_.resourceTiming[this.id]),this.fire(new p.Event("data",v)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,a){const h=f.actor?"reloadTile":"loadTile";f.actor=this.actor,f.request=this.actor.send(h,{type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:p.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,v)=>(delete f.request,f.unloadVectorData(),f.aborted?a(null):_?a(_):(f.loadVectorData(v,this.map.painter,"reloadTile"===h),a(null))),void 0,"loadTile"===h)}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f){f.unloadVectorData(),this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return p.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Ot{constructor(f,a,h,_){super(f,a,h,_),this.roundZoom=!0,this.type="video",this.options=a}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const a of f.urls)this.urls.push(this.map._requestManager.transformRequest(a,p.ResourceType.Source).url);p.getVideo(this.urls,(a,h)=>{this._loaded=!0,a?this.fire(new p.ErrorEvent(a)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const a=this.video.seekable;f<a.start(0)||f>a.end(0)?this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${a.start(0)} and ${a.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const f=this.map.painter.context,a=f.gl;this.texture?this.video.paused||(this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),a.texSubImage2D(a.TEXTURE_2D,0,0,0,a.RGBA,a.UNSIGNED_BYTE,this.video)):(this.texture=new p.Texture(f,this.video,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Ot,canvas:class extends Ot{constructor(f,a,h,_){super(f,a,h,_),a.coordinates?Array.isArray(a.coordinates)&&4===a.coordinates.length&&!a.coordinates.some(v=>!Array.isArray(v)||2!==v.length||v.some(b=>"number"!=typeof b))||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'missing required property "coordinates"'))),a.animate&&"boolean"!=typeof a.animate&&this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),a.canvas?"string"==typeof a.canvas||a.canvas instanceof p.window.HTMLCanvasElement||this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new p.ErrorEvent(new p.ValidationError(`sources.${f}`,null,'missing required property "canvas"'))),this.options=a,this.animate=void 0===a.animate||a.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof p.window.HTMLCanvasElement?this.options.canvas:p.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new p.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const a=this.map.painter.context;this.texture?(f||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new p.Texture(a,this.canvas,a.gl.RGBA,{premultiply:!0}),this._prepareData(a)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends p.Evented{constructor(f,a,h,_){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=a,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new p.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new p.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new ts(this._implementation.bounds,this.minzoom,this.maxzoom)),a.update=this._update.bind(this),a.clearTiles=this._clearTiles.bind(this),a.coveringTiles=this._coveringTiles.bind(this),p.extend(this,p.pick(a,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return p.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new p.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this._map=f,this._loaded=!1,this.fire(new p.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:a,y:h,z:_}=f.canonical;return this._implementation.hasTile({x:a,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,a){const{x:h,y:_,z:v}=f.tileID.canonical,b=new p.window.AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:v},{signal:b.signal})).then(function(T){return delete f.request,f.aborted?(f.state="unloaded",a(null)):void 0===T?(f.state="errored",a(null)):null===T?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",a(null)):(M=T)instanceof p.window.ImageData||M instanceof p.window.HTMLCanvasElement||M instanceof p.window.ImageBitmap||M instanceof p.window.HTMLImageElement?(this.loadTileData(f,T),f.state="loaded",void a(null)):(f.state="errored",a(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var M}.bind(this)).catch(T=>{20!==T.code&&(f.state="errored",a(T))}),f.request.cancel=()=>b.abort()}loadTileData(f,a){tt.loadTileData(f,a,this._map.painter)}unloadTileData(f){tt.unloadTileData(f,this._map.painter)}unloadTile(f,a){if(this.unloadTileData(f),this._implementation.unloadTile){const{x:h,y:_,z:v}=f.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:v})}a()}abortTile(f,a){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),a()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new p.Event("data",{dataType:"source",sourceDataType:"content"}))}}},rn=function(f,a,h,_){const v=new qt[a.type](f,a,h,_);if(v.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${v.id}`);return p.bindAll(["load","abort","unload","serialize","prepare"],v),v};function mn(f,a){const h=p.identity([]);return p.scale(h,h,[.5*f.width,.5*-f.height,1]),p.translate(h,h,[1,-1,0]),p.multiply(h,h,f.calculateProjMatrix(a.toUnwrapped())),Float32Array.from(h)}function si(f,a,h,_,v,b,T,M=!1){const k=f.tilesIn(_,T,M);k.sort(gr);const F=[];for(const z of k)F.push({wrappedTileID:z.tile.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(a,h,f._state,z,v,b,mn(f.transform,z.tile.tileID),M)});const O=function(z){const $={},Q={};for(const K of z){const X=K.queryResults,ee=K.wrappedTileID,V=Q[ee]=Q[ee]||{};for(const W in X){const ie=X[W],te=V[W]=V[W]||{},pe=$[W]=$[W]||[];for(const me of ie)te[me.featureIndex]||(te[me.featureIndex]=!0,pe.push(me))}}return $}(F);for(const z in O)O[z].forEach($=>{const Q=$.feature,K=Q.layer;K&&"background"!==K.type&&"sky"!==K.type&&(Q.source=K.source,K["source-layer"]&&(Q.sourceLayer=K["source-layer"]),Q.state=void 0!==Q.id?f.getFeatureState(K["source-layer"],Q.id):{})});return O}function Ai(f,a){const h=f.getRenderableIds().map(b=>f.getTileByID(b)),_=[],v={};for(let b=0;b<h.length;b++){const T=h[b],M=T.tileID.canonical.key;v[M]||(v[M]=!0,T.querySourceFeatures(_,a))}return _}function gr(f,a){const h=f.tileID,_=a.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function Oi(){return null!=Kr.workerClass?new Kr.workerClass:new p.window.Worker(Kr.workerUrl)}const Wi="mapboxgl_preloaded_worker_pool";class Zi{constructor(){this.active={}}acquire(a){if(!this.workers)for(this.workers=[];this.workers.length<Zi.workerCount;)this.workers.push(new Oi);return this.active[a]=!0,this.workers.slice()}release(a){delete this.active[a],0===this.numActive()&&(this.workers.forEach(h=>{h.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Wi]}numActive(){return Object.keys(this.active).length}}let Vn;function Po(){return Vn||(Vn=new Zi),Vn}function ns(f,a){const h={};for(const _ in f)"ref"!==_&&(h[_]=f[_]);return p.refProperties.forEach(_=>{_ in a&&(h[_]=a[_])}),h}function mm(f){f=f.slice();const a=Object.create(null);for(let h=0;h<f.length;h++)a[f[h].id]=f[h];for(let h=0;h<f.length;h++)"ref"in f[h]&&(f[h]=ns(f[h],a[f[h].ref]));return f}Zi.workerCount=2;const Dn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Xh(f,a,h){h.push({command:Dn.addSource,args:[f,a[f]]})}function za(f,a,h){a.push({command:Dn.removeSource,args:[f]}),h[f]=!0}function xu(f,a,h,_){za(f,h,_),Xh(f,a,h)}function aa(f,a,h){let _;for(_ in f[h])if(f[h].hasOwnProperty(_)&&"data"!==_&&!je(f[h][_],a[h][_]))return!1;for(_ in a[h])if(a[h].hasOwnProperty(_)&&"data"!==_&&!je(f[h][_],a[h][_]))return!1;return!0}function is(f,a,h,_,v,b){let T;for(T in a=a||{},f=f||{})f.hasOwnProperty(T)&&(je(f[T],a[T])||h.push({command:b,args:[_,T,a[T],v]}));for(T in a)a.hasOwnProperty(T)&&!f.hasOwnProperty(T)&&(je(f[T],a[T])||h.push({command:b,args:[_,T,a[T],v]}))}function rs(f){return f.id}function bu(f,a){return f[a.id]=a,f}class Kh{constructor(a,h){this.reset(a,h)}reset(a,h){this.points=a||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(a){if(1===this.points.length)return this.points[0];a=p.clamp(a,0,1);let h=1,_=this._distances[h];const v=a*this.paddedLength+this.padding;for(;_<v&&h<this._distances.length;)_=this._distances[++h];const b=h-1,T=this._distances[b],M=_-T,k=M>0?(v-T)/M:0;return this.points[b].mult(1-k).add(this.points[h].mult(k))}}class Va{constructor(a,h,_){const v=this.boxCells=[],b=this.circleCells=[];this.xCellCount=Math.ceil(a/_),this.yCellCount=Math.ceil(h/_);for(let T=0;T<this.xCellCount*this.yCellCount;T++)v.push([]),b.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=a,this.height=h,this.xScale=this.xCellCount/a,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(a,h,_,v,b){this._forEachCell(h,_,v,b,this._insertBoxCell,this.boxUid++),this.boxKeys.push(a),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(v),this.bboxes.push(b)}insertCircle(a,h,_,v){this._forEachCell(h-v,_-v,h+v,_+v,this._insertCircleCell,this.circleUid++),this.circleKeys.push(a),this.circles.push(h),this.circles.push(_),this.circles.push(v)}_insertBoxCell(a,h,_,v,b,T){this.boxCells[b].push(T)}_insertCircleCell(a,h,_,v,b,T){this.circleCells[b].push(T)}_query(a,h,_,v,b,T){if(_<0||a>this.width||v<0||h>this.height)return!b&&[];const M=[];if(a<=0&&h<=0&&this.width<=_&&this.height<=v){if(b)return!0;for(let k=0;k<this.boxKeys.length;k++)M.push({key:this.boxKeys[k],x1:this.bboxes[4*k],y1:this.bboxes[4*k+1],x2:this.bboxes[4*k+2],y2:this.bboxes[4*k+3]});for(let k=0;k<this.circleKeys.length;k++){const F=this.circles[3*k],O=this.circles[3*k+1],z=this.circles[3*k+2];M.push({key:this.circleKeys[k],x1:F-z,y1:O-z,x2:F+z,y2:O+z})}return T?M.filter(T):M}return this._forEachCell(a,h,_,v,this._queryCell,M,{hitTest:b,seenUids:{box:{},circle:{}}},T),b?M.length>0:M}_queryCircle(a,h,_,v,b){const T=a-_,M=a+_,k=h-_,F=h+_;if(M<0||T>this.width||F<0||k>this.height)return!v&&[];const O=[];return this._forEachCell(T,k,M,F,this._queryCellCircle,O,{hitTest:v,circle:{x:a,y:h,radius:_},seenUids:{box:{},circle:{}}},b),v?O.length>0:O}query(a,h,_,v,b){return this._query(a,h,_,v,!1,b)}hitTest(a,h,_,v,b){return this._query(a,h,_,v,!0,b)}hitTestCircle(a,h,_,v){return this._queryCircle(a,h,_,!0,v)}_queryCell(a,h,_,v,b,T,M,k){const F=M.seenUids,O=this.boxCells[b];if(null!==O){const $=this.bboxes;for(const Q of O)if(!F.box[Q]){F.box[Q]=!0;const K=4*Q;if(a<=$[K+2]&&h<=$[K+3]&&_>=$[K+0]&&v>=$[K+1]&&(!k||k(this.boxKeys[Q]))){if(M.hitTest)return T.push(!0),!0;T.push({key:this.boxKeys[Q],x1:$[K],y1:$[K+1],x2:$[K+2],y2:$[K+3]})}}}const z=this.circleCells[b];if(null!==z){const $=this.circles;for(const Q of z)if(!F.circle[Q]){F.circle[Q]=!0;const K=3*Q;if(this._circleAndRectCollide($[K],$[K+1],$[K+2],a,h,_,v)&&(!k||k(this.circleKeys[Q]))){if(M.hitTest)return T.push(!0),!0;{const X=$[K],ee=$[K+1],V=$[K+2];T.push({key:this.circleKeys[Q],x1:X-V,y1:ee-V,x2:X+V,y2:ee+V})}}}}}_queryCellCircle(a,h,_,v,b,T,M,k){const F=M.circle,O=M.seenUids,z=this.boxCells[b];if(null!==z){const Q=this.bboxes;for(const K of z)if(!O.box[K]){O.box[K]=!0;const X=4*K;if(this._circleAndRectCollide(F.x,F.y,F.radius,Q[X+0],Q[X+1],Q[X+2],Q[X+3])&&(!k||k(this.boxKeys[K])))return T.push(!0),!0}}const $=this.circleCells[b];if(null!==$){const Q=this.circles;for(const K of $)if(!O.circle[K]){O.circle[K]=!0;const X=3*K;if(this._circlesCollide(Q[X],Q[X+1],Q[X+2],F.x,F.y,F.radius)&&(!k||k(this.circleKeys[K])))return T.push(!0),!0}}}_forEachCell(a,h,_,v,b,T,M,k){const F=this._convertToXCellCoord(a),O=this._convertToYCellCoord(h),z=this._convertToXCellCoord(_),$=this._convertToYCellCoord(v);for(let Q=F;Q<=z;Q++)for(let K=O;K<=$;K++)if(b.call(this,a,h,_,v,this.xCellCount*K+Q,T,M,k))return}_convertToXCellCoord(a){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(a*this.xScale)))}_convertToYCellCoord(a){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(a*this.yScale)))}_circlesCollide(a,h,_,v,b,T){const M=v-a,k=b-h,F=_+T;return F*F>M*M+k*k}_circleAndRectCollide(a,h,_,v,b,T,M){const k=(T-v)/2,F=Math.abs(a-(v+k));if(F>k+_)return!1;const O=(M-b)/2,z=Math.abs(h-(b+O));if(z>O+_)return!1;if(F<=k||z<=O)return!0;const $=F-k,Q=z-O;return $*$+Q*Q<=_*_}}const Ss={unknown:0,flipRequired:1,flipNotRequired:2},mc=Math.tan(85*Math.PI/180);function Fe(f,a,h,_,v,b,T){const M=p.create();if(h)if("globe"===b.name){const k=p.calculateGlobeLabelMatrix(v,a);p.multiply(M,M,k)}else{const k=lt([],T);M[0]=k[0],M[1]=k[1],M[4]=k[2],M[5]=k[3],_||p.rotateZ(M,M,v.angle)}else p.multiply(M,v.labelPlaneMatrix,f);return M}function ks(f,a,h,_,v,b,T){const M=Fe(f,a,h,_,v,b,T);return"globe"===b.name&&h||(M[2]=M[6]=M[10]=M[14]=0),M}function Ti(f,a,h,_,v,b,T){if(h){if("globe"===b.name){const M=Fe(f,a,h,_,v,b,T);return p.invert(M,M),p.multiply(M,f,M),M}{const M=p.clone(f),k=p.identity([]);return k[0]=T[0],k[1]=T[1],k[4]=T[2],k[5]=T[3],p.multiply(M,M,k),_||p.rotateZ(M,M,-v.angle),M}}return v.glCoordMatrix}function xn(f,a,h,_){const v=[f,a,h,1];h?p.transformMat4$1(v,v,_):Yt(v,v,_);const b=v[3];return v[0]/=b,v[1]/=b,v[2]/=b,v}function pp(f,a){return Math.min(.5+f/a*.5,1.5)}function Ro(f,a){const h=f[0]/f[3],_=f[1]/f[3];return h>=-a[0]&&h<=a[0]&&_>=-a[1]&&_<=a[1]}function gc(f,a,h,_,v,b,T,M,k,F){const O=h.transform,z=_?f.textSizeData:f.iconSizeData,$=p.evaluateSizeForZoom(z,h.transform.zoom),Q="globe"===O.projection.name,K=[256/h.width*2+1,256/h.height*2+1],X=_?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;X.clear();let ee=null;Q&&(ee=_?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const V=f.lineVertexArray,W=_?f.text.placedSymbolArray:f.icon.placedSymbolArray,ie=h.transform.width/h.transform.height;let te,pe=!1;for(let me=0;me<W.length;me++){const fe=W.get(me),{numGlyphs:ve,writingMode:ye}=fe;if(ye!==p.WritingMode.vertical||pe||te===p.WritingMode.horizontal||(pe=!0),te=ye,(fe.hidden||ye===p.WritingMode.vertical)&&!pe){Pt(ve,X);continue}pe=!1;const Me=new p.Point(fe.tileAnchorX,fe.tileAnchorY);let{x:Ze,y:Ce,z:Be}=O.projection.projectTilePoint(Me.x,Me.y,F.canonical);if(k){const[zt,vt,kt]=k(Me);Ze+=zt,Ce+=vt,Be+=kt}const Se=[Ze,Ce,Be,1];if(p.transformMat4$1(Se,Se,a),!Ro(Se,K)){Pt(ve,X);continue}const Qe=pp(h.transform.cameraToCenterDistance,Se[3]),Te=p.evaluateSizeForFeature(z,$,fe),Le=T?Te/Qe:Te*Qe,Xe=xn(Ze,Ce,Be,v);if(Xe[3]<=0){Pt(ve,X);continue}let He={};const nt=T?null:k,Ct=et(fe,Le,!1,M,a,v,b,f.glyphOffsetArray,V,X,ee,Xe,Me,He,ie,nt,O.projection,F,T);pe=Ct.useVertical,nt&&Ct.needsFlipping&&(He={}),(Ct.notEnoughRoom||pe||Ct.needsFlipping&&et(fe,Le,!0,M,a,v,b,f.glyphOffsetArray,V,X,ee,Xe,Me,He,ie,nt,O.projection,F,T).notEnoughRoom)&&Pt(ve,X)}_?(f.text.dynamicLayoutVertexBuffer.updateData(X),ee&&f.text.globeExtVertexBuffer.updateData(ee)):(f.icon.dynamicLayoutVertexBuffer.updateData(X),ee&&f.icon.globeExtVertexBuffer.updateData(ee))}function Xn(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X){const{lineStartIndex:ee,glyphStartIndex:V,segment:W}=M,ie=V+M.numGlyphs,te=ee+M.lineLength,pe=a.getoffsetX(V),me=a.getoffsetX(ie-1),fe=vn(f*pe,h,_,v,b,T,W,ee,te,k,F,O,z,$,!0,Q,K,X);if(!fe)return null;const ve=vn(f*me,h,_,v,b,T,W,ee,te,k,F,O,z,$,!0,Q,K,X);return ve?{first:fe,last:ve}:null}function la(f,a,h,_){return f===p.WritingMode.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:f===p.WritingMode.vertical?_>0?{needsFlipping:!0}:null:a!==Ss.unknown&&(0===(v=h)||Math.abs(_/v)>mc)?a===Ss.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null;var v}function et(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X,ee,V,W){const ie=a/24,te=f.lineOffsetX*ie,pe=f.lineOffsetY*ie,{lineStartIndex:me,glyphStartIndex:fe,numGlyphs:ve,segment:ye,writingMode:Me,flipState:Ze}=f,Ce=me+f.lineLength,Be=Se=>{if(O){const[Xe,He,nt]=Se.up,Ct=F.length;p.updateGlobeVertexNormal(O,Ct+0,Xe,He,nt),p.updateGlobeVertexNormal(O,Ct+1,Xe,He,nt),p.updateGlobeVertexNormal(O,Ct+2,Xe,He,nt),p.updateGlobeVertexNormal(O,Ct+3,Xe,He,nt)}const[Qe,Te,Le]=Se.point;p.addDynamicAttributes(F,Qe,Te,Le,Se.angle)};if(ve>1){const Se=Xn(ie,M,te,pe,h,z,$,f,k,b,Q,X,!1,ee,V,W);if(!Se)return{notEnoughRoom:!0};if(_&&!h){let[Qe,Te,Le]=Se.first.point,[Xe,He,nt]=Se.last.point;[Qe,Te]=xn(Qe,Te,Le,T),[Xe,He]=xn(Xe,He,nt,T);const Ct=la(Me,Ze,(Xe-Qe)*K,He-Te);if(f.flipState=Ct&&Ct.needsFlipping?Ss.flipRequired:Ss.flipNotRequired,Ct)return Ct}Be(Se.first);for(let Qe=fe+1;Qe<fe+ve-1;Qe++){const Te=vn(ie*M.getoffsetX(Qe),te,pe,h,z,$,ye,me,Ce,k,b,Q,X,!1,!1,ee,V,W);if(!Te)return F.length-=4*(Qe-fe),{notEnoughRoom:!0};Be(Te)}Be(Se.last)}else{if(_&&!h){const Qe=xn($.x,$.y,0,v),Te=me+ye+1,Le=new p.Point(k.getx(Te),k.gety(Te)),Xe=xn(Le.x,Le.y,0,v),He=Xe[3]>0?Xe:ln($,Le,Qe,1,v,void 0,ee,V.canonical),nt=la(Me,Ze,(He[0]-Qe[0])*K,He[1]-Qe[1]);if(f.flipState=nt&&nt.needsFlipping?Ss.flipRequired:Ss.flipNotRequired,nt)return nt}const Se=vn(ie*M.getoffsetX(fe),te,pe,h,z,$,ye,me,Ce,k,b,Q,X,!1,!1,ee,V,W);if(!Se)return{notEnoughRoom:!0};Be(Se)}return{}}function an(f,a,h,_,v){const{x:b,y:T,z:M}=_.projectTilePoint(f.x,f.y,a);if(!v)return xn(b,T,M,h);const[k,F,O]=v(f);return xn(b+k,T+F,M+O,h)}function ln(f,a,h,_,v,b,T,M){const k=an(f.sub(a)._unit()._add(f),M,v,T,b);return p.sub(k,h,k),p.normalize(k,k),p.scaleAndAdd(k,h,k,_)}function vn(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X,ee,V){const W=_?f-a:f+a;let ie=W>0?1:-1,te=0;_&&(ie*=-1,te=Math.PI),ie<0&&(te+=Math.PI);let pe=M+T+(ie>0?0:1)|0,me=v,fe=v,ve=0,ye=0;const Me=Math.abs(W),Ze=[],Ce=[];let Be=b,Se=Be;const Qe=()=>ln(Se,Be,fe,Me-ve+1,O,$,X,ee.canonical);for(;ve+ye<=Me;){if(pe+=ie,pe<M||pe>=k)return null;if(fe=me,Se=Be,Ze.push(fe),Q&&Ce.push(Se),Be=new p.Point(F.getx(pe),F.gety(pe)),me=z[pe],!me){const kt=an(Be,ee.canonical,O,X,$);me=kt[3]>0?z[pe]=kt:Qe()}ve+=ye,ye=p.distance(fe,me)}K&&$&&(z[pe]&&(me=Qe(),ye=p.distance(fe,me)),z[pe]=me);const Te=(Me-ve)/ye,Le=Be.sub(Se)._mult(Te)._add(Se),Xe=p.sub([],me,fe),He=p.scaleAndAdd([],fe,Xe,Te);let nt=[0,0,1],Ct=Xe[0],zt=Xe[1];if(V&&(nt=X.upVector(ee.canonical,Le.x,Le.y),0!==nt[0]||0!==nt[1]||1!==nt[2])){const kt=[nt[2],0,-nt[0]],dn=p.cross([],nt,kt);p.normalize(kt,kt),p.normalize(dn,dn),Ct=p.dot(Xe,kt),zt=p.dot(Xe,dn)}if(h){const kt=p.cross([],nt,Xe);p.normalize(kt,kt),p.scaleAndAdd(He,He,kt,h*ie)}const vt=te+Math.atan2(zt,Ct);return Ze.push(He),Q&&Ce.push(Le),{point:He,angle:vt,path:Ze,tilePath:Ce,up:nt}}function Pt(f,a){const h=a.length,_=h+4*f;a.resize(_),a.float32.fill(-1/0,4*h,4*_)}function Yt(f,a,h){const _=a[0],v=a[1];return f[0]=h[0]*_+h[4]*v+h[12],f[1]=h[1]*_+h[5]*v+h[13],f[3]=h[3]*_+h[7]*v+h[15],f}const Or=100;class wu{constructor(a,h,_=new Va(a.width+200,a.height+200,25),v=new Va(a.width+200,a.height+200,25)){this.transform=a,this.grid=_,this.ignoredGrid=v,this.pitchfactor=Math.cos(a._pitch)*a.cameraToCenterDistance,this.screenRightBoundary=a.width+Or,this.screenBottomBoundary=a.height+Or,this.gridRightBoundary=a.width+200,this.gridBottomBoundary=a.height+200,this.fogState=h}placeCollisionBox(a,h,_,v,b,T,M,k){let F=_.projectedAnchorX,O=_.projectedAnchorY,z=_.projectedAnchorZ;const $=_.elevation,Q=_.tileID,K=a.getProjection();if($&&Q){const[me,fe,ve]=K.upVector(Q.canonical,_.tileAnchorX,_.tileAnchorY),ye=K.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;F+=me*$*ye,O+=fe*$*ye,z+=ve*$*ye}const X=this.projectAndGetPerspectiveRatio(M,F,O,z,_.tileID,"globe"===K.name||!!$||this.transform.pitch>0,K),ee=T*X.perspectiveRatio,V=(_.x1*h+v.x-_.padding)*ee+X.point.x,W=(_.y1*h+v.y-_.padding)*ee+X.point.y,ie=(_.x2*h+v.x+_.padding)*ee+X.point.x,te=(_.y2*h+v.y+_.padding)*ee+X.point.y,pe=X.perspectiveRatio<=.55||X.occluded;return!this.isInsideGrid(V,W,ie,te)||!b&&this.grid.hitTest(V,W,ie,te,k)||pe?{box:[],offscreen:!1,occluded:X.occluded}:{box:[V,W,ie,te],offscreen:this.isOffscreen(V,W,ie,te),occluded:!1}}placeCollisionCircles(a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X){const ee=[],V=this.transform.elevation,W=a.getProjection(),ie=V?V.getAtTileOffsetFunc(X,this.transform.center.lat,this.transform.worldSize,W):null,te=new p.Point(_.tileAnchorX,_.tileAnchorY);let{x:pe,y:me,z:fe}=W.projectTilePoint(te.x,te.y,X.canonical);if(ie){const[Le,Xe,He]=ie(te);pe+=Le,me+=Xe,fe+=He}const ve="globe"===W.name,ye=this.projectAndGetPerspectiveRatio(M,pe,me,fe,X,ve||!!V||this.transform.pitch>0,W),{perspectiveRatio:Me}=ye,Ze=(z?T/Me:T*Me)/p.ONE_EM,Ce=xn(pe,me,fe,k),Be=ye.signedDistanceFromCamera>0?Xn(Ze,b,_.lineOffsetX*Ze,_.lineOffsetY*Ze,!1,Ce,te,_,v,k,{},V&&!z?ie:null,z&&!!V,W,X,z):null;let Se=!1,Qe=!1,Te=!0;if(Be&&!ye.occluded){const Le=.5*Q*Me+K,Xe=new p.Point(-100,-100),He=new p.Point(this.screenRightBoundary,this.screenBottomBoundary),nt=new Kh,{first:Ct,last:zt}=Be,vt=Ct.path.length;let kt=[];for(let Et=vt-1;Et>=1;Et--)kt.push(Ct.path[Et]);for(let Et=1;Et<zt.path.length;Et++)kt.push(zt.path[Et]);const dn=2.5*Le;F&&(kt=kt.map(([Et,Sn,Un],kn)=>(ie&&!ve&&(Un=ie(kn<vt-1?Ct.tilePath[vt-1-kn]:zt.tilePath[kn-vt+2])[2]),xn(Et,Sn,Un,F))),kt.some(Et=>Et[3]<=0)&&(kt=[]));let cn=[];if(kt.length>0){let Et=1/0,Sn=-1/0,Un=1/0,kn=-1/0;for(const jn of kt)Et=Math.min(Et,jn[0]),Un=Math.min(Un,jn[1]),Sn=Math.max(Sn,jn[0]),kn=Math.max(kn,jn[1]);Sn>=Xe.x&&Et<=He.x&&kn>=Xe.y&&Un<=He.y&&(cn=[kt.map(jn=>new p.Point(jn[0],jn[1]))],(Et<Xe.x||Sn>He.x||Un<Xe.y||kn>He.y)&&(cn=p.clipLine(cn,Xe.x,Xe.y,He.x,He.y)))}for(const Et of cn){nt.reset(Et,.25*Le);let Sn=0;Sn=nt.length<=.5*Le?1:Math.ceil(nt.paddedLength/dn)+1;for(let Un=0;Un<Sn;Un++){const kn=Un/Math.max(Sn-1,1),jn=nt.lerp(kn),ar=jn.x+Or,Si=jn.y+Or;ee.push(ar,Si,Le,0);const yo=ar-Le,oo=Si-Le,Kn=ar+Le,Ln=Si+Le;if(Te=Te&&this.isOffscreen(yo,oo,Kn,Ln),Qe=Qe||this.isInsideGrid(yo,oo,Kn,Ln),!h&&this.grid.hitTestCircle(ar,Si,Le,$)&&(Se=!0,!O))return{circles:[],offscreen:!1,collisionDetected:Se,occluded:!1}}}}return{circles:!O&&Se||!Qe?[]:ee,offscreen:Te,collisionDetected:Se,occluded:ye.occluded}}queryRenderedSymbols(a){if(0===a.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const h=[];let _=1/0,v=1/0,b=-1/0,T=-1/0;for(const O of a){const z=new p.Point(O.x+Or,O.y+Or);_=Math.min(_,z.x),v=Math.min(v,z.y),b=Math.max(b,z.x),T=Math.max(T,z.y),h.push(z)}const M=this.grid.query(_,v,b,T).concat(this.ignoredGrid.query(_,v,b,T)),k={},F={};for(const O of M){const z=O.key;if(void 0===k[z.bucketInstanceId]&&(k[z.bucketInstanceId]={}),k[z.bucketInstanceId][z.featureIndex])continue;const $=[new p.Point(O.x1,O.y1),new p.Point(O.x2,O.y1),new p.Point(O.x2,O.y2),new p.Point(O.x1,O.y2)];p.polygonIntersectsPolygon(h,$)&&(k[z.bucketInstanceId][z.featureIndex]=!0,void 0===F[z.bucketInstanceId]&&(F[z.bucketInstanceId]=[]),F[z.bucketInstanceId].push(z.featureIndex))}return F}insertCollisionBox(a,h,_,v,b){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:v,collisionGroupID:b},a[0],a[1],a[2],a[3])}insertCollisionCircles(a,h,_,v,b){const T=h?this.ignoredGrid:this.grid,M={bucketInstanceId:_,featureIndex:v,collisionGroupID:b};for(let k=0;k<a.length;k+=4)T.insertCircle(M,a[k],a[k+1],a[k+2])}projectAndGetPerspectiveRatio(a,h,_,v,b,T,M){const k=[h,_,v,1];let F=!1;v||this.transform.pitch>0?(p.transformMat4$1(k,k,a),this.fogState&&b&&"globe"!==M.name&&(F=function($,Q,K,X,ee,V){const W=V.calculateFogTileMatrix(ee),ie=[Q,K,X];return p.transformMat4(ie,ie,W),Oa($,ie,V.pitch,V._fov)}(this.fogState,h,_,v,b.toUnwrapped(),this.transform)>.9)):Yt(k,k,a);const O=k[3];return{point:new p.Point((k[0]/O+1)/2*this.transform.width+Or,(-k[1]/O+1)/2*this.transform.height+Or),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/O*.5,1.5),signedDistanceFromCamera:O,occluded:T&&k[2]>O||F}}isOffscreen(a,h,_,v){return _<Or||a>=this.screenRightBoundary||v<Or||h>this.screenBottomBoundary}isInsideGrid(a,h,_,v){return _>=0&&a<this.gridRightBoundary&&v>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const a=p.identity([]);return p.translate(a,a,[-100,-100,0]),a}}function os(f,a,h){const _=a.createTileMatrix(f,f.worldSize,h.toUnwrapped());return p.multiply(new Float32Array(16),f.projMatrix,_)}function st(f,a,h){if(a.projection.name===h.projection.name)return f.projMatrix;const _=h.clone();return _.setProjection(a.projection),os(_,a.getProjection(),f)}function Zn(f,a,h){return a.name===h.projection.name?f.projMatrix:os(h,a,f)}class en{constructor(a,h,_,v){this.opacity=a?Math.max(0,Math.min(1,a.opacity+(a.placed?h:-h))):v&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class An{constructor(a,h,_,v,b,T=!1){this.text=new en(a?a.text:null,h,_,b),this.icon=new en(a?a.icon:null,h,v,b),this.clipped=T}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class _c{constructor(a,h,_,v=!1){this.text=a,this.icon=h,this.skipFade=_,this.clipped=v}}class Eu{constructor(){this.invProjMatrix=p.create(),this.viewportMatrix=p.create(),this.circles=[]}}class Jh{constructor(a,h,_,v,b){this.bucketInstanceId=a,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=v,this.tileID=b}}class yc{constructor(a){this.crossSourceCollisions=a,this.maxGroupID=0,this.collisionGroups={}}get(a){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[a]){const h=++this.maxGroupID;this.collisionGroups[a]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[a]}}function or(f,a,h,_,v){const{horizontalAlign:b,verticalAlign:T}=p.getAnchorAlignment(f),M=-(b-.5)*a,k=-(T-.5)*h,F=p.evaluateVariableOffset(f,_);return new p.Point(M+F[0]*v,k+F[1]*v)}function Cu(f,a,h,_,v){const b=new p.Point(f,a);return h&&b._rotate(_?v:-v),b}class Iu{constructor(a,h,_,v,b){this.transform=a.clone(),this.projection=a.projection.name,this.collisionIndex=new wu(this.transform,b),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new yc(_),this.collisionCircleArrays={},this.prevPlacement=v,v&&(v.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(a,h,_,v){const b=_.getBucket(h),T=_.latestFeatureIndex;if(!b||!T||h.id!==b.layerIds[0])return;const M=b.layers[0].layout,k=_.collisionBoxArray,F=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),O=_.tileSize/p.EXTENT,z=_.tileID.toUnwrapped();this.transform.setProjection(b.projection);const $=(Q=_.tileID,K=b.getProjection(),X=this.transform,K.name===this.projection?X.calculateProjMatrix(Q.toUnwrapped()):os(X,K,Q));var Q,K,X;const ee="map"===M.get("text-pitch-alignment"),V="map"===M.get("text-rotation-alignment");h.compileFilter();const W=h.dynamicFilter(),ie=h.dynamicFilterNeedsFeature(),te=this.transform.calculatePixelsToTileUnitsMatrix(_),pe=ks($,_.tileID.canonical,ee,V,this.transform,b.getProjection(),te);let me=null;if(ee){const ye=Ti($,_.tileID.canonical,ee,V,this.transform,b.getProjection(),te);me=p.multiply([],this.transform.labelPlaneMatrix,ye)}let fe=null;W&&_.latestFeatureIndex&&(fe={unwrappedTileID:z,dynamicFilter:W,dynamicFilterNeedsFeature:ie,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[b.bucketInstanceId]=new Jh(b.bucketInstanceId,T,b.sourceLayerIndex,b.index,_.tileID);const ve={bucket:b,layout:M,posMatrix:$,textLabelPlaneMatrix:pe,labelToScreenMatrix:me,clippingData:fe,scale:F,textPixelRatio:O,holdingForFade:_.holdingForFade(),collisionBoxArray:k,partiallyEvaluatedTextSize:p.evaluateSizeForZoom(b.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:p.evaluateSizeForZoom(b.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(b.sourceID)};if(v)for(const ye of b.sortKeyRanges){const{sortKey:Me,symbolInstanceStart:Ze,symbolInstanceEnd:Ce}=ye;a.push({sortKey:Me,symbolInstanceStart:Ze,symbolInstanceEnd:Ce,parameters:ve})}else a.push({symbolInstanceStart:0,symbolInstanceEnd:b.symbolInstances.length,parameters:ve})}attemptAnchorPlacement(a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X,ee,V,W){const{textOffset0:ie,textOffset1:te,crossTileID:pe}=$,me=[ie,te],fe=or(a,_,v,me,b),ve=this.collisionIndex.placeCollisionBox(K,b,h,Cu(fe.x,fe.y,T,M,this.transform.angle),z,k,F,O.predicate);if(ee){const ye=K.getSymbolInstanceIconSize(W,this.transform.zoom,$.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(K,ye,ee,Cu(fe.x,fe.y,T,M,this.transform.angle),z,k,F,O.predicate).box.length)return}if(ve.box.length>0){let ye;return this.prevPlacement&&this.prevPlacement.variableOffsets[pe]&&this.prevPlacement.placements[pe]&&this.prevPlacement.placements[pe].text&&(ye=this.prevPlacement.variableOffsets[pe].anchor),this.variableOffsets[pe]={textOffset:me,width:_,height:v,anchor:a,textScale:b,prevAnchor:ye},this.markUsedJustification(K,a,$,X),K.allowVerticalPlacement&&(this.markUsedOrientation(K,X,$),this.placedOrientations[pe]=X),{shift:fe,placedGlyphBoxes:ve}}}placeLayerBucketPart(a,h,_,v){const{bucket:b,layout:T,posMatrix:M,textLabelPlaneMatrix:k,labelToScreenMatrix:F,clippingData:O,textPixelRatio:z,holdingForFade:$,collisionBoxArray:Q,partiallyEvaluatedTextSize:K,partiallyEvaluatedIconSize:X,collisionGroup:ee}=a.parameters,V=T.get("text-optional"),W=T.get("icon-optional"),ie=T.get("text-allow-overlap"),te=T.get("icon-allow-overlap"),pe="map"===T.get("text-rotation-alignment"),me="map"===T.get("text-pitch-alignment"),fe="none"!==T.get("icon-text-fit"),ve="viewport-y"===T.get("symbol-z-order");this.transform.setProjection(b.projection);let ye=ie&&(te||!b.hasIconData()||W),Me=te&&(ie||!b.hasTextData()||V);!b.collisionArrays&&Q&&b.deserializeCollisionBoxes(Q),_&&v&&b.updateCollisionDebugBuffers(this.transform.zoom,Q);const Ze=(Ce,Be,Se)=>{const{crossTileID:Qe,numVerticalGlyphVertices:Te}=Ce;if(O){const Kn={zoom:this.transform.zoom,pitch:this.transform.pitch};let Ln=null;if(O.dynamicFilterNeedsFeature){const Pn=this.retainedQueryData[b.bucketInstanceId];Ln=O.featureIndex.loadFeature({featureIndex:Ce.featureIndex,bucketIndex:Pn.bucketIndex,sourceLayerIndex:Pn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(Kn,Ln,this.retainedQueryData[b.bucketInstanceId].tileID.canonical,new p.Point(Ce.tileAnchorX,Ce.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[Qe]=new _c(!1,!1,!1,!0),void h.add(Qe)}if(h.has(Qe))return;if($)return void(this.placements[Qe]=new _c(!1,!1,!1));let Le=!1,Xe=!1,He=!0,nt=!1,Ct=!1,zt=null,vt={box:null,offscreen:null,occluded:null},kt={box:null,offscreen:null,occluded:null},dn=null,cn=null,Et=null,Sn=0,Un=0,kn=0;Se.textFeatureIndex?Sn=Se.textFeatureIndex:Ce.useRuntimeCollisionCircles&&(Sn=Ce.featureIndex),Se.verticalTextFeatureIndex&&(Un=Se.verticalTextFeatureIndex);const jn=Kn=>{Kn.tileID=this.retainedQueryData[b.bucketInstanceId].tileID;const Ln=this.transform.elevation;(Ln||Kn.elevation)&&(Kn.elevation=Ln?Ln.getAtTileOffset(Kn.tileID,Kn.tileAnchorX,Kn.tileAnchorY):0)},ar=Se.textBox;if(ar){jn(ar);const Kn=Pn=>{let wi=p.WritingMode.horizontal;if(b.allowVerticalPlacement&&!Pn&&this.prevPlacement){const Er=this.prevPlacement.placedOrientations[Qe];Er&&(this.placedOrientations[Qe]=Er,wi=Er,this.markUsedOrientation(b,wi,Ce))}return wi},Ln=(Pn,wi)=>{if(b.allowVerticalPlacement&&Te>0&&Se.verticalTextBox){for(const Er of b.writingModes)if(Er===p.WritingMode.vertical?(vt=wi(),kt=vt):vt=Pn(),vt&&vt.box&&vt.box.length)break}else vt=Pn()};if(T.get("text-variable-anchor")){let Pn=T.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Qe]){const ni=this.prevPlacement.variableOffsets[Qe];Pn.indexOf(ni.anchor)>0&&(Pn=Pn.filter(_i=>_i!==ni.anchor),Pn.unshift(ni.anchor))}const wi=(ni,_i,Qu)=>{const fs=b.getSymbolInstanceTextSize(K,Ce,this.transform.zoom,Be),Qa=(ni.x2-ni.x1)*fs+2*ni.padding,ms=(ni.y2-ni.y1)*fs+2*ni.padding,gs=fe&&!te?_i:null;gs&&jn(gs);let Bs={box:[],offscreen:!1,occluded:!1};const Xu=ie?2*Pn.length:Pn.length;for(let Nl=0;Nl<Xu;++Nl){const Ku=this.attemptAnchorPlacement(Pn[Nl%Pn.length],ni,Qa,ms,fs,pe,me,z,M,ee,Nl>=Pn.length,Ce,Be,b,Qu,gs,K,X);if(Ku&&(Bs=Ku.placedGlyphBoxes,Bs&&Bs.box&&Bs.box.length)){Le=!0,zt=Ku.shift;break}}return Bs};Ln(()=>wi(ar,Se.iconBox,p.WritingMode.horizontal),()=>{const ni=Se.verticalTextBox;return ni&&jn(ni),b.allowVerticalPlacement&&!(vt&&vt.box&&vt.box.length)&&Te>0&&ni?wi(ni,Se.verticalIconBox,p.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),vt&&(Le=vt.box,He=vt.offscreen,nt=vt.occluded);const Er=Kn(!(!vt||!vt.box));if(!Le&&this.prevPlacement){const ni=this.prevPlacement.variableOffsets[Qe];ni&&(this.variableOffsets[Qe]=ni,this.markUsedJustification(b,ni.anchor,Ce,Er))}}else{const Pn=(wi,Er)=>{const ni=b.getSymbolInstanceTextSize(K,Ce,this.transform.zoom,Be),_i=this.collisionIndex.placeCollisionBox(b,ni,wi,new p.Point(0,0),ie,z,M,ee.predicate);return _i&&_i.box&&_i.box.length&&(this.markUsedOrientation(b,Er,Ce),this.placedOrientations[Qe]=Er),_i};Ln(()=>Pn(ar,p.WritingMode.horizontal),()=>{const wi=Se.verticalTextBox;return b.allowVerticalPlacement&&Te>0&&wi?(jn(wi),Pn(wi,p.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),Kn(!!(vt&&vt.box&&vt.box.length))}}if(dn=vt,Le=dn&&dn.box&&dn.box.length>0,He=dn&&dn.offscreen,nt=dn&&dn.occluded,Ce.useRuntimeCollisionCircles){const Kn=b.text.placedSymbolArray.get(Ce.centerJustifiedTextSymbolIndex>=0?Ce.centerJustifiedTextSymbolIndex:Ce.verticalPlacedTextSymbolIndex),Ln=p.evaluateSizeForFeature(b.textSizeData,K,Kn),Pn=T.get("text-padding");cn=this.collisionIndex.placeCollisionCircles(b,ie,Kn,b.lineVertexArray,b.glyphOffsetArray,Ln,M,k,F,_,me,ee.predicate,Ce.collisionCircleDiameter*Ln/p.ONE_EM,Pn,this.retainedQueryData[b.bucketInstanceId].tileID),Le=ie||cn.circles.length>0&&!cn.collisionDetected,He=He&&cn.offscreen,nt=cn.occluded}if(Se.iconFeatureIndex&&(kn=Se.iconFeatureIndex),Se.iconBox){const Kn=Ln=>{jn(Ln);const Pn=fe&&zt?Cu(zt.x,zt.y,pe,me,this.transform.angle):new p.Point(0,0),wi=b.getSymbolInstanceIconSize(X,this.transform.zoom,Ce.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(b,wi,Ln,Pn,te,z,M,ee.predicate)};kt&&kt.box&&kt.box.length&&Se.verticalIconBox?(Et=Kn(Se.verticalIconBox),Xe=Et.box.length>0):(Et=Kn(Se.iconBox),Xe=Et.box.length>0),He=He&&Et.offscreen,Ct=Et.occluded}const Si=V||0===Ce.numHorizontalGlyphVertices&&0===Te,yo=W||0===Ce.numIconVertices;if(Si||yo?yo?Si||(Xe=Xe&&Le):Le=Xe&&Le:Xe=Le=Xe&&Le,Le&&dn&&dn.box&&this.collisionIndex.insertCollisionBox(dn.box,T.get("text-ignore-placement"),b.bucketInstanceId,kt&&kt.box&&Un?Un:Sn,ee.ID),Xe&&Et&&this.collisionIndex.insertCollisionBox(Et.box,T.get("icon-ignore-placement"),b.bucketInstanceId,kn,ee.ID),cn&&(Le&&this.collisionIndex.insertCollisionCircles(cn.circles,T.get("text-ignore-placement"),b.bucketInstanceId,Sn,ee.ID),_)){const Kn=b.bucketInstanceId;let Ln=this.collisionCircleArrays[Kn];void 0===Ln&&(Ln=this.collisionCircleArrays[Kn]=new Eu);for(let Pn=0;Pn<cn.circles.length;Pn+=4)Ln.circles.push(cn.circles[Pn+0]),Ln.circles.push(cn.circles[Pn+1]),Ln.circles.push(cn.circles[Pn+2]),Ln.circles.push(cn.collisionDetected?1:0)}const oo="globe"!==b.projection.name;ye=ye&&(oo||!nt),Me=Me&&(oo||!Ct),this.placements[Qe]=new _c(Le||ye,Xe||Me,He||b.justReloaded),h.add(Qe)};if(ve){const Ce=b.getSortedSymbolIndexes(this.transform.angle);for(let Be=Ce.length-1;Be>=0;--Be){const Se=Ce[Be];Ze(b.symbolInstances.get(Se),Se,b.collisionArrays[Se])}}else for(let Ce=a.symbolInstanceStart;Ce<a.symbolInstanceEnd;Ce++)Ze(b.symbolInstances.get(Ce),Ce,b.collisionArrays[Ce]);if(_&&b.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[b.bucketInstanceId];p.invert(Ce.invProjMatrix,M),Ce.viewportMatrix=this.collisionIndex.getViewportMatrix()}b.justReloaded=!1}markUsedJustification(a,h,_,v){const{leftJustifiedTextSymbolIndex:b,centerJustifiedTextSymbolIndex:T,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:k,crossTileID:F}=_,O=p.getAnchorJustification(h),z=v===p.WritingMode.vertical?k:"left"===O?b:"center"===O?T:"right"===O?M:-1;b>=0&&(a.text.placedSymbolArray.get(b).crossTileID=z>=0&&b!==z?0:F),T>=0&&(a.text.placedSymbolArray.get(T).crossTileID=z>=0&&T!==z?0:F),M>=0&&(a.text.placedSymbolArray.get(M).crossTileID=z>=0&&M!==z?0:F),k>=0&&(a.text.placedSymbolArray.get(k).crossTileID=z>=0&&k!==z?0:F)}markUsedOrientation(a,h,_){const v=h===p.WritingMode.horizontal||h===p.WritingMode.horizontalOnly?h:0,b=h===p.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:T,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:k,verticalPlacedTextSymbolIndex:F}=_,O=a.text.placedSymbolArray;T>=0&&(O.get(T).placedOrientation=v),M>=0&&(O.get(M).placedOrientation=v),k>=0&&(O.get(k).placedOrientation=v),F>=0&&(O.get(F).placedOrientation=b)}commit(a){this.commitTime=a,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const v=h?h.symbolFadeChange(a):1,b=h?h.opacities:{},T=h?h.variableOffsets:{},M=h?h.placedOrientations:{};for(const k in this.placements){const F=this.placements[k],O=b[k];O?(this.opacities[k]=new An(O,v,F.text,F.icon,null,F.clipped),_=_||F.text!==O.text.placed||F.icon!==O.icon.placed):(this.opacities[k]=new An(null,v,F.text,F.icon,F.skipFade,F.clipped),_=_||F.text||F.icon)}for(const k in b){const F=b[k];if(!this.opacities[k]){const O=new An(F,v,!1,!1);O.isHidden()||(this.opacities[k]=O,_=_||F.text.placed||F.icon.placed)}}for(const k in T)this.variableOffsets[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.variableOffsets[k]=T[k]);for(const k in M)this.placedOrientations[k]||!this.opacities[k]||this.opacities[k].isHidden()||(this.placedOrientations[k]=M[k]);_?this.lastPlacementChangeTime=a:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:a)}updateLayerOpacities(a,h){const _=new Set;for(const v of h){const b=v.getBucket(a);b&&v.latestFeatureIndex&&a.id===b.layerIds[0]&&this.updateBucketOpacities(b,_,v.collisionBoxArray)}}updateBucketOpacities(a,h,_){a.hasTextData()&&a.text.opacityVertexArray.clear(),a.hasIconData()&&a.icon.opacityVertexArray.clear(),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexArray.clear(),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexArray.clear();const v=a.layers[0].layout,b=!!a.layers[0].dynamicFilter(),T=new An(null,0,!1,!1,!0),M=v.get("text-allow-overlap"),k=v.get("icon-allow-overlap"),F=v.get("text-variable-anchor"),O="map"===v.get("text-rotation-alignment"),z="map"===v.get("text-pitch-alignment"),$="none"!==v.get("icon-text-fit"),Q=new An(null,0,M&&(k||!a.hasIconData()||v.get("icon-optional")),k&&(M||!a.hasTextData()||v.get("text-optional")),!0);!a.collisionArrays&&_&&(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData())&&a.deserializeCollisionBoxes(_);const K=(ee,V,W)=>{for(let ie=0;ie<V/4;ie++)ee.opacityVertexArray.emplaceBack(W)};let X=0;for(let ee=0;ee<a.symbolInstances.length;ee++){const V=a.symbolInstances.get(ee),{numHorizontalGlyphVertices:W,numVerticalGlyphVertices:ie,crossTileID:te,numIconVertices:pe}=V,me=h.has(te);let fe=this.opacities[te];me?fe=T:fe||(fe=Q,this.opacities[te]=fe),h.add(te);const ve=W>0||ie>0,ye=pe>0,Me=this.placedOrientations[te],Ze=Me===p.WritingMode.vertical,Ce=Me===p.WritingMode.horizontal||Me===p.WritingMode.horizontalOnly;if(!ve&&!ye||fe.isHidden()||X++,ve){const Be=Ac(fe.text);K(a.text,W,Ze?xi:Be),K(a.text,ie,Ce?xi:Be);const Se=fe.text.isHidden(),{leftJustifiedTextSymbolIndex:Qe,centerJustifiedTextSymbolIndex:Te,rightJustifiedTextSymbolIndex:Le,verticalPlacedTextSymbolIndex:Xe}=V,He=a.text.placedSymbolArray,nt=Se||Ze?1:0;Qe>=0&&(He.get(Qe).hidden=nt),Te>=0&&(He.get(Te).hidden=nt),Le>=0&&(He.get(Le).hidden=nt),Xe>=0&&(He.get(Xe).hidden=Se||Ce?1:0);const Ct=this.variableOffsets[te];Ct&&this.markUsedJustification(a,Ct.anchor,V,Me);const zt=this.placedOrientations[te];zt&&(this.markUsedJustification(a,"left",V,zt),this.markUsedOrientation(a,zt,V))}if(ye){const Be=Ac(fe.icon),{placedIconSymbolIndex:Se,verticalPlacedIconSymbolIndex:Qe}=V,Te=a.icon.placedSymbolArray,Le=fe.icon.isHidden()?1:0;Se>=0&&(K(a.icon,pe,Ze?xi:Be),Te.get(Se).hidden=Le),Qe>=0&&(K(a.icon,V.numVerticalIconVertices,Ce?xi:Be),Te.get(Qe).hidden=Le)}if(a.hasIconCollisionBoxData()||a.hasTextCollisionBoxData()){const Be=a.collisionArrays[ee];if(Be){let Se=new p.Point(0,0),Qe=!0;if(Be.textBox||Be.verticalTextBox){if(F){const Le=this.variableOffsets[te];Le?(Se=or(Le.anchor,Le.width,Le.height,Le.textOffset,Le.textScale),O&&Se._rotate(z?this.transform.angle:-this.transform.angle)):Qe=!1}b&&(Qe=!fe.clipped),Be.textBox&&vc(a.textCollisionBox.collisionVertexArray,fe.text.placed,!Qe||Ze,Se.x,Se.y),Be.verticalTextBox&&vc(a.textCollisionBox.collisionVertexArray,fe.text.placed,!Qe||Ce,Se.x,Se.y)}const Te=Qe&&Boolean(!Ce&&Be.verticalIconBox);Be.iconBox&&vc(a.iconCollisionBox.collisionVertexArray,fe.icon.placed,Te,$?Se.x:0,$?Se.y:0),Be.verticalIconBox&&vc(a.iconCollisionBox.collisionVertexArray,fe.icon.placed,!Te,$?Se.x:0,$?Se.y:0)}}}if(a.fullyClipped=0===X,a.sortFeatures(this.transform.angle),this.retainedQueryData[a.bucketInstanceId]&&(this.retainedQueryData[a.bucketInstanceId].featureSortOrder=a.featureSortOrder),a.hasTextData()&&a.text.opacityVertexBuffer&&a.text.opacityVertexBuffer.updateData(a.text.opacityVertexArray),a.hasIconData()&&a.icon.opacityVertexBuffer&&a.icon.opacityVertexBuffer.updateData(a.icon.opacityVertexArray),a.hasIconCollisionBoxData()&&a.iconCollisionBox.collisionVertexBuffer&&a.iconCollisionBox.collisionVertexBuffer.updateData(a.iconCollisionBox.collisionVertexArray),a.hasTextCollisionBoxData()&&a.textCollisionBox.collisionVertexBuffer&&a.textCollisionBox.collisionVertexBuffer.updateData(a.textCollisionBox.collisionVertexArray),a.bucketInstanceId in this.collisionCircleArrays){const ee=this.collisionCircleArrays[a.bucketInstanceId];a.placementInvProjMatrix=ee.invProjMatrix,a.placementViewportMatrix=ee.viewportMatrix,a.collisionCircleArray=ee.circles,delete this.collisionCircleArrays[a.bucketInstanceId]}}symbolFadeChange(a){return 0===this.fadeDuration?1:(a-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(a){return Math.max(0,(this.transform.zoom-a)/1.5)}hasTransitions(a){return this.stale||a-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(a,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>a}setStale(){this.stale=!0}}function vc(f,a,h,_,v){f.emplaceBack(a?1:0,h?1:0,_||0,v||0),f.emplaceBack(a?1:0,h?1:0,_||0,v||0),f.emplaceBack(a?1:0,h?1:0,_||0,v||0),f.emplaceBack(a?1:0,h?1:0,_||0,v||0)}const Mi=Math.pow(2,25),Di=Math.pow(2,24),fp=Math.pow(2,17),mp=Math.pow(2,16),no=Math.pow(2,9),fo=Math.pow(2,8),gm=Math.pow(2,1);function Ac(f){if(0===f.opacity&&!f.placed)return 0;if(1===f.opacity&&f.placed)return 4294967295;const a=f.placed?1:0,h=Math.floor(127*f.opacity);return h*Mi+a*Di+h*fp+a*mp+h*no+a*fo+h*gm+a}const xi=0;class _r{constructor(a){this._sortAcrossTiles="viewport-y"!==a.layout.get("symbol-z-order")&&void 0!==a.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(a,h,_,v,b){const T=this._bucketParts;for(;this._currentTileIndex<a.length;)if(h.getBucketParts(T,v,a[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,b())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,T.sort((M,k)=>M.sortKey-k.sortKey));this._currentPartIndex<T.length;){const M=T[this._currentPartIndex];if(h.placeLayerBucketPart(M,this._seenCrossTileIDs,_,0===M.symbolInstanceStart),this._currentPartIndex++,b())return!0}return!1}}class Nn{constructor(a,h,_,v,b,T,M,k){this.placement=new Iu(a,b,T,M,k),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=v,this._done=!1}isDone(){return this._done}continuePlacement(a,h,_){const v=p.exported.now(),b=()=>{const T=p.exported.now()-v;return!this._forceFullPlacement&&T>2};for(;this._currentPlacementIndex>=0;){const T=h[a[this._currentPlacementIndex]],M=this.placement.collisionIndex.transform.zoom;if("symbol"===T.type&&(!T.minzoom||T.minzoom<=M)&&(!T.maxzoom||T.maxzoom>M)){if(this._inProgressLayer||(this._inProgressLayer=new _r(T)),this._inProgressLayer.continuePlacement(_[T.source],this.placement,this._showCollisionBoxes,T,b))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(a){return this.placement.commit(a),this.placement}}const bl=512/p.EXTENT/2;class yr{constructor(a,h,_){this.tileID=a,this.bucketInstanceId=_,this.index=new p.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const v=a.canonical.x*p.EXTENT,b=a.canonical.y*p.EXTENT;for(let T=0;T<h.length;T++){const{key:M,crossTileID:k,tileAnchorX:F,tileAnchorY:O}=h.get(T),z=Math.floor((v+F)*bl),$=Math.floor((b+O)*bl);this.index.add(z,$),this.keys.push(M),this.crossTileIDs.push(k)}this.index.finish()}findMatches(a,h,_){const v=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),b=bl/Math.pow(2,h.canonical.z-this.tileID.canonical.z),T=h.canonical.x*p.EXTENT,M=h.canonical.y*p.EXTENT;for(let k=0;k<a.length;k++){const F=a.get(k);if(F.crossTileID)continue;const{key:O,tileAnchorX:z,tileAnchorY:$}=F,Q=Math.floor((T+z)*b),K=Math.floor((M+$)*b),X=this.index.range(Q-v,K-v,Q+v,K+v);for(const ee of X){const V=this.crossTileIDs[ee];if(this.keys[ee]===O&&!_.has(V)){_.add(V),F.crossTileID=V;break}}}}}class gp{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Tt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(a){const h=Math.round((a-this.lng)/360);if(0!==h)for(const _ in this.indexes){const v=this.indexes[_],b={};for(const T in v){const M=v[T];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+h),b[M.tileID.key]=M}this.indexes[_]=b}this.lng=a}addBucket(a,h,_){if(this.indexes[a.overscaledZ]&&this.indexes[a.overscaledZ][a.key]){if(this.indexes[a.overscaledZ][a.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(a.overscaledZ,this.indexes[a.overscaledZ][a.key])}for(let b=0;b<h.symbolInstances.length;b++)h.symbolInstances.get(b).crossTileID=0;this.usedCrossTileIDs[a.overscaledZ]||(this.usedCrossTileIDs[a.overscaledZ]=new Set);const v=this.usedCrossTileIDs[a.overscaledZ];for(const b in this.indexes){const T=this.indexes[b];if(Number(b)>a.overscaledZ)for(const M in T){const k=T[M];k.tileID.isChildOf(a)&&k.findMatches(h.symbolInstances,a,v)}else{const M=T[a.scaledTo(Number(b)).key];M&&M.findMatches(h.symbolInstances,a,v)}}for(let b=0;b<h.symbolInstances.length;b++){const T=h.symbolInstances.get(b);T.crossTileID||(T.crossTileID=_.generate(),v.add(T.crossTileID))}return void 0===this.indexes[a.overscaledZ]&&(this.indexes[a.overscaledZ]={}),this.indexes[a.overscaledZ][a.key]=new yr(a,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(a,h){for(const _ of h.crossTileIDs)this.usedCrossTileIDs[a].delete(_)}removeStaleBuckets(a){let h=!1;for(const _ in this.indexes){const v=this.indexes[_];for(const b in v)a[v[b].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,v[b]),delete v[b],h=!0)}return h}}class ca{constructor(){this.layerIndexes={},this.crossTileIDs=new gp,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(a,h,_,v){let b=this.layerIndexes[a.id];void 0===b&&(b=this.layerIndexes[a.id]=new Tt);let T=!1;const M={};"globe"!==v.name&&b.handleWrapJump(_);for(const k of h){const F=k.getBucket(a);F&&a.id===F.layerIds[0]&&(F.bucketInstanceId||(F.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(k.tileID,F,this.crossTileIDs)&&(T=!0),M[F.bucketInstanceId]=!0)}return b.removeStaleBuckets(M)&&(T=!0),T}pruneUnusedLayers(a){const h={};a.forEach(_=>{h[_]=!0});for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}const fi=(f,a)=>p.emitValidationErrors(f,a&&a.filter(h=>"source.canvas"!==h.identifier)),Ua=p.pick(Dn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),_m=p.pick(Dn,["setCenter","setZoom","setBearing","setPitch"]),Tu={version:8,layers:[],sources:{}},wl={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ss extends p.Evented{constructor(a,h={}){super(),this.map=a,this.dispatcher=new fn(Po(),this),this.imageManager=new Ra,this.imageManager.setEventedParent(this),this.glyphManager=new p.GlyphManager(a._requestManager,h.localFontFamily?p.LocalGlyphMode.all:h.localIdeographFontFamily?p.LocalGlyphMode.ideographs:p.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new ca,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",p.getReferrer());const _=this;this._rtlTextPluginCallback=ss.registerForPluginStateChange(v=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:v.pluginStatus,pluginURL:v.pluginURL},(b,T)=>{if(p.triggerPluginCompletionEvent(b),T&&T.every(M=>M))for(const M in _._sourceCaches){const k=_._sourceCaches[M],F=k.getSource().type;"vector"!==F&&"geojson"!==F||k.reload()}})}),this.on("data",v=>{if("source"!==v.dataType||"metadata"!==v.sourceDataType)return;const b=this.getSource(v.sourceId);if(b&&b.vectorLayerIds)for(const T in this._layers){const M=this._layers[T];M.source===b.id&&this._validateLayer(M)}})}loadURL(a,h={}){this.fire(new p.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof h.validate?h.validate:!p.isMapboxURL(a);a=this.map._requestManager.normalizeStyleURL(a,h.accessToken);const v=this.map._requestManager.transformRequest(a,p.ResourceType.Style);this._request=p.getJSON(v,(b,T)=>{this._request=null,b?this.fire(new p.ErrorEvent(b)):T&&this._load(T,_)})}loadJSON(a,h={}){this.fire(new p.Event("dataloading",{dataType:"style"})),this._request=p.exported.frame(()=>{this._request=null,this._load(a,!1!==h.validate)})}loadEmpty(){this.fire(new p.Event("dataloading",{dataType:"style"})),this._load(Tu,!1)}_updateLayerCount(a,h){const _=h?1:-1;a.is3D()&&(this._num3DLayers+=_),"circle"===a.type&&(this._numCircleLayers+=_),"symbol"===a.type&&(this._numSymbolLayers+=_)}_load(a,h){if(h&&fi(this,p.validateStyle(a)))return;this._loaded=!0,this.stylesheet=p.clone$1(a),this._updateMapProjection();for(const v in a.sources)this.addSource(v,a.sources[v],{validate:!1});this._changed=!1,a.sprite?this._loadSprite(a.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(a.glyphs);const _=mm(this.stylesheet.layers);this._order=_.map(v=>v.id),this._layers={},this._serializedLayers={};for(const v of _){const b=p.createStyleLayer(v);b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new qi(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new p.Event("data",{dataType:"style"})),this.fire(new p.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(a){a?this.stylesheet.projection=a:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(a){this._spriteRequest=function(h,_,v){let b,T,M;const k=p.exported.devicePixelRatio>1?"@2x":"";let F=p.getJSON(_.transformRequest(_.normalizeSpriteURL(h,k,".json"),p.ResourceType.SpriteJSON),($,Q)=>{F=null,M||(M=$,b=Q,z())}),O=p.getImage(_.transformRequest(_.normalizeSpriteURL(h,k,".png"),p.ResourceType.SpriteImage),($,Q)=>{O=null,M||(M=$,T=Q,z())});function z(){if(M)v(M);else if(b&&T){const $=p.exported.getImageData(T),Q={};for(const K in b){const{width:X,height:ee,x:V,y:W,sdf:ie,pixelRatio:te,stretchX:pe,stretchY:me,content:fe}=b[K],ve=new p.RGBAImage({width:X,height:ee});p.RGBAImage.copy($,ve,{x:V,y:W},{x:0,y:0},{width:X,height:ee}),Q[K]={data:ve,pixelRatio:te,sdf:ie,stretchX:pe,stretchY:me,content:fe}}v(null,Q)}}return{cancel(){F&&(F.cancel(),F=null),O&&(O.cancel(),O=null)}}}(a,this.map._requestManager,(h,_)=>{if(this._spriteRequest=null,h)this.fire(new p.ErrorEvent(h));else if(_)for(const v in _)this.imageManager.addImage(v,_[v]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new p.Event("data",{dataType:"style"}))})}_validateLayer(a){const h=this.getSource(a.source);if(!h)return;const _=a.sourceLayer;_&&("geojson"===h.type||h.vectorLayerIds&&-1===h.vectorLayerIds.indexOf(_))&&this.fire(new p.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${a.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const a in this._sourceCaches)if(!this._sourceCaches[a].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(a){const h=[];for(const _ of a){const v=this._layers[_];"custom"!==v.type&&h.push(v.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const a in this._sourceCaches)if(this._sourceCaches[a].hasTransition())return!0;for(const a in this._layers)if(this._layers[a].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(a){return!!this.terrain&&("function"==typeof a.isLayerDraped?a.isLayerDraped():wl[a.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(a){if(!this._loaded)return;const h=this._changed;if(this._changed){const v=Object.keys(this._updatedLayers),b=Object.keys(this._removedLayers);(v.length||b.length)&&this._updateWorkerLayers(v,b);for(const T in this._updatedSources){const M=this._updatedSources[T];"reload"===M?this._reloadSource(T):"clear"===M&&this._clearSource(T)}this._updateTilesForChangedImages();for(const T in this._updatedPaintProps)this._layers[T].updateTransitions(a);this.light.updateTransitions(a),this.fog&&this.fog.updateTransitions(a),this._resetUpdates()}const _={};for(const v in this._sourceCaches){const b=this._sourceCaches[v];_[v]=b.used,b.used=!1}for(const v of this._order){const b=this._layers[v];if(b.recalculate(a,this._availableImages),!b.isHidden(a.zoom)){const M=this._getLayerSourceCache(b);M&&(M.used=!0)}const T=this.map.painter;if(T){const M=b.getProgramIds();if(!M)continue;const k=b.getProgramConfiguration(a.zoom);for(const F of M)T.useProgram(F,k)}}for(const v in _){const b=this._sourceCaches[v];_[v]!==b.used&&b.getSource().fire(new p.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:b.getSource().id}))}this.light.recalculate(a),this.terrain&&this.terrain.recalculate(a),this.fog&&this.fog.recalculate(a),this.z=a.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new p.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const a=Object.keys(this._changedImages);if(a.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],a);this._changedImages={}}}_updateWorkerLayers(a,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(a),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(a){if(this._checkLoaded(),fi(this,p.validateStyle(a)))return!1;(a=p.clone$1(a)).layers=mm(a.layers);const h=function(v,b){if(!v)return[{command:Dn.setStyle,args:[b]}];let T=[];try{if(!je(v.version,b.version))return[{command:Dn.setStyle,args:[b]}];je(v.center,b.center)||T.push({command:Dn.setCenter,args:[b.center]}),je(v.zoom,b.zoom)||T.push({command:Dn.setZoom,args:[b.zoom]}),je(v.bearing,b.bearing)||T.push({command:Dn.setBearing,args:[b.bearing]}),je(v.pitch,b.pitch)||T.push({command:Dn.setPitch,args:[b.pitch]}),je(v.sprite,b.sprite)||T.push({command:Dn.setSprite,args:[b.sprite]}),je(v.glyphs,b.glyphs)||T.push({command:Dn.setGlyphs,args:[b.glyphs]}),je(v.transition,b.transition)||T.push({command:Dn.setTransition,args:[b.transition]}),je(v.light,b.light)||T.push({command:Dn.setLight,args:[b.light]}),je(v.fog,b.fog)||T.push({command:Dn.setFog,args:[b.fog]}),je(v.projection,b.projection)||T.push({command:Dn.setProjection,args:[b.projection]});const M={},k=[];!function(z,$,Q,K){let X;for(X in $=$||{},z=z||{})z.hasOwnProperty(X)&&($.hasOwnProperty(X)||za(X,Q,K));for(X in $){if(!$.hasOwnProperty(X))continue;const ee=$[X];z.hasOwnProperty(X)?je(z[X],ee)||("geojson"===z[X].type&&"geojson"===ee.type&&aa(z,$,X)?Q.push({command:Dn.setGeoJSONSourceData,args:[X,ee.data]}):xu(X,$,Q,K)):Xh(X,$,Q)}}(v.sources,b.sources,k,M);const F=[];v.layers&&v.layers.forEach(z=>{z.source&&M[z.source]?T.push({command:Dn.removeLayer,args:[z.id]}):F.push(z)});let O=v.terrain;O&&M[O.source]&&(T.push({command:Dn.setTerrain,args:[void 0]}),O=void 0),T=T.concat(k),je(O,b.terrain)||T.push({command:Dn.setTerrain,args:[b.terrain]}),function(z,$,Q){$=$||[];const K=(z=z||[]).map(rs),X=$.map(rs),ee=z.reduce(bu,{}),V=$.reduce(bu,{}),W=K.slice(),ie=Object.create(null);let te,pe,me,fe,ve,ye,Me;for(te=0,pe=0;te<K.length;te++)me=K[te],V.hasOwnProperty(me)?pe++:(Q.push({command:Dn.removeLayer,args:[me]}),W.splice(W.indexOf(me,pe),1));for(te=0,pe=0;te<X.length;te++)me=X[X.length-1-te],W[W.length-1-te]!==me&&(ee.hasOwnProperty(me)?(Q.push({command:Dn.removeLayer,args:[me]}),W.splice(W.lastIndexOf(me,W.length-pe),1)):pe++,ye=W[W.length-te],Q.push({command:Dn.addLayer,args:[V[me],ye]}),W.splice(W.length-te,0,me),ie[me]=!0);for(te=0;te<X.length;te++)if(me=X[te],fe=ee[me],ve=V[me],!ie[me]&&!je(fe,ve))if(je(fe.source,ve.source)&&je(fe["source-layer"],ve["source-layer"])&&je(fe.type,ve.type)){for(Me in is(fe.layout,ve.layout,Q,me,null,Dn.setLayoutProperty),is(fe.paint,ve.paint,Q,me,null,Dn.setPaintProperty),je(fe.filter,ve.filter)||Q.push({command:Dn.setFilter,args:[me,ve.filter]}),je(fe.minzoom,ve.minzoom)&&je(fe.maxzoom,ve.maxzoom)||Q.push({command:Dn.setLayerZoomRange,args:[me,ve.minzoom,ve.maxzoom]}),fe)fe.hasOwnProperty(Me)&&"layout"!==Me&&"paint"!==Me&&"filter"!==Me&&"metadata"!==Me&&"minzoom"!==Me&&"maxzoom"!==Me&&(0===Me.indexOf("paint.")?is(fe[Me],ve[Me],Q,me,Me.slice(6),Dn.setPaintProperty):je(fe[Me],ve[Me])||Q.push({command:Dn.setLayerProperty,args:[me,Me,ve[Me]]}));for(Me in ve)ve.hasOwnProperty(Me)&&!fe.hasOwnProperty(Me)&&"layout"!==Me&&"paint"!==Me&&"filter"!==Me&&"metadata"!==Me&&"minzoom"!==Me&&"maxzoom"!==Me&&(0===Me.indexOf("paint.")?is(fe[Me],ve[Me],Q,me,Me.slice(6),Dn.setPaintProperty):je(fe[Me],ve[Me])||Q.push({command:Dn.setLayerProperty,args:[me,Me,ve[Me]]}))}else Q.push({command:Dn.removeLayer,args:[me]}),ye=W[W.lastIndexOf(me)+1],Q.push({command:Dn.addLayer,args:[ve,ye]})}(F,b.layers,T)}catch(M){console.warn("Unable to compute style diff:",M),T=[{command:Dn.setStyle,args:[b]}]}return T}(this.serialize(),a).filter(v=>!(v.command in _m));if(0===h.length)return!1;const _=h.filter(v=>!(v.command in Ua));if(_.length>0)throw new Error(`Unimplemented: ${_.map(v=>v.command).join(", ")}.`);return h.forEach(v=>{"setTransition"!==v.command&&"setProjection"!==v.command&&this[v.command].apply(this,v.args)}),this.stylesheet=a,this._updateMapProjection(),!0}addImage(a,h){return this.getImage(a)?this.fire(new p.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(a,h),this._afterImageUpdated(a),this)}updateImage(a,h){this.imageManager.updateImage(a,h)}getImage(a){return this.imageManager.getImage(a)}removeImage(a){return this.getImage(a)?(this.imageManager.removeImage(a),this._afterImageUpdated(a),this):this.fire(new p.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(a){this._availableImages=this.imageManager.listImages(),this._changedImages[a]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new p.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(a,h,_={}){if(this._checkLoaded(),void 0!==this.getSource(a))throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(p.validateSource,`sources.${a}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const v=rn(a,h,this.dispatcher,this);v.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(a),source:v.serialize(),sourceId:a}));const b=T=>{const M=(T?"symbol:":"other:")+a,k=this._sourceCaches[M]=new p.SourceCache(M,v,T);(T?this._symbolSourceCaches:this._otherSourceCaches)[a]=k,k.style=this,k.onAdd(this.map)};b(!1),"vector"!==h.type&&"geojson"!==h.type||b(!0),v.onAdd&&v.onAdd(this.map),this._changed=!0}removeSource(a){this._checkLoaded();const h=this.getSource(a);if(!h)throw new Error("There is no source with this ID");for(const v in this._layers)if(this._layers[v].source===a)return this.fire(new p.ErrorEvent(new Error(`Source "${a}" cannot be removed while layer "${v}" is using it.`)));if(this.terrain&&this.terrain.get().source===a)return this.fire(new p.ErrorEvent(new Error(`Source "${a}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(a);for(const v of _)delete this._sourceCaches[v.id],delete this._updatedSources[v.id],v.fire(new p.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:v.getSource().id})),v.setEventedParent(null),v.clearTiles();return delete this._otherSourceCaches[a],delete this._symbolSourceCaches[a],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(a,h){this._checkLoaded(),this.getSource(a).setData(h),this._changed=!0}getSource(a){const h=this._getSourceCache(a);return h&&h.getSource()}_getSources(){const a=[];for(const h in this._otherSourceCaches){const _=this._getSourceCache(h);_&&a.push(_.getSource())}return a}addLayer(a,h,_={}){this._checkLoaded();const v=a.id;if(this.getLayer(v))return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${v}" already exists on this map`)));let b;if("custom"===a.type){if(fi(this,p.validateCustomStyleLayer(a)))return;b=p.createStyleLayer(a)}else{if("object"==typeof a.source&&(this.addSource(v,a.source),a=p.clone$1(a),a=p.extend(a,{source:v})),this._validate(p.validateLayer,`layers.${v}`,a,{arrayIndex:-1},_))return;b=p.createStyleLayer(a),this._validateLayer(b),b.setEventedParent(this,{layer:{id:v}}),this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0)}const T=h?this._order.indexOf(h):this._order.length;if(h&&-1===T)return void this.fire(new p.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(T,0,v),this._layerOrderChanged=!0,this._layers[v]=b;const M=this._getLayerSourceCache(b);if(this._removedLayers[v]&&b.source&&M&&"custom"!==b.type){const k=this._removedLayers[v];delete this._removedLayers[v],k.type!==b.type?this._updatedSources[b.source]="clear":(this._updatedSources[b.source]="reload",M.pause())}this._updateLayer(b),b.onAdd&&b.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(a,h){if(this._checkLoaded(),this._changed=!0,!this._layers[a])return void this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be moved.`)));if(a===h)return;const _=this._order.indexOf(a);this._order.splice(_,1);const v=h?this._order.indexOf(h):this._order.length;h&&-1===v?this.fire(new p.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(v,0,a),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(a){this._checkLoaded();const h=this._layers[a];if(!h)return void this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const _=this._order.indexOf(a);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[a]=h,delete this._layers[a],delete this._serializedLayers[a],delete this._updatedLayers[a],delete this._updatedPaintProps[a],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(a){return this._layers[a]}hasLayer(a){return a in this._layers}hasLayerType(a){for(const h in this._layers)if(this._layers[h].type===a)return!0;return!1}setLayerZoomRange(a,h,_){this._checkLoaded();const v=this.getLayer(a);v?v.minzoom===h&&v.maxzoom===_||(null!=h&&(v.minzoom=h),null!=_&&(v.maxzoom=_),this._updateLayer(v)):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(a,h,_={}){this._checkLoaded();const v=this.getLayer(a);if(v){if(!je(v.filter,h))return null==h?(v.filter=void 0,void this._updateLayer(v)):void(this._validate(p.validateFilter,`layers.${v.id}.filter`,h,{layerType:v.type},_)||(v.filter=p.clone$1(h),this._updateLayer(v)))}else this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be filtered.`)))}getFilter(a){const h=this.getLayer(a);return h&&p.clone$1(h.filter)}setLayoutProperty(a,h,_,v={}){this._checkLoaded();const b=this.getLayer(a);b?je(b.getLayoutProperty(h),_)||(b.setLayoutProperty(h,_,v),this._updateLayer(b)):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(a,h){const _=this.getLayer(a);if(_)return _.getLayoutProperty(h);this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style.`)))}setPaintProperty(a,h,_,v={}){this._checkLoaded();const b=this.getLayer(a);b?je(b.getPaintProperty(h),_)||(b.setPaintProperty(h,_,v)&&this._updateLayer(b),this._changed=!0,this._updatedPaintProps[a]=!0):this.fire(new p.ErrorEvent(new Error(`The layer '${a}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(a,h){const _=this.getLayer(a);return _&&_.getPaintProperty(h)}setFeatureState(a,h){this._checkLoaded();const _=a.source,v=a.sourceLayer,b=this.getSource(_);if(!b)return void this.fire(new p.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const T=b.type;if("geojson"===T&&v)return void this.fire(new p.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===T&&!v)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===a.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided.")));const M=this._getSourceCaches(_);for(const k of M)k.setFeatureState(v,a.id,h)}removeFeatureState(a,h){this._checkLoaded();const _=a.source,v=this.getSource(_);if(!v)return void this.fire(new p.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const b=v.type,T="vector"===b?a.sourceLayer:void 0;if("vector"===b&&!T)return void this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&"string"!=typeof a.id&&"number"!=typeof a.id)return void this.fire(new p.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const M=this._getSourceCaches(_);for(const k of M)k.removeFeatureState(T,a.id,h)}getFeatureState(a){this._checkLoaded();const h=a.source,_=a.sourceLayer,v=this.getSource(h);if(v){if("vector"!==v.type||_)return void 0===a.id&&this.fire(new p.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,a.id);this.fire(new p.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new p.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return p.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const a={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();a[_.id]||(a[_.id]=_.serialize())}return p.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:a,layers:this._serializeLayers(this._order)},h=>void 0!==h)}_updateLayer(a){this._updatedLayers[a.id]=!0;const h=this._getLayerSourceCache(a);a.source&&!this._updatedSources[a.source]&&h&&"raster"!==h.getSource().type&&(this._updatedSources[a.source]="reload",h.pause()),this._changed=!0,a.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(a){const h=T=>"fill-extrusion"===this._layers[T].type,_={},v=[];for(let T=this._order.length-1;T>=0;T--){const M=this._order[T];if(h(M)){_[M]=T;for(const k of a){const F=k[M];if(F)for(const O of F)v.push(O)}}}v.sort((T,M)=>M.intersectionZ-T.intersectionZ);const b=[];for(let T=this._order.length-1;T>=0;T--){const M=this._order[T];if(h(M))for(let k=v.length-1;k>=0;k--){const F=v[k].feature;if(_[F.layer.id]<T)break;b.push(F),v.pop()}else for(const k of a){const F=k[M];if(F)for(const O of F)b.push(O.feature)}}return b}queryRenderedFeatures(a,h,_){h&&h.filter&&this._validate(p.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const v={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new p.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const k of h.layers){const F=this._layers[k];if(!F)return this.fire(new p.ErrorEvent(new Error(`The layer '${k}' does not exist in the map's style and cannot be queried for features.`))),[];v[F.source]=!0}}const b=[];h.availableImages=this._availableImages;const T=h&&h.layers?h.layers.some(k=>{const F=this.getLayer(k);return F&&F.is3D()}):this.has3DLayers(),M=ta.createFromScreenPoints(a,_);for(const k in this._sourceCaches){const F=this._sourceCaches[k].getSource().id;h.layers&&!v[F]||b.push(si(this._sourceCaches[k],this._layers,this._serializedLayers,M,h,_,T,!!this.map._showQueryGeometry))}return this.placement&&b.push(function(k,F,O,z,$,Q,K){const X={},ee=Q.queryRenderedSymbols(z),V=[];for(const W of Object.keys(ee).map(Number))V.push(K[W]);V.sort(gr);for(const W of V){const ie=W.featureIndex.lookupSymbolFeatures(ee[W.bucketInstanceId],F,W.bucketIndex,W.sourceLayerIndex,$.filter,$.layers,$.availableImages,k);for(const te in ie){const pe=X[te]=X[te]||[],me=ie[te];me.sort((fe,ve)=>{const ye=W.featureSortOrder;if(ye){const Me=ye.indexOf(fe.featureIndex);return ye.indexOf(ve.featureIndex)-Me}return ve.featureIndex-fe.featureIndex});for(const fe of me)pe.push(fe)}}for(const W in X)X[W].forEach(ie=>{const te=ie.feature,pe=O(k[W]);if(!pe)return;const me=pe.getFeatureState(te.layer["source-layer"],te.id);te.source=te.layer.source,te.layer["source-layer"]&&(te.sourceLayer=te.layer["source-layer"]),te.state=me});return X}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),M.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(b)}querySourceFeatures(a,h){h&&h.filter&&this._validate(p.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const _=this._getSourceCaches(a);let v=[];for(const b of _)v=v.concat(Ai(b,h));return v}addSourceType(a,h,_){return ss.getSourceType(a)?_(new Error(`A source type called "${a}" already exists.`)):(ss.setSourceType(a,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:a,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(a,h={}){this._checkLoaded();const _=this.light.getLight();let v=!1;for(const T in a)if(!je(a[T],_[T])){v=!0;break}if(!v)return;const b=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(a,h),this.light.updateTransitions(b)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(a,h=1){if(this._checkLoaded(),!a)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=a;if(1===h){if("object"==typeof _.source){const v="terrain-dem-src";this.addSource(v,_.source),_=p.clone$1(_),_=p.extend(_,{source:v})}if(this._validate(p.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,h)}else{const v=this.terrain,b=v.get();for(const T of Object.keys(p.spec.terrain))!_.hasOwnProperty(T)&&p.spec.terrain[T].default&&(_[T]=p.spec.terrain[T].default);for(const T in _)if(!je(_[T],b[T])){v.set(_),this.stylesheet.terrain=_;const M=this._setTransitionParameters({duration:0});v.updateTransitions(M);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(a){const h=this.fog=new Fa(a,this.map.transform);this.stylesheet.fog=a;const _=this._setTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const a of this.map._markers)a._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(a){if(this._checkLoaded(),!a)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,_=h.get();0===Object.keys(a).length&&h.set(a);for(const v in a)if(!je(a[v],_[v])){h.set(a),this.stylesheet.fog=a;const b=this._setTransitionParameters({duration:0});h.updateTransitions(b);break}}else this._createFog(a);this._markersNeedUpdate=!0}_setTransitionParameters(a){return{now:p.exported.now(),transition:p.extend(a,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const a=this._order.filter(_=>this.isLayerDraped(this._layers[_])),h=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...a),this._drapedFirstOrder.push(...h)}_createTerrain(a,h){const _=this.terrain=new _u(a,h);this.stylesheet.terrain=a,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const v=this._setTransitionParameters({duration:0});_.updateTransitions(v)}_force3DLayerUpdate(){for(const a in this._layers){const h=this._layers[a];"fill-extrusion"===h.type&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const a in this._layers){const h=this._layers[a];"symbol"===h.type&&this._updateLayer(h)}}_validate(a,h,_,v,b={}){return(!b||!1!==b.validate)&&fi(this,a.call(p.validateStyle,p.extend({key:h,style:this.serialize(),value:_,styleSpec:p.spec},v)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),p.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const a in this._layers)this._layers[a].setEventedParent(null);for(const a in this._sourceCaches)this._sourceCaches[a].clearTiles(),this._sourceCaches[a].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(a){const h=this._getSourceCaches(a);for(const _ of h)_.clearTiles()}_reloadSource(a){const h=this._getSourceCaches(a);for(const _ of h)_.resume(),_.reload()}_reloadSources(){for(const a of this._getSources())a.reload&&a.reload()}_updateSources(a){for(const h in this._sourceCaches)this._sourceCaches[h].update(a)}_generateCollisionBoxes(){for(const a in this._sourceCaches){const h=this._sourceCaches[a];h.resume(),h.reload()}}_updatePlacement(a,h,_,v,b=!1){let T=!1,M=!1;const k={};for(const F of this._order){const O=this._layers[F];if("symbol"!==O.type)continue;if(!k[O.source]){const $=this._getLayerSourceCache(O);if(!$)continue;k[O.source]=$.getRenderableIds(!0).map(Q=>$.getTileByID(Q)).sort((Q,K)=>K.tileID.overscaledZ-Q.tileID.overscaledZ||(Q.tileID.isLessThan(K.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(O,k[O.source],a.center.lng,a.projection);T=T||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),b=b||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new p.Event("neworder")),(b||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(p.exported.now(),a.zoom))&&(this.pauseablePlacement=new Nn(a,this._order,b,h,_,v,this.placement,this.fog&&a.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,k),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(p.exported.now()),M=!0),T&&this.pauseablePlacement.placement.setStale()),M||T)for(const F of this._order){const O=this._layers[F];"symbol"===O.type&&this.placement.updateLayerOpacities(O,k[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(p.exported.now())}_releaseSymbolFadeTiles(){for(const a in this._sourceCaches)this._sourceCaches[a].releaseSymbolFadeTiles()}getImages(a,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();const v=b=>{b&&b.setDependencies(h.tileID.key,h.type,h.icons)};v(this._otherSourceCaches[h.source]),v(this._symbolSourceCaches[h.source])}getGlyphs(a,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(a,h,_){return p.makeRequest(h,_)}_getSourceCache(a){return this._otherSourceCaches[a]}_getLayerSourceCache(a){return"symbol"===a.type?this._symbolSourceCaches[a.source]:this._otherSourceCaches[a.source]}_getSourceCaches(a){const h=[];return this._otherSourceCaches[a]&&h.push(this._otherSourceCaches[a]),this._symbolSourceCaches[a]&&h.push(this._symbolSourceCaches[a]),h}_isSourceCacheLoaded(a){const h=this._getSourceCaches(a);return 0===h.length?(this.fire(new p.ErrorEvent(new Error(`There is no source with ID '${a}'`))),!1):h.every(_=>_.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ss.getSourceType=function(f){return qt[f]},ss.setSourceType=function(f,a){qt[f]=a},ss.registerForPluginStateChange=p.registerForPluginStateChange;var Mu="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",as="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Oo="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",El="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Ps="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Bt={},ua={};const xc=[];wc(Mu,xc),wc(Oo,xc),wc(El,xc),wc(Ps,xc),Bt=On("",Oo),ua=On(Ps,El);const io=On("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),bc=Mu,_p="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var ti={background:On("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:On("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:On("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:On("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:On("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:On("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:On("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:On("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:On("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:On("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:On("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:On("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:On("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:On("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:On("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:On("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:On("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:On("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:On("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:On("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:On("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:On("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:On("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:On("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:On("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:On("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",as),skyboxGradient:On("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",as),skyboxCapture:On("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:On("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:On("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function wc(f,a){const h=f.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let _ of h)if(_=_.trim(),"#"===_[0]&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const v=_.split(" ");for(const b of v)a.includes(b)||a.push(b)}}function On(f,a){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=a.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),v={},b=[...xc];return wc(f,b),wc(a,b),{fragmentSource:f=f.replace(h,(T,M,k,F,O)=>(v[O]=!0,"define"===M?`\n#ifndef HAS_UNIFORM_u_${O}\nvarying ${k} ${F} ${O};\n#else\nuniform ${k} ${F} u_${O};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${O}\n    ${k} ${F} ${O} = u_${O};\n#endif\n`)),vertexSource:a=a.replace(h,(T,M,k,F,O)=>{const z="float"===F?"vec2":"vec4",$=O.match(/color/)?"color":z;return v[O]?"define"===M?`\n#ifndef HAS_UNIFORM_u_${O}\nuniform lowp float u_${O}_t;\nattribute ${k} ${z} a_${O};\nvarying ${k} ${F} ${O};\n#else\nuniform ${k} ${F} u_${O};\n#endif\n`:"vec4"===$?`\n#ifndef HAS_UNIFORM_u_${O}\n    ${O} = a_${O};\n#else\n    ${k} ${F} ${O} = u_${O};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${O}\n    ${O} = unpack_mix_${$}(a_${O}, u_${O}_t);\n#else\n    ${k} ${F} ${O} = u_${O};\n#endif\n`:"define"===M?`\n#ifndef HAS_UNIFORM_u_${O}\nuniform lowp float u_${O}_t;\nattribute ${k} ${z} a_${O};\n#else\nuniform ${k} ${F} u_${O};\n#endif\n`:"vec4"===$?`\n#ifndef HAS_UNIFORM_u_${O}\n    ${k} ${F} ${O} = a_${O};\n#else\n    ${k} ${F} ${O} = u_${O};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${O}\n    ${k} ${F} ${O} = unpack_mix_${$}(a_${O}, u_${O}_t);\n#else\n    ${k} ${F} ${O} = u_${O};\n#endif\n`}),staticAttributes:_,usedDefines:b}}class ny{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(a,h,_,v,b,T,M){this.context=a;let k=this.boundPaintVertexBuffers.length!==v.length;for(let O=0;!k&&O<v.length;O++)this.boundPaintVertexBuffers[O]!==v[O]&&(k=!0);let F=this.boundDynamicVertexBuffers.length!==M.length;for(let O=0;!F&&O<M.length;O++)this.boundDynamicVertexBuffers[O]!==M[O]&&(F=!0);if(!a.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||k||F||this.boundIndexBuffer!==b||this.boundVertexOffset!==T)this.freshBind(h,_,v,b,T,M);else{a.bindVertexArrayOES.set(this.vao);for(const O of M)O&&O.bind();b&&b.dynamicDraw&&b.bind()}}freshBind(a,h,_,v,b,T){let M;const k=a.numAttributes,F=this.context,O=F.gl;if(F.extVertexArrayObject)this.vao&&this.destroy(),this.vao=F.extVertexArrayObject.createVertexArrayOES(),F.bindVertexArrayOES.set(this.vao),M=0,this.boundProgram=a,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=v,this.boundVertexOffset=b,this.boundDynamicVertexBuffers=T;else{M=F.currentNumAttributes||0;for(let z=k;z<M;z++)O.disableVertexAttribArray(z)}h.enableAttributes(O,a),h.bind(),h.setVertexAttribPointers(O,a,b);for(const z of _)z.enableAttributes(O,a),z.bind(),z.setVertexAttribPointers(O,a,b);for(const z of T)z&&(z.enableAttributes(O,a),z.bind(),z.setVertexAttribPointers(O,a,b));v&&v.bind(),F.currentNumAttributes=k}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function ja(f,a){const h=Math.pow(2,a.canonical.z),_=a.canonical.y;return[new p.MercatorCoordinate(0,_/h).toLngLat().lat,new p.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function Du(f,a,h,_,v,b,T){const M=f.context,k=M.gl,F=h.fbo;if(!F)return;f.prepareDrawTile();const O=f.useProgram("hillshade");M.activeTexture.set(k.TEXTURE0),k.bindTexture(k.TEXTURE_2D,F.colorAttachment.get());const z=((X,ee,V,W)=>{const ie=V.paint.get("hillshade-shadow-color"),te=V.paint.get("hillshade-highlight-color"),pe=V.paint.get("hillshade-accent-color");let me=V.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===V.paint.get("hillshade-illumination-anchor")&&(me-=X.transform.angle);const fe=!X.options.moving;return{u_matrix:W||X.transform.calculateProjMatrix(ee.tileID.toUnwrapped(),fe),u_image:0,u_latrange:ja(0,ee.tileID),u_light:[V.paint.get("hillshade-exaggeration"),me],u_shadow:ie,u_highlight:te,u_accent:pe}})(f,h,_,f.terrain?a.projMatrix:null);f.prepareDrawProgram(M,O,a.toUnwrapped());const{tileBoundsBuffer:$,tileBoundsIndexBuffer:Q,tileBoundsSegments:K}=f.getTileBoundsBuffers(h);O.draw(M,k.TRIANGLES,v,b,T,p.CullFaceMode.disabled,z,_.id,$,Q,K)}function Cl(f,a,h){if(!a.needsDEMTextureUpload)return;const _=f.context,v=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),a.demTexture=a.demTexture||f.getTileTexture(h.stride);const b=h.getPixels();a.demTexture?a.demTexture.update(b,{premultiply:!1}):a.demTexture=new p.Texture(_,b,v.RGBA,{premultiply:!1}),a.needsDEMTextureUpload=!1}function yp(f,a,h,_,v,b){const T=f.context,M=T.gl;if(!a.dem)return;const k=a.dem;if(T.activeTexture.set(M.TEXTURE1),Cl(f,a,k),!a.demTexture)return;a.demTexture.bind(M.NEAREST,M.CLAMP_TO_EDGE);const F=k.dim;T.activeTexture.set(M.TEXTURE0);let O=a.fbo;if(!O){const K=new p.Texture(T,{width:F,height:F,data:null},M.RGBA);K.bind(M.LINEAR,M.CLAMP_TO_EDGE),O=a.fbo=T.createFramebuffer(F,F,!0),O.colorAttachment.set(K.texture)}T.bindFramebuffer.set(O.framebuffer),T.viewport.set([0,0,F,F]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:$,tileBoundsSegments:Q}=f.getMercatorTileBoundsBuffers();f.useProgram("hillshadePrepare").draw(T,M.TRIANGLES,_,v,b,p.CullFaceMode.disabled,((K,X)=>{const ee=X.stride,V=p.create();return p.ortho(V,0,p.EXTENT,-p.EXTENT,0,0,1),p.translate(V,V,[0,-p.EXTENT,0]),{u_matrix:V,u_image:1,u_dimension:[ee,ee],u_zoom:K.overscaledZ,u_unpack:X.unpackVector}})(a.tileID,k),h.id,z,$,Q),a.needsHillshadePrepare=!1}const Yh=f=>({u_matrix:new p.UniformMatrix4f(f),u_image0:new p.Uniform1i(f),u_skirt_height:new p.Uniform1f(f)}),Il=(f,a)=>({u_matrix:f,u_image0:0,u_skirt_height:a}),Ec=(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:a,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:v,u_merc_center:b,u_image0:0,u_frustum_tl:T,u_frustum_tr:M,u_frustum_br:k,u_frustum_bl:F,u_globe_pos:O,u_globe_radius:z,u_viewport:$,u_grid_matrix:K?Float32Array.from(K):new Float32Array(9),u_skirt_height:Q});function ls(f,a){return null!=f&&null!=a&&!(!f.hasData()||!a.hasData())&&null!=f.demTexture&&null!=a.demTexture&&f.tileID.key!==a.tileID.key}const Zr=new class{constructor(){this.operations={}}newMorphing(f,a,h,_,v){if(f in this.operations){const b=this.operations[f];b.to.tileID.key!==h.tileID.key&&(b.queued=h)}else this.operations[f]={startTime:_,phase:0,duration:v,from:a,to:h,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const a=this.operations[f];return{from:a.from,to:a.to,phase:a.phase}}update(f){for(const a in this.operations){const h=this.operations[a];for(h.phase=(f-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,f)){delete this.operations[a];break}}}_nextOp(f,a){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=a,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},Ha={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function gt(f){return 6*Math.pow(1.5,22-f)}function ed(f,a){const h=1<<f.z;return!a&&(0===f.x||f.x===h-1)||0===f.y||f.y===h-1}const Wt=f=>({u_matrix:f});function Tl(f,a,h,_,v){if(v>0){const b=p.exported.now(),T=(b-f.timeAdded)/v,M=a?(b-a.timeAdded)/v:-1,k=h.getSource(),F=_.coveringZoomLevel({tileSize:k.tileSize,roundZoom:k.roundZoom}),O=!a||Math.abs(a.tileID.overscaledZ-F)>Math.abs(f.tileID.overscaledZ-F),z=O&&f.refreshedUponExpiration?1:p.clamp(O?T:1-M,0,1);return f.refreshedUponExpiration&&T>=1&&(f.refreshedUponExpiration=!1),a?{opacity:1,mix:1-z}:{opacity:z,mix:0}}return{opacity:1,mix:0}}class Cc extends p.SourceCache{constructor(a){const h={type:"raster-dem",maxzoom:a.transform.maxZoom},_=new fn(Po(),null),v=rn("mock-dem",h,_,a.style);super("mock-dem",v,!1),v.setEventedParent(this),this._sourceLoaded=!0}_loadTile(a,h){a.state="loaded",h(null)}}class ha extends p.SourceCache{constructor(a){const h=rn("proxy",{type:"geojson",maxzoom:a.transform.maxZoom},new fn(Po(),null),a.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=a,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(a,h,_){if(a.freezeTileCoverage)return;this.transform=a;const v=a.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((b,T)=>{if(b[T.key]="",!this._tiles[T.key]){const M=new p.Tile(T,this._source.tileSize*T.overscaleFactor(),a.tileZoom);M.state="loaded",this._tiles[T.key]=M}return b},{});for(const b in this._tiles)b in v||(this.freeFBO(b),this._tiles[b].unloadVectorData(),delete this._tiles[b])}freeFBO(a){const h=this.proxyCachedFBO[a];if(void 0!==h){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[a]}}deallocRenderCache(){this.renderCache.forEach(a=>a.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Su extends p.OverscaledTileID{constructor(a,h,_){super(a.overscaledZ,a.wrap,a.canonical.z,a.canonical.x,a.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class td extends p.Elevation{constructor(a,h){super(),this.painter=a,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,v,b]=function(k){const F=new p.StructArrayLayout2i4,O=new p.StructArrayLayout3ui6,z=131;F.reserve(17161),O.reserve(33800);const $=p.EXTENT/128,Q=p.EXTENT+$/2,K=Q+$;for(let ee=-$;ee<K;ee+=$)for(let V=-$;V<K;V+=$){const W=V<0||V>Q||ee<0||ee>Q?24575:0,ie=p.clamp(Math.round(V),0,p.EXTENT),te=p.clamp(Math.round(ee),0,p.EXTENT);F.emplaceBack(ie+W,te)}const X=(ee,V)=>{const W=V*z+ee;O.emplaceBack(W+1,W,W+z),O.emplaceBack(W+z,W+z+1,W+1)};for(let ee=1;ee<129;ee++)for(let V=1;V<129;V++)X(V,ee);return[0,129].forEach(ee=>{for(let V=0;V<130;V++)X(V,ee),X(ee,V)}),[F,O,32768]}(),T=a.context;this.gridBuffer=T.createVertexBuffer(_,p.posAttributes.members),this.gridIndexBuffer=T.createIndexBuffer(v),this.gridSegments=p.SegmentVector.simpleSegment(0,0,_.length,v.length),this.gridNoSkirtSegments=p.SegmentVector.simpleSegment(0,0,_.length,b),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ha(h.map),this.orthoMatrix=p.create(),p.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,p.EXTENT,0,p.EXTENT,0,1);const M=T.gl;this._overlapStencilMode=new p.StencilMode({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=a.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Cc(h.map)}set style(a){a.on("data",this._onStyleDataEvent.bind(this)),a.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=a,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(a,h,_){if(a&&a.terrain){this._style!==a&&(this.style=a),this.enabled=!0;const v=a.terrain.properties;this.sourceCache=0===a.terrain.drapeRenderMode?this._mockSourceCache:a._getSourceCache(v.get("source")),this._exaggeration=v.get("exaggeration");const b=()=>{this.sourceCache.used&&p.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const T=this.getScaledDemTileSize();this.sourceCache.update(h,T,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,b(),this._initializing=!0),b(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(a){this._findCoveringTileCache[a]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const a=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==a.efficiency&&p.warnOnce(`Terrain render cache efficiency is not optimal (${a.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${a.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(a){a.coord&&"source"===a.dataType?this._clearRenderCacheForTile(a.sourceCacheId,a.coord):"style"===a.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const a in this._style._sourceCaches)this._style._sourceCaches[a].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(a=>a.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const a=2*this.proxySourceCache.getSource().tileSize;return[a,a]}set useVertexMorphing(a){this._useVertexMorphing=a}updateTileBinding(a){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const v=this.proxyCoords=h.getIds().map(k=>{const F=h.getTileByID(k).tileID;return F.projMatrix=_.calculateProjMatrix(F.toUnwrapped()),F});(function(k,F){const O=F.transform.pointCoordinate(F.transform.getCameraPoint()),z=new p.Point(O.x,O.y);k.sort(($,Q)=>{if(Q.overscaledZ-$.overscaledZ)return Q.overscaledZ-$.overscaledZ;const K=new p.Point($.canonical.x+(1<<$.canonical.z)*$.wrap,$.canonical.y),X=new p.Point(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),ee=z.mult(1<<$.canonical.z);return ee.x-=.5,ee.y-=.5,ee.distSqr(K)-ee.distSqr(X)})})(v,this.painter),this._previousZoom=_.zoom;const b=this.proxyToSource||{};this.proxyToSource={},v.forEach(k=>{this.proxyToSource[k.key]={}}),this.terrainTileForTile={};const T=this._style._sourceCaches;for(const k in T){const F=T[k];if(!F.used||(F!==this.sourceCache&&this.resetTileLookupCache(F.id),this._setupProxiedCoordsForOrtho(F,a[k],b),F.usedForTerrain))continue;const O=a[k];F.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[h.id]=v.map(k=>new Su(k,k.key,this.orthoMatrix)),this._assignTerrainTiles(v),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(b),this.renderingToTexture=!1,this._updateTimestamp=p.exported.now();const M={};this._visibleDemTiles=[];for(const k of this.proxyCoords){const F=this.terrainTileForTile[k.key];if(!F)continue;const O=F.tileID.key;O in M||(this._visibleDemTiles.push(F),M[O]=O)}}_assignTerrainTiles(a){this._initializing||a.forEach(h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)})}_prepareDEMTextures(){const a=this.painter.context,h=a.gl;for(const _ in this.terrainTileForTile){const v=this.terrainTileForTile[_],b=v.dem;!b||v.demTexture&&!v.needsDEMTextureUpload||(a.activeTexture.set(h.TEXTURE1),Cl(this.painter,v,b))}}_prepareDemTileUniforms(a,h,_,v){if(!h||null==h.demTexture)return!1;const b=a.tileID.canonical,T=Math.pow(2,h.tileID.canonical.z-b.z),M=v||"";return _[`u_dem_tl${M}`]=[b.x*T%1,b.y*T%1],_[`u_dem_scale${M}`]=T,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const a=this.painter.context,h=a.gl;if(!this._emptyDepthBufferTexture){const _=new p.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new p.Texture(a,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let a=0;const h=this._visibleDemTiles.reduce((_,v)=>{if(!v.dem)return _;const b=v.dem.tree.minimums[0];return b>0&&a++,_+b},0);return a?h/a:0}_updateEmptyDEMTexture(){const a=this.painter.context,h=a.gl;a.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),v=new p.RGBAImage({width:1,height:1},new Uint8Array(p.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let b=this._emptyDEMTexture;return b?b.update(v,{premultiply:!1}):b=this._emptyDEMTexture=new p.Texture(a,v,h.RGBA,{premultiply:!1}),b}setupElevationDraw(a,h,_){const v=this.painter.context,b=v.gl,T=(M=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:p.DEMData.getUnpackVector(M),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var M;T.u_dem_size=this.sourceCache.getSource().tileSize,T.u_exaggeration=this.exaggeration();let k=null,F=null,O=1;if(_&&_.morphing&&this._useVertexMorphing){const z=_.morphing.srcDemTile,$=_.morphing.dstDemTile;O=_.morphing.phase,z&&$&&(this._prepareDemTileUniforms(a,z,T,"_prev")&&(F=z),this._prepareDemTileUniforms(a,$,T)&&(k=$))}if(F&&k?(v.activeTexture.set(b.TEXTURE2),k.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),v.activeTexture.set(b.TEXTURE4),F.demTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE,b.NEAREST),T.u_dem_lerp=O):(k=this.terrainTileForTile[a.tileID.key],v.activeTexture.set(b.TEXTURE2),(this._prepareDemTileUniforms(a,k,T)?k.demTexture:this.emptyDEMTexture).bind(b.NEAREST,b.CLAMP_TO_EDGE)),v.activeTexture.set(b.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),this._depthFBO&&(T.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(b.NEAREST,b.CLAMP_TO_EDGE),T.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&k){const z=(1<<k.tileID.canonical.z)*p.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;T.u_meter_to_dem=z}if(_&&_.labelPlaneMatrixInv&&(T.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(v,T),"globe"===this.painter.transform.projection.name){const z=this.globeUniformValues(this.painter.transform,a.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(v,z)}}globeUniformValues(a,h,_){const v=a.projection;return{u_tile_tl_up:v.upVector(h,0,0),u_tile_tr_up:v.upVector(h,p.EXTENT,0),u_tile_br_up:v.upVector(h,p.EXTENT,p.EXTENT),u_tile_bl_up:v.upVector(h,0,p.EXTENT),u_tile_up_scale:_?p.globeMetersToEcef(1):v.upVectorScale(h,a.center.lat,a.worldSize).metersToTile}}renderToBackBuffer(a){const h=this.painter,_=this.painter.context;0!==a.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(v,b,T,M,k){if("globe"===v.transform.projection.name)!function(F,O,z,$,Q){const K=F.context,X=K.gl;let ee,V;const W=F.options.showTerrainWireframe?2:0,ie=F.transform,te=p.globeUseCustomAntiAliasing(F,K,ie),pe=(Qe,Te)=>{if(V===Qe)return;const Le=[Ha[Qe],"PROJECTION_GLOBE_VIEW"];te&&Le.push("CUSTOM_ANTIALIASING"),Te&&Le.push(Ha[W]),ee=F.useProgram("globeRaster",null,Le),V=Qe},me=F.colorModeForRenderPass(),fe=new p.DepthMode(X.LEQUAL,p.DepthMode.ReadWrite,F.depthRangeFor3D);Zr.update(Q);const ve=p.calculateGlobeMercatorMatrix(ie),ye=[p.mercatorXfromLng(ie.center.lng),p.mercatorYfromLat(ie.center.lat)],Me=W?[!1,!0]:[!1],Ze=F.globeSharedBuffers,Ce=[ie.width*p.exported.devicePixelRatio,ie.height*p.exported.devicePixelRatio],Be=Float32Array.from(ie.globeMatrix),Se={useDenormalizedUpVectorScale:!0};if(Me.forEach(Qe=>{const Te=F.transform,Le=gt(Te.zoom)*O.exaggeration();V=-1;const Xe=Qe?X.LINES:X.TRIANGLES;for(const He of $){const nt=z.getTile(He),Ct=p.StencilMode.disabled,zt=O.prevTerrainTileForTile[He.key],vt=O.terrainTileForTile[He.key];ls(zt,vt)&&Zr.newMorphing(He.key,zt,vt,Q,250),K.activeTexture.set(X.TEXTURE0),nt.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);const kt=Zr.getMorphValuesForProxy(He.key),dn=kt?1:0;kt&&p.extend$1(Se,{morphing:{srcDemTile:kt.from,dstDemTile:kt.to,phase:p.easeCubicInOut(kt.phase)}});const cn=p.tileCornersToBounds(He.canonical),Et=p.getLatitudinalLod(cn.getCenter().lat),Sn=p.getGridMatrix(He.canonical,cn,Et,Te.worldSize/Te._pixelsPerMercatorPixel),Un=p.globeNormalizeECEF(p.globeTileBounds(He.canonical)),kn=Ec(Te.projMatrix,Be,ve,Un,p.globeToMercatorTransition(Te.zoom),ye,Te.frustumCorners.TL,Te.frustumCorners.TR,Te.frustumCorners.BR,Te.frustumCorners.BL,Te.globeCenterInViewSpace,Te.globeRadius,Ce,Le,Sn);if(pe(dn,Qe),O.setupElevationDraw(nt,ee,Se),F.prepareDrawProgram(K,ee,He.toUnwrapped()),Ze){const[jn,ar,Si]=Qe?Ze.getWirefameBuffers(F.context,Et):Ze.getGridBuffers(Et,0!==Le);ee.draw(K,Xe,fe,Ct,me,p.CullFaceMode.backCCW,kn,"globe_raster",jn,ar,Si)}}}),Ze){const Qe=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];te&&Qe.push("CUSTOM_ANTIALIASING"),ee=F.useProgram("globeRaster",null,Qe);for(const Te of $){const{x:Le,y:Xe,z:He}=Te.canonical,nt=0===Xe,Ct=Xe===(1<<He)-1,[zt,vt,kt,dn]=Ze.getPoleBuffers(He);if(dn&&(nt||Ct)){const cn=z.getTile(Te);K.activeTexture.set(X.TEXTURE0),cn.texture.bind(X.LINEAR,X.CLAMP_TO_EDGE);let Et=p.globePoleMatrixForTile(He,Le,ie);const Sn=p.globeNormalizeECEF(p.globeTileBounds(Te.canonical)),Un=(kn,jn)=>kn.draw(K,X.TRIANGLES,fe,p.StencilMode.disabled,me,p.CullFaceMode.disabled,Ec(ie.projMatrix,Et,Et,Sn,0,ye,ie.frustumCorners.TL,ie.frustumCorners.TR,ie.frustumCorners.BR,ie.frustumCorners.BL,ie.globeCenterInViewSpace,ie.globeRadius,Ce,0),"globe_pole_raster",jn,kt,dn);O.setupElevationDraw(cn,ee,Se),F.prepareDrawProgram(K,ee,Te.toUnwrapped()),nt&&Un(ee,zt),Ct&&(Et=p.scale(p.create(),Et,[1,-1,1]),Un(ee,vt))}}}}(v,b,T,M,k);else{const F=v.context,O=F.gl;let z,$;const Q=v.options.showTerrainWireframe?2:0,K=(ie,te)=>{if($===ie)return;const pe=[Ha[ie]];te&&pe.push(Ha[Q]),z=v.useProgram("terrainRaster",null,pe),$=ie},X=v.colorModeForRenderPass(),ee=new p.DepthMode(O.LEQUAL,p.DepthMode.ReadWrite,v.depthRangeFor3D);Zr.update(k);const V=v.transform,W=gt(V.zoom)*b.exaggeration();(Q?[!1,!0]:[!1]).forEach(ie=>{$=-1;const te=ie?O.LINES:O.TRIANGLES,[pe,me]=ie?b.getWirefameBuffer():[b.gridIndexBuffer,b.gridSegments];for(const fe of M){const ve=T.getTile(fe),ye=p.StencilMode.disabled,Me=b.prevTerrainTileForTile[fe.key],Ze=b.terrainTileForTile[fe.key];ls(Me,Ze)&&Zr.newMorphing(fe.key,Me,Ze,k,250),F.activeTexture.set(O.TEXTURE0),ve.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const Ce=Zr.getMorphValuesForProxy(fe.key),Be=Ce?1:0;let Se;Ce&&(Se={morphing:{srcDemTile:Ce.from,dstDemTile:Ce.to,phase:p.easeCubicInOut(Ce.phase)}});const Qe=Il(fe.projMatrix,ed(fe.canonical,V.renderWorldCopies)?W/10:W);K(Be,ie),b.setupElevationDraw(ve,z,Se),v.prepareDrawProgram(F,z,fe.toUnwrapped()),z.draw(F,te,ee,ye,X,p.CullFaceMode.backCCW,Qe,"terrain_raster",b.gridBuffer,pe,me)}})}}(h,this,this.proxySourceCache,a,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),a.splice(0,a.length))}renderBatch(a){if(0===this._drapedRenderBatches.length)return a+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,v=this.proxySourceCache,b=this.proxiedCoords[v.id],T=this._drapedRenderBatches.shift(),M=[],k=h.style.order;let F=0;for(const O of b){const z=v.getTileByID(O.proxyTileKey),$=v.proxyCachedFBO[O.key]?v.proxyCachedFBO[O.key][a]:void 0,Q=void 0!==$?v.renderCache[$]:this.pool[F++],K=void 0!==$;if(z.texture=Q.tex,K&&!Q.dirty){M.push(z.tileID);continue}let X;_.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(_.clear({color:p.Color.transparent,stencil:0}),Q.dirty=!1);for(let ee=T.start;ee<=T.end;++ee){const V=h.style._layers[k[ee]];if(V.isHidden(h.transform.zoom))continue;const W=h.style._getLayerSourceCache(V),ie=W?this.proxyToSource[O.key][W.id]:[O];if(!ie)continue;const te=ie;_.viewport.set([0,0,Q.fb.width,Q.fb.height]),X!==(W?W.id:null)&&(this._setupStencil(Q,ie,V,W),X=W?W.id:null),h.renderLayer(h,W,V,te)}this.renderedToTile?(Q.dirty=!0,M.push(z.tileID)):K||--F,5===F&&(F=0,this.renderToBackBuffer(M))}return this.renderToBackBuffer(M),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),T.end+1}postRender(){}renderCacheEfficiency(a){const h=a.order.length;if(0===h)return{efficiency:100};let _,v=0,b=0,T=!1;for(let M=0;M<h;++M){const k=a._layers[a.order[M]];this._style.isLayerDraped(k)?(T&&++v,++b):T||(T=!0,_=k.id)}return 0===b?{efficiency:100}:{efficiency:100*(1-v/b),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let a=0;return this._visibleDemTiles.filter(h=>h.dem).forEach(h=>{a=Math.min(a,h.dem.tree.minimums[0])}),0===a?a:(a-30)*this._exaggeration}raycast(a,h,_){if(!this._visibleDemTiles)return null;const v=this._visibleDemTiles.filter(b=>b.dem).map(b=>{const T=b.tileID,M=1<<T.overscaledZ,{x:k,y:F}=T.canonical,O=k/M,z=(k+1)/M,$=F/M,Q=(F+1)/M;return{minx:O,miny:$,maxx:z,maxy:Q,t:b.dem.tree.raycastRoot(O,$,z,Q,a,h,_),tile:b}});v.sort((b,T)=>(null!==b.t?b.t:Number.MAX_VALUE)-(null!==T.t?T.t:Number.MAX_VALUE));for(const b of v){if(null==b.t)return null;const T=b.tile.dem.tree.raycast(b.minx,b.miny,b.maxx,b.maxy,a,h,_);if(null!=T)return T}return null}_createFBO(){const a=this.painter.context,h=a.gl,_=this.drapeBufferSize;a.activeTexture.set(h.TEXTURE0);const v=new p.Texture(a,{width:_[0],height:_[1],data:null},h.RGBA);v.bind(h.LINEAR,h.CLAMP_TO_EDGE);const b=a.createFramebuffer(_[0],_[1],!1);return b.colorAttachment.set(v.texture),b.depthAttachment=new ge(a,b.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=a.createRenderbuffer(a.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,b.depthAttachment.set(this._sharedDepthStencil),a.clear({stencil:0})):b.depthAttachment.set(this._sharedDepthStencil),a.extTextureFilterAnisotropic&&!a.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,a.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,a.extTextureFilterAnisotropicMax),{fb:b,tex:v,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const a in this._style._sourceCaches)if(this._style._sourceCaches[a].hasTransition())return!0;return this._style.order.some(a=>{const h=this._style._layers[a],_=h.isHidden(this.painter.transform.zoom);return"custom"===h.type?!_&&h.shouldRedrape():!_&&h.hasTransition()})}_clearLineLayersFromRenderCache(){let a=!1;for(const _ of this._style._getSources())if(_ instanceof at){a=!0;break}if(!a)return;const h={};for(let _=0;_<this._style.order.length;++_){const v=this._style._layers[this._style.order[_]],b=this._style._getLayerSourceCache(v);if(b&&!h[b.id]&&!v.isHidden(this.painter.transform.zoom)&&"line"===v.type&&v.widthExpression()instanceof p.ZoomDependentExpression){h[b.id]=!0;for(const T of this.proxyCoords){const M=this.proxyToSource[T.key][b.id];if(M)for(const k of M)this._clearRenderCacheForTile(b.id,k)}}}}_clearRasterLayersFromRenderCache(){let a=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof tt){a=!0;break}if(!a)return;const h={};for(let _=0;_<this._style.order.length;++_){const v=this._style._layers[this._style.order[_]],b=this._style._getLayerSourceCache(v);if(!b||h[b.id]||v.isHidden(this.painter.transform.zoom)||"raster"!==v.type)continue;const T=v.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const k=this.proxyToSource[M.key][b.id];if(k)for(const F of k){const O=Tl(b.getTile(F),b.findLoadedParent(F,0),b,this.painter.transform,T);(1!==O.opacity||0!==O.mix)&&this._clearRenderCacheForTile(b.id,F)}}}}_setupDrapedRenderBatches(){const a=this._style.order,h=a.length;if(0===h)return;const _=[];let v,b=0,T=this._style._layers[a[b]];for(;!this._style.isLayerDraped(T)&&T.isHidden(this.painter.transform.zoom)&&++b<h;)T=this._style._layers[a[b]];for(;b<h;++b){const M=this._style._layers[a[b]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?void 0===v&&(v=b):void 0!==v&&(_.push({start:v,end:b-1}),v=void 0))}void 0!==v&&_.push({start:v,end:b-1}),this._drapedRenderBatches=_}_setupRenderCache(a){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const T=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let M=0;M<T.length;++M){const k=Object.values(T[M]);h.renderCachePool.push(...k)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,v=this._tilesDirty;for(let T=_.length-1;T>=0;T--){const M=_[T];if(h.getTileByID(M.key),void 0!==h.proxyCachedFBO[M.key]){const k=a[M.key],F=this.proxyToSource[M.key];let O=0;for(const z in F){const $=F[z],Q=k[z];if(!Q||Q.length!==$.length||$.some((K,X)=>K!==Q[X]||v[z]&&v[z].hasOwnProperty(K.key))){O=-1;break}++O}for(const z in h.proxyCachedFBO[M.key])h.renderCache[h.proxyCachedFBO[M.key][z]].dirty=O<0||O!==Object.values(k).length}}const b=[...this._drapedRenderBatches];b.sort((T,M)=>M.end-M.start-(T.end-T.start));for(const T of b)for(const M of _){if(h.proxyCachedFBO[M.key])continue;let k=h.renderCachePool.pop();void 0===k&&h.renderCache.length<50&&(k=h.renderCache.length,h.renderCache.push(this._createFBO())),void 0!==k&&(h.proxyCachedFBO[M.key]={},h.proxyCachedFBO[M.key][T.start]=k,h.renderCache[k].dirty=!0)}this._tilesDirty={}}_setupStencil(a,h,_,v){if(!v||!this._sourceTilesOverlap[v.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const b=this.painter.context,T=b.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let M;if(_.isTileClipped())M=h.length,this._overlapStencilMode.test={func:T.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:T.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(b.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(a){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[a.key]),this._overlapStencilMode):p.StencilMode.disabled}_renderTileClippingMasks(a,h){const _=this.painter,v=this.painter.context,b=v.gl;_._tileClippingMaskIDs={},v.setColorMode(p.ColorMode.disabled),v.setDepthMode(p.DepthMode.disabled);const T=_.useProgram("clippingMask");for(const M of a){const k=_._tileClippingMaskIDs[M.key]=--h;T.draw(v,b.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:b.ALWAYS,mask:0},k,255,b.KEEP,b.KEEP,b.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,Wt(M.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(a){const h=this.painter.transform;if(a.x<0||a.x>h.width||a.y<0||a.y>h.height)return null;const _=[a.x,a.y,1,1];p.transformMat4$1(_,_,h.pixelMatrixInverse),p.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const v=h._camera.position,b=p.mercatorZfromAltitude(1,h.center.lat),T=[v[0],v[1],v[2]/b,0],M=p.subtract([],_.slice(0,3),T);p.normalize(M,M);const k=this.raycast(T,M,this._exaggeration);return null!==k&&k?(p.scaleAndAdd(T,T,M,k),T[3]=T[2],T[2]*=b,T):null}drawDepth(){const a=this.painter,h=a.context,_=this.proxySourceCache,v=Math.ceil(a.width),b=Math.ceil(a.height);if(!this._depthFBO||this._depthFBO.width===v&&this._depthFBO.height===b||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const T=h.gl,M=h.createFramebuffer(v,b,!0);h.activeTexture.set(T.TEXTURE0);const k=new p.Texture(h,{width:v,height:b,data:null},T.RGBA);k.bind(T.NEAREST,T.CLAMP_TO_EDGE),M.colorAttachment.set(k.texture);const F=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,v,b);M.depthAttachment.set(F),this._depthFBO=M,this._depthTexture=k}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,v,b]),function(T,M,k,F){if("globe"===T.transform.projection.name)return;const O=T.context,z=O.gl;O.clear({depth:1});const $=T.useProgram("terrainDepth"),Q=new p.DepthMode(z.LESS,p.DepthMode.ReadWrite,T.depthRangeFor3D);for(const K of F){const X=k.getTile(K),ee=Il(K.projMatrix,0);M.setupElevationDraw(X,$),$.draw(O,z.TRIANGLES,Q,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.backCCW,ee,"terrain_depth",M.gridBuffer,M.gridIndexBuffer,M.gridNoSkirtSegments)}}(a,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(a,h,_){if(a.getSource()instanceof Ot)return this._setupProxiedCoordsForImageSource(a,h,_);this._findCoveringTileCache[a.id]=this._findCoveringTileCache[a.id]||{};const v=this.proxiedCoords[a.id]=[],b=this.proxyCoords;for(let M=0;M<b.length;M++){const k=b[M],F=this._findTileCoveringTileID(k,a);if(F){const O=this._createProxiedId(k,F,_[k.key]&&_[k.key][a.id]);v.push(O),this.proxyToSource[k.key][a.id]=[O]}}let T=!1;for(let M=0;M<h.length;M++){const k=a.getTile(h[M]);if(!k||!k.hasData())continue;const F=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(F&&F.tileID.canonical.z!==k.tileID.canonical.z){const O=this.proxyToSource[F.tileID.key][a.id],z=this._createProxiedId(F.tileID,k,_[F.tileID.key]&&_[F.tileID.key][a.id]);O?O.splice(O.length-1,0,z):this.proxyToSource[F.tileID.key][a.id]=[z],v.push(z),T=!0}}this._sourceTilesOverlap[a.id]=T}_setupProxiedCoordsForImageSource(a,h,_){if(!a.getSource().loaded())return;const v=this.proxiedCoords[a.id]=[],b=this.proxyCoords,T=a.getSource(),M=new p.Point(T.tileID.x,T.tileID.y)._div(1<<T.tileID.z),k=T.coordinates.map(p.MercatorCoordinate.fromLngLat).reduce((O,z)=>(O.min.x=Math.min(O.min.x,z.x-M.x),O.min.y=Math.min(O.min.y,z.y-M.y),O.max.x=Math.max(O.max.x,z.x-M.x),O.max.y=Math.max(O.max.y,z.y-M.y),O),{min:new p.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new p.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),F=(O,z)=>{const $=O.wrap+O.canonical.x/(1<<O.canonical.z),Q=O.canonical.y/(1<<O.canonical.z),K=p.EXTENT/(1<<O.canonical.z),X=z.wrap+z.canonical.x/(1<<z.canonical.z),ee=z.canonical.y/(1<<z.canonical.z);return $+K<X+k.min.x||$>X+k.max.x||Q+K<ee+k.min.y||Q>ee+k.max.y};for(let O=0;O<b.length;O++){const z=b[O];for(let $=0;$<h.length;$++){const Q=a.getTile(h[$]);if(!Q||!Q.hasData()||F(z,Q.tileID))continue;const K=this._createProxiedId(z,Q,_[z.key]&&_[z.key][a.id]),X=this.proxyToSource[z.key][a.id];X?X.push(K):this.proxyToSource[z.key][a.id]=[K],v.push(K)}}}_createProxiedId(a,h,_){let v=this.orthoMatrix;if(_){const b=_.find(T=>T.key===h.tileID.key);if(b)return b}if(h.tileID.key!==a.key){const b=a.canonical.z-h.tileID.canonical.z;let T,M,k;v=p.create();const F=h.tileID.wrap-a.wrap<<a.overscaledZ;b>0?(T=p.EXTENT>>b,M=T*((h.tileID.canonical.x<<b)-a.canonical.x+F),k=T*((h.tileID.canonical.y<<b)-a.canonical.y)):(T=p.EXTENT<<-b,M=p.EXTENT*(h.tileID.canonical.x-(a.canonical.x+F<<-b)),k=p.EXTENT*(h.tileID.canonical.y-(a.canonical.y<<-b))),p.ortho(v,0,T,0,T,0,1),p.translate(v,v,[M,k,0])}return new Su(h.tileID,a.key,v)}_findTileCoveringTileID(a,h){let _=h.getTile(a);if(_&&_.hasData())return _;const v=this._findCoveringTileCache[h.id],b=v[a.key];if(_=b?h.getTileByID(b):null,_&&_.hasData()||null===b)return _;let T=_?_.tileID:a,M=T.overscaledZ;const k=h.getSource().minzoom,F=[];if(!b){const z=h.getSource().maxzoom;if(a.canonical.z>=z){const $=a.canonical.z-z;h.getSource().reparseOverscaled?(M=Math.max(a.canonical.z+2,h.transform.tileZoom),T=new p.OverscaledTileID(M,a.wrap,z,a.canonical.x>>$,a.canonical.y>>$)):0!==$&&(M=z,T=new p.OverscaledTileID(M,a.wrap,z,a.canonical.x>>$,a.canonical.y>>$))}T.key!==a.key&&(F.push(T.key),_=h.getTile(T))}const O=z=>{F.forEach($=>{v[$]=z}),F.length=0};for(M-=1;M>=k&&(!_||!_.hasData());M--){_&&O(_.tileID.key);const z=T.calculateScaledKey(M);if(_=h.getTileByID(z),_&&_.hasData())break;const $=v[z];if(null===$)break;void 0===$?F.push(z):_=h.getTileByID($)}return O(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(a){return this.enabled?this._findTileCoveringTileID(a,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(a,h){let _=this._tilesDirty[a];_||(_=this._tilesDirty[a]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const a=function(h){let _=0;const v=new p.StructArrayLayout2ui4,b=131;for(let T=1;T<129;T++){for(let M=1;M<129;M++)_=T*b+M,v.emplaceBack(_,_+1),v.emplaceBack(_,_+b),v.emplaceBack(_+1,_+b),128===T&&v.emplaceBack(_+b,_+b+1);v.emplaceBack(_+1,_+1+b)}return v}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(a),this.wireframeSegments=p.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,a.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class bn{static cacheKey(a,h,_,v){let b=`${h}${v?v.cacheKey:""}`;for(const T of _)a.usedDefines.includes(T)&&(b+=`/${T}`);return b}constructor(a,h,_,v,b,T){const M=a.gl;this.program=M.createProgram();const k=function(V){const W=[];for(let ie=0;ie<V.length;ie++){if(null===V[ie])continue;const te=V[ie].split(" ");W.push(te.pop())}return W}(_.staticAttributes),F=v?v.getBinderAttributes():[],O=k.concat(F);let z=v?v.defines():[];z=z.concat(T.map(V=>`#define ${V}`));const $=a.isWebGL2?"#version 300 es\n":"",Q=$+z.concat(a.extStandardDerivatives&&0===$.length?"#extension GL_OES_standard_derivatives : enable\n".concat(_p):_p,_p,bc,io.fragmentSource,ua.fragmentSource,_.fragmentSource).join("\n"),K=$+z.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",bc,io.vertexSource,ua.vertexSource,Bt.vertexSource,_.vertexSource).join("\n"),X=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(X,Q),M.compileShader(X),M.attachShader(this.program,X);const ee=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(ee,K),M.compileShader(ee),M.attachShader(this.program,ee),this.attributes={},this.numAttributes=O.length;for(let V=0;V<this.numAttributes;V++)O[V]&&(M.bindAttribLocation(this.program,V,O[V]),this.attributes[O[V]]=V);M.linkProgram(this.program),M.deleteShader(ee),M.deleteShader(X),this.fixedUniforms=b(a),this.binderUniforms=v?v.getUniforms(a):[],T.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new p.Uniform1i(V=a),u_dem_prev:new p.Uniform1i(V),u_dem_unpack:new p.Uniform4f(V),u_dem_tl:new p.Uniform2f(V),u_dem_scale:new p.Uniform1f(V),u_dem_tl_prev:new p.Uniform2f(V),u_dem_scale_prev:new p.Uniform1f(V),u_dem_size:new p.Uniform1f(V),u_dem_lerp:new p.Uniform1f(V),u_exaggeration:new p.Uniform1f(V),u_depth:new p.Uniform1i(V),u_depth_size_inv:new p.Uniform2f(V),u_meter_to_dem:new p.Uniform1f(V),u_label_plane_matrix_inv:new p.UniformMatrix4f(V)}),T.includes("GLOBE")&&(this.globeUniforms=(V=>({u_tile_tl_up:new p.Uniform3f(V),u_tile_tr_up:new p.Uniform3f(V),u_tile_br_up:new p.Uniform3f(V),u_tile_bl_up:new p.Uniform3f(V),u_tile_up_scale:new p.Uniform1f(V)}))(a)),T.includes("FOG")&&(this.fogUniforms=(V=>({u_fog_matrix:new p.UniformMatrix4f(V),u_fog_range:new p.Uniform2f(V),u_fog_color:new p.Uniform4f(V),u_fog_horizon_blend:new p.Uniform1f(V),u_fog_temporal_offset:new p.Uniform1f(V),u_frustum_tl:new p.Uniform3f(V),u_frustum_tr:new p.Uniform3f(V),u_frustum_br:new p.Uniform3f(V),u_frustum_bl:new p.Uniform3f(V),u_globe_pos:new p.Uniform3f(V),u_globe_radius:new p.Uniform1f(V),u_globe_transition:new p.Uniform1f(V),u_is_globe:new p.Uniform1i(V),u_viewport:new p.Uniform2f(V)}))(a))}var V}setTerrainUniformValues(a,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const v in h)_[v]&&_[v].set(this.program,v,h[v])}}setGlobeUniformValues(a,h){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const v in h)_[v]&&_[v].set(this.program,v,h[v])}}setFogUniformValues(a,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){a.program.set(this.program);for(const v in h)_[v].set(this.program,v,h[v])}}draw(a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X){const ee=a.gl;if(this.failedToCreate)return;a.program.set(this.program),a.setDepthMode(_),a.setStencilMode(v),a.setColorMode(b),a.setCullFace(T);for(const W of Object.keys(this.fixedUniforms))this.fixedUniforms[W].set(this.program,W,M[W]);K&&K.setUniforms(this.program,a,this.binderUniforms,$,{zoom:Q});const V={[ee.LINES]:2,[ee.TRIANGLES]:3,[ee.LINE_STRIP]:1}[h];for(const W of z.get()){const ie=W.vaos||(W.vaos={});(ie[k]||(ie[k]=new ny)).bind(a,this,F,K?K.getPaintVertexBuffers():[],O,W.vertexOffset,X||[]),ee.drawElements(h,W.primitiveLength*V,ee.UNSIGNED_SHORT,W.primitiveOffset*V*2)}}}function ro(f,a){const h=Math.pow(2,a.tileID.overscaledZ),_=a.tileSize*Math.pow(2,f.transform.tileZoom)/h,v=_*(a.tileID.canonical.x+a.tileID.wrap*h),b=_*a.tileID.canonical.y;return{u_image:0,u_texsize:a.imageAtlasTexture.size,u_tile_units_to_pixels:1/zi(a,1,f.transform.tileZoom),u_pixel_coord_upper:[v>>16,b>>16],u_pixel_coord_lower:[65535&v,65535&b]}}const Fo=p.create(),mo=(f,a,h,_,v,b,T,M,k,F,O)=>{const z=a.style.light,$=z.properties.get("position"),Q=[$.x,$.y,$.z],K=p.create$1();"viewport"===z.properties.get("anchor")&&(p.fromRotation(K,-a.transform.angle),p.transformMat3(Q,Q,K));const X=z.properties.get("color"),ee=a.transform,V={u_matrix:f,u_lightpos:Q,u_lightintensity:z.properties.get("intensity"),u_lightcolor:[X.r,X.g,X.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fo,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:v,u_edge_radius:b};return"globe"===ee.projection.name&&(V.u_tile_id=[T.canonical.x,T.canonical.y,1<<T.canonical.z],V.u_zoom_transition=k,V.u_inv_rot_matrix=O,V.u_merc_center=F,V.u_up_dir=ee.projection.upVector(new p.CanonicalTileID(0,0,0),F[0]*p.EXTENT,F[1]*p.EXTENT),V.u_height_lift=M),V},cs=(f,a,h,_,v,b,T,M,k,F,O,z)=>{const $=mo(f,a,h,_,v,b,T,k,F,O,z),Q={u_height_factor:-Math.pow(2,T.overscaledZ)/M.tileSize/8};return p.extend($,ro(a,M),Q)},wn=f=>({u_matrix:f}),Ml=(f,a,h)=>p.extend(wn(f),ro(a,h)),nd=(f,a)=>({u_matrix:f,u_world:a}),id=(f,a,h,_)=>p.extend(Ml(f,a,h),{u_world:_}),vp=p.create(),Lo=(f,a,h,_,v,b)=>{const T=f.transform,M="globe"===T.projection.name;let k;if("map"===b.paint.get("circle-pitch-alignment"))if(M){const O=p.globePixelsToTileUnits(T.zoom,a.canonical)*T._pixelsPerMercatorPixel;k=Float32Array.from([O,0,0,O])}else k=T.calculatePixelsToTileUnitsMatrix(h);else k=new Float32Array([T.pixelsToGLUnits[0],0,0,T.pixelsToGLUnits[1]]);const F={u_camera_to_center_distance:T.cameraToCenterDistance,u_matrix:f.translatePosMatrix(a.projMatrix,h,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:p.exported.devicePixelRatio,u_extrude_scale:k,u_inv_rot_matrix:vp,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(M){F.u_inv_rot_matrix=_,F.u_merc_center=v,F.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],F.u_zoom_transition=p.globeToMercatorTransition(T.zoom);const O=v[0]*p.EXTENT,z=v[1]*p.EXTENT;F.u_up_dir=T.projection.upVector(new p.CanonicalTileID(0,0,0),O,z)}return F},Ga=f=>{const a=[];return"map"===f.paint.get("circle-pitch-alignment")&&a.push("PITCH_WITH_MAP"),"map"===f.paint.get("circle-pitch-scale")&&a.push("SCALE_WITH_MAP"),a},rd=(f,a,h,_)=>{const v=p.EXTENT/h.tileSize;return{u_matrix:f,u_camera_to_center_distance:a.getCameraToCenterDistance(_),u_extrude_scale:[a.pixelsToGLUnits[0]/v,a.pixelsToGLUnits[1]/v]}},vr=(f,a,h=1)=>({u_matrix:f,u_color:a,u_overlay:0,u_overlay_scale:h}),od=p.create(),Ap=(f,a,h,_,v,b,T)=>{const M=f.transform,k="globe"===M.projection.name,F=k?p.globePixelsToTileUnits(M.zoom,a.canonical)*M._pixelsPerMercatorPixel:zi(h,1,b),O={u_matrix:a.projMatrix,u_extrude_scale:F,u_intensity:T,u_inv_rot_matrix:od,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(k){O.u_inv_rot_matrix=_,O.u_merc_center=v,O.u_tile_id=[a.canonical.x,a.canonical.y,1<<a.canonical.z],O.u_zoom_transition=p.globeToMercatorTransition(M.zoom);const z=v[0]*p.EXTENT,$=v[1]*p.EXTENT;O.u_up_dir=M.projection.upVector(new p.CanonicalTileID(0,0,0),z,$)}return O},ym=(f,a,h,_,v,b,T)=>{const M=f.transform,k=M.calculatePixelsToTileUnitsMatrix(a);return{u_matrix:ku(f,a,h,_),u_pixels_to_tile_units:k,u_device_pixel_ratio:b,u_units_to_pixels:[1/M.pixelsToGLUnits[0],1/M.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:v,u_texsize:Nt(h)?a.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Dl(a,f.transform),u_alpha_discard_threshold:0,u_trim_offset:T}},Vi=(f,a,h,_,v)=>{const b=f.transform;return{u_matrix:ku(f,a,h,_),u_texsize:a.imageAtlasTexture.size,u_pixels_to_tile_units:b.calculatePixelsToTileUnitsMatrix(a),u_device_pixel_ratio:v,u_image:0,u_tile_units_to_pixels:Dl(a,b),u_units_to_pixels:[1/b.pixelsToGLUnits[0],1/b.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Dl(f,a){return 1/zi(f,1,a.tileZoom)}function ku(f,a,h,_){return f.translatePosMatrix(_||a.tileID.projMatrix,a,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function Nt(f){const a=f.paint.get("line-dasharray").value;return a.value||"constant"!==a.kind}const Ar=(f,a,h,_,v,b)=>{return{u_matrix:f,u_tl_parent:a,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*v.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:v.paint.get("raster-brightness-min"),u_brightness_high:v.paint.get("raster-brightness-max"),u_saturation_factor:(M=v.paint.get("raster-saturation"),M>0?1-1/(1.001-M):-M),u_contrast_factor:(T=v.paint.get("raster-contrast"),T>0?1/(1-T):1+T),u_spin_weights:gn(v.paint.get("raster-hue-rotate")),u_perspective_transform:b};var T,M};function gn(f){f*=Math.PI/180;const a=Math.sin(f),h=Math.cos(f);return[(2*h+1)/3,(-Math.sqrt(3)*a-h+1)/3,(Math.sqrt(3)*a-h+1)/3]}const Ui=p.create(),xr=(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X)=>{const ee=v.transform,V={u_is_size_zoom_constant:+("constant"===f||"source"===f),u_is_size_feature_constant:+("constant"===f||"camera"===f),u_size_t:a?a.uSizeT:0,u_size:a?a.uSize:0,u_camera_to_center_distance:ee.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:ee.width/ee.height,u_fade_change:v.options.fadeDuration?v.symbolFadeChange:1,u_matrix:b,u_label_plane_matrix:T,u_coord_matrix:M,u_is_text:+k,u_pitch_with_map:+_,u_texsize:F,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ui,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ui,u_up_vector:[0,-1,0]};return"globe"===X.name&&(V.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],V.u_zoom_transition=z,V.u_inv_rot_matrix=Q,V.u_merc_center=$,V.u_camera_forward=ee._camera.forward(),V.u_ecef_origin=p.globeECEFOrigin(ee.globeMatrix,O.toUnwrapped()),V.u_tile_matrix=Float32Array.from(ee.globeMatrix),V.u_up_vector=K),V},Rs=(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X,ee)=>p.extend(xr(f,a,h,_,v,b,T,M,k,F,z,$,Q,K,X,ee),{u_gamma_scale:_?v.transform.cameraToCenterDistance*Math.cos(v.terrain?0:v.transform._pitch):1,u_device_pixel_ratio:p.exported.devicePixelRatio,u_is_halo:+O}),Qr=(f,a,h,_,v,b,T,M,k,F,O,z,$,Q,K,X)=>p.extend(Rs(f,a,h,_,v,b,T,M,!0,k,!0,O,z,$,Q,K,X),{u_texsize_icon:F,u_texture_icon:1}),Pu=(f,a,h)=>({u_matrix:f,u_opacity:a,u_color:h}),xp=(f,a,h,_,v)=>p.extend(function(b,T,M){const k=T.imageManager.getPattern(b.toString()),{width:F,height:O}=T.imageManager.getPixelSize(),z=Math.pow(2,M.tileID.overscaledZ),$=M.tileSize*Math.pow(2,T.transform.tileZoom)/z,Q=$*(M.tileID.canonical.x+M.tileID.wrap*z),K=$*M.tileID.canonical.y;return{u_image:0,u_pattern_tl:k.tl,u_pattern_br:k.br,u_texsize:[F,O],u_pattern_size:k.displaySize,u_tile_units_to_pixels:1/zi(M,1,T.transform.tileZoom),u_pixel_coord_upper:[Q>>16,K>>16],u_pixel_coord_lower:[65535&Q,65535&K]}}(_,h,v),{u_matrix:f,u_opacity:a}),Sl={fillExtrusion:f=>({u_matrix:new p.UniformMatrix4f(f),u_lightpos:new p.Uniform3f(f),u_lightintensity:new p.Uniform1f(f),u_lightcolor:new p.Uniform3f(f),u_vertical_gradient:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_edge_radius:new p.Uniform1f(f),u_ao:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_up_dir:new p.Uniform3f(f),u_height_lift:new p.Uniform1f(f)}),fillExtrusionPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_lightpos:new p.Uniform3f(f),u_lightintensity:new p.Uniform1f(f),u_lightcolor:new p.Uniform3f(f),u_vertical_gradient:new p.Uniform1f(f),u_height_factor:new p.Uniform1f(f),u_edge_radius:new p.Uniform1f(f),u_ao:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_up_dir:new p.Uniform3f(f),u_height_lift:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f)}),fill:f=>({u_matrix:new p.UniformMatrix4f(f)}),fillPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f)}),fillOutline:f=>({u_matrix:new p.UniformMatrix4f(f),u_world:new p.Uniform2f(f)}),fillOutlinePattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_world:new p.Uniform2f(f),u_image:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f)}),circle:f=>({u_camera_to_center_distance:new p.Uniform1f(f),u_extrude_scale:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_up_dir:new p.Uniform3f(f)}),collisionBox:f=>({u_matrix:new p.UniformMatrix4f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_extrude_scale:new p.Uniform2f(f)}),collisionCircle:f=>({u_matrix:new p.UniformMatrix4f(f),u_inv_matrix:new p.UniformMatrix4f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_viewport_size:new p.Uniform2f(f)}),debug:f=>({u_color:new p.UniformColor(f),u_matrix:new p.UniformMatrix4f(f),u_overlay:new p.Uniform1i(f),u_overlay_scale:new p.Uniform1f(f)}),clippingMask:f=>({u_matrix:new p.UniformMatrix4f(f)}),heatmap:f=>({u_extrude_scale:new p.Uniform1f(f),u_intensity:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_up_dir:new p.Uniform3f(f)}),heatmapTexture:f=>({u_image:new p.Uniform1i(f),u_color_ramp:new p.Uniform1i(f),u_opacity:new p.Uniform1f(f)}),hillshade:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_latrange:new p.Uniform2f(f),u_light:new p.Uniform2f(f),u_shadow:new p.UniformColor(f),u_highlight:new p.UniformColor(f),u_accent:new p.UniformColor(f)}),hillshadePrepare:f=>({u_matrix:new p.UniformMatrix4f(f),u_image:new p.Uniform1i(f),u_dimension:new p.Uniform2f(f),u_zoom:new p.Uniform1f(f),u_unpack:new p.Uniform4f(f)}),line:f=>({u_matrix:new p.UniformMatrix4f(f),u_pixels_to_tile_units:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_units_to_pixels:new p.Uniform2f(f),u_dash_image:new p.Uniform1i(f),u_gradient_image:new p.Uniform1i(f),u_image_height:new p.Uniform1f(f),u_texsize:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f),u_alpha_discard_threshold:new p.Uniform1f(f),u_trim_offset:new p.Uniform2f(f)}),linePattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_texsize:new p.Uniform2f(f),u_pixels_to_tile_units:new p.UniformMatrix2f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_units_to_pixels:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f),u_alpha_discard_threshold:new p.Uniform1f(f)}),raster:f=>({u_matrix:new p.UniformMatrix4f(f),u_tl_parent:new p.Uniform2f(f),u_scale_parent:new p.Uniform1f(f),u_fade_t:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_image0:new p.Uniform1i(f),u_image1:new p.Uniform1i(f),u_brightness_low:new p.Uniform1f(f),u_brightness_high:new p.Uniform1f(f),u_saturation_factor:new p.Uniform1f(f),u_contrast_factor:new p.Uniform1f(f),u_spin_weights:new p.Uniform3f(f),u_perspective_transform:new p.Uniform2f(f)}),symbolIcon:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_camera_forward:new p.Uniform3f(f),u_tile_matrix:new p.UniformMatrix4f(f),u_up_vector:new p.Uniform3f(f),u_ecef_origin:new p.Uniform3f(f),u_texture:new p.Uniform1i(f)}),symbolSDF:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_texture:new p.Uniform1i(f),u_gamma_scale:new p.Uniform1f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_tile_id:new p.Uniform3f(f),u_zoom_transition:new p.Uniform1f(f),u_inv_rot_matrix:new p.UniformMatrix4f(f),u_merc_center:new p.Uniform2f(f),u_camera_forward:new p.Uniform3f(f),u_tile_matrix:new p.UniformMatrix4f(f),u_up_vector:new p.Uniform3f(f),u_ecef_origin:new p.Uniform3f(f),u_is_halo:new p.Uniform1i(f)}),symbolTextAndIcon:f=>({u_is_size_zoom_constant:new p.Uniform1i(f),u_is_size_feature_constant:new p.Uniform1i(f),u_size_t:new p.Uniform1f(f),u_size:new p.Uniform1f(f),u_camera_to_center_distance:new p.Uniform1f(f),u_rotate_symbol:new p.Uniform1i(f),u_aspect_ratio:new p.Uniform1f(f),u_fade_change:new p.Uniform1f(f),u_matrix:new p.UniformMatrix4f(f),u_label_plane_matrix:new p.UniformMatrix4f(f),u_coord_matrix:new p.UniformMatrix4f(f),u_is_text:new p.Uniform1i(f),u_pitch_with_map:new p.Uniform1i(f),u_texsize:new p.Uniform2f(f),u_texsize_icon:new p.Uniform2f(f),u_texture:new p.Uniform1i(f),u_texture_icon:new p.Uniform1i(f),u_gamma_scale:new p.Uniform1f(f),u_device_pixel_ratio:new p.Uniform1f(f),u_is_halo:new p.Uniform1i(f)}),background:f=>({u_matrix:new p.UniformMatrix4f(f),u_opacity:new p.Uniform1f(f),u_color:new p.UniformColor(f)}),backgroundPattern:f=>({u_matrix:new p.UniformMatrix4f(f),u_opacity:new p.Uniform1f(f),u_image:new p.Uniform1i(f),u_pattern_tl:new p.Uniform2f(f),u_pattern_br:new p.Uniform2f(f),u_texsize:new p.Uniform2f(f),u_pattern_size:new p.Uniform2f(f),u_pixel_coord_upper:new p.Uniform2f(f),u_pixel_coord_lower:new p.Uniform2f(f),u_tile_units_to_pixels:new p.Uniform1f(f)}),terrainRaster:Yh,terrainDepth:Yh,skybox:f=>({u_matrix:new p.UniformMatrix4f(f),u_sun_direction:new p.Uniform3f(f),u_cubemap:new p.Uniform1i(f),u_opacity:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f)}),skyboxGradient:f=>({u_matrix:new p.UniformMatrix4f(f),u_color_ramp:new p.Uniform1i(f),u_center_direction:new p.Uniform3f(f),u_radius:new p.Uniform1f(f),u_opacity:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f)}),skyboxCapture:f=>({u_matrix_3f:new p.UniformMatrix3f(f),u_sun_direction:new p.Uniform3f(f),u_sun_intensity:new p.Uniform1f(f),u_color_tint_r:new p.Uniform4f(f),u_color_tint_m:new p.Uniform4f(f),u_luminance:new p.Uniform1f(f)}),globeRaster:f=>({u_proj_matrix:new p.UniformMatrix4f(f),u_globe_matrix:new p.UniformMatrix4f(f),u_normalize_matrix:new p.UniformMatrix4f(f),u_merc_matrix:new p.UniformMatrix4f(f),u_zoom_transition:new p.Uniform1f(f),u_merc_center:new p.Uniform2f(f),u_image0:new p.Uniform1i(f),u_grid_matrix:new p.UniformMatrix3f(f),u_skirt_height:new p.Uniform1f(f),u_frustum_tl:new p.Uniform3f(f),u_frustum_tr:new p.Uniform3f(f),u_frustum_br:new p.Uniform3f(f),u_frustum_bl:new p.Uniform3f(f),u_globe_pos:new p.Uniform3f(f),u_globe_radius:new p.Uniform1f(f),u_viewport:new p.Uniform2f(f)}),globeAtmosphere:f=>({u_frustum_tl:new p.Uniform3f(f),u_frustum_tr:new p.Uniform3f(f),u_frustum_br:new p.Uniform3f(f),u_frustum_bl:new p.Uniform3f(f),u_horizon:new p.Uniform1f(f),u_transition:new p.Uniform1f(f),u_fadeout_range:new p.Uniform1f(f),u_color:new p.Uniform4f(f),u_high_color:new p.Uniform4f(f),u_space_color:new p.Uniform4f(f),u_star_intensity:new p.Uniform1f(f),u_star_density:new p.Uniform1f(f),u_star_size:new p.Uniform1f(f),u_temporal_offset:new p.Uniform1f(f),u_horizon_angle:new p.Uniform1f(f),u_rotation_matrix:new p.UniformMatrix4f(f)})};let go;function wt(f,a,h,_,v,b,T){const M=f.context,k=M.gl,F=f.transform,O=f.useProgram("collisionBox"),z=[];let $=0,Q=0;for(let te=0;te<_.length;te++){const pe=_[te],me=a.getTile(pe),fe=me.getBucket(h);if(!fe)continue;const ve=st(pe,fe,F);let ye=ve;0===v[0]&&0===v[1]||(ye=f.translatePosMatrix(ve,me,v,b));const Me=T?fe.textCollisionBox:fe.iconCollisionBox,Ze=fe.collisionCircleArray;if(Ze.length>0){const Ce=p.create(),Be=ye;p.mul(Ce,fe.placementInvProjMatrix,F.glCoordMatrix),p.mul(Ce,Ce,fe.placementViewportMatrix),z.push({circleArray:Ze,circleOffset:Q,transform:Be,invTransform:Ce,projection:fe.getProjection()}),$+=Ze.length/4,Q=$}Me&&(f.terrain&&f.terrain.setupElevationDraw(me,O),O.draw(M,k.LINES,p.DepthMode.disabled,p.StencilMode.disabled,f.colorModeForRenderPass(),p.CullFaceMode.disabled,rd(ye,F,me,fe.getProjection()),h.id,Me.layoutVertexBuffer,Me.indexBuffer,Me.segments,null,F.zoom,null,[Me.collisionVertexBuffer,Me.collisionVertexBufferExt]))}if(!T||!z.length)return;const K=f.useProgram("collisionCircle"),X=new p.StructArrayLayout2f1f2i16;X.resize(4*$),X._trim();let ee=0;for(const te of z)for(let pe=0;pe<te.circleArray.length/4;pe++){const me=4*pe,fe=te.circleArray[me+0],ve=te.circleArray[me+1],ye=te.circleArray[me+2],Me=te.circleArray[me+3];X.emplace(ee++,fe,ve,ye,Me,0),X.emplace(ee++,fe,ve,ye,Me,1),X.emplace(ee++,fe,ve,ye,Me,2),X.emplace(ee++,fe,ve,ye,Me,3)}(!go||go.length<2*$)&&(go=function(te){const pe=2*te,me=new p.StructArrayLayout3ui6;me.resize(pe),me._trim();for(let fe=0;fe<pe;fe++){const ve=6*fe;me.uint16[ve+0]=4*fe+0,me.uint16[ve+1]=4*fe+1,me.uint16[ve+2]=4*fe+2,me.uint16[ve+3]=4*fe+2,me.uint16[ve+4]=4*fe+3,me.uint16[ve+5]=4*fe+0}return me}($));const V=M.createIndexBuffer(go,!0),W=M.createVertexBuffer(X,p.collisionCircleLayout.members,!0);for(const te of z){const pe={u_matrix:te.transform,u_inv_matrix:te.invTransform,u_camera_to_center_distance:(ie=F).getCameraToCenterDistance(te.projection),u_viewport_size:[ie.width,ie.height]};K.draw(M,k.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,f.colorModeForRenderPass(),p.CullFaceMode.disabled,pe,h.id,W,V,p.SegmentVector.simpleSegment(0,2*te.circleOffset,te.circleArray.length,te.circleArray.length/2),null,F.zoom)}var ie;W.destroy(),V.destroy()}const hn=p.create();function ui({width:f,height:a,anchor:h,textOffset:_,textScale:v},b){const{horizontalAlign:T,verticalAlign:M}=p.getAnchorAlignment(h),k=-(T-.5)*f,F=-(M-.5)*a,O=p.evaluateVariableOffset(h,_);return new p.Point((k/v+O[0])*b,(F/v+O[1])*b)}function Bo(f,a,h,_,v,b,T,M,k,F,O){const z=f.text.placedSymbolArray,$=f.text.dynamicLayoutVertexArray,Q=f.icon.dynamicLayoutVertexArray,K={},X=f.getProjection(),ee=Zn(M,X,b),V=b.elevation,W=X.upVectorScale(M.canonical,b.center.lat,b.worldSize).metersToTile;$.clear();for(let ie=0;ie<z.length;ie++){const te=z.get(ie),{tileAnchorX:pe,tileAnchorY:me,numGlyphs:fe}=te,ve=te.hidden||!te.crossTileID||f.allowVerticalPlacement&&!te.placedOrientation?null:_[te.crossTileID];if(ve){let ye=0,Me=0,Ze=0;if(V){const nt=V?V.getAtTileOffset(M,pe,me):0,[Ct,zt,vt]=X.upVector(M.canonical,pe,me);ye=nt*Ct*W,Me=nt*zt*W,Ze=nt*vt*W}let[Ce,Be,Se,Qe]=xn(te.projectedAnchorX+ye,te.projectedAnchorY+Me,te.projectedAnchorZ+Ze,h?ee:T);const Te=pp(b.getCameraToCenterDistance(X),Qe);let Le=v.evaluateSizeForFeature(f.textSizeData,F,te)*Te/p.ONE_EM;h&&(Le*=f.tilePixelRatio/k);const Xe=ui(ve,Le);h?(({x:Ce,y:Be,z:Se}=X.projectTilePoint(pe+Xe.x,me+Xe.y,M.canonical)),[Ce,Be,Se]=xn(Ce+ye,Be+Me,Se+Ze,T)):(a&&Xe._rotate(-b.angle),Ce+=Xe.x,Be+=Xe.y,Se=0);const He=f.allowVerticalPlacement&&te.placedOrientation===p.WritingMode.vertical?Math.PI/2:0;for(let nt=0;nt<fe;nt++)p.addDynamicAttributes($,Ce,Be,Se,He);O&&te.associatedIconIndex>=0&&(K[te.associatedIconIndex]={x:Ce,y:Be,z:Se,angle:He})}else Pt(fe,$)}if(O){Q.clear();const ie=f.icon.placedSymbolArray;for(let te=0;te<ie.length;te++){const pe=ie.get(te),{numGlyphs:me}=pe,fe=K[te];if(pe.hidden||!fe)Pt(me,Q);else{const{x:ve,y:ye,z:Me,angle:Ze}=fe;for(let Ce=0;Ce<me;Ce++)p.addDynamicAttributes(Q,ve,ye,Me,Ze)}}f.icon.dynamicLayoutVertexBuffer.updateData(Q)}f.text.dynamicLayoutVertexBuffer.updateData($)}function Os(f,a,h){return h.iconsInText&&a?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function sr(f,a,h,_,v,b,T,M,k,F,O,z){const $=f.context,Q=$.gl,K=f.transform,X="map"===M,ee="map"===k,V=X&&"point"!==h.layout.get("symbol-placement"),W=X&&!ee&&!V,ie=void 0!==h.layout.get("symbol-sort-key").constantOr(1);let te=!1;const pe=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),me=[p.mercatorXfromLng(K.center.lng),p.mercatorYfromLat(K.center.lat)],fe=h.layout.get("text-variable-anchor"),ve="globe"===K.projection.name,ye=[],Me=[0,-1,0];let Ze=Me;!ve&&!K.mercatorFromTransition||X||(Ze=function(Ce){const Be=Ce._camera.getWorldToCamera(Ce.worldSize,1),Se=p.multiply([],Be,Ce.globeMatrix);p.invert(Se,Se);const Qe=[0,0,0],Te=[0,1,0,0];return p.transformMat4$1(Te,Te,Se),Qe[0]=Te[0],Qe[1]=Te[1],Qe[2]=Te[2],p.normalize(Qe,Qe),Qe}(K));for(const Ce of _){const Be=a.getTile(Ce),Se=Be.getBucket(h);if(!Se||"mercator"===Se.projection.name&&ve)continue;const Qe=v?Se.text:Se.icon;if(!Qe||Se.fullyClipped||!Qe.segments.get().length)continue;const Te=Qe.programConfigurations.get(h.id),Le=v||Se.sdfIcons,Xe=v?Se.textSizeData:Se.iconSizeData,He=ee||0!==K.pitch,nt=p.evaluateSizeForZoom(Xe,K.zoom);let Ct,zt,vt,kt,dn=[0,0],cn=null;if(v)zt=Be.glyphAtlasTexture,vt=Q.LINEAR,Ct=Be.glyphAtlasTexture.size,Se.iconsInText&&(dn=Be.imageAtlasTexture.size,cn=Be.imageAtlasTexture,kt=He||f.options.rotating||f.options.zooming||"composite"===Xe.kind||"camera"===Xe.kind?Q.LINEAR:Q.NEAREST);else{const ms=1!==h.layout.get("icon-size").constantOr(0)||Se.iconsNeedLinear;zt=Be.imageAtlasTexture,vt=Le||f.options.rotating||f.options.zooming||ms||He?Q.LINEAR:Q.NEAREST,Ct=Be.imageAtlasTexture.size}const Et="globe"===Se.projection.name,Sn=Et?Ze:Me,Un=Et?p.globeToMercatorTransition(K.zoom):0,kn=Zn(Ce,Se.getProjection(),K),jn=K.calculatePixelsToTileUnitsMatrix(Be),ar=Fe(kn,Be.tileID.canonical,ee,X,K,Se.getProjection(),jn),Si=f.terrain&&ee&&V?p.invert(p.create(),ar):hn,yo=Ti(kn,Be.tileID.canonical,ee,X,K,Se.getProjection(),jn),oo=fe&&Se.hasTextData(),Kn="none"!==h.layout.get("icon-text-fit")&&oo&&Se.hasIconData();if(V){const ms=K.elevation,gs=ms?ms.getAtTileOffsetFunc(Ce,K.center.lat,K.worldSize,Se.getProjection()):null,Bs=ks(kn,Be.tileID.canonical,ee,X,K,Se.getProjection(),jn);gc(Se,kn,f,v,Bs,yo,ee,F,gs,Ce)}const Ln=V||v&&fe||Kn,Pn=f.translatePosMatrix(kn,Be,b,T),wi=Ln?hn:ar,Er=f.translatePosMatrix(yo,Be,b,T,!0),ni=Se.getProjection().createInversionMatrix(K,Ce.canonical),_i=[];f.terrainRenderModeElevated()&&ee&&_i.push("PITCH_WITH_MAP_TERRAIN"),Et&&_i.push("PROJECTION_GLOBE_VIEW"),Ln&&_i.push("PROJECTED_POS_ON_VIEWPORT");const Qu=Le&&0!==h.paint.get(v?"text-halo-width":"icon-halo-width").constantOr(1);let fs;fs=Le?Se.iconsInText?Qr(Xe.kind,nt,W,ee,f,Pn,wi,Er,Ct,dn,Ce,Un,me,ni,Sn,Se.getProjection()):Rs(Xe.kind,nt,W,ee,f,Pn,wi,Er,v,Ct,!0,Ce,Un,me,ni,Sn,Se.getProjection()):xr(Xe.kind,nt,W,ee,f,Pn,wi,Er,v,Ct,Ce,Un,me,ni,Sn,Se.getProjection());const Qa={program:f.useProgram(Os(Le,v,Se),Te,_i),buffers:Qe,uniformValues:fs,atlasTexture:zt,atlasTextureIcon:cn,atlasInterpolation:vt,atlasInterpolationIcon:kt,isSDF:Le,hasHalo:Qu,tile:Be,labelPlaneMatrixInv:Si};if(ie&&Se.canOverlap){te=!0;const ms=Qe.segments.get();for(const gs of ms)ye.push({segments:new p.SegmentVector([gs]),sortKey:gs.sortKey,state:Qa})}else ye.push({segments:Qe.segments,sortKey:0,state:Qa})}te&&ye.sort((Ce,Be)=>Ce.sortKey-Be.sortKey);for(const Ce of ye){const Be=Ce.state;if(f.terrain&&f.terrain.setupElevationDraw(Be.tile,Be.program,{useDepthForOcclusion:!ve,labelPlaneMatrixInv:Be.labelPlaneMatrixInv}),$.activeTexture.set(Q.TEXTURE0),Be.atlasTexture.bind(Be.atlasInterpolation,Q.CLAMP_TO_EDGE),Be.atlasTextureIcon&&($.activeTexture.set(Q.TEXTURE1),Be.atlasTextureIcon&&Be.atlasTextureIcon.bind(Be.atlasInterpolationIcon,Q.CLAMP_TO_EDGE)),Be.isSDF){const Se=Be.uniformValues;Be.hasHalo&&(Se.u_is_halo=1,us(Be.buffers,Ce.segments,h,f,Be.program,pe,O,z,Se)),Se.u_is_halo=0}us(Be.buffers,Ce.segments,h,f,Be.program,pe,O,z,Be.uniformValues)}}function us(f,a,h,_,v,b,T,M,k){const F=_.context,O=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.globeExtVertexBuffer];v.draw(F,F.gl.TRIANGLES,b,T,M,p.CullFaceMode.disabled,k,h.id,f.layoutVertexBuffer,f.indexBuffer,a,h.paint,_.transform.zoom,f.programConfigurations.get(h.id),O)}function bi(f,a,h,_,v,b,T){const M=f.context.gl,k=h.paint.get("fill-pattern"),F=k&&k.constantOr(1);let O,z,$,Q,K;T?(z=F&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=M.LINES):(z=F?"fillPattern":"fill",O=M.TRIANGLES);for(const X of _){const ee=a.getTile(X);if(F&&!ee.patternsLoaded())continue;const V=ee.getBucket(h);if(!V)continue;f.prepareDrawTile();const W=V.programConfigurations.get(h.id),ie=f.useProgram(z,W);F&&(f.context.activeTexture.set(M.TEXTURE0),ee.imageAtlasTexture.bind(M.LINEAR,M.CLAMP_TO_EDGE),W.updatePaintBuffers());const te=k.constantOr(null);if(te&&ee.imageAtlas){const me=ee.imageAtlas.patternPositions[te.toString()];me&&W.setConstantPatternPositions(me)}const pe=f.translatePosMatrix(X.projMatrix,ee,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(T){Q=V.indexBuffer2,K=V.segments2;const me=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[M.drawingBufferWidth,M.drawingBufferHeight];$="fillOutlinePattern"===z&&F?id(pe,f,ee,me):nd(pe,me)}else Q=V.indexBuffer,K=V.segments,$=F?Ml(pe,f,ee):wn(pe);f.prepareDrawProgram(f.context,ie,X.toUnwrapped()),ie.draw(f.context,O,v,f.stencilModeForClipping(X),b,p.CullFaceMode.disabled,$,h.id,V.layoutVertexBuffer,Q,K,h.paint,f.transform.zoom,W)}}function $a(f,a,h,_,v,b,T){const M=f.context,k=M.gl,F=f.transform,O=h.paint.get("fill-extrusion-pattern"),z=O.constantOr(1),$=h.paint.get("fill-extrusion-opacity"),Q=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],K=h.layout.get("fill-extrusion-edge-radius"),X=K>0&&!h.paint.get("fill-extrusion-rounded-roof"),ee=X?0:K,V="globe"===F.projection.name?p.fillExtrusionHeightLift():0,W="globe"===F.projection.name,ie=W?p.globeToMercatorTransition(F.zoom):0,te=[p.mercatorXfromLng(F.center.lng),p.mercatorYfromLat(F.center.lat)],pe=[];W&&pe.push("PROJECTION_GLOBE_VIEW"),Q[0]>0&&pe.push("FAUX_AO"),X&&pe.push("ZERO_ROOF_RADIUS");for(const me of _){const fe=a.getTile(me),ve=fe.getBucket(h);if(!ve||ve.projection.name!==F.projection.name)continue;const ye=ve.programConfigurations.get(h.id),Me=f.useProgram(z?"fillExtrusionPattern":"fillExtrusion",ye,pe);if(f.terrain){const Le=f.terrain;if(f.style.terrainSetForDrapingOnly())Le.setupElevationDraw(fe,Me,{useMeterToDem:!0});else{if(!ve.enableTerrain)continue;if(Le.setupElevationDraw(fe,Me,{useMeterToDem:!0}),Ic(M,a,me,ve,h,Le),!ve.centroidVertexBuffer){const Xe=Me.attributes.a_centroid_pos;void 0!==Xe&&k.vertexAttrib2f(Xe,0,0)}}}z&&(f.context.activeTexture.set(k.TEXTURE0),fe.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),ye.updatePaintBuffers());const Ze=O.constantOr(null);if(Ze&&fe.imageAtlas){const Le=fe.imageAtlas.patternPositions[Ze.toString()];Le&&ye.setConstantPatternPositions(Le)}const Ce=f.translatePosMatrix(me.projMatrix,fe,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),Be=F.projection.createInversionMatrix(F,me.canonical),Se=h.paint.get("fill-extrusion-vertical-gradient"),Qe=z?cs(Ce,f,Se,$,Q,ee,me,fe,V,ie,te,Be):mo(Ce,f,Se,$,Q,ee,me,V,ie,te,Be);f.prepareDrawProgram(M,Me,me.toUnwrapped());const Te=[];f.terrain&&Te.push(ve.centroidVertexBuffer),W&&Te.push(ve.layoutVertexExtBuffer),Me.draw(M,M.gl.TRIANGLES,v,b,T,p.CullFaceMode.backCCW,Qe,h.id,ve.layoutVertexBuffer,ve.indexBuffer,ve.segments,h.paint,f.transform.zoom,ye,Te)}}function Ic(f,a,h,_,v,b){const T=[V=>{let W=V.canonical.x-1,ie=V.wrap;return W<0&&(W=(1<<V.canonical.z)-1,ie--),new p.OverscaledTileID(V.overscaledZ,ie,V.canonical.z,W,V.canonical.y)},V=>{let W=V.canonical.x+1,ie=V.wrap;return W===1<<V.canonical.z&&(W=0,ie++),new p.OverscaledTileID(V.overscaledZ,ie,V.canonical.z,W,V.canonical.y)},V=>new p.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,(0===V.canonical.y?1<<V.canonical.z:V.canonical.y)-1),V=>new p.OverscaledTileID(V.overscaledZ,V.wrap,V.canonical.z,V.canonical.x,V.canonical.y===(1<<V.canonical.z)-1?0:V.canonical.y+1)],M=V=>{const W=a.getSource().minzoom,ie=pe=>{const me=a.getTileByID(pe);if(me&&me.hasData())return me.getBucket(v)},te=[0,-1,1];for(const pe of te){if(V.overscaledZ+pe<W)continue;const me=ie(V.calculateScaledKey(V.overscaledZ+pe));if(me)return me}},k=[0,0,0],F=(V,W)=>(k[0]=Math.min(V.min.y,W.min.y),k[1]=Math.max(V.max.y,W.max.y),k[2]=p.EXTENT-W.min.x>V.max.x?W.min.x-p.EXTENT:V.max.x,k),O=(V,W)=>(k[0]=Math.min(V.min.x,W.min.x),k[1]=Math.max(V.max.x,W.max.x),k[2]=p.EXTENT-W.min.y>V.max.y?W.min.y-p.EXTENT:V.max.y,k),z=[(V,W)=>F(V,W),(V,W)=>F(W,V),(V,W)=>O(V,W),(V,W)=>O(W,V)],$=new p.Point(0,0);let Q,K,X;const ee=(V,W,ie,te,pe)=>{const me=[[te?ie:V,te?V:ie,0],[te?ie:W,te?W:ie,0]],fe=pe<0?p.EXTENT+pe:pe,ve=[te?fe:(V+W)/2,te?(V+W)/2:fe,0];return 0===ie&&pe<0||0!==ie&&pe>0?b.getForTilePoints(X,[ve],!0,K):me.push(ve),b.getForTilePoints(h,me,!0,Q),Math.max(me[0][2],me[1][2],ve[2])/b.exaggeration()};for(let V=0;V<4;V++){const W=(V<2?1:5)-V,ie=_.borders[V];if(0===ie.length)continue;const te=X=T[V](h),pe=M(te);if(!(pe&&pe instanceof p.FillExtrusionBucket&&pe.enableTerrain)||_.borderDoneWithNeighborZ[V]===pe.canonical.z&&pe.borderDoneWithNeighborZ[W]===_.canonical.z||(K=b.findDEMTileFor(te),!K||!K.dem))continue;if(!Q){const ye=b.findDEMTileFor(h);if(!ye||!ye.dem)return;Q=ye}const me=pe.borders[W];let fe=0;const ve=pe.borderDoneWithNeighborZ[W]!==_.canonical.z;if(_.canonical.z===pe.canonical.z){for(let ye=0;ye<ie.length;ye++){const Me=_.featuresOnBorder[ie[ye]],Ze=Me.borders[V];let Ce;for(;fe<me.length&&(Ce=pe.featuresOnBorder[me[fe]],!(Ce.borders[W][1]>Ze[0]+3));)ve&&pe.encodeCentroid(void 0,Ce,!1),fe++;if(Ce&&fe<me.length){const Be=fe;let Se=0;for(;!(Ce.borders[W][0]>Ze[1]-3)&&(Se++,++fe!==me.length);)Ce=pe.featuresOnBorder[me[fe]];if(Ce=pe.featuresOnBorder[me[Be]],Me.intersectsCount()>1||Ce.intersectsCount()>1||1!==Se){1!==Se&&(fe=Be),_.encodeCentroid(void 0,Me,!1),ve&&pe.encodeCentroid(void 0,Ce,!1);continue}const Qe=z[V](Me,Ce),Te=V%2?p.EXTENT-1:0;$.x=ee(Qe[0],Math.min(p.EXTENT-1,Qe[1]),Te,V<2,Qe[2]),$.y=0,_.encodeCentroid($,Me,!1),ve&&pe.encodeCentroid($,Ce,!1)}else _.encodeCentroid(void 0,Me,!1)}_.borderDoneWithNeighborZ[V]=pe.canonical.z,_.needsCentroidUpdate=!0,ve&&(pe.borderDoneWithNeighborZ[W]=_.canonical.z,pe.needsCentroidUpdate=!0)}else{for(const ye of ie)_.encodeCentroid(void 0,_.featuresOnBorder[ye],!1);if(ve){for(const ye of me)pe.encodeCentroid(void 0,pe.featuresOnBorder[ye],!1);pe.borderDoneWithNeighborZ[W]=_.canonical.z,pe.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[V]=pe.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(f)}const tn=new p.Color(1,0,0,1),sd=new p.Color(0,1,0,1),Tc=new p.Color(0,0,1,1),bp=new p.Color(1,0,1,1),kl=new p.Color(0,1,1,1);function br(f,a,h){const _=f.context,v=f.transform,b=_.gl,T="globe"===v.projection.name,M=T?["PROJECTION_GLOBE_VIEW"]:null;let k=h.projMatrix;if(T&&p.globeToMercatorTransition(v.zoom)>0){const Me=p.transitionTileAABBinECEF(h.canonical,v),Ze=p.globeDenormalizeECEF(Me);k=p.multiply(new Float32Array(16),v.globeMatrix,Ze),p.multiply(k,v.projMatrix,k)}const F=f.useProgram("debug",null,M),O=a.getTileByID(h.key);f.terrain&&f.terrain.setupElevationDraw(O,F);const z=p.DepthMode.disabled,$=p.StencilMode.disabled,Q=f.colorModeForRenderPass(),K="$debug";_.activeTexture.set(b.TEXTURE0),f.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),T?O._makeGlobeTileDebugBuffers(f.context,v):O._makeDebugTileBoundsBuffers(f.context,v.projection);const X=O._tileDebugBuffer||f.debugBuffer,ee=O._tileDebugIndexBuffer||f.debugIndexBuffer,V=O._tileDebugSegments||f.debugSegments;F.draw(_,b.LINE_STRIP,z,$,Q,p.CullFaceMode.disabled,vr(k,p.Color.red),K,X,ee,V,null,null,null,[O._globeTileDebugBorderBuffer]);const W=O.latestRawTileData,ie=Math.floor((W&&W.byteLength||0)/1024),te=a.getTile(h).tileSize,pe=512/Math.min(te,512)*(h.overscaledZ/v.zoom)*.5;let me=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(me+=` => ${h.overscaledZ}`),me+=` ${ie}kb`,function(Me,Ze){Me.initDebugOverlayCanvas();const Ce=Me.debugOverlayCanvas,Be=Me.context.gl,Se=Me.debugOverlayCanvas.getContext("2d");Se.clearRect(0,0,Ce.width,Ce.height),Se.shadowColor="white",Se.shadowBlur=2,Se.lineWidth=1.5,Se.strokeStyle="white",Se.textBaseline="top",Se.font="bold 36px Open Sans, sans-serif",Se.fillText(Ze,5,5),Se.strokeText(Ze,5,5),Me.debugOverlayTexture.update(Ce),Me.debugOverlayTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE)}(f,me);const fe=O._tileDebugTextBuffer||f.debugBuffer,ve=O._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,ye=O._tileDebugTextSegments||f.debugSegments;F.draw(_,b.TRIANGLES,z,$,p.ColorMode.alphaBlended,p.CullFaceMode.disabled,vr(k,p.Color.transparent,pe),K,fe,ve,ye,null,null,null,[O._globeTileDebugTextBuffer])}function Pl(f,a,h,_){Fr(f,0,a+h/2,f.transform.width,h,_)}function Fs(f,a,h,_){Fr(f,a-h/2,0,h,f.transform.height,_)}function Fr(f,a,h,_,v,b){const T=f.context,M=T.gl;M.enable(M.SCISSOR_TEST),M.scissor(a*p.exported.devicePixelRatio,h*p.exported.devicePixelRatio,_*p.exported.devicePixelRatio,v*p.exported.devicePixelRatio),T.clear({color:b}),M.disable(M.SCISSOR_TEST)}const Rl=p.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ad}=Rl;function Fn(f,a,h,_){f.emplaceBack(a,h,_)}class ld{constructor(a){this.vertexArray=new p.StructArrayLayout3f12,this.indices=new p.StructArrayLayout3ui6,Fn(this.vertexArray,-1,-1,1),Fn(this.vertexArray,1,-1,1),Fn(this.vertexArray,-1,1,1),Fn(this.vertexArray,1,1,1),Fn(this.vertexArray,-1,-1,-1),Fn(this.vertexArray,1,-1,-1),Fn(this.vertexArray,-1,1,-1),Fn(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=a.createVertexBuffer(this.vertexArray,ad),this.indexBuffer=a.createIndexBuffer(this.indices),this.segment=p.SegmentVector.simpleSegment(0,0,36,12)}}function Xr(f,a,h,_,v,b){const T=f.gl,M=a.paint.get("sky-atmosphere-color"),k=a.paint.get("sky-atmosphere-halo-color"),F=a.paint.get("sky-atmosphere-sun-intensity"),O={u_matrix_3f:p.fromMat4(p.create$1(),_),u_sun_direction:v,u_sun_intensity:F,u_color_tint_r:[(K=M).r,K.g,K.b,K.a],u_color_tint_m:[(X=k).r,X.g,X.b,X.a],u_luminance:5e-5};var K,X;T.framebufferTexture2D(T.FRAMEBUFFER,T.COLOR_ATTACHMENT0,T.TEXTURE_CUBE_MAP_POSITIVE_X+b,a.skyboxTexture,0),h.draw(f,T.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,p.ColorMode.unblended,p.CullFaceMode.frontCW,O,"skyboxCapture",a.skyboxGeometry.vertexBuffer,a.skyboxGeometry.indexBuffer,a.skyboxGeometry.segment)}const Ol=p.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Mc{constructor(a){const h=new p.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const _=new p.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=a.createVertexBuffer(h,Ol.members),this.indexBuffer=a.createIndexBuffer(_),this.segments=p.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const hs={symbol:function(f,a,h,_,v){if("translucent"!==f.renderPass)return;const b=p.StencilMode.disabled,T=f.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&function(M,k,F,O,z,$,Q){const K=k.transform,X="map"===z,ee="map"===$;for(const V of M){const W=O.getTile(V),ie=W.getBucket(F);if(!ie||!ie.text||!ie.text.segments.get().length)continue;const te=p.evaluateSizeForZoom(ie.textSizeData,K.zoom),pe=Zn(V,ie.getProjection(),K),me=K.calculatePixelsToTileUnitsMatrix(W),fe=Fe(pe,W.tileID.canonical,ee,X,K,ie.getProjection(),me),ve="none"!==F.layout.get("icon-text-fit")&&ie.hasIconData();if(te){const ye=Math.pow(2,K.zoom-W.tileID.overscaledZ);Bo(ie,X,ee,Q,p.symbolSize,K,fe,V,ye,te,ve)}}}(_,f,h,a,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),v),0!==h.paint.get("icon-opacity").constantOr(1)&&sr(f,a,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),b,T),0!==h.paint.get("text-opacity").constantOr(1)&&sr(f,a,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),b,T),a.map.showCollisionBoxes&&(wt(f,a,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),wt(f,a,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(f,a,h,_){if("translucent"!==f.renderPass)return;const v=h.paint.get("circle-opacity"),b=h.paint.get("circle-stroke-width"),T=h.paint.get("circle-stroke-opacity"),M=void 0!==h.layout.get("circle-sort-key").constantOr(1);if(0===v.constantOr(1)&&(0===b.constantOr(1)||0===T.constantOr(1)))return;const k=f.context,F=k.gl,O=f.transform,z=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),$=p.StencilMode.disabled,Q=f.colorModeForRenderPass(),K="globe"===O.projection.name,X=[p.mercatorXfromLng(O.center.lng),p.mercatorYfromLat(O.center.lat)],ee=[];for(let W=0;W<_.length;W++){const ie=_[W],te=a.getTile(ie),pe=te.getBucket(h);if(!pe||pe.projection.name!==O.projection.name)continue;const me=pe.programConfigurations.get(h.id),fe=Ga(h);K&&fe.push("PROJECTION_GLOBE_VIEW");const ve=f.useProgram("circle",me,fe),ye=pe.layoutVertexBuffer,Me=pe.globeExtVertexBuffer,Ze=pe.indexBuffer,Ce=O.projection.createInversionMatrix(O,ie.canonical),Be={programConfiguration:me,program:ve,layoutVertexBuffer:ye,globeExtVertexBuffer:Me,indexBuffer:Ze,uniformValues:Lo(f,ie,te,Ce,X,h),tile:te};if(M){const Se=pe.segments.get();for(const Qe of Se)ee.push({segments:new p.SegmentVector([Qe]),sortKey:Qe.sortKey,state:Be})}else ee.push({segments:pe.segments,sortKey:0,state:Be})}M&&ee.sort((W,ie)=>W.sortKey-ie.sortKey);const V={useDepthForOcclusion:!K};for(const W of ee){const{programConfiguration:ie,program:te,layoutVertexBuffer:pe,globeExtVertexBuffer:me,indexBuffer:fe,uniformValues:ve,tile:ye}=W.state,Me=W.segments;f.terrain&&f.terrain.setupElevationDraw(ye,te,V),f.prepareDrawProgram(k,te,ye.tileID.toUnwrapped()),te.draw(k,F.TRIANGLES,z,$,Q,p.CullFaceMode.disabled,ve,h.id,pe,fe,Me,h.paint,O.zoom,ie,[me])}},heatmap:function(f,a,h,_){if(0!==h.paint.get("heatmap-opacity"))if("offscreen"===f.renderPass){const v=f.context,b=v.gl,T=p.StencilMode.disabled,M=new p.ColorMode([b.ONE,b.ONE],p.Color.transparent,[!0,!0,!0,!0]);(function(Q,K,X,ee){const V=Q.gl,W=K.width*ee,ie=K.height*ee;Q.activeTexture.set(V.TEXTURE1),Q.viewport.set([0,0,W,ie]);let te=X.heatmapFbo;if(!te||te&&(te.width!==W||te.height!==ie)){te&&te.destroy();const pe=V.createTexture();V.bindTexture(V.TEXTURE_2D,pe),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_S,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_WRAP_T,V.CLAMP_TO_EDGE),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MIN_FILTER,V.LINEAR),V.texParameteri(V.TEXTURE_2D,V.TEXTURE_MAG_FILTER,V.LINEAR),te=X.heatmapFbo=Q.createFramebuffer(W,ie,!1),function(me,fe,ve,ye,Me,Ze){const Ce=me.gl;Ce.texImage2D(Ce.TEXTURE_2D,0,me.isWebGL2&&me.extRenderToTextureHalfFloat?Ce.RGBA16F:Ce.RGBA,Me,Ze,0,Ce.RGBA,me.extRenderToTextureHalfFloat?me.isWebGL2?Ce.HALF_FLOAT:me.extTextureHalfFloat.HALF_FLOAT_OES:Ce.UNSIGNED_BYTE,null),ye.colorAttachment.set(ve)}(Q,0,pe,te,W,ie)}else V.bindTexture(V.TEXTURE_2D,te.colorAttachment.get()),Q.bindFramebuffer.set(te.framebuffer)})(v,f,h,"globe"===f.transform.projection.name?.5:.25),v.clear({color:p.Color.transparent});const k=f.transform,F="globe"===k.projection.name,O=F?["PROJECTION_GLOBE_VIEW"]:null,z=F?p.CullFaceMode.frontCCW:p.CullFaceMode.disabled,$=[p.mercatorXfromLng(k.center.lng),p.mercatorYfromLat(k.center.lat)];for(let Q=0;Q<_.length;Q++){const K=_[Q];if(a.hasRenderableParent(K))continue;const X=a.getTile(K),ee=X.getBucket(h);if(!ee||ee.projection.name!==k.projection.name)continue;const V=ee.programConfigurations.get(h.id),W=f.useProgram("heatmap",V,O),{zoom:ie}=f.transform;f.terrain&&f.terrain.setupElevationDraw(X,W),f.prepareDrawProgram(v,W,K.toUnwrapped());const te=k.projection.createInversionMatrix(k,K.canonical);W.draw(v,b.TRIANGLES,p.DepthMode.disabled,T,M,z,Ap(f,K,X,te,$,ie,h.paint.get("heatmap-intensity")),h.id,ee.layoutVertexBuffer,ee.indexBuffer,ee.segments,h.paint,f.transform.zoom,V,F?[ee.globeExtVertexBuffer]:null)}v.viewport.set([0,0,f.width,f.height])}else"translucent"===f.renderPass&&(f.context.setColorMode(f.colorModeForRenderPass()),function(v,b){const T=v.context,M=T.gl,k=b.heatmapFbo;if(!k)return;T.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,k.colorAttachment.get()),T.activeTexture.set(M.TEXTURE1);let F=b.colorRampTexture;F||(F=b.colorRampTexture=new p.Texture(T,b.colorRamp,M.RGBA)),F.bind(M.LINEAR,M.CLAMP_TO_EDGE),v.useProgram("heatmapTexture").draw(T,M.TRIANGLES,p.DepthMode.disabled,p.StencilMode.disabled,v.colorModeForRenderPass(),p.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:b.paint.get("heatmap-opacity")},b.id,v.viewportBuffer,v.quadTriangleIndexBuffer,v.viewportSegments,b.paint,v.transform.zoom)}(f,h))},line:function(f,a,h,_){if("translucent"!==f.renderPass)return;const v=h.paint.get("line-opacity"),b=h.paint.get("line-width");if(0===v.constantOr(1)||0===b.constantOr(1))return;const T=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),M=f.colorModeForRenderPass(),k=f.terrain&&f.terrain.renderingToTexture?1:p.exported.devicePixelRatio,F=h.paint.get("line-dasharray"),O=F.constantOr(1),z=h.layout.get("line-cap"),$=h.paint.get("line-pattern"),Q=$.constantOr(1),K=h.paint.get("line-gradient"),X=Q?"linePattern":"line",ee=f.context,V=ee.gl,W=(te=>{const pe=[];Nt(te)&&pe.push("RENDER_LINE_DASH"),te.paint.get("line-gradient")&&pe.push("RENDER_LINE_GRADIENT");const me=te.paint.get("line-trim-offset");0===me[0]&&0===me[1]||pe.push("RENDER_LINE_TRIM_OFFSET");const fe=te.paint.get("line-pattern").constantOr(1),ve=1!==te.paint.get("line-opacity").constantOr(1);return!fe&&ve&&pe.push("RENDER_LINE_ALPHA_DISCARD"),pe})(h);let ie=W.includes("RENDER_LINE_ALPHA_DISCARD");f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(ie=!1);for(const te of _){const pe=a.getTile(te);if(Q&&!pe.patternsLoaded())continue;const me=pe.getBucket(h);if(!me)continue;f.prepareDrawTile();const fe=me.programConfigurations.get(h.id),ve=f.useProgram(X,fe,W),ye=$.constantOr(null);if(ye&&pe.imageAtlas){const Le=pe.imageAtlas.patternPositions[ye.toString()];Le&&fe.setConstantPatternPositions(Le)}const Me=F.constantOr(null),Ze=z.constantOr(null);if(!Q&&Me&&Ze&&pe.lineAtlas){const Le=pe.lineAtlas.getDash(Me,Ze);Le&&fe.setConstantPatternPositions(Le)}let[Ce,Be]=h.paint.get("line-trim-offset");("round"===Ze||"square"===Ze)&&Ce!==Be&&(0===Ce&&(Ce-=1),1===Be&&(Be+=1));const Se=f.terrain?te.projMatrix:null,Qe=Q?Vi(f,pe,h,Se,k):ym(f,pe,h,Se,me.lineClipsArray.length,k,[Ce,Be]);if(K){const Le=me.gradients[h.id];let Xe=Le.texture;if(h.gradientVersion!==Le.version){let He=256;if(h.stepInterpolant){const nt=a.getSource().maxzoom,Ct=te.canonical.z===nt?Math.ceil(1<<f.transform.maxZoom-te.canonical.z):1;He=p.clamp(p.nextPowerOfTwo(me.maxLineLength/p.EXTENT*1024*Ct),256,ee.maxTextureSize)}Le.gradient=p.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:He,image:Le.gradient||void 0,clips:me.lineClipsArray}),Le.texture?Le.texture.update(Le.gradient):Le.texture=new p.Texture(ee,Le.gradient,V.RGBA),Le.version=h.gradientVersion,Xe=Le.texture}ee.activeTexture.set(V.TEXTURE1),Xe.bind(h.stepInterpolant?V.NEAREST:V.LINEAR,V.CLAMP_TO_EDGE)}O&&(ee.activeTexture.set(V.TEXTURE0),pe.lineAtlasTexture.bind(V.LINEAR,V.REPEAT),fe.updatePaintBuffers()),Q&&(ee.activeTexture.set(V.TEXTURE0),pe.imageAtlasTexture.bind(V.LINEAR,V.CLAMP_TO_EDGE),fe.updatePaintBuffers()),f.prepareDrawProgram(ee,ve,te.toUnwrapped());const Te=Le=>{ve.draw(ee,V.TRIANGLES,T,Le,M,p.CullFaceMode.disabled,Qe,h.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,h.paint,f.transform.zoom,fe,[me.layoutVertexBuffer2])};if(ie){const Le=f.stencilModeForClipping(te).ref;0===Le&&f.terrain&&ee.clear({stencil:0});const Xe={func:V.EQUAL,mask:255};Qe.u_alpha_discard_threshold=.8,Te(new p.StencilMode(Xe,Le,255,V.KEEP,V.KEEP,V.INVERT)),Qe.u_alpha_discard_threshold=0,Te(new p.StencilMode(Xe,Le,255,V.KEEP,V.KEEP,V.KEEP))}else Te(f.stencilModeForClipping(te))}ie&&(f.resetStencilClippingMasks(),f.terrain&&ee.clear({stencil:0}))},fill:function(f,a,h,_){const v=h.paint.get("fill-color"),b=h.paint.get("fill-opacity");if(0===b.constantOr(1))return;const T=f.colorModeForRenderPass(),M=h.paint.get("fill-pattern"),k=f.opaquePassEnabledForLayer()&&!M.constantOr(1)&&1===v.constantOr(p.Color.transparent).a&&1===b.constantOr(0)?"opaque":"translucent";if(f.renderPass===k){const F=f.depthModeForSublayer(1,"opaque"===f.renderPass?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly);bi(f,a,h,_,F,T,!1)}if("translucent"===f.renderPass&&h.paint.get("fill-antialias")){const F=f.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,p.DepthMode.ReadOnly);bi(f,a,h,_,F,T,!0)}},"fill-extrusion":function(f,a,h,_){const v=h.paint.get("fill-extrusion-opacity");if(0!==v&&"translucent"===f.renderPass){const b=new p.DepthMode(f.context.gl.LEQUAL,p.DepthMode.ReadWrite,f.depthRangeFor3D);if(1!==v||h.paint.get("fill-extrusion-pattern").constantOr(1))$a(f,a,h,_,b,p.StencilMode.disabled,p.ColorMode.disabled),$a(f,a,h,_,b,f.stencilModeFor3D(),f.colorModeForRenderPass()),f.resetStencilClippingMasks();else{const T=f.colorModeForRenderPass();$a(f,a,h,_,b,p.StencilMode.disabled,T)}}},hillshade:function(f,a,h,_){if("offscreen"!==f.renderPass&&"translucent"!==f.renderPass)return;const v=f.context,b=f.depthModeForSublayer(0,p.DepthMode.ReadOnly),T=f.colorModeForRenderPass(),M=f.terrain&&f.terrain.renderingToTexture,[k,F]="translucent"!==f.renderPass||M?[{},_]:f.stencilConfigForOverlap(_);for(const O of F){const z=a.getTile(O);if(z.needsHillshadePrepare&&"offscreen"===f.renderPass)yp(f,z,h,b,p.StencilMode.disabled,T);else if("translucent"===f.renderPass){const $=M&&f.terrain?f.terrain.stencilModeForRTTOverlap(O):k[O.overscaledZ];Du(f,O,z,h,b,$,T)}}v.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,a,h,_,v,b){if("translucent"!==f.renderPass||0===h.paint.get("raster-opacity")||!_.length)return;const T=f.context,M=T.gl,k=a.getSource(),F=f.useProgram("raster"),O=f.colorModeForRenderPass(),z=f.terrain&&f.terrain.renderingToTexture,[$,Q]=k instanceof Ot||z?[{},_]:f.stencilConfigForOverlap(_),K=Q[Q.length-1].overscaledZ,X=!f.options.moving;for(const ee of Q){const V=z?p.DepthMode.disabled:f.depthModeForSublayer(ee.overscaledZ-K,1===h.paint.get("raster-opacity")?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly,M.LESS),W=ee.toUnwrapped(),ie=a.getTile(ee);if(z&&(!ie||!ie.hasData()))continue;const te=z?ee.projMatrix:f.transform.calculateProjMatrix(W,X),pe=f.terrain&&z?f.terrain.stencilModeForRTTOverlap(ee):$[ee.overscaledZ],me=b?0:h.paint.get("raster-fade-duration");ie.registerFadeDuration(me);const fe=a.findLoadedParent(ee,0),ve=Tl(ie,fe,a,f.transform,me);let ye,Me;f.terrain&&f.terrain.prepareDrawTile();const Ze="nearest"===h.paint.get("raster-resampling")?M.NEAREST:M.LINEAR;T.activeTexture.set(M.TEXTURE0),ie.texture.bind(Ze,M.CLAMP_TO_EDGE),T.activeTexture.set(M.TEXTURE1),fe?(fe.texture.bind(Ze,M.CLAMP_TO_EDGE),ye=Math.pow(2,fe.tileID.overscaledZ-ie.tileID.overscaledZ),Me=[ie.tileID.canonical.x*ye%1,ie.tileID.canonical.y*ye%1]):ie.texture.bind(Ze,M.CLAMP_TO_EDGE),ie.texture.useMipmap&&T.extTextureFilterAnisotropic&&f.transform.pitch>20&&M.texParameterf(M.TEXTURE_2D,T.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,T.extTextureFilterAnisotropicMax);const Ce=Ar(te,Me||[0,0],ye||1,ve,h,k instanceof Ot?k.perspectiveTransform:[0,0]);if(f.prepareDrawProgram(T,F,W),k instanceof Ot)k.boundsBuffer&&k.boundsSegments&&F.draw(T,M.TRIANGLES,V,p.StencilMode.disabled,O,p.CullFaceMode.disabled,Ce,h.id,k.boundsBuffer,f.quadTriangleIndexBuffer,k.boundsSegments);else{const{tileBoundsBuffer:Be,tileBoundsIndexBuffer:Se,tileBoundsSegments:Qe}=f.getTileBoundsBuffers(ie);F.draw(T,M.TRIANGLES,V,pe,O,p.CullFaceMode.disabled,Ce,h.id,Be,Se,Qe)}}f.resetStencilClippingMasks()},background:function(f,a,h,_){const v=h.paint.get("background-color"),b=h.paint.get("background-opacity");if(0===b)return;const T=f.context,M=T.gl,k=f.transform,F=k.tileSize,O=h.paint.get("background-pattern");if(f.isPatternMissing(O))return;const z=!O&&1===v.a&&1===b&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==z)return;const $=p.StencilMode.disabled,Q=f.depthModeForSublayer(0,"opaque"===z?p.DepthMode.ReadWrite:p.DepthMode.ReadOnly),K=f.colorModeForRenderPass(),X=f.useProgram(O?"backgroundPattern":"background");let ee,V=_;V||(ee=f.getBackgroundTiles(),V=Object.values(ee).map(W=>W.tileID)),O&&(T.activeTexture.set(M.TEXTURE0),f.imageManager.bind(f.context));for(const W of V){const ie=W.toUnwrapped(),te=_?W.projMatrix:f.transform.calculateProjMatrix(ie);f.prepareDrawTile();const pe=a?a.getTile(W):ee?ee[W.key]:new p.Tile(W,F,k.zoom,f),me=O?xp(te,b,f,O,{tileID:W,tileSize:F}):Pu(te,b,v);f.prepareDrawProgram(T,X,ie);const{tileBoundsBuffer:fe,tileBoundsIndexBuffer:ve,tileBoundsSegments:ye}=f.getTileBoundsBuffers(pe);X.draw(T,M.TRIANGLES,Q,$,K,p.CullFaceMode.disabled,me,h.id,fe,ve,ye)}},sky:function(f,a,h){const _=f.transform,v="mercator"===_.projection.name||"globe"===_.projection.name?1:p.smoothstep(7,8,_.zoom),b=h.paint.get("sky-opacity")*v;if(0===b)return;const T=f.context,M=h.paint.get("sky-type"),k=new p.DepthMode(T.gl.LEQUAL,p.DepthMode.ReadOnly,[0,1]),F=f.frameCounter/1e3%1;"atmosphere"===M?"offscreen"===f.renderPass?h.needsSkyboxCapture(f)&&(function(O,z,$,Q){const K=O.context,X=K.gl;let ee=z.skyboxFbo;if(!ee){ee=z.skyboxFbo=K.createFramebuffer(32,32,!1),z.skyboxGeometry=new ld(K),z.skyboxTexture=K.gl.createTexture(),X.bindTexture(X.TEXTURE_CUBE_MAP,z.skyboxTexture),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_S,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_WRAP_T,X.CLAMP_TO_EDGE),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MIN_FILTER,X.LINEAR),X.texParameteri(X.TEXTURE_CUBE_MAP,X.TEXTURE_MAG_FILTER,X.LINEAR);for(let te=0;te<6;++te)X.texImage2D(X.TEXTURE_CUBE_MAP_POSITIVE_X+te,0,X.RGBA,32,32,0,X.RGBA,X.UNSIGNED_BYTE,null)}K.bindFramebuffer.set(ee.framebuffer),K.viewport.set([0,0,32,32]);const V=z.getCenter(O,!0),W=O.useProgram("skyboxCapture"),ie=new Float64Array(16);p.identity(ie),p.rotateY(ie,ie,.5*-Math.PI),Xr(K,z,W,ie,V,0),p.identity(ie),p.rotateY(ie,ie,.5*Math.PI),Xr(K,z,W,ie,V,1),p.identity(ie),p.rotateX(ie,ie,.5*-Math.PI),Xr(K,z,W,ie,V,2),p.identity(ie),p.rotateX(ie,ie,.5*Math.PI),Xr(K,z,W,ie,V,3),p.identity(ie),Xr(K,z,W,ie,V,4),p.identity(ie),p.rotateY(ie,ie,Math.PI),Xr(K,z,W,ie,V,5),K.viewport.set([0,0,O.width,O.height])}(f,h),h.markSkyboxValid(f)):"sky"===f.renderPass&&function(O,z,$,Q,K){const X=O.context,ee=X.gl,V=O.transform,W=O.useProgram("skybox");X.activeTexture.set(ee.TEXTURE0),ee.bindTexture(ee.TEXTURE_CUBE_MAP,z.skyboxTexture);const ie={u_matrix:V.skyboxMatrix,u_sun_direction:z.getCenter(O,!1),u_cubemap:0,u_opacity:Q,u_temporal_offset:K};O.prepareDrawProgram(X,W),W.draw(X,ee.TRIANGLES,$,p.StencilMode.disabled,O.colorModeForRenderPass(),p.CullFaceMode.backCW,ie,"skybox",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(f,h,k,b,F):"gradient"===M&&"sky"===f.renderPass&&function(O,z,$,Q,K){const X=O.context,ee=X.gl,V=O.transform,W=O.useProgram("skyboxGradient");z.skyboxGeometry||(z.skyboxGeometry=new ld(X)),X.activeTexture.set(ee.TEXTURE0);let ie=z.colorRampTexture;ie||(ie=z.colorRampTexture=new p.Texture(X,z.colorRamp,ee.RGBA)),ie.bind(ee.LINEAR,ee.CLAMP_TO_EDGE);const te=(pe=V.skyboxMatrix,me=z.getCenter(O,!1),fe=z.paint.get("sky-gradient-radius"),ve=Q,ye=K,{u_matrix:pe,u_color_ramp:0,u_center_direction:me,u_radius:p.degToRad(fe),u_opacity:ve,u_temporal_offset:ye});var pe,me,fe,ve,ye;O.prepareDrawProgram(X,W),W.draw(X,ee.TRIANGLES,$,p.StencilMode.disabled,O.colorModeForRenderPass(),p.CullFaceMode.backCW,te,"skyboxGradient",z.skyboxGeometry.vertexBuffer,z.skyboxGeometry.indexBuffer,z.skyboxGeometry.segment)}(f,h,k,b,F)},debug:function(f,a,h){for(let _=0;_<h.length;_++)br(f,a,h[_])},custom:function(f,a,h,_){const v=f.context,b=h.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||"offscreen"===f.renderPass)&&h.isLayerDraped()){if("offscreen"===f.renderPass){const T=b.prerender;if(T){if(f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),"globe"===f.transform.projection.name){const M=f.transform.pointMerc;T.call(b,v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),p.globeToMercatorTransition(f.transform.zoom),[M.x,M.y],f.transform.pixelsPerMeterRatio)}else T.call(b,v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState()}}else if("translucent"===f.renderPass){if(f.terrain&&f.terrain.renderingToTexture){const M=b.renderToTile;if(M){const k=_[0].canonical,F=new p.MercatorCoordinate(k.x+_[0].wrap*(1<<k.z),k.y,k.z);v.setDepthMode(p.DepthMode.disabled),v.setStencilMode(p.StencilMode.disabled),v.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),M.call(b,v.gl,F),v.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),v.setColorMode(f.colorModeForRenderPass()),v.setStencilMode(p.StencilMode.disabled);const T="3d"===b.renderingMode?new p.DepthMode(f.context.gl.LEQUAL,p.DepthMode.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,p.DepthMode.ReadOnly);if(v.setDepthMode(T),"globe"===f.transform.projection.name){const M=f.transform.pointMerc;b.render(v.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),p.globeToMercatorTransition(f.transform.zoom),[M.x,M.y],f.transform.pixelsPerMeterRatio)}else b.render(v.gl,f.transform.customLayerMatrix());v.setDirty(),f.setBaseState(),v.bindFramebuffer.set(null)}}else p.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class No{constructor(a,h,_=!1){this.context=new rt(a,_),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=p.SourceCache.maxUnderzooming+p.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(a,h){const _=!!a&&!!a.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new td(this,a));const v=this._terrain;this.transform.elevation=_?v:null,v.update(a,this.transform,h)}_updateFog(a){const h=a.fog;if(!h||"globe"===this.transform.projection.name||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,v]=h.getFovAdjustedRange(this.transform._fov);if(_>v)return void(this.transform.fogCullDistSq=null);const b=_+.78*(v-_);this.transform.fogCullDistSq=b*b}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(a,h){if(this.width=a*p.exported.devicePixelRatio,this.height=h*p.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const a=this.context,h=new p.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(p.EXTENT,0),h.emplaceBack(0,p.EXTENT),h.emplaceBack(p.EXTENT,p.EXTENT),this.tileExtentBuffer=a.createVertexBuffer(h,p.posAttributes.members),this.tileExtentSegments=p.SegmentVector.simpleSegment(0,0,4,2);const _=new p.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(p.EXTENT,0),_.emplaceBack(0,p.EXTENT),_.emplaceBack(p.EXTENT,p.EXTENT),this.debugBuffer=a.createVertexBuffer(_,p.posAttributes.members),this.debugSegments=p.SegmentVector.simpleSegment(0,0,4,5);const v=new p.StructArrayLayout2i4;v.emplaceBack(-1,-1),v.emplaceBack(1,-1),v.emplaceBack(-1,1),v.emplaceBack(1,1),this.viewportBuffer=a.createVertexBuffer(v,p.posAttributes.members),this.viewportSegments=p.SegmentVector.simpleSegment(0,0,4,2);const b=new p.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(p.EXTENT,0,p.EXTENT,0),b.emplaceBack(0,p.EXTENT,0,p.EXTENT),b.emplaceBack(p.EXTENT,p.EXTENT,p.EXTENT,p.EXTENT),this.mercatorBoundsBuffer=a.createVertexBuffer(b,p.boundsAttributes.members),this.mercatorBoundsSegments=p.SegmentVector.simpleSegment(0,0,4,2);const T=new p.StructArrayLayout3ui6;T.emplaceBack(0,1,2),T.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=a.createIndexBuffer(T);const M=new p.StructArrayLayout1ui2;for(const F of[0,1,3,2,0])M.emplaceBack(F);this.debugIndexBuffer=a.createIndexBuffer(M),this.emptyTexture=new p.Texture(a,new p.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),a.gl.RGBA),this.identityMat=p.create();const k=this.context.gl;this.stencilClearMode=new p.StencilMode({func:k.ALWAYS,mask:0},0,255,k.ZERO,k.ZERO,k.ZERO),this.loadTimeStamps.push(p.window.performance.now()),this.atmosphereBuffer=new Mc(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(a){return a._makeTileBoundsBuffers(this.context,this.transform.projection),a._tileBoundsBuffer?{tileBoundsBuffer:a._tileBoundsBuffer,tileBoundsIndexBuffer:a._tileBoundsIndexBuffer,tileBoundsSegments:a._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const a=this.context,h=a.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(a,h.TRIANGLES,p.DepthMode.disabled,this.stencilClearMode,p.ColorMode.disabled,p.CullFaceMode.disabled,Wt(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(a,h,_){if(!h||this.currentStencilSource===h.id||!a.isTileClipped()||!_||0===_.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const k of _)if(void 0===this._tileClippingMaskIDs[k.key]){M=!0;break}if(!M)return}this.currentStencilSource=h.id;const v=this.context,b=v.gl;this.nextStencilID+_.length>256&&this.clearStencil(),v.setColorMode(p.ColorMode.disabled),v.setDepthMode(p.DepthMode.disabled);const T=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of _){const k=h.getTile(M),F=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:z,tileBoundsSegments:$}=this.getTileBoundsBuffers(k);T.draw(v,b.TRIANGLES,p.DepthMode.disabled,new p.StencilMode({func:b.ALWAYS,mask:0},F,255,b.KEEP,b.KEEP,b.REPLACE),p.ColorMode.disabled,p.CullFaceMode.disabled,Wt(M.projMatrix),"$clipping",O,z,$)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const a=this.nextStencilID++,h=this.context.gl;return new p.StencilMode({func:h.NOTEQUAL,mask:255},a,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(a){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(a);const h=this.context.gl;return new p.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[a.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(a){const h=this.context.gl,_=a.sort((T,M)=>M.overscaledZ-T.overscaledZ),v=_[_.length-1].overscaledZ,b=_[0].overscaledZ-v+1;if(b>1){this.currentStencilSource=void 0,this.nextStencilID+b>256&&this.clearStencil();const T={};for(let M=0;M<b;M++)T[M+v]=new p.StencilMode({func:h.GEQUAL,mask:255},M+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=b,[T,_]}return[{[v]:p.StencilMode.disabled},_]}colorModeForRenderPass(){const a=this.context.gl;return this._showOverdrawInspector?new p.ColorMode([a.CONSTANT_COLOR,a.ONE],new p.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?p.ColorMode.unblended:p.ColorMode.alphaBlended}depthModeForSublayer(a,h,_){if(!this.opaquePassEnabledForLayer())return p.DepthMode.disabled;const v=1-((1+this.currentLayer)*this.numSublayers+a)*this.depthEpsilon;return new p.DepthMode(_||this.context.gl.LEQUAL,h,[v,v])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(a,h){this.style=a,this.options=h,this.imageManager=a.imageManager,this.glyphManager=a.glyphManager,this.symbolFadeChange=a.placement.symbolFadeChange(p.exported.now()),this.imageManager.beginFrame();const _=this.style.order,v=this.style._sourceCaches;for(const F in v){const O=v[F];O.used&&O.prepare(this.context)}const b={},T={},M={};for(const F in v){const O=v[F];b[F]=O.getVisibleCoordinates(),T[F]=b[F].slice().reverse(),M[F]=O.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let F=0;F<_.length;F++)if(this.style._layers[_[F]].is3D()){this.opaquePassCutoff=F;break}if(this.terrain&&(this.terrain.updateTileBinding(M),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new p.GlobeSharedBuffers(this.context)),!p.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const F of _){const O=this.style._layers[F],z=a._getLayerSourceCache(O);if(!O.hasOffscreenPass()||O.isHidden(this.transform.zoom))continue;const $=z?T[z.id]:void 0;("custom"===O.type||O.isSky()||$&&$.length)&&this.renderLayer(this,z,O,$)}this.depthRangeFor3D=[0,1-(a.order.length+2)*this.numSublayers*this.depthEpsilon];const k=this.terrain;if(k&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&k.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?p.Color.black:p.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const F=this.style._layers[_[this.currentLayer]],O=a._getLayerSourceCache(F);if(F.isSky())continue;const z=O?T[O.id]:void 0;this._renderTileClippingMasks(F,O,z),this.renderLayer(this,O,F,z)}if(this.style.fog&&this.transform.projection.supportsFog&&function(F,O){const z=F.context,$=z.gl,Q=F.transform,K=new p.DepthMode($.LEQUAL,p.DepthMode.ReadOnly,[0,1]),X=F.useProgram("globeAtmosphere",null,"globe"===Q.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ee=p.globeToMercatorTransition(Q.zoom),V=O.properties.get("color").toArray01(),W=O.properties.get("high-color").toArray01(),ie=O.properties.get("space-color").toArray01PremultipliedAlpha(),te=p.identity$1([]);p.rotateY$1(te,te,-p.degToRad(Q._center.lng)),p.rotateX$1(te,te,p.degToRad(Q._center.lat)),p.rotateZ$1(te,te,Q.angle),p.rotateX$1(te,te,-Q._pitch);const pe=p.fromQuat(new Float32Array(16),te),me=p.mapValue(O.properties.get("star-intensity"),0,1,0,.25),ve=p.mapValue(O.properties.get("horizon-blend"),0,1,5e-4,.25),ye=p.globeUseCustomAntiAliasing(F,z,Q)&&5e-4===ve?Q.worldSize/(2*Math.PI*1.025)-1:Q.globeRadius,Me=F.frameCounter/1e3%1,Ze=p.length(Q.globeCenterInViewSpace),Ce=Math.sqrt(Math.pow(Ze,2)-Math.pow(ye,2)),Be=Math.acos(Ce/Ze),Se={u_frustum_tl:Q.frustumCorners.TL,u_frustum_tr:Q.frustumCorners.TR,u_frustum_br:Q.frustumCorners.BR,u_frustum_bl:Q.frustumCorners.BL,u_horizon:Q.frustumCorners.horizon,u_transition:ee,u_fadeout_range:ve,u_color:V,u_high_color:W,u_space_color:ie,u_star_intensity:me,u_star_size:5*p.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Me,u_horizon_angle:Be,u_rotation_matrix:pe};F.prepareDrawProgram(z,X);const Qe=F.atmosphereBuffer;Qe&&X.draw(z,$.TRIANGLES,K,p.StencilMode.disabled,p.ColorMode.alphaBlended,p.CullFaceMode.backCW,Se,"skybox",Qe.vertexBuffer,Qe.indexBuffer,Qe.segments)}(this,this.style.fog),this.renderPass="sky",(p.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const F=this.style._layers[_[this.currentLayer]],O=a._getLayerSourceCache(F);F.isSky()&&this.renderLayer(this,O,F,O?T[O.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const F=this.style._layers[_[this.currentLayer]],O=a._getLayerSourceCache(F);if(F.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(F)){if(F.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const z=O?("symbol"===F.type?M:T)[O.id]:void 0;this._renderTileClippingMasks(F,O,O?b[O.id]:void 0),this.renderLayer(this,O,F,z),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let F=null;p.values(this.style._layers).forEach(O=>{const z=a._getLayerSourceCache(O);z&&!O.isHidden(this.transform.zoom)&&(!F||F.getSource().maxzoom<z.getSource().maxzoom)&&(F=z)}),F&&this.options.showTileBoundaries&&hs.debug(this,F,F.getVisibleCoordinates())}this.options.showPadding&&function(F){const O=F.transform.padding;Pl(F,F.transform.height-(O.top||0),3,tn),Pl(F,O.bottom||0,3,sd),Fs(F,O.left||0,3,Tc),Fs(F,F.transform.width-(O.right||0),3,bp);const z=F.transform.centerPoint;var $,Q,K,X;Fr($=F,(Q=z.x)-1,(K=F.transform.height-z.y)-10,2,20,X=kl),Fr($,Q-10,K-1,20,2,X)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(p.window.performance.now()),this.saveCanvasCopy())}renderLayer(a,h,_,v){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||v&&v.length)&&(this.id=_.id,this.gpuTimingStart(_),(!a.transform.projection.unsupportedLayers||!a.transform.projection.unsupportedLayers.includes(_.type)||a.terrain&&"custom"===_.type)&&hs[_.type](a,h,_,v,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(a){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let _=this.gpuTimers[a.id];_||(_=this.gpuTimers[a.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const a=this.context.extTimerQuery,h=a.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),a.beginQueryEXT(a.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;a.endQueryEXT(a.TIME_ELAPSED_EXT)}collectGpuTimers(){const a=this.gpuTimers;return this.gpuTimers={},a}collectDeferredRenderGpuQueries(){const a=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],a}queryGpuTimers(a){const h={};for(const _ in a){const v=a[_],b=this.context.extTimerQuery,T=b.getQueryObjectEXT(v.query,b.QUERY_RESULT_EXT)/1e6;b.deleteQueryEXT(v.query),h[_]=T}return h}queryGpuTimeDeferredRender(a){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let _=0;for(const v of a)_+=h.getQueryObjectEXT(v,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(v);return _}translatePosMatrix(a,h,_,v,b){if(!_[0]&&!_[1])return a;const T=b?"map"===v?this.transform.angle:0:"viewport"===v?-this.transform.angle:0;if(T){const F=Math.sin(T),O=Math.cos(T);_=[_[0]*O-_[1]*F,_[0]*F+_[1]*O]}const M=[b?_[0]:zi(h,_[0],this.transform.zoom),b?_[1]:zi(h,_[1],this.transform.zoom),0],k=new Float32Array(16);return p.translate(k,a,M),k}saveTileTexture(a){const h=this._tileTextures[a.size[0]];h?h.push(a):this._tileTextures[a.size[0]]=[a]}getTileTexture(a){const h=this._tileTextures[a];return h&&h.length>0?h.pop():null}isPatternMissing(a){return null===a||void 0!==a&&!this.imageManager.getPattern(a.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const a=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&0===this.terrain.exaggeration(),_=this.style&&this.style.fog,v=[];return this.terrainRenderModeElevated()&&v.push("TERRAIN"),"globe"===this.transform.projection.name&&v.push("GLOBE"),h&&v.push("ZERO_EXAGGERATION"),_&&!a&&0!==_.getOpacity(this.transform.pitch)&&v.push("FOG"),a&&v.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&v.push("OVERDRAW_INSPECTOR"),v}useProgram(a,h,_){this.cache=this.cache||{};const v=_||[],b=this.currentGlobalDefines().concat(v),T=bn.cacheKey(ti[a],a,b,h);return this.cache[T]||(this.cache[T]=new bn(this.context,a,ti[a],h,Sl[a],b)),this.cache[T]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const a=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(a.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=p.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new p.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(a,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;const v=this.style.fog;if(v){const b=v.getOpacity(this.transform.pitch),T=((M,k,F,O,z,$,Q,K,X,ee,V)=>{const W=M.transform,ie=k.properties.get("color").toArray01();ie[3]=O;const te=M.frameCounter/1e3%1;return{u_fog_matrix:F?W.calculateFogTileMatrix(F):M.identityMat,u_fog_range:k.getFovAdjustedRange(W._fov),u_fog_color:ie,u_fog_horizon_blend:k.properties.get("horizon-blend"),u_fog_temporal_offset:te,u_frustum_tl:z,u_frustum_tr:$,u_frustum_br:Q,u_frustum_bl:K,u_globe_pos:X,u_globe_radius:ee,u_viewport:V,u_globe_transition:p.globeToMercatorTransition(W.zoom),u_is_globe:+("globe"===W.projection.name)}})(this,v,_,b,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*p.exported.devicePixelRatio,this.transform.height*p.exported.devicePixelRatio]);h.setFogUniformValues(a,T)}}setTileLoadedFlag(a){this.tileLoaded=a}saveCanvasCopy(){const a=this.canvasCopy();a&&(this.frameCopies.push(a),this.tileLoaded=!1)}canvasCopy(){const a=this.context.gl,h=a.createTexture();return a.bindTexture(a.TEXTURE_2D,h),a.copyTexImage2D(a.TEXTURE_2D,0,a.RGBA,0,0,a.drawingBufferWidth,a.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const a=this.style&&this.style.fog;return!!a&&0!==a.getOpacity(this.transform.pitch)}getBackgroundTiles(){const a=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const v of _)h[v.key]=a[v.key]||new p.Tile(v,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class Qi{constructor(a=0,h=0,_=0,v=0){if(isNaN(a)||a<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(v)||v<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=a,this.bottom=h,this.left=_,this.right=v}interpolate(a,h,_){return null!=h.top&&null!=a.top&&(this.top=p.number(a.top,h.top,_)),null!=h.bottom&&null!=a.bottom&&(this.bottom=p.number(a.bottom,h.bottom,_)),null!=h.left&&null!=a.left&&(this.left=p.number(a.left,h.left,_)),null!=h.right&&null!=a.right&&(this.right=p.number(a.right,h.right,_)),this}getCenter(a,h){const _=p.clamp((this.left+a-this.right)/2,0,a),v=p.clamp((this.top+h-this.bottom)/2,0,h);return new p.Point(_,v)}equals(a){return this.top===a.top&&this.bottom===a.bottom&&this.left===a.left&&this.right===a.right}clone(){return new Qi(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function cd(f,a){const h=p.getColumn(f,3);p.fromQuat(f,a),p.setColumn(f,3,h)}function Zt(f,a){const h=p.identity$1([]);return p.rotateZ$1(h,h,-a),p.rotateX$1(h,h,-f),h}function Lr(f,a){const h=[f[0],f[1],0],_=[a[0],a[1],0];if(p.length(h)>=1e-15){const T=p.normalize([],h);p.scale$2(_,T,p.dot(_,T)),a[0]=_[0],a[1]=_[1]}const v=p.cross([],a,f);if(p.len(v)<1e-15)return null;const b=Math.atan2(-v[1],v[0]);return Zt(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),b)}class Ru{constructor(a,h){this.position=a,this.orientation=h}get position(){return this._position}set position(a){if(a){const h=a instanceof p.MercatorCoordinate?a:new p.MercatorCoordinate(a[0],a[1],a[2]);this._renderWorldCopies&&(h.x=p.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(a,h){if(this.orientation=null,!this.position)return;const _=this.position,v=this._elevation?this._elevation.getAtPointOrZero(p.MercatorCoordinate.fromLngLat(a)):0,b=p.MercatorCoordinate.fromLngLat(a,v),T=[b.x-_.x,b.y-_.y,b.z-_.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=Lr(T,h)}setPitchBearing(a,h){this.orientation=Zt(p.degToRad(a),p.degToRad(-h))}}class da{constructor(a,h){this._transform=p.identity([]),this.orientation=h,this.position=a}get mercatorPosition(){const a=this.position;return new p.MercatorCoordinate(a[0],a[1],a[2])}get position(){const a=p.getColumn(this._transform,3);return[a[0],a[1],a[2]]}set position(a){var h;a&&p.setColumn(this._transform,3,[(h=a)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(a){this._orientation=a||p.identity$1([]),a&&cd(this._transform,this._orientation)}getPitchBearing(){const a=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(a[0]*a[0]+a[1]*a[1]),-a[2])}}setPitchBearing(a,h){this._orientation=Zt(a,h),cd(this._transform,this._orientation)}forward(){const a=p.getColumn(this._transform,2);return[-a[0],-a[1],-a[2]]}up(){const a=p.getColumn(this._transform,1);return[-a[0],-a[1],-a[2]]}right(){const a=p.getColumn(this._transform,0);return[a[0],a[1],a[2]]}getCameraToWorld(a,h){const _=new Float64Array(16);return p.invert(_,this.getWorldToCamera(a,h)),_}getWorldToCameraPosition(a,h,_){const v=this.position;p.scale$2(v,v,-a);const b=new Float64Array(16);return p.fromScaling(b,[_,_,_]),p.translate(b,b,v),b[10]*=h,b}getWorldToCamera(a,h){const _=new Float64Array(16),v=new Float64Array(4),b=this.position;return p.conjugate(v,this._orientation),p.scale$2(b,b,-a),p.fromQuat(_,v),p.translate(_,_,b),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(a,h,_,v){const b=new Float64Array(16);return p.perspective(b,a,h,_,v),b}getDistanceToElevation(a,h=!1){const _=0===a?0:p.mercatorZfromAltitude(a,h?p.latFromMercatorY(this.position[1]):this.position[1]),v=this.forward();return(_-this.position[2])/v[2]}clone(){return new da([...this.position],[...this.orientation])}}function Ls(f,a){const h=Ou(f.projection,f.zoom,f.width,f.height),_=function(b,T,M,k,F){const O=new p.LngLat(M.lng-180*pa,M.lat),z=new p.LngLat(M.lng+180*pa,M.lat),$=b.project(O.lng,O.lat),Q=b.project(z.lng,z.lat),K=-Math.atan2(Q.y-$.y,Q.x-$.x),X=p.MercatorCoordinate.fromLngLat(M);X.y=p.clamp(X.y,-1+pa,1-pa);const ee=X.toLngLat(),V=b.project(ee.lng,ee.lat),W=p.MercatorCoordinate.fromLngLat(ee);W.x+=pa;const ie=W.toLngLat(),te=b.project(ie.lng,ie.lat),pe=Fu(te.x-V.x,te.y-V.y,K),me=p.MercatorCoordinate.fromLngLat(ee);me.y+=pa;const fe=me.toLngLat(),ve=b.project(fe.lng,fe.lat),ye=Fu(ve.x-V.x,ve.y-V.y,K),Me=Math.abs(pe.x)/Math.abs(ye.y),Ze=p.identity([]);p.rotateZ(Ze,Ze,-K*(1-(F?0:k)));const Ce=p.identity([]);return p.scale(Ce,Ce,[1,1-(1-Me)*k,1]),Ce[4]=-ye.x/ye.y*k,p.rotateZ(Ce,Ce,K),p.multiply(Ce,Ze,Ce),Ce}(f.projection,0,f.center,h,a),v=_o(f);return p.scale(_,_,[v,v,1]),_}function _o(f){const a=f.projection,h=Ou(f.projection,f.zoom,f.width,f.height),_=wp(a,f.center),v=wp(a,p.LngLat.convert(a.center));return Math.pow(2,_*h+(1-h)*v)}function Ou(f,a,h,_,v=1/0){const b=f.range;if(!b)return 0;const T=Math.min(v,Math.max(h,_)),M=Math.log(T/1024)/Math.LN2;return p.smoothstep(b[0]+M,b[1]+M,a)}const pa=1/4e4;function wp(f,a){const h=p.clamp(a.lat,-p.MAX_MERCATOR_LATITUDE,p.MAX_MERCATOR_LATITUDE),_=new p.LngLat(a.lng-180*pa,h),v=new p.LngLat(a.lng+180*pa,h),b=f.project(_.lng,h),T=f.project(v.lng,h),M=p.MercatorCoordinate.fromLngLat(_),k=p.MercatorCoordinate.fromLngLat(v),F=T.x-b.x,O=T.y-b.y,z=k.x-M.x,$=k.y-M.y,Q=Math.sqrt((z*z+$*$)/(F*F+O*O));return Math.log(Q)/Math.LN2}function Fu(f,a,h){const _=Math.cos(h),v=Math.sin(h);return{x:f*_-a*v,y:f*v+a*_}}class Dc{constructor(a,h,_,v,b,T,M){this.tileSize=512,this._renderWorldCopies=void 0===b||b,this._minZoom=a||0,this._maxZoom=h||22,this._minPitch=_??0,this._maxPitch=v??60,this.setProjection(T),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new p.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Qi,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new da,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const a=new Dc(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return a._elevation=this._elevation,a._centerAltitude=this._centerAltitude,a._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,a.tileSize=this.tileSize,a.mercatorFromTransition=this.mercatorFromTransition,a.width=this.width,a.height=this.height,a.cameraElevationReference=this.cameraElevationReference,a._center=this._center,a._setZoom(this.zoom),a._seaLevelZoom=this._seaLevelZoom,a.angle=this.angle,a._fov=this._fov,a._pitch=this._pitch,a._nearZ=this._nearZ,a._farZ=this._farZ,a._averageElevation=this._averageElevation,a._unmodified=this._unmodified,a._edgeInsets=this._edgeInsets.clone(),a._camera=this._camera.clone(),a._calcMatrices(),a.freezeTileCoverage=this.freezeTileCoverage,a.frustumCorners=this.frustumCorners,a}get elevation(){return this._elevation}set elevation(a){this._elevation!==a&&(this._elevation=a,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(a,h=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||_)&&this._updateCameraOnTerrain(),(a||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return p.pick(this.projection,["name","center","parallels"])}setProjection(a){this.projectionOptions=a||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=p.getProjection(this.projectionOptions);const _=!je(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const a=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=p.getProjection({name:"mercator"});const h=a!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(a){this._minZoom!==a&&(this._minZoom=a,this.zoom=Math.max(this.zoom,a))}get maxZoom(){return this._maxZoom}set maxZoom(a){this._maxZoom!==a&&(this._maxZoom=a,this.zoom=Math.min(this.zoom,a))}get minPitch(){return this._minPitch}set minPitch(a){this._minPitch!==a&&(this._minPitch=a,this.pitch=Math.max(this.pitch,a))}get maxPitch(){return this._maxPitch}set maxPitch(a){this._maxPitch!==a&&(this._maxPitch=a,this.pitch=Math.min(this.pitch,a))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(a){void 0===a?a=!0:null===a&&(a=!1),this._renderWorldCopies=a}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get cameraWorldSize(){const a=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(a))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return p.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new p.Point(this.width,this.height)}get bearing(){return p.wrap(this.rotation,-180,180)}set bearing(a){this.rotation=a}get rotation(){return-this.angle/Math.PI*180}set rotation(a){const h=-a*Math.PI/180;var _,v,b,T,M,k,F,O,z,$;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new p.ARRAY_TYPE(4),p.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),v=this.rotationMatrix,T=this.angle,M=(b=this.rotationMatrix)[0],k=b[1],F=b[2],O=b[3],z=Math.sin(T),$=Math.cos(T),v[0]=M*$+F*z,v[1]=k*$+O*z,v[2]=M*-z+F*$,v[3]=k*-z+O*$)}get pitch(){return this._pitch/Math.PI*180}set pitch(a){const h=p.clamp(a,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const a=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/a)}set fov(a){a=Math.max(.01,Math.min(60,a)),this._fov!==a&&(this._unmodified=!1,this._fov=p.degToRad(a),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(a){this._averageElevation=a,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(a){const h=Math.min(Math.max(a,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(a){this._zoom=a,this.scale=this.zoomScale(a),this.tileZoom=Math.floor(a),this.zoomFraction=a-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const a=this._elevation;this._centerAltitude=a.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=a.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const a=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let v=0,b=0;for(let T=0;T<h.length;T++){const M=new p.Point(h[T][0]*this.width,_+h[T][1]*(this.height-_)),k=a.pointCoordinate(M);if(!k)continue;const F=1/Math.hypot(k[0]-this._camera.position[0],k[1]-this._camera.position[1]);v+=k[3]*F,b+=F}return 0===b?NaN:v/b}get center(){return this._center}set center(a){a.lat===this._center.lat&&a.lng===this._center.lng||(this._unmodified=!1,this._center=a,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const a=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,v=this._mercatorZfromZoom(a),b=this._mercatorZfromZoom(this._maxZoom),T=Math.max(v-_,b);this._setZoom(this._zoomFromMercatorZ(T))}get padding(){return this._edgeInsets.toJSON()}set padding(a){this._edgeInsets.equals(a)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,a,1),this._calcMatrices())}computeZoomRelativeTo(a){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,a.toAltitude()));let _;_=a.z<this._camera.position[2]?[h.x,h.y,h.z]:[a.x,a.y,a.z];const v=p.length(p.sub([],this._camera.position,_));return p.clamp(this._zoomFromMercatorZ(v),this._minZoom,this._maxZoom)}setFreeCameraOptions(a){if(!this.height||!a.position&&!a.orientation)return;this._updateCameraState();let h=!1;if(a.orientation&&!p.exactEquals(a.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(a.orientation)),a.position){const _=[a.position.x,a.position.y,a.position.z];p.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const a=this._camera.position,h=new Ru;return h.position=new p.MercatorCoordinate(a[0],a[1],a[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(a){if(!p.length$1(a))return!1;p.normalize$1(a,a);const h=p.transformQuat([],[0,0,-1],a),_=p.transformQuat([],[0,-1,0],a);if(_[2]<0)return!1;const v=Lr(h,_);return!!v&&(this._camera.orientation=v,!0)}_setCameraPosition(a){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,v=this.cameraToCenterDistance;a[2]=p.clamp(a[2],v/_,v/h),this._camera.position=a}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(a){return this._edgeInsets.equals(a)}interpolatePadding(a,h,_){this._unmodified=!1,this._edgeInsets.interpolate(a,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(a){const h=(a.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/a.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(a){const h=[new p.UnwrappedTileID(0,a)];if(this.renderWorldCopies){const _=this.pointCoordinate(new p.Point(0,0)),v=this.pointCoordinate(new p.Point(this.width,0)),b=this.pointCoordinate(new p.Point(this.width,this.height)),T=this.pointCoordinate(new p.Point(0,this.height)),M=Math.floor(Math.min(_.x,v.x,b.x,T.x)),k=Math.floor(Math.max(_.x,v.x,b.x,T.x)),F=1;for(let O=M-F;O<=k+F;O++)0!==O&&h.push(new p.UnwrappedTileID(O,a))}return h}coveringTiles(a){let h=this.coveringZoomLevel(a);const _=h,v=this.elevation&&!a.isTerrainDEM,b="mercator"===this.projection.name;if(void 0!==a.minzoom&&h<a.minzoom)return[];void 0!==a.maxzoom&&h>a.maxzoom&&(h=a.maxzoom);const T=this.locationCoordinate(this.center),M=this.center.lat,k=1<<h,F=[k*T.x,k*T.y,0],O="globe"===this.projection.name,z=!O,$=p.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,z),Q=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),K=k*p.mercatorZfromAltitude(1,this.center.lat),X=this._camera.position[2]/p.mercatorZfromAltitude(1,this.center.lat),ee=[k*Q.x,k*Q.y,X*(z?1:K)],V=this.cameraToCenterDistance/a.tileSize*(a.roundZoom?1:.502),W=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,ie=a.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,te=a.isTerrainDEM?-ie:this._elevation?this._elevation.getMinElevationBelowMSL():0,pe=this.projection.isReprojectedInTileSpace?_o(this):1,me=Te=>{const Xe=new p.MercatorCoordinate(Te.x+25e-6,Te.y,Te.z),He=new p.MercatorCoordinate(Te.x,Te.y+25e-6,Te.z),nt=Te.toLngLat(),Ct=Xe.toLngLat(),zt=He.toLngLat(),vt=this.locationCoordinate(nt),kt=this.locationCoordinate(Ct),dn=this.locationCoordinate(zt),cn=Math.hypot(kt.x-vt.x,kt.y-vt.y),Et=Math.hypot(dn.x-vt.x,dn.y-vt.y);return Math.sqrt(cn*Et)*pe/25e-6},fe=Te=>{const Le=ie,Xe=te;return{aabb:p.tileAABB(this,k,0,0,0,Te,Xe,Le,this.projection),zoom:0,x:0,y:0,minZ:Xe,maxZ:Le,wrap:Te,fullyVisible:!1}},ve=[];let ye=[];const Me=h,Ze=a.reparseOverscaled?_:h,Ce=Te=>Te*Te,Be=Ce((X-this._centerAltitude)*K),Se=Te=>{if(!this._elevation||!Te.tileID||!b)return;const Le=this._elevation.getMinMaxForTile(Te.tileID),Xe=Te.aabb;Le?(Xe.min[2]=Le.min,Xe.max[2]=Le.max,Xe.center[2]=(Xe.min[2]+Xe.max[2])/2):(Te.shouldSplit=Qe(Te),Te.shouldSplit||(Xe.min[2]=Xe.max[2]=Xe.center[2]=this._centerAltitude))},Qe=Te=>{if(Te.zoom<W)return!0;if(Te.zoom===Me)return!1;if(null!=Te.shouldSplit)return Te.shouldSplit;const Le=Te.aabb.distanceX(ee),Xe=Te.aabb.distanceY(ee);let He=Be,nt=1;if(O){He=Ce(Te.aabb.distanceZ(ee));const vt=Math.pow(2,Te.zoom),kt=p.latFromMercatorY((Te.y+1)/vt),dn=p.latFromMercatorY(Te.y/vt),cn=Math.min(Math.max(M,kt),dn),Et=p.circumferenceAtLatitude(cn)/p.circumferenceAtLatitude(M);if(nt=cn===M?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Et/this._mercatorScaleRatio),this.zoom<=p.GLOBE_ZOOM_THRESHOLD_MIN&&Te.zoom===Me-1&&Et>=.9)return!0}else if(v&&(He=Ce(Te.aabb.distanceZ(ee)*K)),this.projection.isReprojectedInTileSpace&&_<=5){const vt=Math.pow(2,Te.zoom),kt=me(new p.MercatorCoordinate((Te.x+.5)/vt,(Te.y+.5)/vt));nt=kt>.85?1:kt}const Ct=Le*Le+Xe*Xe+He;return Ct<Ce((1<<Me-Te.zoom)*V*nt*((vt,kt)=>{if(kt*Ce(.707)<vt)return 1;const dn=Math.sqrt(kt/vt);return dn/(1.4144271570014144+(Math.pow(1.1,dn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(He,Be),Ct))};if(this.renderWorldCopies)for(let Te=1;Te<=3;Te++)ve.push(fe(-Te)),ve.push(fe(Te));for(ve.push(fe(0));ve.length>0;){const Te=ve.pop(),Le=Te.x,Xe=Te.y;let He=Te.fullyVisible;if(!He){const nt=Te.aabb.intersects($);if(0===nt)continue;He=2===nt}if(Te.zoom!==Me&&Qe(Te))for(let nt=0;nt<4;nt++){const Ct=(Le<<1)+nt%2,zt=(Xe<<1)+(nt>>1),vt={aabb:b?Te.aabb.quadrant(nt):p.tileAABB(this,k,Te.zoom+1,Ct,zt,Te.wrap,Te.minZ,Te.maxZ,this.projection),zoom:Te.zoom+1,x:Ct,y:zt,wrap:Te.wrap,fullyVisible:He,tileID:void 0,shouldSplit:void 0,minZ:Te.minZ,maxZ:Te.maxZ};v&&!O&&(vt.tileID=new p.OverscaledTileID(Te.zoom+1===Me?Ze:Te.zoom+1,Te.wrap,Te.zoom+1,Ct,zt),Se(vt)),ve.push(vt)}else{const nt=Te.zoom===Me?Ze:Te.zoom;if(a.minzoom&&a.minzoom>nt)continue;const Ct=F[0]-(.5+Le+(Te.wrap<<Te.zoom))*(1<<h-Te.zoom),zt=F[1]-.5-Xe,vt=Te.tileID?Te.tileID:new p.OverscaledTileID(nt,Te.wrap,Te.zoom,Le,Xe);ye.push({tileID:vt,distanceSq:Ct*Ct+zt*zt})}}if(this.fogCullDistSq){const Te=this.fogCullDistSq,Le=this.horizonLineFromTop();ye=ye.filter(Xe=>{const He=[0,0,0,1],nt=[p.EXTENT,p.EXTENT,0,1],Ct=this.calculateFogTileMatrix(Xe.tileID.toUnwrapped());p.transformMat4$1(He,He,Ct),p.transformMat4$1(nt,nt,Ct);const zt=p.getAABBPointSquareDist(He,nt);if(0===zt)return!0;let vt=!1;const kt=this._elevation;if(kt&&zt>Te&&0!==Le){const dn=this.calculateProjMatrix(Xe.tileID.toUnwrapped());let cn;a.isTerrainDEM||(cn=kt.getMinMaxForTile(Xe.tileID)),cn||(cn={min:te,max:ie});const Et=p.furthestTileCorner(this.rotation),Sn=[Et[0]*p.EXTENT,Et[1]*p.EXTENT,cn.max];p.transformMat4(Sn,Sn,dn),vt=(1-Sn[1])*this.height*.5<Le}return zt<Te||vt})}return ye.sort((Te,Le)=>Te.distanceSq-Le.distanceSq).map(Te=>Te.tileID)}resize(a,h){this.width=a,this.height=h,this.pixelsToGLUnits=[2/a,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(a){return Math.pow(2,a)}scaleZoom(a){return Math.log(a)/Math.LN2}project(a){const h=p.clamp(a.lat,-p.MAX_MERCATOR_LATITUDE,p.MAX_MERCATOR_LATITUDE),_=this.projection.project(a.lng,h);return new p.Point(_.x*this.worldSize,_.y*this.worldSize)}unproject(a){return this.projection.unproject(a.x/this.worldSize,a.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/p.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(a,h){let _,v;const b=this.centerPoint;if("globe"===this.projection.name){const M=this.worldSize;_=(h.x-b.x)/M,v=(h.y-b.y)/M}else{const M=this.pointCoordinate(h),k=this.pointCoordinate(b);_=M.x-k.x,v=M.y-k.y}const T=this.locationCoordinate(a);this.setLocation(new p.MercatorCoordinate(T.x-_,T.y-v))}setLocation(a){this.center=this.coordinateLocation(a),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(a){return this.projection.locationPoint(this,a)}locationPoint3D(a){return this.projection.locationPoint(this,a,!0)}pointLocation(a){return this.coordinateLocation(this.pointCoordinate(a))}pointLocation3D(a){return this.coordinateLocation(this.pointCoordinate3D(a))}locationCoordinate(a,h){const _=h?p.mercatorZfromAltitude(h,a.lat):void 0,v=this.projection.project(a.lng,a.lat);return new p.MercatorCoordinate(v.x,v.y,_)}coordinateLocation(a){return this.projection.unproject(a.x,a.y)}pointRayIntersection(a,h){const _=h??this._centerAltitude,v=[a.x,a.y,0,1],b=[a.x,a.y,1,1];p.transformMat4$1(v,v,this.pixelMatrixInverse),p.transformMat4$1(b,b,this.pixelMatrixInverse);const T=b[3];p.scale$1(v,v,1/v[3]),p.scale$1(b,b,1/T);const M=v[2],k=b[2];return{p0:v,p1:b,t:M===k?0:(_-M)/(k-M)}}screenPointToMercatorRay(a){const h=[a.x,a.y,0,1],_=[a.x,a.y,1,1];return p.transformMat4$1(h,h,this.pixelMatrixInverse),p.transformMat4$1(_,_,this.pixelMatrixInverse),p.scale$1(h,h,1/h[3]),p.scale$1(_,_,1/_[3]),h[2]=p.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=p.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,p.scale$1(h,h,1/this.worldSize),p.scale$1(_,_,1/this.worldSize),new p.Ray([h[0],h[1],h[2]],p.normalize([],p.sub([],_,h)))}rayIntersectionCoordinate(a){const{p0:h,p1:_,t:v}=a,b=p.mercatorZfromAltitude(h[2],this._center.lat),T=p.mercatorZfromAltitude(_[2],this._center.lat);return new p.MercatorCoordinate(p.number(h[0],_[0],v)/this.worldSize,p.number(h[1],_[1],v)/this.worldSize,p.number(b,T,v))}pointCoordinate(a,h=this._centerAltitude){return this.projection.pointCoordinate(this,a.x,a.y,h)}pointCoordinate3D(a){if(!this.elevation)return this.pointCoordinate(a);let h=this.projection.pointCoordinate3D(this,a.x,a.y);if(h)return new p.MercatorCoordinate(h[0],h[1],h[2]);let _=0,v=this.horizonLineFromTop();if(a.y>v)return this.pointCoordinate(a);const b=.02*v,T=a.clone();for(let M=0;M<10&&v-_>b;M++){T.y=p.number(_,v,.66);const k=this.projection.pointCoordinate3D(this,T.x,T.y);k?(v=T.y,h=k):_=T.y}return h?new p.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(a)}isPointAboveHorizon(a){return this.projection.isPointAboveHorizon(this,a)}isPointOnSurface(a){if(a.y<0||a.y>this.height||a.x<0||a.x>this.width)return!1;if(this.elevation||this.zoom>=p.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(a);const h=this.pointCoordinate(a);return h.y>=0&&h.y<=1}_coordinatePoint(a,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(a,this._centerAltitude):this._centerAltitude,v=[a.x*this.worldSize,a.y*this.worldSize,_+a.toAltitude(),1];return p.transformMat4$1(v,v,this.pixelMatrix),v[3]>0?new p.Point(v[0]/v[3],v[1]/v[3]):new p.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:a,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,v=this.width-this._edgeInsets.right,b=this.pointLocation3D(new p.Point(h,a)),T=this.pointLocation3D(new p.Point(v,a)),M=this.pointLocation3D(new p.Point(v,_)),k=this.pointLocation3D(new p.Point(h,_));let F=Math.min(b.lng,T.lng,M.lng,k.lng),O=Math.max(b.lng,T.lng,M.lng,k.lng),z=Math.min(b.lat,T.lat,M.lat,k.lat),$=Math.max(b.lat,T.lat,M.lat,k.lat);const Q=Math.pow(2,-this.zoom)/16*270,K="globe"===this.projection.name?1:4,X=(ee,V,W,ie,te)=>{const pe=(ee+W)/2,me=(V+ie)/2,fe=new p.Point(pe,me),{lng:ve,lat:ye}=this.pointLocation3D(fe),Me=Math.max(0,F-ve,z-ye,ve-O,ye-$);F=Math.min(F,ve),O=Math.max(O,ve),z=Math.min(z,ye),$=Math.max($,ye),(te<K||Me>Q)&&(X(ee,V,pe,me,te+1),X(pe,me,W,ie,te+1))};if(X(h,a,v,a,1),X(v,a,v,_,1),X(v,_,h,_,1),X(h,_,h,a,1),"globe"===this.projection.name){const[ee,V]=p.polesInViewport(this);ee?($=90,O=180,F=-180):V&&(z=-90,O=180,F=-180)}return new p.LngLatBounds(new p.LngLat(F,z),new p.LngLat(O,$))}_getBoundsRectangular(a,h){const{top:_,left:v}=this._edgeInsets,b=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,M=new p.Point(v,_),k=new p.Point(T,_),F=new p.Point(T,b),O=new p.Point(v,b);let z=this.pointCoordinate(M,a),$=this.pointCoordinate(k,a);const Q=this.pointCoordinate(F,h),K=this.pointCoordinate(O,h),X=(ee,V)=>(V.y-ee.y)/(V.x-ee.x);return z.y>1&&$.y>=0?z=new p.MercatorCoordinate((1-K.y)/X(K,z)+K.x,1):z.y<0&&$.y<=1&&(z=new p.MercatorCoordinate(-K.y/X(K,z)+K.x,0)),$.y>1&&z.y>=0?$=new p.MercatorCoordinate((1-Q.y)/X(Q,$)+Q.x,1):$.y<0&&z.y<=1&&($=new p.MercatorCoordinate(-Q.y/X(Q,$)+Q.x,0)),(new p.LngLatBounds).extend(this.coordinateLocation(z)).extend(this.coordinateLocation($)).extend(this.coordinateLocation(K)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const a=this.elevation;if(!a.visibleDemTiles.length||a.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=a.visibleDemTiles.reduce((_,v)=>{if(v.dem){const b=v.dem.tree;_.min=Math.min(_.min,b.minimums[0]),_.max=Math.max(_.max,b.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*a.exaggeration(),h.max*a.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(a=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return a?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(a){this.maxBounds=a,this.minLat=-p.MAX_MERCATOR_LATITUDE,this.maxLat=p.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,a&&(this.minLat=a.getSouth(),this.maxLat=a.getNorth(),this.minLng=a.getWest(),this.maxLng=a.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=p.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=p.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=p.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=p.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(a,h){return this.projection.createTileMatrix(this,h,a)}calculateDistanceTileData(a){const h=a.key,_=this._distanceTileDataCache;if(_[h])return _[h];const v=a.canonical,b=1/this.height,T=this.cameraWorldSize,M=T/this.zoomScale(v.z),k=(v.x+Math.pow(2,v.z)*a.wrap)*M,F=v.y*M,O=this.point;O.x*=T/this.worldSize,O.y*=T/this.worldSize;const z=this.angle,$=Math.sin(-z),Q=-Math.cos(-z);return _[h]={bearing:[$,Q],center:[(O.x-k)*b,(O.y-F)*b],scale:M/p.EXTENT*b},_[h]}calculateFogTileMatrix(a){const h=a.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const v=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,a);return p.multiply(v,this.worldToFogMatrix,v),_[h]=new Float32Array(v),_[h]}calculateProjMatrix(a,h=!1){const _=a.key,v=h?this._alignedProjMatrixCache:this._projMatrixCache;if(v[_])return v[_];const b=this.calculatePosMatrix(a,this.worldSize);return p.multiply(b,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,b),v[_]=new Float32Array(b),v[_]}calculatePixelsToTileUnitsMatrix(a){const h=a.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const v=function(b,T){const{scale:M}=b.tileTransform,k=M*p.EXTENT/(b.tileSize*Math.pow(2,T.zoom-b.tileID.overscaledZ+b.tileID.canonical.z));return F=new Float32Array(4),$=(O=T.inverseAdjustmentMatrix)[1],Q=O[2],K=O[3],ee=(z=[k,k])[1],F[0]=O[0]*(X=z[0]),F[1]=$*X,F[2]=Q*ee,F[3]=K*ee,F;var F,O,z,$,Q,K,X,ee}(a,this);return _[h]=v,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const a=1/this.worldSize,h=p.fromScaling([],[a,a,a]);return p.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const a=this._elevation;this._updateCameraState();const h=p.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),v=this._camera.forward(),b=p.mercatorZfromAltitude(1,this._center.lat);_[2]/=b,v[2]/=b,p.normalize(v,v);const T=a.raycast(_,v,a.exaggeration());if(T){const M=p.scaleAndAdd([],_,v,T),k=new p.MercatorCoordinate(M[0],M[1],p.mercatorZfromAltitude(M[2],p.latFromMercatorY(M[1]))),F=(k.z+p.length([k.x-_[0],k.y-_[1],k.z-_[2]*b]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(F),this._centerAltitude=k.toAltitude(),this._center=this.coordinateLocation(k),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(a=!1){if(!this._elevation)return;const h=this._elevation,_=p.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,v=this._computeCameraPosition(_),b=h.getAtPointOrZero(new p.MercatorCoordinate(...v)),T=this.pixelsPerMeter/this.worldSize*b,M=this._minimumHeightOverTerrain(),k=v[2]-T;if(k<=M)if(k<0||a){const F=this.locationCoordinate(this._center,this._centerAltitude),O=[v[0],v[1],F.z-v[2]],z=p.length(O);O[2]-=(M-k)/this._pixelsPerMercatorPixel;const $=p.length(O);if(0===$)return;p.scale$2(O,O,z/$*this._pixelsPerMercatorPixel),this._camera.position=[v[0],v[1],F.z*this._pixelsPerMercatorPixel-O[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const a="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||a){const $=this.center;return $.lat=p.clamp($.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!a)&&($.lng=p.clamp($.lng,this.minLng,this.maxLng)),this.center=$,void(this._constraining=!1)}const h=this._unmodified,{x:_,y:v}=this.point;let b=0,T=_,M=v;const k=this.width/2,F=this.height/2,O=this.worldMinY*this.scale,z=this.worldMaxY*this.scale;if(v-F<O&&(M=O+F),v+F>z&&(M=z-F),z-O<this.height&&(b=Math.max(b,this.height/(z-O)),M=(z+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const $=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,K=this.worldSize/2-($+Q)/2;T=(_+K+this.worldSize)%this.worldSize-K,T-k<$&&(T=$+k),T+k>Q&&(T=Q-k),Q-$<this.width&&(b=Math.max(b,this.width/(Q-$)),T=(Q+$)/2)}T===_&&M===v||(this.center=this.unproject(new p.Point(T,M))),b&&(this.zoom+=this.scaleZoom(b)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let a=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(a=Math.max(a,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),a}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const a=this.centerOffset,h=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=p.mercatorZfromAltitude(1,this.center.lat)/p.mercatorZfromAltitude(1,p.GLOBE_SCALE_MATCH_LATITUDE));const _=Ou(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const v="meters"===this.projection.zAxisUnit?h:1,b=this._camera.getWorldToCamera(this.worldSize,v),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-a.x/this.width,T[9]=2*a.y/this.height;let M=p.mul([],T,b);if(this.projection.isReprojectedInTileSpace){const me=this.locationCoordinate(this.center),fe=p.identity([]);p.translate(fe,fe,[me.x*this.worldSize,me.y*this.worldSize,0]),p.multiply(fe,fe,Ls(this)),p.translate(fe,fe,[-me.x*this.worldSize,-me.y*this.worldSize,0]),p.multiply(M,M,fe),this.inverseAdjustmentMatrix=function(ve){const ye=Ls(ve,!0);return lt([],[ye[0],ye[1],ye[4],ye[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=p.scale([],M,[this.worldSize,this.worldSize,this.worldSize/v,1]),this.projMatrix=M,this.invProjMatrix=p.invert(new Float64Array(16),this.projMatrix);const k=p.invert([],T);this.frustumCorners=p.FrustumCorners.fromInvProjectionMatrix(k,this.horizonLineFromTop(),this.height);const F=new Float32Array(16);p.identity(F),p.scale(F,F,[1,-1,1]),p.rotateX(F,F,this._pitch),p.rotateZ(F,F,this.angle);const O=p.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),z=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;O[8]=2*-a.x/this.width,O[9]=2*(a.y+z)/this.height,this.skyboxMatrix=p.multiply(F,O,F);const $=this.point,Q=$.x,K=$.y,X=this.width%2/2,ee=this.height%2/2,V=Math.cos(this.angle),W=Math.sin(this.angle),ie=Q-Math.round(Q)+V*X+W*ee,te=K-Math.round(K)+V*ee+W*X,pe=new Float64Array(M);if(p.translate(pe,pe,[ie>.5?ie-1:ie,te>.5?te-1:te,0]),this.alignedProjMatrix=pe,M=p.create(),p.scale(M,M,[this.width/2,-this.height/2,1]),p.translate(M,M,[1,-1,0]),this.labelPlaneMatrix=M,M=p.create(),p.scale(M,M,[1,-1,1]),p.translate(M,M,[-1,-1,0]),p.scale(M,M,[2/this.width,2/this.height,1]),this.glCoordMatrix=M,this.pixelMatrix=p.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},M=p.invert(new Float64Array(16),this.pixelMatrix),!M)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=M,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=p.calculateGlobeMatrix(this);const me=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=p.transformMat4(me,me,b),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=M;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const a=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,v=1/this.height/this._pixelsPerMercatorPixel,b=[a,a,h];p.scale$2(b,b,v),p.scale$2(_,_,-1),p.multiply$2(_,_,b);const T=p.create();p.translate(T,T,_),p.scale(T,T,b),this.mercatorFogMatrix=T,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(a,h,v)}_computeCameraPosition(a){const h=(a=a||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),v=this.point,b=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-a/this.worldSize*this._centerAltitude;return[v.x/this.worldSize-_[0]*b,v.y/this.worldSize-_[1]*b,a/this.worldSize*this._centerAltitude-_[2]*b]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(a){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],v=a[2];let b=1;this.projection.wrap&&(this.center=this.center.wrap()),v>0&&(b=Math.min((h-_)/v,1)),this._camera.position=p.scaleAndAdd([],this._camera.position,a,b),this._updateStateFromCamera()}_updateStateFromCamera(){const a=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:v}=this._camera.getPitchBearing(),b=p.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,T=this._mercatorZfromZoom(this._maxZoom)*Math.cos(p.degToRad(this._maxPitch)),M=Math.max((a[2]-b)/Math.cos(_),T),k=this._zoomFromMercatorZ(M);p.scaleAndAdd(a,a,h,M),this._pitch=p.clamp(_,p.degToRad(this.minPitch),p.degToRad(this.maxPitch)),this.angle=p.wrap(v,-Math.PI,Math.PI),this._setZoom(p.clamp(k,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new p.MercatorCoordinate(a[0],a[1],a[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(a){return Math.pow(2,a)*this.tileSize}_mercatorZfromZoom(a){return this.cameraToCenterDistance/this._worldSizeFromZoom(a)}_minimumHeightOverTerrain(){const a=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(a)}_zoomFromMercatorZ(a){return this.scaleZoom(this.cameraToCenterDistance/(a*this.tileSize))}zoomFromMercatorZAdjusted(a){let h=0,_=p.GLOBE_ZOOM_THRESHOLD_MAX,v=0,b=1/0;for(;_-h>1e-6&&_>h;){const T=h+.5*(_-h),M=this.tileSize*Math.pow(2,T),k=this.getCameraToCenterDistance(this.projection,T,M),F=this.scaleZoom(k/(a*this.tileSize)),O=Math.abs(T-F);O<b&&(b=O,v=T),T<F?h=T:_=T}return v}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(p.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(a,h){const _=Math.min(a.x,h.x),v=Math.max(a.x,h.x),b=Math.min(a.y,h.y),T=Math.max(a.y,h.y);if(b<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const M=[new p.Point(_,b),new p.Point(v,T),new p.Point(_,T),new p.Point(v,b)],k=this.renderWorldCopies?-3:0,F=this.renderWorldCopies?4:1;for(const O of M){const z=this.pointRayIntersection(O);if(z.t<0)return!0;const $=this.rayIntersectionCoordinate(z);if($.x<k||$.y<0||$.x>F||$.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+p.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new p.Point(0,0),new p.Point(this.width,this.height))}zoomDeltaToMovement(a,h){const _=p.length(p.sub([],this._camera.position,a)),v=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(v)}getCameraPoint(){if("globe"===this.projection.name){const a=function([h,_,v],b){const T=[h,_,v,1];p.transformMat4$1(T,T,b);const M=T[3]=Math.max(T[3],1e-6);return T[0]/=M,T[1]/=M,T[2]/=M,T}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new p.Point(a[0],a[1])}{const a=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new p.Point(0,a))}}getCameraToCenterDistance(a,h=this.zoom,_=this.worldSize){const v=Ou(a,h,this.width,this.height,1024),b=a.pixelSpaceConversion(this.center.lat,_,v);return.5/Math.tan(.5*this._fov)*this.height*b}getWorldToCameraMatrix(){const a=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&p.multiply(a,a,this.globeMatrix),a}}function Sc(f,a){let h=!1,_=null;const v=()=>{_=null,h&&(f(),_=setTimeout(v,a),h=!1)};return()=>(h=!0,_||v(),_)}class Ep{constructor(a){this._hashName=a&&encodeURIComponent(a),p.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Sc(this._updateHashUnthrottled.bind(this),300)}addTo(a){return this._map=a,p.window.addEventListener("hashchange",this._onHashChange,!1),a.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),p.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const a=this._map;if(!a)return"";const h=Lu(a);if(this._hashName){const _=this._hashName;let v=!1;const b=p.window.location.hash.slice(1).split("&").map(T=>{const M=T.split("=")[0];return M===_?(v=!0,`${M}=${h}`):T}).filter(T=>T);return v||b.push(`${_}=${h}`),`#${b.join("&")}`}return`#${h}`}_getCurrentHash(){const a=p.window.location.hash.replace("#","");if(this._hashName){let h;return a.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(h=_)}),(h&&h[1]||"").split("/")}return a.split("/")}_onHashChange(){const a=this._map;if(!a)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some(_=>isNaN(_))){const _=a.dragRotate.isEnabled()&&a.touchZoomRotate.isEnabled()?+(h[3]||0):a.getBearing();return a.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const a=p.window.location.href.replace(/(#.+)?$/,this.getHashString());p.window.history.replaceState(p.window.history.state,null,a)}}function Lu(f,a){const h=f.getCenter(),_=Math.round(100*f.getZoom())/100,v=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),b=Math.pow(10,v),T=Math.round(h.lng*b)/b,M=Math.round(h.lat*b)/b,k=f.getBearing(),F=f.getPitch();let O=a?`/${T}/${M}/${_}`:`${_}/${M}/${T}`;return(k||F)&&(O+="/"+Math.round(10*k)/10),F&&(O+=`/${Math.round(F)}`),O}const Bu={linearity:.3,easing:p.bezier(0,0,.3,1)},ud=p.extend({deceleration:2500,maxSpeed:1400},Bu),hd=p.extend({deceleration:20,maxSpeed:1400},Bu),mt=p.extend({deceleration:1e3,maxSpeed:360},Bu),ds=p.extend({deceleration:1e3,maxSpeed:90},Bu);class vm{constructor(a){this._map=a,this.clear()}clear(){this._inertiaBuffer=[]}record(a){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:p.exported.now(),settings:a})}_drainInertiaBuffer(){const a=this._inertiaBuffer,h=p.exported.now();for(;a.length>0&&h-a[0].time>160;)a.shift()}_onMoveEnd(a){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new p.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:b}of this._inertiaBuffer)h.zoom+=b.zoomDelta||0,h.bearing+=b.bearingDelta||0,h.pitch+=b.pitchDelta||0,b.panDelta&&h.pan._add(b.panDelta),b.around&&(h.around=b.around),b.pinchAround&&(h.pinchAround=b.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,v={};if(h.pan.mag()){const b=zu(h.pan.mag(),_,p.extend({},ud,a||{}));v.offset=h.pan.mult(b.amount/h.pan.mag()),v.center=this._map.transform.center,Nu(v,b)}if(h.zoom){const b=zu(h.zoom,_,hd);v.zoom=this._map.transform.zoom+b.amount,Nu(v,b)}if(h.bearing){const b=zu(h.bearing,_,mt);v.bearing=this._map.transform.bearing+p.clamp(b.amount,-179,179),Nu(v,b)}if(h.pitch){const b=zu(h.pitch,_,ds);v.pitch=this._map.transform.pitch+b.amount,Nu(v,b)}if(v.zoom||v.bearing){const b=void 0===h.pinchAround?h.around:h.pinchAround;v.around=b?this._map.unproject(b):this._map.getCenter()}return this.clear(),v.noMoveStart=!0,v}}function Nu(f,a){(!f.duration||f.duration<a.duration)&&(f.duration=a.duration,f.easing=a.easing)}function zu(f,a,h){const{maxSpeed:_,linearity:v,deceleration:b}=h,T=p.clamp(f*v/(a/1e3),-_,_),M=Math.abs(T)/(b*v);return{easing:h.easing,duration:1e3*M,amount:T*(M/2)}}class ji extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,h,_,v={}){const b=Wr(h.getCanvasContainer(),_),T=h.unproject(b);super(a,p.extend({point:b,lngLat:T,originalEvent:_},v)),this._defaultPrevented=!1,this.target=h}}class Fl extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,h,_){const v="touchend"===a?_.changedTouches:_.touches,b=Pa(h.getCanvasContainer(),v),T=b.map(k=>h.unproject(k)),M=b.reduce((k,F,O,z)=>k.add(F.div(z.length)),new p.Point(0,0));super(a,{points:b,point:M,lngLats:T,lngLat:h.unproject(M),originalEvent:_}),this._defaultPrevented=!1}}class dd extends p.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(a,h,_){super(a,{originalEvent:_}),this._defaultPrevented=!1}}class Cp{constructor(a,h){this._map=a,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(a){return this._firePreventable(new dd(a.type,this._map,a))}mousedown(a,h){return this._mousedownPos=h,this._firePreventable(new ji(a.type,this._map,a))}mouseup(a){this._map.fire(new ji(a.type,this._map,a))}preclick(a){const h=p.extend({},a);h.type="preclick",this._map.fire(new ji(h.type,this._map,h))}click(a,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(a),this._map.fire(new ji(a.type,this._map,a)))}dblclick(a){return this._firePreventable(new ji(a.type,this._map,a))}mouseover(a){this._map.fire(new ji(a.type,this._map,a))}mouseout(a){this._map.fire(new ji(a.type,this._map,a))}touchstart(a){return this._firePreventable(new Fl(a.type,this._map,a))}touchmove(a){this._map.fire(new Fl(a.type,this._map,a))}touchend(a){this._map.fire(new Fl(a.type,this._map,a))}touchcancel(a){this._map.fire(new Fl(a.type,this._map,a))}_firePreventable(a){if(this._map.fire(a),a.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class pd{constructor(a){this._map=a}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(a){this._map.fire(new ji(a.type,this._map,a))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ji("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(a){this._delayContextMenu?this._contextMenuEvent=a:this._map.fire(new ji(a.type,this._map,a)),this._map.listens("contextmenu")&&a.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class fa{constructor(a,h){this._map=a,this._el=a.getCanvasContainer(),this._container=a.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(a,h){this.isEnabled()&&a.shiftKey&&0===a.button&&(cc(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(a,h){if(!this._active)return;const _=h,v=this._startPos,b=this._lastPos;if(!v||!b||b.equals(_)||!this._box&&_.dist(v)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=Xt("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",a));const T=Math.min(v.x,_.x),M=Math.max(v.x,_.x),k=Math.min(v.y,_.y),F=Math.max(v.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${k}px)`,this._box.style.width=M-T+"px",this._box.style.height=F-k+"px")})}mouseupWindow(a,h){if(!this._active)return;const _=this._startPos,v=h;if(_&&0===a.button){if(this.reset(),uo(),_.x!==v.x||_.y!==v.y)return this._map.fire(new p.Event("boxzoomend",{originalEvent:a})),{cameraAnimation:b=>b.fitScreenCoordinates(_,v,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",a)}}keydown(a){this._active&&27===a.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",a))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),gl(),delete this._startPos,delete this._lastPos}_fireEvent(a,h){return this._map.fire(new p.Event(a,{originalEvent:h}))}}function Vu(f,a){const h={};for(let _=0;_<f.length;_++)h[f[_].identifier]=a[_];return h}class Hi{constructor(a){this.reset(),this.numTouches=a.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(a,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=a.timeStamp),_.length===this.numTouches&&(this.centroid=function(v){const b=new p.Point(0,0);for(const T of v)b._add(T);return b.div(v.length)}(h),this.touches=Vu(_,h)))}touchmove(a,h,_){if(this.aborted||!this.centroid)return;const v=Vu(_,h);for(const b in this.touches){const T=v[b];(!T||T.dist(this.touches[b])>30)&&(this.aborted=!0)}}touchend(a,h,_){if((!this.centroid||a.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const v=!this.aborted&&this.centroid;if(this.reset(),v)return v}}}class Uu{constructor(a){this.singleTap=new Hi(a),this.numTaps=a.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(a,h,_){this.singleTap.touchstart(a,h,_)}touchmove(a,h,_){this.singleTap.touchmove(a,h,_)}touchend(a,h,_){const v=this.singleTap.touchend(a,h,_);if(v){const b=a.timeStamp-this.lastTime<500,T=!this.lastTap||this.lastTap.dist(v)<30;if(b&&T||this.reset(),this.count++,this.lastTime=a.timeStamp,this.lastTap=v,this.count===this.numTaps)return this.reset(),v}}}class Am{constructor(){this._zoomIn=new Uu({numTouches:1,numTaps:2}),this._zoomOut=new Uu({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(a,h,_){this._zoomIn.touchstart(a,h,_),this._zoomOut.touchstart(a,h,_)}touchmove(a,h,_){this._zoomIn.touchmove(a,h,_),this._zoomOut.touchmove(a,h,_)}touchend(a,h,_){const v=this._zoomIn.touchend(a,h,_),b=this._zoomOut.touchend(a,h,_);return v?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()+1,around:T.unproject(v)},{originalEvent:a})}):b?(this._active=!0,a.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:T=>T.easeTo({duration:300,zoom:T.getZoom()-1,around:T.unproject(b)},{originalEvent:a})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ip={0:1,2:2};class qa{constructor(a){this.reset(),this._clickTolerance=a.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(a,h){return!1}_move(a,h){return{}}mousedown(a,h){if(this._lastPoint)return;const _=Ms(a);this._correctButton(a,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(a,h){const _=this._lastPoint;if(_)if(a.preventDefault(),null!=this._eventButton&&function(v,b){const T=Ip[b];return void 0===v.buttons||(v.buttons&T)!==T}(a,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}mouseupWindow(a){this._lastPoint&&Ms(a)===this._eventButton&&(this._moved&&uo(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ju extends qa{mousedown(a,h){super.mousedown(a,h),this._lastPoint&&(this._active=!0)}_correctButton(a,h){return 0===h&&!a.ctrlKey}_move(a,h){return{around:h,panDelta:h.sub(a)}}}class fd extends qa{_correctButton(a,h){return 0===h&&a.ctrlKey||2===h}_move(a,h){const _=.8*(h.x-a.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(a){a.preventDefault()}}class kc extends qa{_correctButton(a,h){return 0===h&&a.ctrlKey||2===h}_move(a,h){const _=-.5*(h.y-a.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(a){a.preventDefault()}}class Hu{constructor(a,h){this._map=a,this._el=a.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),p.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new p.Point(0,0)}touchstart(a,h,_){return this._calculateTransform(a,h,_)}touchmove(a,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===_.length&&!p.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return a.cancelable&&a.preventDefault(),this._calculateTransform(a,h,_)}}touchend(a,h,_){this._calculateTransform(a,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(a,h,_){_.length>0&&(this._active=!0);const v=Vu(_,h),b=new p.Point(0,0),T=new p.Point(0,0);let M=0;for(const F in v){const O=v[F],z=this._touches[F];z&&(b._add(O),T._add(O.sub(z)),M++,v[F]=O)}if(this._touches=v,M<this._minTouches||!T.mag())return;const k=T.div(M);return this._sum._add(k),this._sum.mag()<this._clickTolerance?void 0:{around:b.div(M),panDelta:k}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Xt("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class wr{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(a){}_move(a,h,_){return{}}touchstart(a,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(a,h,_){const v=this._firstTwoTouches;if(!v)return;a.preventDefault();const[b,T]=v,M=Ll(_,h,b),k=Ll(_,h,T);if(!M||!k)return;const F=this._aroundCenter?null:M.add(k).div(2);return this._move([M,k],F,a)}touchend(a,h,_){if(!this._firstTwoTouches)return;const[v,b]=this._firstTwoTouches,T=Ll(_,h,v),M=Ll(_,h,b);T&&M||(this._active&&uo(),this.reset())}touchcancel(){this.reset()}enable(a){this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Ll(f,a,h){for(let _=0;_<f.length;_++)if(f[_].identifier===h)return a[_]}function Gu(f,a){return Math.log(f/a)/Math.LN2}class Xi extends wr{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(a){this._startDistance=this._distance=a[0].dist(a[1])}_move(a,h){const _=this._distance;if(this._distance=a[0].dist(a[1]),this._active||!(Math.abs(Gu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Gu(this._distance,_),pinchAround:h}}}function md(f,a){return 180*f.angleWith(a)/Math.PI}class Pc extends wr{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(a){this._startVector=this._vector=a[0].sub(a[1]),this._minDiameter=a[0].dist(a[1])}_move(a,h){const _=this._vector;if(this._vector=a[0].sub(a[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:md(this._vector,_),pinchAround:h}}_isBelowThreshold(a){this._minDiameter=Math.min(this._minDiameter,a.mag());const h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const v=md(a,_);return Math.abs(v)<h}}function Fi(f){return Math.abs(f.y)>Math.abs(f.x)}class Tp extends wr{constructor(a){super(),this._map=a}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(a){this._lastPoints=a,Fi(a[0].sub(a[1]))&&(this._valid=!1)}_move(a,h,_){const v=this._lastPoints;if(!v)return;const b=a[0].sub(v[0]),T=a[1].sub(v[1]);return this._map._cooperativeGestures&&!p.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(b,T,_.timeStamp),!this._valid)?void 0:(this._lastPoints=a,this._active=!0,{pitchDelta:(b.y+T.y)/2*-.5})}gestureBeginsVertically(a,h,_){if(void 0!==this._valid)return this._valid;const v=a.mag()>=2,b=h.mag()>=2;if(!v&&!b)return;if(!v||!b)return null==this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const T=a.y>0==h.y>0;return Fi(a)&&Fi(h)&&T}}const gd={panStep:100,bearingStep:15,pitchStep:10};class Bl{constructor(){const a=gd;this._panStep=a.panStep,this._bearingStep=a.bearingStep,this._pitchStep=a.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(a){if(a.altKey||a.ctrlKey||a.metaKey)return;let h=0,_=0,v=0,b=0,T=0;switch(a.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:a.shiftKey?_=-1:(a.preventDefault(),b=-1);break;case 39:a.shiftKey?_=1:(a.preventDefault(),b=1);break;case 38:a.shiftKey?v=1:(a.preventDefault(),T=-1);break;case 40:a.shiftKey?v=-1:(a.preventDefault(),T=1);break;default:return}return this._rotationDisabled&&(_=0,v=0),{cameraAnimation:M=>{const k=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:Br,zoom:h?Math.round(k)+h*(a.shiftKey?2:1):k,bearing:M.getBearing()+_*this._bearingStep,pitch:M.getPitch()+v*this._pitchStep,offset:[-b*this._panStep,-T*this._panStep],center:M.getCenter()},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Br(f){return f*(2-f)}const _d=4.000244140625;class Rc{constructor(a,h){this._map=a,this._el=a.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,p.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(a){this._defaultZoomRate=a}setWheelZoomRate(a){this._wheelZoomRate=a}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(a){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!a&&"center"===a.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(a){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(a.ctrlKey||a.metaKey||this.isZooming()||p.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=a.deltaMode===p.window.WheelEvent.DOM_DELTA_LINE?40*a.deltaY:a.deltaY;const _=p.exported.now(),v=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==h&&h%_d==0?this._type="wheel":0!==h&&Math.abs(h)<4?this._type="trackpad":v>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,a)):this._type||(this._type=Math.abs(v*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),a.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=a,this._delta-=h,this._active||this._start(a)),a.preventDefault()}_onTimeout(a){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(a)}_start(a){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Wr(this._el,a);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const a=this._map.transform;"wheel"===this._type&&a.projection.wrap&&(a._center.lng>=180||a._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>a._terrainEnabled()&&this._aroundCoord?a.computeZoomRelativeTo(this._aroundCoord):a.zoom;if(0!==this._delta){const k="wheel"===this._type&&Math.abs(this._delta)>_d?this._wheelZoomRate:this._defaultZoomRate;let F=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&0!==F&&(F=1/F);const O=h(),z=Math.pow(2,O),$="number"==typeof this._targetZoom?a.zoomScale(this._targetZoom):z;this._targetZoom=Math.min(a.maxZoom,Math.max(a.minZoom,a.scaleZoom($*F))),"wheel"===this._type&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:h(),v=this._startZoom,b=this._easing;let T,M=!1;if("wheel"===this._type&&v&&b){const k=Math.min((p.exported.now()-this._lastWheelEventTime)/200,1),F=b(k);T=p.number(v,_,F),k<1?this._frameId||(this._frameId=!0):M=!0}else T=_,M=!0;return this._active=!0,M&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!M,zoomDelta:T-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(a){let h=p.ease;if(this._prevEase){const _=this._prevEase,v=(p.exported.now()-_.start)/_.duration,b=_.easing(v+.01)-_.easing(v),T=.27/Math.sqrt(b*b+1e-4)*.01,M=Math.sqrt(.0729-T*T);h=p.bezier(T,M,.25,1)}return this._prevEase={start:p.exported.now(),duration:a,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Xt("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(p.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Mp{constructor(a,h){this._clickZoom=a,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class mi{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(a,h){return a.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(a.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:a})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dp{constructor(){this._tap=new Uu({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(a,h,_){this._swipePoint||(this._tapTime&&a.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(a,h,_))}touchmove(a,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const v=h[0],b=v.y-this._swipePoint.y;return this._swipePoint=v,a.preventDefault(),this._active=!0,{zoomDelta:b/128}}}else this._tap.touchmove(a,h,_)}touchend(a,h,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(a,h,_)&&(this._tapTime=a.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $u{constructor(a,h,_){this._el=a,this._mousePan=h,this._touchPan=_}enable(a){this._inertiaOptions=a||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class on{constructor(a,h,_){this._pitchWithRotate=a.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Sp{constructor(a,h,_,v){this._el=a,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=v,this._rotationDisabled=!1,this._enabled=!0}enable(a){this._touchZoom.enable(a),this._rotationDisabled||this._touchRotate.enable(a),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const zo=f=>f.zoom||f.drag||f.pitch||f.rotate;class kp extends p.Event{}class xm{constructor(){this.constants=[1,1,.01],this.radius=0}setup(a,h){const _=p.sub([],h,a);this.radius=p.length(_[2]<0?p.div([],_,this.constants):[_[0],_[1],0])}projectRay(a){p.div(a,a,this.constants),p.normalize(a,a),p.mul$1(a,a,this.constants);const h=p.scale$2([],a,this.radius);if(h[2]>0){const _=p.scale$2([],[0,0,1],p.dot(h,[0,0,1])),v=p.scale$2([],p.normalize([],[h[0],h[1],0]),this.radius),b=p.add([],h,p.scale$2([],p.sub([],p.add([],v,_),h),2));h[0]=b[0],h[1]=b[1]}return h}}function Vo(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Uo{constructor(a,h){this._map=a,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vm(a),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new xm,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),p.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[p.window.document,"mousemove",{capture:!0}],[p.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[p.window,"blur",void 0]];for(const[v,b,T]of this._listeners)v.addEventListener(b,v===p.window.document?this.handleWindowEvent:this.handleEvent,T)}destroy(){for(const[a,h,_]of this._listeners)a.removeEventListener(h,a===p.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(a){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new Cp(h,a));const v=h.boxZoom=new fa(h,a);this._add("boxZoom",v);const b=new Am,T=new mi;h.doubleClickZoom=new Mp(T,b),this._add("tapZoom",b),this._add("clickZoom",T);const M=new Dp;this._add("tapDragZoom",M);const k=h.touchPitch=new Tp(h);this._add("touchPitch",k);const F=new fd(a),O=new kc(a);h.dragRotate=new on(a,F,O),this._add("mouseRotate",F,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const z=new ju(a),$=new Hu(h,a);h.dragPan=new $u(_,z,$),this._add("mousePan",z),this._add("touchPan",$,["touchZoom","touchRotate"]);const Q=new Pc,K=new Xi;h.touchZoomRotate=new Sp(_,K,Q,M),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",K,["touchPan","touchRotate"]),this._add("blockableMapEvent",new pd(h));const X=h.scrollZoom=new Rc(h,this);this._add("scrollZoom",X,["mousePan"]);const ee=h.keyboard=new Bl;this._add("keyboard",ee);for(const V of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])a.interactive&&a[V]&&h[V].enable(a[V])}_add(a,h,_){this._handlers.push({handlerName:a,handler:h,allowed:_}),this._handlersById[a]=h}stop(a){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},a),this._changes=[]}}isActive(){for(const{handler:a}of this._handlers)if(a.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!zo(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(a,h,_){for(const v in a)if(v!==_&&(!h||h.indexOf(v)<0))return!0;return!1}handleWindowEvent(a){this.handleEvent(a,`${a.type}Window`)}_getMapTouches(a){const h=[];for(const _ of a)this._el.contains(_.target)&&h.push(_);return h}handleEvent(a,h){this._updatingCamera=!0;const _="renderFrame"===a.type,v=_?void 0:a,b={needsRenderFrame:!1},T={},M={},k=a.touches?this._getMapTouches(a.touches):void 0,F=k?Pa(this._el,k):_?void 0:Wr(this._el,a);for(const{handlerName:$,handler:Q,allowed:K}of this._handlers){if(!Q.isEnabled())continue;let X;this._blockedByActive(M,K,$)?Q.reset():Q[h||a.type]&&(X=Q[h||a.type](a,F,k),this.mergeHandlerResult(b,T,X,$,v),X&&X.needsRenderFrame&&this._triggerRenderFrame()),(X||Q.isActive())&&(M[$]=Q)}const O={};for(const $ in this._previousActiveHandlers)M[$]||(O[$]=v);this._previousActiveHandlers=M,(Object.keys(O).length||Vo(b))&&(this._changes.push([b,T,O]),this._triggerRenderFrame()),(Object.keys(M).length||Vo(b))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:z}=b;z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],z(this._map))}mergeHandlerResult(a,h,_,v,b){if(!_)return;p.extend(a,_);const T={handlerName:v,originalEvent:_.originalEvent||b};void 0!==_.zoomDelta&&(h.zoom=T),void 0!==_.panDelta&&(h.drag=T),void 0!==_.pitchDelta&&(h.pitch=T),void 0!==_.bearingDelta&&(h.rotate=T)}_applyChanges(){const a={},h={},_={};for(const[v,b,T]of this._changes)v.panDelta&&(a.panDelta=(a.panDelta||new p.Point(0,0))._add(v.panDelta)),v.zoomDelta&&(a.zoomDelta=(a.zoomDelta||0)+v.zoomDelta),v.bearingDelta&&(a.bearingDelta=(a.bearingDelta||0)+v.bearingDelta),v.pitchDelta&&(a.pitchDelta=(a.pitchDelta||0)+v.pitchDelta),void 0!==v.around&&(a.around=v.around),void 0!==v.aroundCoord&&(a.aroundCoord=v.aroundCoord),void 0!==v.pinchAround&&(a.pinchAround=v.pinchAround),v.noInertia&&(a.noInertia=v.noInertia),p.extend(h,b),p.extend(_,T);this._updateMapTransform(a,h,_),this._changes=[]}_updateMapTransform(a,h,_){const v=this._map,b=v.transform,T=W=>[W.x,W.y,W.z];if((W=>{const ie=this._eventsInProgress.drag;return ie&&!this._handlersById[ie.handlerName].isActive()})()&&!Vo(a)){const W=b.zoom;b.cameraElevationReference="sea",b.recenterOnTerrain(),b.cameraElevationReference="ground",W!==b.zoom&&this._map._update(!0)}if(b._isCameraConstrained&&v._stop(!0),!Vo(a))return void this._fireEvents(h,_,!0);let{panDelta:M,zoomDelta:k,bearingDelta:F,pitchDelta:O,around:z,aroundCoord:$,pinchAround:Q}=a;b._isCameraConstrained&&(k>0&&(k=0),b._isCameraConstrained=!1),void 0!==Q&&(z=Q),(k||(W=>h[W]&&!this._eventsInProgress[W])("drag"))&&z&&(this._dragOrigin=T(b.pointCoordinate3D(z)),this._trackingEllipsoid.setup(b._camera.position,this._dragOrigin)),b.cameraElevationReference="sea",v._stop(!0),z=z||v.transform.centerPoint,F&&(b.bearing+=F),O&&(b.pitch+=O),b._updateCameraState();const K=[0,0,0];if(M)if("mercator"===b.projection.name){const W=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(z).dir),ie=this._trackingEllipsoid.projectRay(b.screenPointToMercatorRay(z.sub(M)).dir);K[0]=ie[0]-W[0],K[1]=ie[1]-W[1]}else{const W=b.pointCoordinate(z);if("globe"===b.projection.name){M=M.rotate(-b.angle);const ie=b._pixelsPerMercatorPixel/b.worldSize;K[0]=-M.x*p.mercatorScale(p.latFromMercatorY(W.y))*ie,K[1]=-M.y*p.mercatorScale(b.center.lat)*ie}else{const ie=b.pointCoordinate(z.sub(M));W&&ie&&(K[0]=ie.x-W.x,K[1]=ie.y-W.y)}}const X=b.zoom,ee=[0,0,0];if(k){const W=T($||b.pointCoordinate3D(z)),ie={dir:p.normalize([],p.sub([],W,b._camera.position))};if(ie.dir[2]<0){const te=b.zoomDeltaToMovement(W,k);p.scale$2(ee,ie.dir,te)}}const V=p.add(K,K,ee);b._translateCameraConstrained(V),k&&Math.abs(b.zoom-X)>1e-4&&b.recenterOnTerrain(),b.cameraElevationReference="ground",this._map._update(),a.noInertia||this._inertia.record(a),this._fireEvents(h,_,!0)}_fireEvents(a,h,_){const v=zo(this._eventsInProgress),b=zo(a),T={};for(const O in a){const{originalEvent:z}=a[O];this._eventsInProgress[O]||(T[`${O}start`]=z),this._eventsInProgress[O]=a[O]}!v&&b&&this._fireEvent("movestart",b.originalEvent);for(const O in T)this._fireEvent(O,T[O]);b&&this._fireEvent("move",b.originalEvent);for(const O in a){const{originalEvent:z}=a[O];this._fireEvent(O,z)}const M={};let k;for(const O in this._eventsInProgress){const{handlerName:z,originalEvent:$}=this._eventsInProgress[O];this._handlersById[z].isActive()||(delete this._eventsInProgress[O],k=h[z]||$,M[`${O}end`]=k)}for(const O in M)this._fireEvent(O,M[O]);const F=zo(this._eventsInProgress);if(_&&(v||b)&&!F){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=$=>0!==$&&-this._bearingSnap<$&&$<this._bearingSnap;O?(z(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:k})):(this._map.fire(new p.Event("moveend",{originalEvent:k})),z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(a,h){this._map.fire(new p.Event(a,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(a=>{this._frameId=void 0,this.handleEvent(new kp("renderFrame",{timeStamp:a})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Wa="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qu extends p.Evented{constructor(a,h){super(),this._moving=!1,this._zooming=!1,this.transform=a,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=!1!==h.respectPrefersReducedMotion,p.bindAll(["_renderFrameCallback"],this)}getCenter(){return new p.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(a,h){return this.jumpTo({center:a},h)}panBy(a,h,_){return a=p.Point.convert(a).mult(-1),this.panTo(this.transform.center,p.extend({offset:a},h),_)}panTo(a,h,_){return this.easeTo(p.extend({center:a},h),_)}getZoom(){return this.transform.zoom}setZoom(a,h){return this.jumpTo({zoom:a},h),this}zoomTo(a,h,_){return this.easeTo(p.extend({zoom:a},h),_)}zoomIn(a,h){return this.zoomTo(this.getZoom()+1,a,h),this}zoomOut(a,h){return this.zoomTo(this.getZoom()-1,a,h),this}getBearing(){return this.transform.bearing}setBearing(a,h){return this.jumpTo({bearing:a},h),this}getPadding(){return this.transform.padding}setPadding(a,h){return this.jumpTo({padding:a},h),this}rotateTo(a,h,_){return this.easeTo(p.extend({bearing:a},h),_)}resetNorth(a,h){return this.rotateTo(0,p.extend({duration:1e3},a),h),this}resetNorthPitch(a,h){return this.easeTo(p.extend({bearing:0,pitch:0,duration:1e3},a),h),this}snapToNorth(a,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(a,h):this}getPitch(){return this.transform.pitch}setPitch(a,h){return this.jumpTo({pitch:a},h),this}cameraForBounds(a,h){a=p.LngLatBounds.convert(a);const _=h&&h.bearing||0,v=h&&h.pitch||0,b=a.getNorthWest(),T=a.getSouthEast();return this._cameraForBounds(this.transform,b,T,_,v,h)}_extendCameraOptions(a){const h={top:0,bottom:0,right:0,left:0};if("number"==typeof(a=p.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},a)).padding){const _=a.padding;a.padding={top:_,bottom:_,right:_,left:_}}return a.padding=p.extend(h,a.padding),a}_minimumAABBFrustumDistance(a,h){const _=h.max[0]-h.min[0],v=h.max[1]-h.min[1];return _/v>a.aspect?_/(2*Math.tan(.5*a.fovX)*a.aspect):v/(2*Math.tan(.5*a.fovY)*a.aspect)}_cameraForBoundsOnGlobe(a,h,_,v,b,T){const M=a.clone(),k=this._extendCameraOptions(T);M.bearing=v,M.pitch=b;const F=p.LngLat.convert(h),O=p.LngLat.convert(_),z=.5*(F.lat+O.lat),$=.5*(F.lng+O.lng),Q=p.latLngToECEF(z,$),K=p.normalize([],Q),X=p.normalize([],p.cross([],K,[0,1,0])),ee=p.cross([],X,K),V=[X[0],X[1],X[2],0,ee[0],ee[1],ee[2],0,K[0],K[1],K[2],0,0,0,0,1],W=[Q,p.latLngToECEF(F.lat,F.lng),p.latLngToECEF(O.lat,F.lng),p.latLngToECEF(O.lat,O.lng),p.latLngToECEF(F.lat,O.lng),p.latLngToECEF(z,F.lng),p.latLngToECEF(z,O.lng),p.latLngToECEF(F.lat,$),p.latLngToECEF(O.lat,$)];let ie=p.Aabb.fromPoints(W.map(He=>[p.dot(X,He),p.dot(ee,He),p.dot(K,He)]));const te=p.transformMat4([],ie.center,V);0===p.squaredLength(te)&&p.set(te,0,0,1),p.normalize(te,te),p.scale$2(te,te,p.GLOBE_RADIUS),M.center=p.ecefToLatLng(te);const pe=M.getWorldToCameraMatrix(),me=p.invert(new Float64Array(16),pe);ie=p.Aabb.applyTransform(ie,p.multiply([],pe,V)),p.transformMat4(te,te,pe);const fe=.5*(ie.max[2]-ie.min[2]),ve=this._minimumAABBFrustumDistance(M,ie),ye=p.scale$2([],[0,0,1],fe),Me=p.add(ye,te,ye),Ze=ve+(0===M.pitch?0:p.distance(te,Me)),Ce=M.globeCenterInViewSpace,Be=p.sub([],te,[Ce[0],Ce[1],Ce[2]]);p.normalize(Be,Be),p.scale$2(Be,Be,Ze);const Se=p.add([],te,Be);p.transformMat4(Se,Se,me);const Qe=p.earthRadius/p.GLOBE_RADIUS,Te=p.length(Se),Le=p.mercatorZfromAltitude(Math.max(Te*Qe-p.earthRadius,Number.EPSILON),0),Xe=Math.min(M.zoomFromMercatorZAdjusted(Le),k.maxZoom);return Xe>.5*(p.GLOBE_ZOOM_THRESHOLD_MIN+p.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"mercator"}),M.zoom=Xe,this._cameraForBounds(M,h,_,v,b,T)):{center:M.center,zoom:Xe,bearing:v,pitch:b}}queryTerrainElevation(a,h){const _=this.transform.elevation;return _?(h=p.extend({},{exaggerated:!0},h),_.getAtPoint(p.MercatorCoordinate.fromLngLat(a),null,h.exaggerated)):null}_cameraForBounds(a,h,_,v,b,T){if("globe"===a.projection.name)return this._cameraForBoundsOnGlobe(a,h,_,v,b,T);const M=a.clone(),k=this._extendCameraOptions(T),F=M.padding;M.bearing=v,M.pitch=b;const O=p.LngLat.convert(h),z=p.LngLat.convert(_),$=new p.LngLat(O.lng,z.lat),Q=new p.LngLat(z.lng,O.lat),K=M.project(O),X=M.project(z),ee=this.queryTerrainElevation(O),V=this.queryTerrainElevation(z),W=this.queryTerrainElevation($),ie=this.queryTerrainElevation(Q),te=[[K.x,K.y,Math.min(ee||0,V||0,W||0,ie||0)],[X.x,X.y,Math.max(ee||0,V||0,W||0,ie||0)]];let pe=p.Aabb.fromPoints(te);const me=M.getWorldToCameraMatrix(),fe=p.invert(new Float64Array(16),me);pe=p.Aabb.applyTransform(pe,me);const ve=p.sub([],pe.max,pe.min),ye=F.left||0,Me=F.right||0,Ze=F.bottom||0,Ce=F.top||0,{left:Be,right:Se,top:Qe,bottom:Te}=k.padding,Le=.5*(ye+Me),Xe=.5*(Ce+Ze),He=Math.min(M.scaleZoom(M.scale*Math.min((M.width-(ye+Me+Be+Se))/ve[0],(M.height-(Ze+Ce+Te+Qe))/ve[1])),k.maxZoom),nt=M.scale/M.zoomScale(He);pe=new p.Aabb([pe.min[0]-(Be+Le)*nt,pe.min[1]-(Te+Xe)*nt,pe.min[2]],[pe.max[0]+(Se+Le)*nt,pe.max[1]+(Qe+Xe)*nt,pe.max[2]]);const Ct=.5*ve[2],zt=this._minimumAABBFrustumDistance(M,pe),vt=[0,0,1,0];p.transformMat4$1(vt,vt,me),p.normalize$2(vt,vt);const kt=p.scale$2([],vt,zt+Ct),dn=p.add([],pe.center,kt),cn=("number"==typeof k.offset.x&&"number"==typeof k.offset.y?new p.Point(k.offset.x,k.offset.y):p.Point.convert(k.offset)).rotate(-p.degToRad(v));pe.center[0]-=cn.x*nt,pe.center[1]+=cn.y*nt,p.transformMat4(pe.center,pe.center,fe),p.transformMat4(dn,dn,fe);const Et=[pe.center[0],pe.center[1],dn[2]*M.pixelsPerMeter];p.scale$2(Et,Et,1/M.worldSize);const Sn=p.lngFromMercatorX(Et[0]),Un=p.latFromMercatorY(Et[1]),kn=Math.min(M._zoomFromMercatorZ(Et[2]),k.maxZoom),jn=new p.LngLat(Sn,Un);return M.mercatorFromTransition&&kn<.5*(p.GLOBE_ZOOM_THRESHOLD_MIN+p.GLOBE_ZOOM_THRESHOLD_MAX)?(M.setProjection({name:"globe"}),M.zoom=kn,this._cameraForBounds(M,h,_,v,b,T)):{center:jn,zoom:kn,bearing:v,pitch:b}}fitBounds(a,h,_){const v=this.cameraForBounds(a,h);return this._fitInternal(v,h,_)}fitScreenCoordinates(a,h,_,v,b){const T=p.Point.convert(a),M=p.Point.convert(h),k=new p.Point(Math.min(T.x,M.x),Math.min(T.y,M.y)),F=new p.Point(Math.max(T.x,M.x),Math.max(T.y,M.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(T,M))return this;const O=this.transform.pointLocation3D(k),z=this.transform.pointLocation3D(F),$=this.transform.pointLocation3D(new p.Point(k.x,F.y)),Q=this.transform.pointLocation3D(new p.Point(F.x,k.y)),K=[Math.min(O.lng,z.lng,$.lng,Q.lng),Math.min(O.lat,z.lat,$.lat,Q.lat)],X=[Math.max(O.lng,z.lng,$.lng,Q.lng),Math.max(O.lat,z.lat,$.lat,Q.lat)],ee=v&&v.pitch?v.pitch:this.getPitch(),V=this._cameraForBounds(this.transform,K,X,_,ee,v);return this._fitInternal(V,v,b)}_fitInternal(a,h,_){return a?(delete(h=p.extend(a,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(a,h){this.stop();const _=a.preloadOnly?this.transform.clone():this.transform;let v=!1,b=!1,T=!1;return"zoom"in a&&_.zoom!==+a.zoom&&(v=!0,_.zoom=+a.zoom),void 0!==a.center&&(_.center=p.LngLat.convert(a.center)),"bearing"in a&&_.bearing!==+a.bearing&&(b=!0,_.bearing=+a.bearing),"pitch"in a&&_.pitch!==+a.pitch&&(T=!0,_.pitch=+a.pitch),null==a.padding||_.isPaddingEqual(a.padding)||(_.padding=a.padding),a.preloadOnly?(this._preloadTiles(_),this):(this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h)),v&&this.fire(new p.Event("zoomstart",h)).fire(new p.Event("zoom",h)).fire(new p.Event("zoomend",h)),b&&this.fire(new p.Event("rotatestart",h)).fire(new p.Event("rotate",h)).fire(new p.Event("rotateend",h)),T&&this.fire(new p.Event("pitchstart",h)).fire(new p.Event("pitch",h)).fire(new p.Event("pitchend",h)),this.fire(new p.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||p.warnOnce(Wa),this.transform.getFreeCameraOptions()}setFreeCameraOptions(a,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return p.warnOnce(Wa),this;this.stop();const v=_.zoom,b=_.pitch,T=_.bearing;_.setFreeCameraOptions(a);const M=v!==_.zoom,k=b!==_.pitch,F=T!==_.bearing;return this.fire(new p.Event("movestart",h)).fire(new p.Event("move",h)),M&&this.fire(new p.Event("zoomstart",h)).fire(new p.Event("zoom",h)).fire(new p.Event("zoomend",h)),F&&this.fire(new p.Event("rotatestart",h)).fire(new p.Event("rotate",h)).fire(new p.Event("rotateend",h)),k&&this.fire(new p.Event("pitchstart",h)).fire(new p.Event("pitch",h)).fire(new p.Event("pitchend",h)),this.fire(new p.Event("moveend",h)),this}easeTo(a,h){this._stop(!1,a.easeId),(!1===(a=p.extend({offset:[0,0],duration:500,easing:p.ease},a)).animate||this._prefersReducedMotion(a))&&(a.duration=0);const _=this.transform,v=this.getZoom(),b=this.getBearing(),T=this.getPitch(),M=this.getPadding(),k="zoom"in a?+a.zoom:v,F="bearing"in a?this._normalizeBearing(a.bearing,b):b,O="pitch"in a?+a.pitch:T,z="padding"in a?a.padding:_.padding,$=p.Point.convert(a.offset);let Q,K,X;if("globe"===_.projection.name){const ye=p.MercatorCoordinate.fromLngLat(_.center),Me=$.rotate(-_.angle);ye.x+=Me.x/_.worldSize,ye.y+=Me.y/_.worldSize;const Ze=ye.toLngLat(),Ce=p.LngLat.convert(a.center||Ze);this._normalizeCenter(Ce),Q=_.centerPoint.add(Me),K=new p.Point(ye.x,ye.y).mult(_.worldSize),X=new p.Point(p.mercatorXfromLng(Ce.lng),p.mercatorYfromLat(Ce.lat)).mult(_.worldSize).sub(K)}else{Q=_.centerPoint.add($);const ye=_.pointLocation(Q),Me=p.LngLat.convert(a.center||ye);this._normalizeCenter(Me),K=_.project(ye),X=_.project(Me).sub(K)}const ee=_.zoomScale(k-v);let V,W;a.around&&(V=p.LngLat.convert(a.around),W=_.locationPoint(V));const ie=this._zooming||k!==v,te=this._rotating||b!==F,pe=this._pitching||O!==T,me=!_.isPaddingEqual(z),fe=ye=>Me=>{if(ie&&(ye.zoom=p.number(v,k,Me)),te&&(ye.bearing=p.number(b,F,Me)),pe&&(ye.pitch=p.number(T,O,Me)),me&&(ye.interpolatePadding(M,z,Me),Q=ye.centerPoint.add($)),V)ye.setLocationAtPoint(V,W);else{const Ze=ye.zoomScale(ye.zoom-v),Ce=k>v?Math.min(2,ee):Math.max(.5,ee),Be=Math.pow(Ce,1-Me),Se=ye.unproject(K.add(X.mult(Me*Be)).mult(Ze));ye.setLocationAtPoint(ye.renderWorldCopies?Se.wrap():Se,Q)}return a.preloadOnly||this._fireMoveEvents(h),ye};if(a.preloadOnly){const ye=this._emulate(fe,a.duration,_);return this._preloadTiles(ye),this}const ve={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ie,this._rotating=te,this._pitching=pe,this._padding=me,this._easeId=a.easeId,this._prepareEase(h,a.noMoveStart,ve),this._ease(fe(_),ye=>{_.recenterOnTerrain(),this._afterEase(h,ye)},a),this}_prepareEase(a,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new p.Event("movestart",a)),this._zooming&&!_.zooming&&this.fire(new p.Event("zoomstart",a)),this._rotating&&!_.rotating&&this.fire(new p.Event("rotatestart",a)),this._pitching&&!_.pitching&&this.fire(new p.Event("pitchstart",a))}_fireMoveEvents(a){this.fire(new p.Event("move",a)),this._zooming&&this.fire(new p.Event("zoom",a)),this._rotating&&this.fire(new p.Event("rotate",a)),this._pitching&&this.fire(new p.Event("pitch",a))}_afterEase(a,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,v=this._rotating,b=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new p.Event("zoomend",a)),v&&this.fire(new p.Event("rotateend",a)),b&&this.fire(new p.Event("pitchend",a)),this.fire(new p.Event("moveend",a))}flyTo(a,h){if(this._prefersReducedMotion(a)){const He=p.pick(a,["center","zoom","bearing","pitch","around"]);return this.jumpTo(He,h)}this.stop(),a=p.extend({offset:[0,0],speed:1.2,curve:1.42,easing:p.ease},a);const _=this.transform,v=this.getZoom(),b=this.getBearing(),T=this.getPitch(),M=this.getPadding(),k="zoom"in a?p.clamp(+a.zoom,_.minZoom,_.maxZoom):v,F="bearing"in a?this._normalizeBearing(a.bearing,b):b,O="pitch"in a?+a.pitch:T,z="padding"in a?a.padding:_.padding,$=_.zoomScale(k-v),Q=p.Point.convert(a.offset);let K=_.centerPoint.add(Q);const X=_.pointLocation(K),ee=p.LngLat.convert(a.center||X);this._normalizeCenter(ee);const V=_.project(X),W=_.project(ee).sub(V);let ie=a.curve;const te=Math.max(_.width,_.height),pe=te/$,me=W.mag();if("minZoom"in a){const He=p.clamp(Math.min(a.minZoom,v,k),_.minZoom,_.maxZoom),nt=te/_.zoomScale(He-v);ie=Math.sqrt(nt/me*2)}const fe=ie*ie;function ve(He){const nt=(pe*pe-te*te+(He?-1:1)*fe*fe*me*me)/(2*(He?pe:te)*fe*me);return Math.log(Math.sqrt(nt*nt+1)-nt)}function ye(He){return(Math.exp(He)-Math.exp(-He))/2}function Me(He){return(Math.exp(He)+Math.exp(-He))/2}const Ze=ve(0);let Ce=function(He){return Me(Ze)/Me(Ze+ie*He)},Be=function(He){return te*((Me(Ze)*(ye(nt=Ze+ie*He)/Me(nt))-ye(Ze))/fe)/me;var nt},Se=(ve(1)-Ze)/ie;if(Math.abs(me)<1e-6||!isFinite(Se)){if(Math.abs(te-pe)<1e-6)return this.easeTo(a,h);const He=pe<te?-1:1;Se=Math.abs(Math.log(pe/te))/ie,Be=function(){return 0},Ce=function(nt){return Math.exp(He*ie*nt)}}a.duration="duration"in a?+a.duration:1e3*Se/("screenSpeed"in a?+a.screenSpeed/ie:+a.speed),a.maxDuration&&a.duration>a.maxDuration&&(a.duration=0);const Qe=b!==F,Te=O!==T,Le=!_.isPaddingEqual(z),Xe=He=>nt=>{const Ct=nt*Se,zt=1/Ce(Ct);He.zoom=1===nt?k:v+He.scaleZoom(zt),Qe&&(He.bearing=p.number(b,F,nt)),Te&&(He.pitch=p.number(T,O,nt)),Le&&(He.interpolatePadding(M,z,nt),K=He.centerPoint.add(Q));const vt=1===nt?ee:He.unproject(V.add(W.mult(Be(Ct))).mult(zt));return He.setLocationAtPoint(He.renderWorldCopies?vt.wrap():vt,K),He._updateCameraOnTerrain(),a.preloadOnly||this._fireMoveEvents(h),He};if(a.preloadOnly){const He=this._emulate(Xe,a.duration,_);return this._preloadTiles(He),this}return this._zooming=!0,this._rotating=Qe,this._pitching=Te,this._padding=Le,this._prepareEase(h,!1),this._ease(Xe(_),()=>this._afterEase(h),a),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(a,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!a){const _=this.handlers;_&&_.stop(!1)}return this}_ease(a,h,_){!1===_.animate||0===_.duration?(a(1),h()):(this._easeStart=p.exported.now(),this._easeOptions=_,this._onEaseFrame=a,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const a=Math.min((p.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(a)),a<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(a,h){a=p.wrap(a,-180,180);const _=Math.abs(a-h);return Math.abs(a-360-h)<_&&(a-=360),Math.abs(a+360-h)<_&&(a+=360),a}_normalizeCenter(a){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const _=a.lng-h.center.lng;a.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(a){return this._respectPrefersReducedMotion&&p.exported.prefersReducedMotion&&!(a&&a.essential)}_emulate(a,h,_){const v=Math.ceil(15*h/1e3),b=[],T=a(_.clone());for(let M=0;M<=v;M++){const k=T(M/v);b.push(k.clone())}return b}}class Ae{constructor(a={}){this.options=a,p.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(a){const h=this.options&&this.options.compact;return this._map=a,this._container=Xt("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Xt("button","mapboxgl-ctrl-attrib-button",this._container),Xt("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Xt("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===h&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(a,h){const _=this._map._getUIString(`AttributionControl.${h}`);a.setAttribute("aria-label",_),a.removeAttribute("title"),a.firstElementChild&&a.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let a=this._editLink;a||(a=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||p.config.ACCESS_TOKEN}];if(a){const _=h.reduce((v,b,T)=>(b.value&&(v+=`${b.key}=${b.value}${T<h.length-1?"&":""}`),v),"?");a.href=`${p.config.FEEDBACK_URL}/${_}#${Lu(this._map,!0)}`,a.rel="noopener nofollow",this._setElementTitle(a,"MapFeedback")}}_updateData(a){!a||"metadata"!==a.sourceDataType&&"visibility"!==a.sourceDataType&&"style"!==a.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let a=[];if(this._map.style.stylesheet){const v=this._map.style.stylesheet;this.styleOwner=v.owner,this.styleId=v.id}const h=this._map.style._sourceCaches;for(const v in h){const b=h[v];if(b.used){const T=b.getSource();T.attribution&&a.indexOf(T.attribution)<0&&a.push(T.attribution)}}a.sort((v,b)=>v.length-b.length),a=a.filter((v,b)=>{for(let T=b+1;T<a.length;T++)if(a[T].indexOf(v)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?a=[...this.options.customAttribution,...a]:a.unshift(this.options.customAttribution));const _=a.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,a.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class In{constructor(){p.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(a){this._map=a,this._container=Xt("div","mapboxgl-ctrl");const h=Xt("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(a){a&&"metadata"!==a.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const a=this._map.style._sourceCaches;if(0===Object.entries(a).length)return!0;for(const h in a){const _=a[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const a=this._container.children;if(a.length){const h=a[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Tn{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(a){const h=++this._id;return this._queue.push({callback:a,id:h,cancelled:!1}),h}remove(a){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const v of _)if(v.id===a)return void(v.cancelled=!0)}run(a=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(a),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function _n(f,a,h){if(f=new p.LngLat(f.lng,f.lat),a){const _=new p.LngLat(f.lng-360,f.lat),v=new p.LngLat(f.lng+360,f.lat),b=360*Math.ceil(Math.abs(f.lng-h.center.lng)/360),T=h.locationPoint(f).distSqr(a),M=a.x<0||a.y<0||a.x>h.width||a.y>h.height;h.locationPoint(_).distSqr(a)<T&&(M||Math.abs(_.lng-h.center.lng)<b)?f=_:h.locationPoint(v).distSqr(a)<T&&(M||Math.abs(v.lng-h.center.lng)<b)&&(f=v)}for(;Math.abs(f.lng-h.center.lng)>180;){const _=h.locationPoint(f);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;f.lng>h.center.lng?f.lng-=360:f.lng+=360}return f}const gi={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class pt extends p.Evented{constructor(a,h){if(super(),(a instanceof p.window.HTMLElement||h)&&(a=p.extend({element:a},h)),p.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=a&&a.anchor||"center",this._color=a&&a.color||"#3FB1CE",this._scale=a&&a.scale||1,this._draggable=a&&a.draggable||!1,this._clickTolerance=a&&a.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=a&&a.rotation||0,this._rotationAlignment=a&&a.rotationAlignment||"auto",this._pitchAlignment=a&&a.pitchAlignment&&a.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=a&&a.occludedOpacity||.2,a&&a.element)this._element=a.element,this._offset=p.Point.convert(a&&a.offset||[0,0]);else{this._defaultMarker=!0,this._element=Xt("div");const v=41,b=27,T=Ni("svg",{display:"block",height:v*this._scale+"px",width:b*this._scale+"px",viewBox:`0 0 ${b} ${v}`},this._element),M=Ni("radialGradient",{id:"shadowGradient"},Ni("defs",{},T));Ni("stop",{offset:"10%","stop-opacity":.4},M),Ni("stop",{offset:"100%","stop-opacity":.05},M),Ni("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},T),Ni("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},T),Ni("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},T),Ni("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},T),this._offset=p.Point.convert(a&&a.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",v=>{v.preventDefault()}),this._element.addEventListener("mousedown",v=>{v.preventDefault()});const _=this._element.classList;for(const v in gi)_.remove(`mapboxgl-marker-anchor-${v}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(a){return a===this._map||(this.remove(),this._map=a,a.getCanvasContainer().appendChild(this._element),a.on("move",this._updateMoving),a.on("moveend",this._update),a.on("remove",this._clearFadeTimer),a._addMarker(this),this.setDraggable(this._draggable),this._update(),a.on("click",this._onMapClick)),this}remove(){const a=this._map;return a&&(a.off("click",this._onMapClick),a.off("move",this._updateMoving),a.off("moveend",this._update),a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler),a.off("mouseup",this._onUp),a.off("touchend",this._onUp),a.off("mousemove",this._onMove),a.off("touchmove",this._onMove),a.off("remove",this._clearFadeTimer),a._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(a){return this._lngLat=p.LngLat.convert(a),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(a){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),a){if(!("offset"in a.options)){const v=Math.sqrt(Math.pow(13.5,2)/2);a.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[v,-1*(24.6+v)],"bottom-right":[-v,-1*(24.6+v)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=a,a._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(a){const h=a.code,_=a.charCode||a.keyCode;"Space"!==h&&"Enter"!==h&&32!==_&&13!==_||this.togglePopup()}_onMapClick(a){const h=a.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const a=this._popup;return a?(a.isOpen()?(a.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(a.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const a=this._map,h=this._pos;if(!a||!h)return!1;const _=a.unproject(h),v=a.getFreeCameraOptions();if(!v.position)return!1;const b=v.position.toLngLat();return b.distanceTo(_)<.9*b.distanceTo(this._lngLat)}_evaluateOpacity(){const a=this._map;if(!a)return;const h=this._pos;if(!h||h.x<0||h.x>a.transform.width||h.y<0||h.y>a.transform.height)return void this._clearFadeTimer();const _=a.unproject(h);let v;a._showingGlobe()&&p.isLngLatBehindGlobe(a.transform,this._lngLat)?v=0:(v=1-a._queryFogOpacity(_),a.transform._terrainEnabled()&&a.getTerrain()&&this._behindTerrain()&&(v*=this._occludedOpacity)),this._element.style.opacity=`${v}`,this._element.style.pointerEvents=v>0?"auto":"none",this._popup&&this._popup._setOpacity(v),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const a=this._pos;if(!a||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${a.x}px,${a.y}px)\n            ${gi[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${h.x}px,${h.y}px)\n        `}_calculateXYTransform(){const a=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!a||"map"!==_)return"";if(!h._showingGlobe()){const k=h.getPitch();return k?`rotateX(${k}deg)`:""}const v=p.radToDeg(p.globeTiltAtLngLat(h.transform,this._lngLat)),b=a.sub(p.globeCenterToScreenPoint(h.transform)),T=Math.abs(b.x)+Math.abs(b.y);if(0===T)return"";const M=v/T;return`rotateX(${-b.y*M}deg) rotateY(${b.x*M}deg)`}_calculateZTransform(){const a=this._pos,h=this._map;if(!h||!a)return"";let _=0;const v=this.getRotationAlignment();if("map"===v)if(h._showingGlobe()){const b=h.project(new p.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),T=h.project(new p.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(b);_=p.radToDeg(Math.atan2(T.y,T.x))-90}else _=-h.getBearing();else if("horizon"===v){const b=p.smoothstep(4,6,h.getZoom()),T=p.globeCenterToScreenPoint(h.transform);T.y+=b*h.transform.height;const M=a.sub(T),k=p.radToDeg(Math.atan2(M.y,M.x));_=(k>90?k-270:k+90)*(1-b)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(a){p.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=_n(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),!0===a?this._updateFrameId=p.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),h._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(a){return this._offset=p.Point.convert(a),this._update(),this}_onMove(a){const h=this._map;if(!h)return;const _=this._pointerdownPos,v=this._positionDelta;if(_&&v){if(!this._isDragging){const b=this._clickTolerance||h._clickTolerance;if(a.point.dist(_)<b)return;this._isDragging=!0}this._pos=a.point.sub(v),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new p.Event("dragstart"))),this.fire(new p.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const a=this._map;a&&(a.off("mousemove",this._onMove),a.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new p.Event("dragend")),this._state="inactive"}_addDragHandler(a){const h=this._map,_=this._pos;h&&_&&this._element.contains(a.originalEvent.target)&&(a.preventDefault(),this._positionDelta=a.point.sub(_),this._pointerdownPos=a.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(a){this._draggable=!!a;const h=this._map;return h&&(a?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(a){return this._rotation=a||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(a){return this._rotationAlignment=a||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(a){return this._pitchAlignment=a||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(a){return this._occludedOpacity=a||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Za={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ps=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Wu(f=new p.Point(0,0),a="bottom"){if("number"==typeof f){const h=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(a){case"top":return new p.Point(0,f);case"top-left":return new p.Point(h,h);case"top-right":return new p.Point(-h,h);case"bottom":return new p.Point(0,-f);case"bottom-left":return new p.Point(h,-h);case"bottom-right":return new p.Point(-h,-h);case"left":return new p.Point(f,0);case"right":return new p.Point(-f,0)}return new p.Point(0,0)}return f instanceof p.Point||Array.isArray(f)?p.Point.convert(f):p.Point.convert(f[a]||[0,0])}class Oc{constructor(a){this.jumpTo(a)}getValue(a){if(a<=this._startTime)return this._start;if(a>=this._endTime)return this._end;const h=p.easeCubicInOut((a-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(a){return a>=this._startTime&&a<=this._endTime}jumpTo(a){this._startTime=-1/0,this._endTime=-1/0,this._start=a,this._end=a}easeTo(a,h,_){this._start=this.getValue(h),this._end=a,this._startTime=h,this._endTime=h+_}}const Pp={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},bm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},Rp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Nr{constructor(a,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new fd({clickTolerance:a.dragRotate._mouseRotate._clickTolerance}),this.map=a,_&&(this.mousePitch=new kc({clickTolerance:a.dragRotate._mousePitch._clickTolerance})),p.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(a,h){this.mouseRotate.mousedown(a,h),this.mousePitch&&this.mousePitch.mousedown(a,h),cc()}move(a,h){const _=this.map,v=this.mouseRotate.mousemoveWindow(a,h),b=v&&v.bearingDelta;if(b&&_.setBearing(_.getBearing()+b),this.mousePitch){const T=this.mousePitch.mousemoveWindow(a,h),M=T&&T.pitchDelta;M&&_.setPitch(_.getPitch()+M)}}off(){const a=this.element;a.removeEventListener("mousedown",this.mousedown),a.removeEventListener("touchstart",this.touchstart,{passive:!1}),a.removeEventListener("touchmove",this.touchmove),a.removeEventListener("touchend",this.touchend),a.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){gl(),p.window.removeEventListener("mousemove",this.mousemove),p.window.removeEventListener("mouseup",this.mouseup)}mousedown(a){this.down(p.extend({},a,{ctrlKey:!0,preventDefault:()=>a.preventDefault()}),Wr(this.element,a)),p.window.addEventListener("mousemove",this.mousemove),p.window.addEventListener("mouseup",this.mouseup)}mousemove(a){this.move(a,Wr(this.element,a))}mouseup(a){this.mouseRotate.mouseupWindow(a),this.mousePitch&&this.mousePitch.mouseupWindow(a),this.offTemp()}touchstart(a){1!==a.targetTouches.length?this.reset():(this._startPos=this._lastPos=Pa(this.element,a.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>a.preventDefault()},this._startPos))}touchmove(a){1!==a.targetTouches.length?this.reset():(this._lastPos=Pa(this.element,a.targetTouches)[0],this.move({preventDefault:()=>a.preventDefault()},this._lastPos))}touchend(a){0===a.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const jo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Zu={maxWidth:100,unit:"metric"},ma={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Kr={version:p.version,supported:Yo,setRTLTextPlugin:p.setRTLTextPlugin,getRTLTextPluginStatus:p.getRTLTextPluginStatus,Map:class extends qu{constructor(f){if(p.LivePerformanceUtils.mark(p.PerformanceMarkers.create),null!=(f=p.extend({},bm,f)).minZoom&&null!=f.maxZoom&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=f.minPitch&&null!=f.maxPitch&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=f.minPitch&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=f.maxPitch&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&p.isSafariWithAntialiasingBug(p.window)&&(f.antialias=!1,p.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Dc(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._useWebGL2=f.useWebGL2,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._optimizeForTerrain=f.optimizeForTerrain,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new Tn,this._domRenderTaskQueue=new Tn,this._controls=[],this._markers=[],this._popups=[],this._mapId=p.uniqueId(),this._locale=p.extend({},Pp,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Oc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new p.RequestManager(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,"string"==typeof f.container){if(this._container=p.window.document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof p.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&p.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),p.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==p.window&&(p.window.addEventListener("online",this._onWindowOnline,!1),p.window.addEventListener("resize",this._onWindowResize,!1),p.window.addEventListener("orientationchange",this._onWindowResize,!1),p.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),p.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Uo(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,f.style&&this.setStyle(f.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this._hash=f.hash&&new Ep("string"==typeof f.hash&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,p.extend({},f.fitBoundsOptions,{duration:0})))),this.resize(),f.attributionControl&&this.addControl(new Ae({customAttribution:f.customAttribution})),this._logoControl=new In,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",a=>{this._update("style"===a.dataType),this.fire(new p.Event(`${a.dataType}data`,a))}),this.on("dataloading",a=>{this.fire(new p.Event(`${a.dataType}dataloading`,a))})}_getMapId(){return this._mapId}addControl(f,a){if(void 0===a&&(a=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=f.onAdd(this);this._controls.push(f);const _=this._controlPositions[a];return-1!==a.indexOf("bottom")?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new p.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const a=this._controls.indexOf(f);return a>-1&&this._controls.splice(a,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const a=!this._moving;return a&&this.fire(new p.Event("movestart",f)).fire(new p.Event("move",f)),this.fire(new p.Event("resize",f)),a&&this.fire(new p.Event("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(p.LngLatBounds.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new p.Event("zoomstart")).fire(new p.Event("zoom")).fire(new p.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new p.Event("zoomstart")).fire(new p.Event("zoom")).fire(new p.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new p.Event("pitchstart")).fire(new p.Event("pitch")).fire(new p.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new p.Event("pitchstart")).fire(new p.Event("pitch")).fire(new p.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return"auto"===f?p.window.navigator.language:Array.isArray(f)?0===f.length?void 0:f.map(a=>"auto"===a?p.window.navigator.language:a):f}setLanguage(f){const a=this._parseLanguage(f);if(!this.style||a===this._language)return this;this._language=a,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(f){return this._lazyInitEmptyStyle(),f?"string"==typeof f&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const f=this.transform,a=f.projection.name;let h;"globe"===a&&f.zoom>=p.GLOBE_ZOOM_THRESHOLD_MAX?(f.setMercatorFromTransition(),h=!0):"mercator"===a&&f.zoom<p.GLOBE_ZOOM_THRESHOLD_MAX&&(f.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,a){return this._updateProjection(f||a||{name:"mercator"})}_updateProjection(f){let a;if(a="globe"===f.name&&this.transform.zoom>=p.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),a){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(f){return this.transform.locationPoint3D(p.LngLat.convert(f))}unproject(f){return this.transform.pointLocation3D(p.Point.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,a,h){if("mouseenter"===f||"mouseover"===f){let _=!1;const v=T=>{const M=a.filter(F=>this.getLayer(F)),k=M.length?this.queryRenderedFeatures(T.point,{layers:M}):[];k.length?_||(_=!0,h.call(this,new ji(f,this,T.originalEvent,{features:k}))):_=!1},b=()=>{_=!1};return{layers:new Set(a),listener:h,delegates:{mousemove:v,mouseout:b}}}if("mouseleave"===f||"mouseout"===f){let _=!1;const v=T=>{const M=a.filter(k=>this.getLayer(k));(M.length?this.queryRenderedFeatures(T.point,{layers:M}):[]).length?_=!0:_&&(_=!1,h.call(this,new ji(f,this,T.originalEvent)))},b=T=>{_&&(_=!1,h.call(this,new ji(f,this,T.originalEvent)))};return{layers:new Set(a),listener:h,delegates:{mousemove:v,mouseout:b}}}{const _=v=>{const b=a.filter(M=>this.getLayer(M)),T=b.length?this.queryRenderedFeatures(v.point,{layers:b}):[];T.length&&(v.features=T,h.call(this,v),delete v.features)};return{layers:new Set(a),listener:h,delegates:{[f]:_}}}}on(f,a,h){if(void 0===h)return super.on(f,a);Array.isArray(a)||(a=[a]);const _=this._createDelegatedListener(f,a,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(_);for(const v in _.delegates)this.on(v,_.delegates[v]);return this}once(f,a,h){if(void 0===h)return super.once(f,a);Array.isArray(a)||(a=[a]);const _=this._createDelegatedListener(f,a,h);for(const v in _.delegates)this.once(v,_.delegates[v]);return this}off(f,a,h){if(void 0===h)return super.off(f,a);a=new Set(Array.isArray(a)?a:[a]);const _=(b,T)=>{if(b.size!==T.size)return!1;for(const M of b)if(!T.has(M))return!1;return!0},v=this._delegatedListeners?this._delegatedListeners[f]:void 0;return v&&(b=>{for(let T=0;T<b.length;T++){const M=b[T];if(M.listener===h&&_(M.layers,a)){for(const k in M.delegates)this.off(k,M.delegates[k]);return b.splice(T,1),this}}})(v),this}queryRenderedFeatures(f,a){return this.style?(void 0!==a||void 0===f||f instanceof p.Point||Array.isArray(f)||(a=f,f=void 0),this.style.queryRenderedFeatures(f=f||[[0,0],[this.transform.width,this.transform.height]],a=a||{},this.transform)):[]}querySourceFeatures(f,a){return this.style.querySourceFeatures(f,a)}isPointOnSurface(f){const{name:a}=this.transform.projection;return"globe"!==a&&"mercator"!==a&&p.warnOnce(`${a} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(p.Point.convert(f))}setStyle(f,a){return!1!==(a=p.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},a)).diff&&a.localIdeographFontFamily===this._localIdeographFontFamily&&a.localFontFamily===this._localFontFamily&&this.style&&f?(this._diffStyle(f,a),this):(this._localIdeographFontFamily=a.localIdeographFontFamily,this._localFontFamily=a.localFontFamily,this._updateStyle(f,a))}_getUIString(f){const a=this._locale[f];if(null==a)throw new Error(`Missing UI string '${f}'`);return a}_updateStyle(f,a){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f&&(this.style=new ss(this,a||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof f?this.style.loadURL(f):this.style.loadJSON(f)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ss(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,a){if("string"==typeof f){const h=this._requestManager.normalizeStyleURL(f),_=this._requestManager.transformRequest(h,p.ResourceType.Style);p.getJSON(_,(v,b)=>{v?this.fire(new p.ErrorEvent(v)):b&&this._updateDiff(b,a)})}else"object"==typeof f&&this._updateDiff(f,a)}_updateDiff(f,a){try{this.style.setState(f)&&this._update(!0)}catch(h){p.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(f,a)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(p.warnOnce("There is no style added to the map."),!1)}addSource(f,a){return this._lazyInitEmptyStyle(),this.style.addSource(f,a),this._update(!0)}isSourceLoaded(f){return!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){const f=this.style&&this.style._sourceCaches;for(const a in f){const h=f[a]._tiles;for(const _ in h){const v=h[_];if("loaded"!==v.state&&"errored"!==v.state)return!1}}return!0}addSourceType(f,a,h){this._lazyInitEmptyStyle(),this.style.addSourceType(f,a,h)}removeSource(f){return this.style.removeSource(f),this._updateTerrain(),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,a,{pixelRatio:h=1,sdf:_=!1,stretchX:v,stretchY:b,content:T}={}){if(this._lazyInitEmptyStyle(),a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap){const{width:M,height:k,data:F}=p.exported.getImageData(a);this.style.addImage(f,{data:new p.RGBAImage({width:M,height:k},F),pixelRatio:h,stretchX:v,stretchY:b,content:T,sdf:_,version:0})}else if(void 0===a.width||void 0===a.height)this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:M,height:k}=a,F=a;this.style.addImage(f,{data:new p.RGBAImage({width:M,height:k},new Uint8Array(F.data)),pixelRatio:h,stretchX:v,stretchY:b,content:T,sdf:_,version:0,userImage:F}),F.onAdd&&F.onAdd(this,f)}}updateImage(f,a){const h=this.style.getImage(f);if(!h)return void this.fire(new p.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap?p.exported.getImageData(a):a,{width:v,height:b}=_;void 0!==v&&void 0!==b?v===h.data.width&&b===h.data.height?(h.data.replace(_.data,!(a instanceof p.window.HTMLImageElement||p.window.ImageBitmap&&a instanceof p.window.ImageBitmap)),this.style.updateImage(f,h)):this.fire(new p.ErrorEvent(new Error(`The width and height of the updated image (${v}, ${b})\n                must be that same as the previous version of the image\n                (${h.data.width}, ${h.data.height})`))):this.fire(new p.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new p.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,a){p.getImage(this._requestManager.transformRequest(f,p.ResourceType.Image),(h,_)=>{a(h,_ instanceof p.window.HTMLImageElement?p.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(f,a){return this._lazyInitEmptyStyle(),this.style.addLayer(f,a),this._update(!0)}moveLayer(f,a){return this.style.moveLayer(f,a),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}setLayerZoomRange(f,a,h){return this.style.setLayerZoomRange(f,a,h),this._update(!0)}setFilter(f,a,h={}){return this.style.setFilter(f,a,h),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,a,h,_={}){return this.style.setPaintProperty(f,a,h,_),this._update(!0)}getPaintProperty(f,a){return this.style.getPaintProperty(f,a)}setLayoutProperty(f,a,h,_={}){return this.style.setLayoutProperty(f,a,h,_),this._update(!0)}getLayoutProperty(f,a){return this.style.getLayoutProperty(f,a)}setLight(f,a={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,a),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(p.LngLat.convert(f),this.transform):0}setFeatureState(f,a){return this.style.setFeatureState(f,a),this._update()}removeFeatureState(f,a){return this.style.removeFeatureState(f,a),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,a=this._container.getBoundingClientRect().height||300;let h,_,v,b=this._container;for(;b&&(!_||!v);){const T=p.window.getComputedStyle(b).transform;T&&"none"!==T&&(h=T.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&"0"!==h[0]&&"1"!==h[0]&&(_=h[0]),h[3]&&"0"!==h[3]&&"1"!==h[3]&&(v=h[3])),b=b.parentElement}this._containerWidth=_?Math.abs(f/_):f,this._containerHeight=v?Math.abs(a/v):a}_detectMissingCSS(){"rgb(250, 128, 114)"!==p.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&p.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=Xt("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const a=this._canvasContainer=Xt("div","mapboxgl-canvas-container",f);this._interactive&&a.classList.add("mapboxgl-interactive"),this._canvas=Xt("canvas","mapboxgl-canvas",a),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=Xt("div","mapboxgl-control-container",f),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(v=>{_[v]=Xt("div",`mapboxgl-ctrl-${v}`,h)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,a){const h=p.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(f),this._canvas.height=h*Math.ceil(a),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${a}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const a=this._markers.indexOf(f);-1!==a&&this._markers.splice(a,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const a=this._popups.indexOf(f);-1!==a&&this._popups.splice(a,1)}_setupPainter(){const f=p.extend({},Yo.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),a=this._useWebGL2&&this._canvas.getContext("webgl2",f),h=a||this._canvas.getContext("webgl",f)||this._canvas.getContext("experimental-webgl",f);h?(this._useWebGL2&&!a&&p.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),p.storeAuthState(h,!0),this.painter=new No(h,this.transform,!!a),this.on("data",_=>{"source"===_.dataType&&this.painter.setTileLoadedFlag(!0)}),p.exported$1.testSupport(h)):this.fire(new p.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new p.Event("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new p.Event("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let a;const h=this.painter.context.extTimerQuery,_=p.exported.now();if(this.listens("gpu-timing-frame")&&(a=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,a)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],p.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],p.window.performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const v=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const M=this.transform.zoom,k=this.transform.pitch,F=p.exported.now(),O=new p.EvaluationParameters(M,{now:F,fadeDuration:v,pitch:k,transition:this.style.getTransition()});this.style.update(O)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let b=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),b=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):b=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,v,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:v,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new p.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new p.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),a){const M=p.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,a),setTimeout(()=>{const k=h.getQueryObjectEXT(a,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(a),this.fire(new p.Event("gpu-timing-frame",{cpuTime:M,gpuTime:k})),p.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:k}})},50)}if(this.listens("gpu-timing-layer")){const M=this.painter.collectGpuTimers();setTimeout(()=>{const k=this.painter.queryGpuTimers(M);this.fire(new p.Event("gpu-timing-layer",{layerTimes:k}))},50)}if(this.listens("gpu-timing-deferred-render")){const M=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const k=this.painter.queryGpuTimeDeferredRender(M);this.fire(new p.Event("gpu-timing-deferred-render",{gpuTime:k}))},50)}const T=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(T||this._repaint)this.triggerRepaint();else{const M=!this.isMoving()&&this.loaded();if(M&&(b=this._updateAverageElevation(_,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),M&&(this.fire(new p.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const k=this._calculateSpeedIndex();this.fire(new p.Event("speedindexcompleted",{speedIndex:k})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||T||(this._fullyLoaded=!0,p.LivePerformanceUtils.mark(p.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&p.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const a of this._markers)f&&!this.getRenderWorldCopies()&&(a._lngLat=a._lngLat.wrap()),a._update();for(const a of this._popups)!f||this.getRenderWorldCopies()||a._trackPointer||(a._lngLat=a._lngLat.wrap()),a._update()}_updateAverageElevation(f,a=!1){const h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&h(0);if((a||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const _=this.transform.averageElevation;let v=this.transform.sampleAverageElevation(),b=!1;this.transform.elevation&&(b=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(v)?v=0:this._averageElevationLastSampledAt=f;const T=Math.abs(_-v);if(T>1){if(this._isInitialLoad||b)return this._averageElevation.jumpTo(v),h(v);this._averageElevation.easeTo(v,f,300)}else if(T>1e-4)return this._averageElevation.jumpTo(v),h(v)}return!!this._averageElevation.isEasing(f)&&h(this._averageElevation.getValue(f))}_authenticate(){p.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===p.AUTH_ERR_MSG||401===f.status)){const a=this.painter.context.gl;p.storeAuthState(a,!1),this._logoControl instanceof In&&this._logoControl._updateLogo(),a&&a.clear(a.DEPTH_BUFFER_BIT|a.COLOR_BUFFER_BIT|a.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new p.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),p.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),a=this.painter.getCanvasCopiesAndTimestamps();a.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function v(b){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,b,0);const T=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,T),T}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(v(f),a.canvasCopies.map(v),a.timeStamps)}_canvasPixelComparison(f,a,h){let _=h[1]-h[0];const v=f.length/4;for(let b=0;b<a.length;b++){const T=a[b];let M=0;for(let k=0;k<T.length;k+=4)T[k]===f[k]&&T[k+1]===f[k+1]&&T[k+2]===f[k+2]&&T[k+3]===f[k+3]&&(M+=1);_+=(h[b+2]-h[b+1])*(1-M/v)}return _}remove(){this._hash&&this._hash.remove();for(const a of this._controls)a.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==p.window&&(p.window.removeEventListener("resize",this._onWindowResize,!1),p.window.removeEventListener("orientationchange",this._onWindowResize,!1),p.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),p.window.removeEventListener("online",this._onWindowOnline,!1),p.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),p.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new p.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=p.exported.frame(a=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(a)}))}_preloadTiles(f){const a=this.style?Object.values(this.style._sourceCaches):[];return p.asyncAll(a,(h,_)=>h._preloadTiles(f,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){"hidden"===p.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,f&&this._update())}_setCacheLimits(f,a){p.setCacheLimits(f,a)}get version(){return p.version}},NavigationControl:class{constructor(f){this.options=p.extend({},Rp,f),this._container=Xt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",a=>a.preventDefault()),this.options.showZoom&&(p.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",a=>{this._map&&this._map.zoomIn({},{originalEvent:a})}),Xt("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",a=>{this._map&&this._map.zoomOut({},{originalEvent:a})}),Xt("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(p.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",a=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:a}):h.resetNorth({},{originalEvent:a}))}),this._compassIcon=Xt("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const a=f.getZoom(),h=a===f.getMaxZoom(),_=a===f.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const a=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=a)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Nr(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,a){const h=Xt("button",f,this._container);return h.type="button",h.addEventListener("click",a),h}_setButtonTitle(f,a){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${a}`);f.setAttribute("aria-label",h),f.firstElementChild&&f.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends p.Evented{constructor(f){super(),this.options=p.extend({geolocation:p.window.navigator.geolocation},jo,f),p.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Sc(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=Xt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const a=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,f(h)};void 0!==this._supportsGeolocation?f(this._supportsGeolocation):void 0!==p.window.navigator.permissions?p.window.navigator.permissions.query({name:"geolocation"}).then(h=>a("denied"!==h.state)).catch(()=>a()):a()}_isOutOfMapMaxBounds(f){const a=this._map.getMaxBounds(),h=f.coords;return!!a&&(h.longitude<a.getWest()||h.longitude>a.getEast()||h.latitude<a.getSouth()||h.latitude>a.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new p.Event("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(f),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(f),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("geolocate",f)),this._finish()}}_updateCamera(f){const a=new p.LngLat(f.coords.longitude,f.coords.latitude),h=f.coords.accuracy,_=this._map.getBearing(),v=p.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(a.toBounds(h),v,{geolocateSource:!0})}_updateMarker(f){if(f){const a=new p.LngLat(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(a).addTo(this._map),this._userLocationDotMarker.setLngLat(a).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,a=p.mercatorZfromAltitude(1,f._center.lat)*f.worldSize,h=Math.ceil(2*this._accuracy*a);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(1===f.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===f.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new p.Event("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",a=>a.preventDefault()),this._geolocateButton=Xt("button","mapboxgl-ctrl-geolocate",this._container),Xt("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===f){p.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const a=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}else{const a=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",a),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",a)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Xt("div","mapboxgl-user-location"),this._dotElement.appendChild(Xt("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Xt("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new pt({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Xt("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new pt({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",a=>{a.geolocateSource||"ACTIVE_LOCK"!==this._watchState||a.originalEvent&&"resize"===a.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new p.Event("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:!0===f.absolute&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return p.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new p.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new p.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new p.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{p.window.addEventListener("ondeviceorientationabsolute"in p.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==p.window.DeviceMotionEvent&&"function"==typeof p.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(a=>{"granted"===a&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),p.window.removeEventListener("deviceorientation",this._onDeviceOrientation),p.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ae,ScaleControl:class{constructor(f){this.options=p.extend({},Zu,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),p.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,a=this._map,h=a._containerHeight/2,_=a._containerWidth/2-f/2,v=a.unproject([_,h]),b=a.unproject([_+f,h]),T=v.distanceTo(b);if("imperial"===this.options.unit){const M=3.2808*T;M>5280?this._setScale(f,M/5280,"mile"):this._setScale(f,M,"foot")}else"nautical"===this.options.unit?this._setScale(f,T/1852,"nautical-mile"):T>=1e3?this._setScale(f,T/1e3,"kilometer"):this._setScale(f,T,"meter")}_setScale(f,a,h){this._map._requestDomTask(()=>{const _=function(b){const T=Math.pow(10,`${Math.floor(b)}`.length-1);let M=b/T;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(k){const F=Math.pow(10,Math.ceil(-Math.log(k)/Math.LN10));return Math.round(k*F)/F}(M),T*M}(a),v=_/a;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==h?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(_):`${_}&nbsp;${ma[h]}`,this._container.style.width=f*v+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=Xt("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f){this._fullscreen=!1,f&&f.container&&(f.container instanceof p.window.HTMLElement?this._container=f.container:p.warnOnce("Full screen control 'container' must be a DOM element.")),p.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in p.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in p.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=Xt("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",p.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,p.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!p.window.document.fullscreenEnabled&&!p.window.document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=Xt("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Xt("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),p.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(p.window.document.fullscreenElement||p.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?p.window.document.exitFullscreen?p.window.document.exitFullscreen():p.window.document.webkitCancelFullScreen&&p.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends p.Evented{constructor(f){super(),this.options=p.extend(Object.create(Za),f),p.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new p.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new p.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=p.LngLat.convert(f),this._pos=null,this._trackPointer=!1,this._update();const a=this._map;return a&&(a.on("move",this._update),a.off("mousemove",this._onMouseEvent),a._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(p.window.document.createTextNode(f))}setHTML(f){const a=p.window.document.createDocumentFragment(),h=p.window.document.createElement("body");let _;for(h.innerHTML=f;_=h.firstChild,_;)a.appendChild(_);return this.setDOMContent(a)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let a=this._content;if(a)for(;a.hasChildNodes();)a.firstChild&&a.removeChild(a.firstChild);else a=this._content=Xt("div","mapboxgl-popup-content",this._container||void 0);if(a.appendChild(f),this.options.closeButton){const h=this._closeButton=Xt("button","mapboxgl-popup-close-button",a);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let a;return this._classList.delete(f)?a=!1:(this._classList.add(f),a=!0),this._updateClassList(),a}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const a=this._map,h=this._container,_=this._pos;if(!a||!h||!_)return"bottom";const v=h.offsetWidth,b=h.offsetHeight,T=_.x<v/2,M=_.x>a.transform.width-v/2;if(_.y+f<b)return T?"top-left":M?"top-right":"top";if(_.y>a.transform.height-b){if(T)return"bottom-left";if(M)return"bottom-right"}return T?"left":M?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const a=[...this._classList];a.push("mapboxgl-popup"),this._anchor&&a.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&a.push("mapboxgl-popup-track-pointer"),f.className=a.join(" ")}_update(f){const a=this._map,h=this._content;if(!a||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=Xt("div","mapboxgl-popup",a.getContainer()),this._tip=Xt("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),a.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=_n(this._lngLat,this._pos,a.transform)),!this._trackPointer||f){const v=this._pos=this._trackPointer&&f?f:a.project(this._lngLat),b=Wu(this.options.offset),T=this._anchor=this._getAnchor(b.y),M=Wu(this.options.offset,T),k=v.add(M).round();a._requestDomTask(()=>{this._container&&T&&(this._container.style.transform=`${gi[T]} translate(${k.x}px,${k.y}px)`)})}if(!this._marker&&a._showingGlobe()){const v=p.isLngLatBehindGlobe(a.transform,this._lngLat)?0:1;this._setOpacity(v)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(ps);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:pt,Style:ss,LngLat:p.LngLat,LngLatBounds:p.LngLatBounds,Point:p.Point,MercatorCoordinate:p.MercatorCoordinate,FreeCameraOptions:Ru,Evented:p.Evented,config:p.config,prewarm:function(){Po().acquire(Wi)},clearPrewarmedResources:function(){const f=Vn;f&&(f.isPreloaded()&&1===f.numActive()?(f.release(Wi),Vn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return p.config.ACCESS_TOKEN},set accessToken(f){p.config.ACCESS_TOKEN=f},get baseApiUrl(){return p.config.API_URL},set baseApiUrl(f){p.config.API_URL=f},get workerCount(){return Zi.workerCount},set workerCount(f){Zi.workerCount=f},get maxParallelImageRequests(){return p.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){p.config.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){p.clearTileCache(f)},workerUrl:"",workerClass:null,setNow:p.exported.setNow,restoreNow:p.exported.restoreNow};return Kr}),oi}()}},pm=>{pm(pm.s=309)}]);